!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AVPlayer=e():t.AVPlayer=e()}(self,(()=>(()=>{var t,e,i={83327:t=>{var e,i,r,s,a,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S;t.exports=(e=void 0,i=!0,r={class:"avplayer-ui-player"},s={class:"avplayer-ui-title"},a={d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"},n={viewBox:"64 64 896 896"},o={href:"https://github.com/zhaohappy/libmedia",target:"_blank"},l={class:"avplayer-ui-header"},c={class:"avplayer-ui-progress-container"},h={class:"avplayer-ui-control-item"},d={class:"avplayer-ui-footer-left"},u={class:"avplayer-ui-footer-right"},f={class:"avplayer-ui-control"},p={class:"avplayer-ui-footer"},m={d:"m10 17 5-5-5-5v10z"},g={viewBox:"0 0 24 24"},v={class:"avplayer-ui-pcm-visualization-container"},y={height:"min(80vh, 80vw)",width:"min(80vh, 80vw)"},A={class:"avplayer-ui-pcm-visualization-mask"},b={class:"avplayer-ui-mask"},x={class:"avplayer-ui-mask info"},w={class:"avplayer-ui-mask showSettings"},k={class:"avplayer-ui-menu-item"},T={class:"avplayer-ui-menu"},S={type:"text/css"},function(t,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G,W,H,j,X,q,Y,K,Q,Z,J,tt,et,it,rt,st,at,nt,ot,lt){lt.push({children:function(){var I=[];return I.push({context:Q,events:{click:E("click","playClick(true)","click","","playClick",{execute:function(t,e){return[!0]}})},nativeAttrs:r,operator:j,ref:"playerContainer",tag:"div",type:3}),$(at,at.length-1,"hasHeader").value?I.push({children:function(){var t=[];return t.push({context:Q,nativeAttrs:s,operator:j,tag:"span",text:G($(at,at.length-1,"title").value),type:3}),t.push({children:[{children:[{context:Q,isPure:i,isStatic:i,isSvg:i,nativeAttrs:a,operator:j,tag:"path",type:3}],context:Q,isPure:i,isStatic:i,isSvg:i,nativeAttrs:n,operator:j,tag:"svg",type:3}],context:Q,isPure:i,isStatic:i,nativeAttrs:o,operator:j,tag:"a",type:3}),t.length?t:e}(),context:Q,nativeAttrs:l,operator:j,tag:"div",type:3}):I.push({isPure:i,operator:H,text:"",type:2}),I.push({children:function(){var t=[];return $(at,at.length-1,"isLive").value?t.push({isPure:i,operator:H,text:"",type:2}):t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{indicatorUrl:$(at,at.length-1,"indicatorUrl").value,player:$(at,at.length-1,"player").value},tag:"Progress",type:4}),t.length?t:e}(),context:Q,nativeAttrs:c,operator:j,tag:"div",type:3}),t.push({children:function(){var t=[];return t.push({children:function(){var t=[];return t.push({children:function(){var t=[];return t.push({context:Q,model:_($(at,at.length-1,"played")),operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},ref:"play",tag:"Play",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}),t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"Volume",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}),$(at,at.length-1,"isLive").value?t.push({isPure:i,operator:H,text:"",type:2}):t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"Loop",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}),$(at,at.length-1,"isLive").value?t.push({isPure:i,operator:H,text:"",type:2}):t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"Timer",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}),t.length?t:e}(),context:Q,nativeAttrs:d,operator:j,tag:"div",type:3}),t.push({children:function(){var t=[];return $(at,at.length-1,"hasVideoTrack").value?t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"VideoTrack",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}):t.push({isPure:i,operator:H,text:"",type:2}),$(at,at.length-1,"hasAudioTrack").value?t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"AudioTrack",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}):t.push({isPure:i,operator:H,text:"",type:2}),$(at,at.length-1,"hasSubtitleTrack").value?t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"SubtitleTrack",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}):t.push({isPure:i,operator:H,text:"",type:2}),t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"Playrate",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}),t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"Setting",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}),$(at,at.length-1,"hasPip").value?t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"Pip",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}):t.push({isPure:i,operator:H,text:"",type:2}),t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{dom:$(at,at.length-1,"fullscreenDom").value,language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"Fullscreen",type:4}),t.length?t:e}(),context:Q,nativeAttrs:h,operator:j,tag:"div",type:3}),t.length?t:e}(),context:Q,nativeAttrs:u,operator:j,tag:"div",type:3}),t.length?t:e}(),context:Q,nativeAttrs:f,operator:j,tag:"div",type:3}),t.length?t:e}(),context:Q,nativeAttrs:p,operator:j,tag:"div",type:3}),$(at,at.length-1,"hasFolder").value?I.push({children:function(){var t=[];return t.push({children:[{children:[{context:Q,isPure:i,isStatic:i,isSvg:i,nativeAttrs:m,operator:j,tag:"path",type:3}],context:Q,isPure:i,isStatic:i,isSvg:i,nativeAttrs:g,operator:j,tag:"svg",type:3}],context:Q,events:{click:E("click","toggleFold()","click","","toggleFold")},nativeAttrs:{class:"avplayer-ui-folder-toggle hint--right","data-hint":$(at,at.length-1,"folded").value?F(at,at.length-1,"language.TIP_UNFOLD",["language","TIP_UNFOLD"],i).value:F(at,at.length-1,"language.TIP_FOLD",["language","TIP_FOLD"],i).value},operator:j,tag:"div",type:3}),t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"Folder",type:4}),t.length?t:e}(),context:Q,nativeAttrs:{class:"avplayer-ui-folder-container","data-fold":$(at,at.length-1,"folded").value?1:0},operator:j,tag:"div",type:3}):I.push({isPure:i,operator:H,text:"",type:2}),I.push({context:Q,operator:X,props:{error:$(at,at.length-1,"error").value,language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"LoadingTip",type:4}),$(at,at.length-1,"hasPcmVisualization").value&&!$(at,at.length-1,"loading").value?I.push({children:function(){var t=[];return t.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"PcmVisualization",type:4}),t.length?t:e}(),context:Q,nativeAttrs:v,nativeStyles:y,operator:j,tag:"div",type:3}),t.length?t:e}(),context:Q,nativeAttrs:A,operator:j,tag:"div",type:3}):I.push({isPure:i,operator:H,text:"",type:2}),I.push({children:function(){var t=[];return t.push({children:function(){var t=[];return $(at,at.length-1,"error").value?t.push({context:Q,nativeAttrs:{src:$(at,at.length-1,"errorStateUrl").value},operator:j,tag:"img",type:3}):$(at,at.length-1,"played").value?t.push({isPure:i,operator:H,text:"",type:2}):t.push({context:Q,events:{click:E("click","playClick()","click","","playClick")},nativeAttrs:{src:$(at,at.length-1,"pauseStateUrl").value},operator:j,tag:"img",type:3}),t.length?t:e}(),context:Q,nativeAttrs:{class:"avplayer-ui-state","data-show":$(at,at.length-1,"title").value&&!$(at,at.length-1,"played").value&&!$(at,at.length-1,"loading").value||$(at,at.length-1,"error").value?1:0},operator:j,tag:"div",type:3}),t.length?t:e}(),context:Q,nativeAttrs:b,operator:j,tag:"div",type:3}),$(at,at.length-1,"showInfo").value?I.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"Info",type:4}),t.length?t:e}(),context:Q,nativeAttrs:x,operator:j,tag:"div",type:3}):I.push({isPure:i,operator:H,text:"",type:2}),$(at,at.length-1,"showSettings").value?I.push({children:function(){var t=[];return t.push({context:Q,operator:X,props:{language:$(at,at.length-1,"language").value,player:$(at,at.length-1,"player").value},tag:"Settings",type:4}),t.length?t:e}(),context:Q,nativeAttrs:w,operator:j,tag:"div",type:3}):I.push({isPure:i,operator:H,text:"",type:2}),$(at,at.length-1,"showMenu").value?I.push({children:function(){var t=[];return B($(at,at.length-1,"menu"),(function(e,i,r,s){t.push({context:Q,events:{click:E("click","menuAction(action)","click","","menuAction",{execute:function(t,i){return[$(e,e.length-1,"action").value]}})},key:$(e,e.length-1,"action").value,nativeAttrs:k,operator:j,tag:"div",text:G($(e,e.length-1,"name").value),type:3})})),t.length?t:e}(),context:Q,events:{outside:E("outside","menuOutside()","outside","","menuOutside")},nativeAttrs:T,nativeStyles:t("top: "+G($(at,at.length-1,"menuTop").value)+"px; left: "+G($(at,at.length-1,"menuLeft").value)+"px;"),operator:j,tag:"div",type:3}):I.push({isPure:i,operator:H,text:"",type:2}),I.push({context:Q,html:G($(at,at.length-1,"style").value),nativeAttrs:S,operator:j,tag:"style",type:3}),I.length?I:e}(),context:Q,events:{mousemove:E("mousemove","mousemove()","mousemove","","mousemove")},nativeAttrs:{class:"avplayer-ui-container","data-bar-show":$(at,at.length-1,"showBar").value?1:0,id:"avplayer-ui-container"},operator:j,tag:"div",type:3})})},82723:t=>{var e,i,r,s,a;t.exports=(e=void 0,i={class:"avplayer-ui-control-audio-track-value"},r={class:"libmedia-ui-selector"},s={type:"text/css"},a={class:"avplayer-ui-control-audio-track"},function(t,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V){V.push({children:function(){var t=[];return t.push({context:M,nativeAttrs:i,operator:I,tag:"div",text:k(A(F,F.length-1,"language.CONTROL_AUDIO_TRACK",["language","CONTROL_AUDIO_TRACK"],!0).value),type:3}),t.push({children:function(){var t=[];return f(b(F,F.length-1,"list"),(function(e,i,r,s,a){t.push({context:M,events:{click:c("click","change(i)","click","","change",{execute:function(t,e){return[a]}})},key:b(e,e.length-1,"id").value,nativeAttrs:{class:"libmedia-ui-selector-item "+(b(e,e.length-1,"selectIndex").value===a?"active":"")},operator:I,tag:"div",text:k(b(e,e.length-1,"name").value),type:3})})),t.length?t:e}(),context:M,nativeAttrs:r,operator:I,tag:"div",type:3}),t.push({context:M,html:k(b(F,F.length-1,"style").value),nativeAttrs:s,operator:I,tag:"style",type:3}),t.length?t:e}(),context:M,nativeAttrs:a,operator:I,tag:"div",type:3})})},22179:t=>{var e,i,r,s,a;t.exports=(e=!0,i={d:"M768 298.666667h170.666667v85.333333h-256V128h85.333333v170.666667zM341.333333 384H85.333333V298.666667h170.666667V128h85.333333v256z m426.666667 341.333333v170.666667h-85.333333v-256h256v85.333333h-170.666667zM341.333333 640v256H256v-170.666667H85.333333v-85.333333h256z",fill:"#ffffff"},r={class:"icon",version:"1.1",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},s={d:"M625.777778 256h142.222222V398.222222h113.777778V142.222222H625.777778v113.777778zM256 398.222222V256H398.222222v-113.777778H142.222222V398.222222h113.777778zM768 625.777778v142.222222H625.777778v113.777778h256V625.777778h-113.777778zM398.222222 768H256V625.777778h-113.777778v256H398.222222v-113.777778z",fill:"#ffffff"},a={type:"text/css"},function(t,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V){V.push({children:function(){var t=[];return b(F,F.length-1,"fullscreen").value?t.push({children:[{context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:i,operator:I,tag:"path",type:3}],context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:r,operator:I,tag:"svg",type:3}):t.push({children:[{context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:s,operator:I,tag:"path",type:3}],context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:r,operator:I,tag:"svg",type:3}),t.push({context:M,html:k(b(F,F.length-1,"style").value),nativeAttrs:a,operator:I,tag:"style",type:3}),t.length?t:void 0}(),context:M,events:{click:c("click","fullscreenClick()","click","","fullscreenClick")},nativeAttrs:{class:"avplayer-ui-control-fullscreen hint--top","data-hint":A(F,F.length-1,"language.TIP_FULLSCREEN",["language","TIP_FULLSCREEN"],e).value},operator:I,tag:"div",type:3})})},82237:t=>{var e,i,r,s,a,n;t.exports=(e=!0,i={d:"M9 8.877a3 3 0 0 0-2.995 2.824L6 11.877v4a3 3 0 0 0 2.824 2.995l.176.005a1 1 0 1 1 0 2 5 5 0 0 1-4.995-4.783L4 15.877v-4a5 5 0 0 1 4.783-4.995L9 6.877h3V5.5a.5.5 0 0 1 .834-.372L17 8.878H9Zm11 10a3 3 0 0 0 2.995-2.823l.005-.177v-4a3 3 0 0 0-2.824-2.995L20 8.877a1 1 0 0 1 0-2 5 5 0 0 1 4.995 4.783l.005.217v4a5 5 0 0 1-4.783 4.996l-.217.004h-3v1.378a.5.5 0 0 1-.834.371L12 18.877h8Z","fill-rule":"nonzero"},r={"fill-rule":"evenodd"},s={viewBox:"0 0 28 28",xmlns:"http://www.w3.org/2000/svg"},a={d:"M16.859 14.22c2.738 0 4.958 2.164 4.958 4.834 0 2.67-2.22 4.834-4.958 4.834-2.739 0-4.959-2.164-4.959-4.834 0-2.67 2.22-4.835 4.959-4.835Zm0 .966c-2.19 0-3.967 1.732-3.967 3.868s1.776 3.867 3.967 3.867c2.19 0 3.967-1.731 3.967-3.867s-1.776-3.868-3.967-3.868Zm-1.206 2.02.069.056 2.975 2.9a.475.475 0 0 1 0 .684.506.506 0 0 1-.633.056l-.068-.056-2.975-2.9a.475.475 0 0 1 0-.684.506.506 0 0 1 .632-.056ZM12.591 4.9a.69.69 0 0 1 .456.171l3.812 3.346H11.9v-.001H8.925c-1.584 0-2.88 1.208-2.97 2.731l-.005.17v3.868c0 1.545 1.239 2.808 2.8 2.896l.175.005.992-.001v1.934h-.992c-2.664 0-4.838-2.048-4.953-4.619l-.005-.215v-3.868c0-2.597 2.101-4.717 4.737-4.83l.221-.004H11.9v-.892c0-.382.31-.691.691-.691Zm7.243 1.68c2.19.433 3.856 2.274 3.961 4.512l.006.225v3.868c0 .432-.058.85-.167 1.248l-1.817-2.215v-2.9c0-1.263-.827-2.338-1.982-2.736V6.581Z","fill-rule":"nonzero"},n={type:"text/css"},function(t,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G){G.push({children:function(){var t=[];return x($,$.length-1,"loop").value?t.push({children:[{children:[{context:R,isPure:e,isStatic:e,isSvg:e,nativeAttrs:i,operator:P,tag:"path",type:3}],context:R,isPure:e,isStatic:e,isSvg:e,nativeAttrs:r,operator:P,tag:"g",type:3}],context:R,isPure:e,isStatic:e,isSvg:e,nativeAttrs:s,operator:P,tag:"svg",type:3}):t.push({children:[{children:[{context:R,isPure:e,isStatic:e,isSvg:e,nativeAttrs:a,operator:P,tag:"path",type:3}],context:R,isPure:e,isStatic:e,isSvg:e,nativeAttrs:r,operator:P,tag:"g",type:3}],context:R,isPure:e,isStatic:e,isSvg:e,nativeAttrs:s,operator:P,tag:"svg",type:3}),t.push({context:R,html:T(x($,$.length-1,"style").value),nativeAttrs:n,operator:P,tag:"style",type:3}),t.length?t:void 0}(),context:R,events:{click:h("click","change()","click","","change")},nativeAttrs:{class:"avplayer-ui-control-loop hint--top","data-hint":x($,$.length-1,"loop").value?b($,$.length-1,"language.TIP_LOOP_STOP",["language","TIP_LOOP_STOP"],e).value:b($,$.length-1,"language.TIP_LOOP_START",["language","TIP_LOOP_START"],e).value},operator:P,tag:"div",type:3})})},16979:t=>{var e,i,r,s;t.exports=(e=!0,i={d:"M23.625 15.75c.966 0 1.75.784 1.75 1.75v4.375a1.75 1.75 0 0 1-1.75 1.75H17.5a1.75 1.75 0 0 1-1.75-1.75V17.5c0-.966.784-1.75 1.75-1.75h6.125ZM21 5.25a2.625 2.625 0 0 1 2.62 2.47l.005.155v5.25a.875.875 0 0 1-1.744.102l-.006-.102v-5.25a.875.875 0 0 0-.773-.87L21 7H7a.875.875 0 0 0-.87.773l-.005.102V19.25c0 .449.338.819.773.87l.102.005h6.125a.875.875 0 0 1 .102 1.744l-.102.006H7a2.625 2.625 0 0 1-2.62-2.47l-.005-.155V7.875a2.625 2.625 0 0 1 2.47-2.62L7 5.25h14Z","fill-rule":"evenodd","stroke-width":".5"},r={viewBox:"0 0 28 28",xmlns:"http://www.w3.org/2000/svg"},s={type:"text/css"},function(t,a,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z){z.push({children:function(){var t=[];return t.push({children:[{children:[{context:C,isPure:e,isStatic:e,isSvg:e,nativeAttrs:i,operator:S,tag:"path",type:3}],context:C,isPure:e,isStatic:e,isSvg:e,operator:S,tag:"g",type:3}],context:C,isPure:e,isStatic:e,isSvg:e,nativeAttrs:r,operator:S,tag:"svg",type:3}),t.push({context:C,html:w(A(O,O.length-1,"style").value),nativeAttrs:s,operator:S,tag:"style",type:3}),t.length?t:void 0}(),context:C,events:{click:l("click","pipClick()","click","","pipClick")},nativeAttrs:{class:"avplayer-ui-control-pip hint--top","data-hint":A(O,O.length-1,"pip").value?y(O,O.length-1,"language.TIP_PIP_STOP",["language","TIP_PIP_STOP"],e).value:y(O,O.length-1,"language.TIP_PIP_START",["language","TIP_PIP_START"],e).value},operator:S,tag:"div",type:3})})},1449:t=>{var e,i,r,s,a;t.exports=(e=!0,i={d:"M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zM15 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"},r={viewBox:"0 0 22 22",xmlns:"http://www.w3.org/2000/svg"},s={d:"M17.982 9.275L8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"},a={type:"text/css"},function(t,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V){V.push({children:function(){var t=[];return b(F,F.length-1,"played").value?t.push({children:[{context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:i,operator:I,tag:"path",type:3}],context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:r,operator:I,tag:"svg",type:3}):t.push({children:[{context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:s,operator:I,tag:"path",type:3}],context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:r,operator:I,tag:"svg",type:3}),t.push({context:M,html:k(b(F,F.length-1,"style").value),nativeAttrs:a,operator:I,tag:"style",type:3}),t.length?t:void 0}(),context:M,events:{click:c("click","playClick()","click","","playClick")},nativeAttrs:{class:"avplayer-ui-control-play hint--top","data-hint":b(F,F.length-1,"played").value?A(F,F.length-1,"language.TIP_PAUSE",["language","TIP_PAUSE"],e).value:A(F,F.length-1,"language.TIP_PLAY",["language","TIP_PLAY"],e).value},operator:I,tag:"div",type:3})})},8809:t=>{var e,i,r,s,a,n,o;t.exports=(i=void 0,r=!0,s={class:"avplayer-ui-control-play-rate-value"},a={class:"libmedia-ui-selector"},n={type:"text/css"},o={class:"avplayer-ui-control-play-rate"},function(t,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G,W){W.push({children:function(){var t=[];return t.push({context:B,nativeAttrs:s,operator:_,tag:"div",text:S(x(z,z.length-1,"language.CONTROL_PLAYRATE",["language","CONTROL_PLAYRATE"],r).value),type:3}),t.push({children:function(){var t=[];return m(w(z,z.length-1,"list"),(function(s,a,n,o,l){t.push({children:function(){var t=[];return t.push({isPure:r,operator:I,text:S((e=s[s.length-1],T(e.getScope(),e.keypath)).value)+"x",type:1}),t.length?t:i}(),context:B,events:{click:d("click","change(i)","click","","change",{execute:function(t,e){return[l]}})},key:(e=s[s.length-1],T(e.getScope(),e.keypath)).value,nativeAttrs:{class:"libmedia-ui-selector-item "+(w(s,s.length-1,"index").value===l?"active":"")},operator:_,tag:"div",type:3})})),t.length?t:i}(),context:B,nativeAttrs:a,operator:_,tag:"div",type:3}),t.push({context:B,html:S(w(z,z.length-1,"style").value),nativeAttrs:n,operator:_,tag:"style",type:3}),t.length?t:i}(),context:B,nativeAttrs:o,operator:_,tag:"div",type:3})})},78675:t=>{var e,i,r,s,a;t.exports=(e=!0,i={cx:"11",cy:"11",r:"2"},r={d:"M19.164 8.861L17.6 8.6a6.978 6.978 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1.001 1.001 0 0 0-1.272.23l-1.008 1.225a7.04 7.04 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A6.997 6.997 0 0 0 4.4 8.6l-1.564.261A.999.999 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.089 7.089 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a.999.999 0 0 0 .835-.986V9.847a.999.999 0 0 0-.836-.986zM11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"},s={viewBox:"0 0 22 22",xmlns:"http://www.w3.org/2000/svg"},a={type:"text/css"},function(t,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V){V.push({children:function(){var t=[];return t.push({children:[{context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:i,operator:I,tag:"circle",type:3},{context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:r,operator:I,tag:"path",type:3}],context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:s,operator:I,tag:"svg",type:3}),t.push({context:M,html:k(b(F,F.length-1,"style").value),nativeAttrs:a,operator:I,tag:"style",type:3}),t.length?t:void 0}(),context:M,events:{click:c("click","click()","click","","click")},nativeAttrs:{class:"avplayer-ui-control-settings hint--top","data-hint":A(F,F.length-1,"language.TIP_SETTING",["language","TIP_SETTING"],e).value},operator:I,tag:"div",type:3})})},95683:t=>{var e,i,r,s,a,n,o;t.exports=(e=void 0,i=!0,r={class:"avplayer-ui-control-subtitle-track-value"},s={display:"none"},a={class:"libmedia-ui-selector"},n={type:"text/css"},o={class:"avplayer-ui-control-subtitle-track"},function(t,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G,W){W.push({children:function(){var t=[];return t.push({context:B,nativeAttrs:r,operator:_,tag:"div",text:S(x(z,z.length-1,"language.CONTROL_SUBTITLE_TRACK",["language","CONTROL_SUBTITLE_TRACK"],i).value),type:3}),t.push({children:function(){var t,r=[];return m(w(z,z.length-1,"list"),(function(t,e,i,s,a){r.push({context:B,events:{click:d("click","change(i)","click","","change",{execute:function(t,e){return[a]}})},key:w(t,t.length-1,"id").value,nativeAttrs:{class:"libmedia-ui-selector-item "+(w(t,t.length-1,"selectIndex").value===a?"active":"")},operator:_,tag:"div",text:S(w(t,t.length-1,"name").value),type:3})})),r.push((t={children:function(){var t=[];return t.push({isPure:i,operator:I,text:S(x(z,z.length-1,"language.CONTROL_SUBTITLE_TRACK_ADD",["language","CONTROL_SUBTITLE_TRACK_ADD"],i).value),type:1}),w(z,z.length-1,"canUseFilePicker").value?t.push({isPure:i,operator:P,text:"",type:2}):t.push({context:B,events:{change:d("change","fileChange()","change","","fileChange")},nativeAttrs:{accept:w(z,z.length-1,"accept").value,id:"avplayer-file-open-subtitle",type:"file"},nativeStyles:s,operator:_,tag:"input",type:3}),t.length?t:e}(),context:B,nativeAttrs:{class:"libmedia-ui-selector-item"},operator:_,tag:"label",type:3},w(z,z.length-1,"canUseFilePicker").value?y(t,"events","click",d("click","openFile()","click","","openFile")):y(t,"nativeAttrs","for","avplayer-file-open-subtitle"),t)),r.length?r:e}(),context:B,nativeAttrs:a,operator:_,tag:"div",type:3}),t.push({context:B,html:S(w(z,z.length-1,"style").value),nativeAttrs:n,operator:_,tag:"style",type:3}),t.length?t:e}(),context:B,nativeAttrs:o,operator:_,tag:"div",type:3})})},9127:t=>{var e,i,r,s,a,n;t.exports=(i=!0,r={class:"avplayer-ui-time-label"},s={class:"avplayer-ui-time-div"},a={type:"text/css"},n={class:"avplayer-ui-control-timer"},function(t,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G){G.push({children:function(){var t=[];return t.push({context:R,nativeAttrs:r,operator:P,tag:"span",text:T(k((e=x($,$.length-1,"formatTime",D&&D.formatTime||U.formatTime).value,"function"==typeof e?e(x($,$.length-1,"currentTime").value):B.fatal("[formatTime(currentTime)] is not a function."))).value),type:3}),t.push({context:R,html:"&nbsp;/&nbsp;",isPure:i,isStatic:i,nativeAttrs:s,operator:P,tag:"span",type:3}),t.push({context:R,nativeAttrs:r,operator:P,tag:"span",text:T(k((e=x($,$.length-1,"formatTime",D&&D.formatTime||U.formatTime).value,"function"==typeof e?e(x($,$.length-1,"totalTime").value):B.fatal("[formatTime(totalTime)] is not a function."))).value),type:3}),t.push({context:R,html:T(x($,$.length-1,"style").value),nativeAttrs:a,operator:P,tag:"style",type:3}),t.length?t:void 0}(),context:R,nativeAttrs:n,operator:P,tag:"div",type:3})})},43145:t=>{var e,i,r,s,a;t.exports=(e=void 0,i={class:"avplayer-ui-control-video-track-value"},r={class:"libmedia-ui-selector"},s={type:"text/css"},a={class:"avplayer-ui-control-video-track"},function(t,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V){V.push({children:function(){var t=[];return t.push({context:M,nativeAttrs:i,operator:I,tag:"div",text:k(A(F,F.length-1,"language.CONTROL_VIDEO_TRACK",["language","CONTROL_VIDEO_TRACK"],!0).value),type:3}),t.push({children:function(){var t=[];return f(b(F,F.length-1,"list"),(function(e,i,r,s,a){t.push({context:M,events:{click:c("click","change(i)","click","","change",{execute:function(t,e){return[a]}})},key:b(e,e.length-1,"id").value,nativeAttrs:{class:"libmedia-ui-selector-item "+(b(e,e.length-1,"selectIndex").value===a?"active":"")},operator:I,tag:"div",text:k(b(e,e.length-1,"name").value),type:3})})),t.length?t:e}(),context:M,nativeAttrs:r,operator:I,tag:"div",type:3}),t.push({context:M,html:k(b(F,F.length-1,"style").value),nativeAttrs:s,operator:I,tag:"style",type:3}),t.length?t:e}(),context:M,nativeAttrs:a,operator:I,tag:"div",type:3})})},93069:t=>{var e,i,r,s,a,n,o,l,c,h,d,u,f;t.exports=(e=void 0,i=!0,r={d:"M10.188 4.65L6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zM14.446 3.778a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z"},s={d:"M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z"},a={viewBox:"0 0 22 22",xmlns:"http://www.w3.org/2000/svg"},n={d:"M15 11a3.998 3.998 0 0 0-2-3.465v2.636l1.865 1.865A4.02 4.02 0 0 0 15 11z"},o={d:"M13.583 5.583A5.998 5.998 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8.001 8.001 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805zM18.778 18.778l-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806c.215-.102.424-.214.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416zM11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172V5.04z"},l={class:"avplayer-ui-volume-icon"},c={class:"avplayer-ui-volume-value"},h={class:"avplayer-ui-volume-inner"},d={class:"avplayer-ui-volume-panel"},u={type:"text/css"},f={class:"avplayer-ui-control-volume"},function(t,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G,W,H,j,X,q,Y,K){K.push({children:function(){var t=[];return t.push({children:function(){var t=[];return _(X,X.length-1,"volume").value?t.push({children:[{context:F,isPure:i,isStatic:i,isSvg:i,nativeAttrs:r,operator:D,tag:"path",type:3},{context:F,isPure:i,isStatic:i,isSvg:i,nativeAttrs:s,operator:D,tag:"path",type:3}],context:F,isPure:i,isStatic:i,isSvg:i,nativeAttrs:a,operator:D,tag:"svg",type:3}):t.push({children:[{context:F,isPure:i,isStatic:i,isSvg:i,nativeAttrs:n,operator:D,tag:"path",type:3},{context:F,isPure:i,isStatic:i,isSvg:i,nativeAttrs:o,operator:D,tag:"path",type:3}],context:F,isPure:i,isStatic:i,isSvg:i,nativeAttrs:a,operator:D,tag:"svg",type:3}),t.length?t:e}(),context:F,events:{click:v("click","volumeClick()","click","","volumeClick")},nativeAttrs:l,operator:D,tag:"div",type:3}),t.push({children:function(){var t=[];return t.push({children:function(){var t=[];return t.push({context:F,nativeAttrs:c,operator:D,tag:"div",text:M(_(X,X.length-1,"volume").value),type:3}),t.push({context:F,model:g(_(X,X.length-1,"volume")),operator:U,tag:"Slider",type:4}),t.length?t:e}(),context:F,nativeAttrs:h,operator:D,tag:"div",type:3}),t.length?t:e}(),context:F,nativeAttrs:d,operator:D,tag:"div",type:3}),t.push({context:F,html:M(_(X,X.length-1,"style").value),nativeAttrs:u,operator:D,tag:"style",type:3}),t.length?t:e}(),context:F,nativeAttrs:f,operator:D,tag:"div",type:3})})},94907:t=>{var e,i,r,s,a,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P;t.exports=(i=void 0,r=!0,s={d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"},a={viewBox:"0 0 24 24"},n={class:"avplayer-ui-folder-icon dir"},o={class:"avplayer-ui-folder-open-name"},l={class:"avplayer-ui-folder-open-dir item"},c={"stroke-width":"0"},h={"stroke-linecap":"round","stroke-linejoin":"round"},d={d:"M21 11V15.8C21 16.9201 21 17.4802 20.782 17.908C20.5903 18.2843 20.2843 18.5903 19.908 18.782C19.4802 19 18.9201 19 17.8 19H6.2C5.0799 19 4.51984 19 4.09202 18.782C3.71569 18.5903 3.40973 18.2843 3.21799 17.908C3 17.4802 3 16.9201 3 15.8V8.2C3 7.0799 3 6.51984 3.21799 6.09202C3.40973 5.71569 3.71569 5.40973 4.09202 5.21799C4.51984 5 5.0799 5 6.2 5H15M21 11L15 5M21 11H16.6C16.0399 11 15.7599 11 15.546 10.891C15.3578 10.7951 15.2049 10.6422 15.109 10.454C15 10.2401 15 9.96005 15 9.4V5","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},u={fill:"none",transform:"rotate(270)",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},f={class:"avplayer-ui-folder-icon file"},p={display:"none"},m={class:"avplayer-ui-folder-open"},g={type:"checkbox"},v={class:"avplayer-ui-url-open-live"},y={"clip-rule":"evenodd",d:"M10 1C9.73478 1 9.48043 1.10536 9.29289 1.29289L3.29289 7.29289C3.10536 7.48043 3 7.73478 3 8V20C3 21.6569 4.34315 23 6 23H7C7.55228 23 8 22.5523 8 22C8 21.4477 7.55228 21 7 21H6C5.44772 21 5 20.5523 5 20V9H10C10.5523 9 11 8.55228 11 8V3H18C18.5523 3 19 3.44772 19 4V7C19 7.55228 19.4477 8 20 8C20.5523 8 21 7.55228 21 7V4C21 2.34315 19.6569 1 18 1H10ZM9 7H6.41421L9 4.41421V7ZM12.5 24","fill-rule":"evenodd"},A={stroke:"none"},b={d:"M17 15V18M17 21V18M17 18H14M17 18H20",stroke:"","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},x={fill:"none",height:"120%",viewBox:"00 0 24 24",width:"120%",x:"-4",xmlns:"http://www.w3.org/2000/svg",y:"-4"},w={fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},k={class:"avplayer-ui-url-open"},T={class:"avplayer-ui-folder-list",role:"list"},S={class:"avplayer-ui-folder-list-container"},I={type:"text/css"},P={class:"avplayer-ui-folder"},function(t,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G,W,H,j,X,q,Y,K,Q,Z,J,tt,et,it,rt,st,at,nt,ot,lt,ct,ht){ht.push({children:function(){var P=[];return P.push({children:function(){var t,e=[];return V(ot,ot.length-1,"canOpenFolder").value?e.push({children:function(){var t=[];return t.push({children:[{children:[{context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:s,operator:q,tag:"path",type:3}],context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:a,operator:q,tag:"svg",type:3}],context:J,isPure:r,isStatic:r,nativeAttrs:n,operator:q,tag:"div",type:3}),t.push({context:J,nativeAttrs:o,operator:q,tag:"div",text:H(z(ot,ot.length-1,"language.FOLDER_OPEN_DIR",["language","FOLDER_OPEN_DIR"],r).value),type:3}),t.length?t:i}(),context:J,events:{click:M("click","openDir()","click","","openDir")},nativeAttrs:l,operator:q,tag:"div",type:3}):e.push({isPure:r,operator:X,text:"",type:2}),e.push((t={children:function(){var t=[];return t.push({children:[{children:[{context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:c,operator:q,tag:"g",type:3},{context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:h,operator:q,tag:"g",type:3},{children:[{isPure:r,operator:j,text:" ",type:1},{context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:d,operator:q,tag:"path",type:3},{isPure:r,operator:j,text:" ",type:1}],context:J,isPure:r,isStatic:r,isSvg:r,operator:q,tag:"g",type:3}],context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:u,operator:q,tag:"svg",type:3}],context:J,isPure:r,isStatic:r,nativeAttrs:f,operator:q,tag:"div",type:3}),t.push({context:J,nativeAttrs:o,operator:q,tag:"div",text:H(z(ot,ot.length-1,"language.FOLDER_OPEN_FILE",["language","FOLDER_OPEN_FILE"],r).value),type:3}),V(ot,ot.length-1,"canUseFilePicker").value?t.push({isPure:r,operator:X,text:"",type:2}):t.push({context:J,events:{change:M("change","fileChange()","change","","fileChange")},nativeAttrs:{accept:V(ot,ot.length-1,"accept").value,id:"avplayer-file-open-input",type:"file"},nativeStyles:p,operator:q,tag:"input",type:3}),t.length?t:i}(),context:J,nativeAttrs:{class:"avplayer-ui-folder-open-file item"},operator:q,tag:"label",type:3},V(ot,ot.length-1,"canUseFilePicker").value?O(t,"events","click",M("click","openFile()","click","","openFile")):O(t,"nativeAttrs","for","avplayer-file-open-input"),t)),e.length?e:i}(),context:J,nativeAttrs:m,operator:q,tag:"div",type:3}),P.push({children:function(){var t=[];return t.push({context:J,nativeAttrs:{class:"avplayer-ui-url-open-input",placeholder:z(ot,ot.length-1,"language.FOLDER_OPEN_URL_PLACEHOLDER",["language","FOLDER_OPEN_URL_PLACEHOLDER"],r).value,type:"text"},operator:q,ref:"url",tag:"input",type:3}),t.push({children:function(){var t=[];return t.push({context:J,nativeAttrs:g,operator:q,ref:"live",tag:"input",type:3}),t.push({context:J,operator:q,tag:"span",text:H(z(ot,ot.length-1,"language.CHECKBOX_LIVE",["language","CHECKBOX_LIVE"],r).value),type:3}),t.length?t:i}(),context:J,nativeAttrs:v,operator:q,tag:"label",type:3}),t.push({children:[{children:[{context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:c,operator:q,tag:"g",type:3},{context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:h,operator:q,tag:"g",type:3},{children:[{isPure:r,operator:j,text:" ",type:1},{context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:y,nativeStyles:A,operator:q,tag:"path",type:3},{isPure:r,operator:j,text:" ",type:1}],context:J,isPure:r,isStatic:r,isSvg:r,operator:q,tag:"g",type:3},{children:[{children:[{context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:b,operator:q,tag:"path",type:3}],context:J,isPure:r,isStatic:r,isSvg:r,operator:q,tag:"g",type:3}],context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:x,operator:q,tag:"svg",type:3}],context:J,isPure:r,isStatic:r,isSvg:r,nativeAttrs:w,operator:q,tag:"svg",type:3}],context:J,events:{click:M("click","openUrl()","click","","openUrl")},nativeAttrs:{class:"avplayer-ui-folder-icon add hint--top","data-hint":z(ot,ot.length-1,"language.BUTTON_ADD",["language","BUTTON_ADD"],r).value},operator:q,tag:"div",type:3}),t.length?t:i}(),context:J,nativeAttrs:k,operator:q,tag:"div",type:3}),P.push({children:function(){var t=[];return t.push({children:function(){var t=[];return U(V(ot,ot.length-1,"root"),(function(i,r,s,a){t.push({context:J,key:W(r.name,i[i.length-1].getKeypath("name")).value,operator:Y,props:{language:V(i,i.length-1,"language").value,node:(e=i[i.length-1],W(e.getScope(),e.keypath)).value},ref:W(r.id,i[i.length-1].getKeypath("id")).value,tag:"FolderNode",type:4})})),t.length?t:i}(),context:J,nativeAttrs:T,operator:q,tag:"ul",type:3}),t.length?t:i}(),context:J,events:{keydown:M("keydown","preventDefault()","keydown","","preventDefault"),keyup:M("keyup","preventDefault()","keyup","","preventDefault")},nativeAttrs:S,operator:q,ref:"scroll",tag:"div",type:3}),P.push({context:J,nativeAttrs:{class:"avplayer-ui-folder-tip","data-show":V(ot,ot.length-1,"tipShow").value?1:0},nativeStyles:t("top: "+H(V(ot,ot.length-1,"tipTop").value)+"px"),operator:q,tag:"div",text:H(V(ot,ot.length-1,"tip").value),type:3}),P.push({context:J,html:H(V(ot,ot.length-1,"style").value),nativeAttrs:I,operator:q,tag:"style",type:3}),P.length?P:i}(),context:J,nativeAttrs:P,operator:q,tag:"div",type:3})})},81747:t=>{var e,i,r,s,a,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S;t.exports=(i=void 0,r=!0,s={d:"m10 17 5-5-5-5v10z"},a={viewBox:"0 0 24 24"},n={d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"},o={class:"avplayer-ui-folder-icon dir"},l={"stroke-width":"0"},c={"stroke-linecap":"round","stroke-linejoin":"round"},h={"clip-rule":"evenodd",d:"M10 1C9.73478 1 9.48043 1.10536 9.29289 1.29289L3.29289 7.29289C3.10536 7.48043 3 7.73478 3 8V20C3 21.6569 4.34315 23 6 23H7C7.55228 23 8 22.5523 8 22C8 21.4477 7.55228 21 7 21H6C5.44772 21 5 20.5523 5 20V9H10C10.5523 9 11 8.55228 11 8V3H18C18.5523 3 19 3.44772 19 4V7C19 7.55228 19.4477 8 20 8C20.5523 8 21 7.55228 21 7V4C21 2.34315 19.6569 1 18 1H10ZM9 7H6.41421L9 4.41421V7ZM12.5 24","fill-rule":"evenodd"},d={d:"M255.994,0.006C114.607,0.013,0.012,114.612,0,256c0.012,141.387,114.607,255.986,255.994,255.994 C397.393,511.986,511.992,397.387,512,256C511.992,114.612,397.393,0.013,255.994,0.006z M97.607,97.612 c23.34-23.328,51.761-41.475,83.455-52.725c-15.183,18.375-27.84,41.906-37.757,69.116H82.772 C87.452,108.308,92.396,102.824,97.607,97.612z M65.612,138.003h69.986c-9.008,31.929-14.41,67.834-15.363,105.997H32.327 C34.374,205.196,46.3,169.088,65.612,138.003z M65.612,373.997C46.3,342.912,34.374,306.804,32.327,268h87.991 c0.961,38.124,6.21,74.092,15.206,105.998H65.612z M97.607,414.386c-5.211-5.211-10.156-10.695-14.836-16.39h60.573 c4.28,11.774,9.019,22.944,14.312,33.21c6.954,13.438,14.758,25.468,23.348,35.89C149.332,455.846,120.931,437.699,97.607,414.386z M243.998,479.667c-3.746-0.196-7.469-0.477-11.164-0.86c-5.89-2.64-11.722-6.25-17.5-10.961 c-17.632-14.359-33.976-38.671-46.398-69.85h75.061V479.667z M243.998,373.997h-83.436c-9.477-31.171-15.316-67.311-16.328-105.998 h99.763V373.997z M243.998,244H144.31c1.008-38.71,6.875-74.819,16.359-105.997h83.33V244z M243.998,114.003h-74.951 c3.109-7.79,6.367-15.312,9.934-22.195c10.64-20.625,23.17-36.89,36.354-47.656c5.777-4.71,11.609-8.32,17.5-10.96 c3.695-0.382,7.417-0.664,11.164-0.859V114.003z M446.392,138.003c19.312,31.085,31.234,67.194,33.281,105.997h-87.991 c-0.961-38.124-6.21-74.092-15.21-105.997H446.392z M414.393,97.612c5.211,5.211,10.156,10.696,14.836,16.391h-60.577 c-4.281-11.773-9.023-22.945-14.312-33.21c-6.953-13.437-14.758-25.468-23.347-35.89C362.668,56.16,391.065,74.301,414.393,97.612z M267.998,32.333c3.746,0.195,7.469,0.484,11.16,0.859c5.89,2.649,11.723,6.25,17.504,10.96 c17.636,14.359,33.976,38.671,46.397,69.85h-75.061V32.333z M267.998,138.003h83.436c9.476,31.171,15.32,67.31,16.328,105.997 h-99.764V138.003z M267.998,268h99.685c-1.007,38.71-6.874,74.818-16.359,105.998h-83.326V268z M296.661,467.846 c-5.781,4.711-11.614,8.313-17.504,10.961c-3.691,0.375-7.414,0.664-11.16,0.86v-81.67h74.951 c-3.109,7.789-6.367,15.312-9.933,22.195C322.376,440.816,309.845,457.081,296.661,467.846z M414.393,414.386 c-23.336,23.328-51.764,41.476-83.459,52.725c15.187-18.375,27.835-41.905,37.757-69.115h60.538 C424.548,403.692,419.604,409.176,414.393,414.386z M446.392,373.997h-69.998c9.008-31.929,14.414-67.842,15.367-105.998h87.912 C477.626,306.804,465.704,342.912,446.392,373.997z"},u={fill:"none",height:"65%",viewBox:"00 0 512 512",width:"65%",x:"8",xmlns:"http://www.w3.org/2000/svg",y:"8"},f={fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},p={class:"avplayer-ui-folder-icon url"},m={"clip-rule":"evenodd",d:"M10 1C9.73478 1 9.48043 1.10536 9.29289 1.29289L3.29289 7.29289C3.10536 7.48043 3 7.73478 3 8V20C3 21.6569 4.34315 23 6 23H7C7.55228 23 8 22.5523 8 22C8 21.4477 7.55228 21 7 21H6C5.44772 21 5 20.5523 5 20V9H10C10.5523 9 11 8.55228 11 8V3H18C18.5523 3 19 3.44772 19 4V7C19 7.55228 19.4477 8 20 8C20.5523 8 21 7.55228 21 7V4C21 2.34315 19.6569 1 18 1H10ZM9 7H6.41421L9 4.41421V7ZM12.5 24C13.8807 24 15 22.8807 15 21.5V12.8673L20 12.153V18.05C19.8384 18.0172 19.6712 18 19.5 18C18.1193 18 17 19.1193 17 20.5C17 21.8807 18.1193 23 19.5 23C20.8807 23 22 21.8807 22 20.5V11C22 10.7101 21.8742 10.4345 21.6552 10.2445C21.4362 10.0546 21.1456 9.96905 20.8586 10.0101L13.8586 11.0101C13.3659 11.0804 13 11.5023 13 12V19.05C12.8384 19.0172 12.6712 19 12.5 19C11.1193 19 10 20.1193 10 21.5C10 22.8807 11.1193 24 12.5 24Z","fill-rule":"evenodd"},g={class:"avplayer-ui-folder-icon music"},v={"clip-rule":"evenodd",d:"M10 1C9.73478 1 9.48043 1.10536 9.29289 1.29289L3.29289 7.29289C3.10536 7.48043 3 7.73478 3 8V20C3 21.6569 4.34315 23 6 23H8C8.55228 23 9 22.5523 9 22C9 21.4477 8.55228 21 8 21H6C5.44772 21 5 20.5523 5 20V9H10C10.5523 9 11 8.55228 11 8V3H18C18.5523 3 19 3.44772 19 4V7C19 7.55228 19.4477 8 20 8C20.5523 8 21 7.55228 21 7V4C21 2.34315 19.6569 1 18 1H10ZM9 7H6.41421L9 4.41421V7ZM12 17C12 14.2386 14.2386 12 17 12C19.7614 12 22 14.2386 22 17C22 19.7614 19.7614 22 17 22C14.2386 22 12 19.7614 12 17ZM17 10C13.134 10 10 13.134 10 17C10 20.866 13.134 24 17 24C20.866 24 24 20.866 24 17C24 13.134 20.866 10 17 10ZM16.5547 14.1679C16.2478 13.9634 15.8533 13.9443 15.5281 14.1183C15.203 14.2923 15 14.6312 15 15V19C15 19.3688 15.203 19.7077 15.5281 19.8817C15.8533 20.0557 16.2478 20.0366 16.5547 19.8321L19.5547 17.8321C19.8329 17.6466 20 17.3344 20 17C20 16.6656 19.8329 16.3534 19.5547 16.1679L16.5547 14.1679Z","fill-rule":"evenodd"},y={class:"avplayer-ui-folder-icon mov"},A={class:"avplayer-ui-folder-node-name"},b={d:"M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zM15 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"},x={viewBox:"0 0 22 22",xmlns:"http://www.w3.org/2000/svg"},w={d:"M17.982 9.275L8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"},k={d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},T={class:"avplayer-ui-folder-list",role:"list"},S={class:"avplayer-ui-folder-list-li",role:"listitem"},function(t,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G,W,H,j,X,q,Y,K,Q,Z,J,tt,et,it,rt,st,at,nt,ot,lt){lt.push({children:function(){var S=[];return S.push({children:function(){var t=[];return V((e=$(at,at.length-1,"isFolder",J&&J.isFolder||tt.isFolder).value,"function"==typeof e?e($(at,at.length-1,"node").value):Z.fatal("[isFolder(node)] is not a function."))).value?(t.push({children:[{children:[{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:s,operator:j,tag:"path",type:3}],context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:a,operator:j,tag:"svg",type:3}],context:Q,events:{click:E("click","toggle()","click","","toggle")},nativeAttrs:{class:"avplayer-ui-folder-expand hint--right","data-hint":F(at,at.length-1,"node.opened",["node","opened"],r).value?F(at,at.length-1,"language.TIP_FOLD",["language","TIP_FOLD"],r).value:F(at,at.length-1,"language.TIP_UNFOLD",["language","TIP_UNFOLD"],r).value,"data-open":F(at,at.length-1,"node.opened",["node","opened"],r).value?1:0},operator:j,tag:"div",type:3}),t.push({children:[{children:[{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:n,operator:j,tag:"path",type:3}],context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:a,operator:j,tag:"svg",type:3}],context:Q,isPure:r,isStatic:r,nativeAttrs:o,operator:j,tag:"div",type:3})):V((e=$(at,at.length-1,"isUrl",J&&J.isUrl||tt.isUrl).value,"function"==typeof e?e($(at,at.length-1,"node").value):Z.fatal("[isUrl(node)] is not a function."))).value?t.push({children:[{children:[{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:l,operator:j,tag:"g",type:3},{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:c,operator:j,tag:"g",type:3},{children:[{isPure:r,operator:W,text:" ",type:1},{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:h,operator:j,tag:"path",type:3},{isPure:r,operator:W,text:" ",type:1}],context:Q,isPure:r,isStatic:r,isSvg:r,operator:j,tag:"g",type:3},{children:[{children:[{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:d,operator:j,tag:"path",type:3},{isPure:r,operator:W,text:" ",type:1}],context:Q,isPure:r,isStatic:r,isSvg:r,operator:j,tag:"g",type:3}],context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:u,operator:j,tag:"svg",type:3}],context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:f,operator:j,tag:"svg",type:3}],context:Q,isPure:r,isStatic:r,nativeAttrs:p,operator:j,tag:"div",type:3}):V((e=$(at,at.length-1,"isMusic",J&&J.isMusic||tt.isMusic).value,"function"==typeof e?e($(at,at.length-1,"node").value):Z.fatal("[isMusic(node)] is not a function."))).value?t.push({children:[{children:[{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:l,operator:j,tag:"g",type:3},{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:c,operator:j,tag:"g",type:3},{children:[{isPure:r,operator:W,text:" ",type:1},{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:m,operator:j,tag:"path",type:3},{isPure:r,operator:W,text:" ",type:1}],context:Q,isPure:r,isStatic:r,isSvg:r,operator:j,tag:"g",type:3}],context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:f,operator:j,tag:"svg",type:3}],context:Q,isPure:r,isStatic:r,nativeAttrs:g,operator:j,tag:"div",type:3}):t.push({children:[{children:[{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:l,operator:j,tag:"g",type:3},{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:c,operator:j,tag:"g",type:3},{children:[{isPure:r,operator:W,text:" ",type:1},{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:v,operator:j,tag:"path",type:3},{isPure:r,operator:W,text:" ",type:1}],context:Q,isPure:r,isStatic:r,isSvg:r,operator:j,tag:"g",type:3}],context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:f,operator:j,tag:"svg",type:3}],context:Q,isPure:r,isStatic:r,nativeAttrs:y,operator:j,tag:"div",type:3}),t.push({context:Q,events:{mouseenter:E("mouseenter","mouseenter()","mouseenter","","mouseenter"),mouseleave:E("mouseleave","mouseleave()","mouseleave","","mouseleave")},nativeAttrs:A,operator:j,ref:"name",tag:"div",text:G(F(at,at.length-1,"node.name",["node","name"],r).value),type:3}),V((e=$(at,at.length-1,"isFolder",J&&J.isFolder||tt.isFolder).value,"function"==typeof e?e($(at,at.length-1,"node").value):Z.fatal("[isFolder(node)] is not a function."))).value?t.push({isPure:r,operator:H,text:"",type:2}):t.push({children:function(){var t=[];return F(at,at.length-1,"node.played",["node","played"],r).value&&!F(at,at.length-1,"node.paused",["node","paused"],r).value?t.push({children:[{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:b,operator:j,tag:"path",type:3}],context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:x,operator:j,tag:"svg",type:3}):t.push({children:[{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:w,operator:j,tag:"path",type:3}],context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:x,operator:j,tag:"svg",type:3}),t.length?t:i}(),context:Q,events:{click:E("click","play()","click","","play")},nativeAttrs:{class:"avplayer-ui-folder-icon play hint--top","data-hint":!F(at,at.length-1,"node.played",["node","played"],r).value||F(at,at.length-1,"node.paused",["node","paused"],r).value?F(at,at.length-1,"language.TIP_PLAY",["language","TIP_PLAY"],r).value:F(at,at.length-1,"language.TIP_PAUSE",["language","TIP_PAUSE"],r).value},operator:j,tag:"div",type:3}),F(at,at.length-1,"node.depth",["node","depth"],r).value?t.push({isPure:r,operator:H,text:"",type:2}):t.push({children:[{children:[{context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:k,operator:j,tag:"path",type:3}],context:Q,isPure:r,isStatic:r,isSvg:r,nativeAttrs:a,operator:j,tag:"svg",type:3}],context:Q,events:{click:E("click","delete()","click","","delete")},nativeAttrs:{class:"avplayer-ui-folder-icon delete hint--top","data-hint":F(at,at.length-1,"language.TIP_DELETE",["language","TIP_DELETE"],r).value},operator:j,tag:"div",type:3}),t.length?t:i}(),context:Q,nativeAttrs:{class:"avplayer-ui-folder-node "+(F(at,at.length-1,"node.played",["node","played"],r).value?"active":"")},nativeStyles:t("padding-inline-start: "+G(V((e=$(at,at.length-1,"paddingStart",J&&J.paddingStart||tt.paddingStart).value,"function"==typeof e?e($(at,at.length-1,"node").value):Z.fatal("[paddingStart(node)] is not a function."))).value)+"px;"),operator:j,tag:"div",type:3}),V((e=$(at,at.length-1,"isFolder",J&&J.isFolder||tt.isFolder).value,"function"==typeof e?e($(at,at.length-1,"node").value):Z.fatal("[isFolder(node)] is not a function."))).value&&F(at,at.length-1,"node.opened",["node","opened"],r).value?S.push({children:function(){var t=[];return B(F(at,at.length-1,"node.children",["node","children"],r),(function(i,r,s,a){t.push({context:Q,key:V(r.name,i[i.length-1].getKeypath("name")).value,operator:X,props:{language:$(i,i.length-1,"language").value,node:(e=i[i.length-1],V(e.getScope(),e.keypath)).value},ref:V(r.id,i[i.length-1].getKeypath("id")).value,tag:"FolderNode",type:4})})),t.length?t:i}(),context:Q,nativeAttrs:T,operator:j,tag:"ul",type:3}):S.push({isPure:r,operator:H,text:"",type:2}),S.length?S:i}(),context:Q,nativeAttrs:S,operator:j,tag:"li",type:3})})},15491:t=>{var e,i,r,s,a,n,o,l,c,h,d,u,f;t.exports=(e=void 0,i=!0,r={class:"avplayer-ui-info-title"},s={d:"m8 6.939 3.182-3.182a.75.75 0 1 1 1.061 1.061L9.061 8l3.182 3.182a.75.75 0 1 1-1.061 1.061L8 9.061l-3.182 3.182a.75.75 0 1 1-1.061-1.061L6.939 8 3.757 4.818a.75.75 0 1 1 1.061-1.061L8 6.939z"},a={"data-pointer":"none",space:"preserve",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},n={class:"avplayer-ui-info-close"},o={class:"avplayer-ui-info-format"},l={class:"avplayer-ui-info-line-title"},c={class:"avplayer-ui-info-line-value"},h={class:"avplayer-ui-info-line"},d={class:"avplayer-ui-info-panel"},u={type:"text/css"},f={class:"avplayer-ui-info"},function(t,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G,W,H,j,X,q,Y,K){K.push({children:function(){var t=[];return t.push({context:F,nativeAttrs:r,operator:D,tag:"div",text:M(P(X,X.length-1,"language.INFO_TITLE",["language","INFO_TITLE"],i).value),type:3}),t.push({children:[{children:[{context:F,isPure:i,isStatic:i,isSvg:i,nativeAttrs:s,operator:D,tag:"path",type:3}],context:F,isPure:i,isStatic:i,isSvg:i,nativeAttrs:a,operator:D,tag:"svg",type:3}],context:F,events:{click:v("click","close()","click","","close")},nativeAttrs:n,operator:D,tag:"span",type:3}),t.push({children:function(){var t=[];return t.push({children:function(){var t=[];return t.push({context:F,html:M(_(X,X.length-1,"info").value),operator:D,tag:"span",type:3}),t.length?t:e}(),context:F,nativeAttrs:o,operator:D,tag:"div",type:3}),x(_(X,X.length-1,"list"),(function(i,r,s,a){t.push({children:function(){var t=[];return t.push({context:F,nativeAttrs:l,operator:D,tag:"span",text:M(_(i,i.length-1,"key").value),type:3}),t.push({context:F,nativeAttrs:c,operator:D,tag:"span",text:M(_(i,i.length-1,"value").value),type:3}),t.length?t:e}(),context:F,nativeAttrs:h,operator:D,tag:"div",type:3})})),t.length?t:e}(),context:F,events:{keydown:v("keydown","preventDefault()","keydown","","preventDefault"),keyup:v("keyup","preventDefault()","keyup","","preventDefault")},nativeAttrs:d,operator:D,tag:"div",type:3}),t.push({context:F,html:M(_(X,X.length-1,"style").value),nativeAttrs:u,operator:D,tag:"style",type:3}),t.length?t:e}(),context:F,nativeAttrs:f,operator:D,tag:"div",type:3})})},32849:t=>{var e,i,r,s,a;t.exports=(e=!0,i={cx:"50",cy:"50",fill:"none",r:"20"},r={class:"avplayer-ui-circular",viewBox:"25 25 50 50"},s={class:"avplayer-ui-loading-spinner"},a={type:"text/css"},function(t,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V){V.push({children:function(){var t=[];return t.push({children:[{children:[{context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:i,operator:I,tag:"circle",type:3}],context:M,isPure:e,isStatic:e,isSvg:e,nativeAttrs:r,operator:I,tag:"svg",type:3}],context:M,isPure:e,isStatic:e,nativeAttrs:s,operator:I,tag:"div",type:3}),t.push({context:M,html:k(b(F,F.length-1,"style").value),nativeAttrs:a,operator:I,tag:"style",type:3}),t.length?t:void 0}(),context:M,nativeAttrs:{class:"avplayer-ui-loading-mask","data-loading":b(F,F.length-1,"loading").value?1:0},operator:I,tag:"div",type:3})})},23077:t=>{var e,i,r,s,a;t.exports=(i=void 0,r=!0,s={class:"avplayer-ui-loading-message-list"},a={type:"text/css"},function(t,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V){V.push({children:function(){var n=[];return n.push({children:function(){var s=[];return f(b(F,F.length-1,"message"),(function(i,a,n,o,l){s.push({context:M,key:(e=i[i.length-1],w(e.getScope(),e.keypath)).value,nativeAttrs:{class:"avplayer-ui-loading-message","data-last":A(i,i.length-1,"message.length",["message","length"],r).value-1===l?1:0},nativeStyles:t("bottom: "+k(30*(A(i,i.length-1,"message.length",["message","length"],r).value-1-l))+"px;"),operator:I,tag:"div",text:k((e=i[i.length-1],w(e.getScope(),e.keypath)).value),type:3})})),s.length?s:i}(),context:M,nativeAttrs:s,operator:I,tag:"div",type:3}),n.push({context:M,html:k(b(F,F.length-1,"style").value),nativeAttrs:a,operator:I,tag:"style",type:3}),n.length?n:i}(),context:M,nativeAttrs:{class:"avplayer-ui-loading-tip","data-show":b(F,F.length-1,"showMessage").value?1:0},operator:I,tag:"div",type:3})})},65051:t=>{var e,i;t.exports=(e={type:"text/css"},i={class:"avplayer-ui-pcm-visualization"},function(t,r,s,a,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F){F.push({children:function(){var t=[];return t.push({context:_,operator:k,ref:"canvas",tag:"canvas",type:3}),t.push({context:_,html:b(v(L,L.length-1,"style").value),nativeAttrs:e,operator:k,tag:"style",type:3}),t.length?t:void 0}(),context:_,nativeAttrs:i,operator:k,tag:"div",type:3})})},90577:t=>{var e,i,r,s,a,n,o,l,c,h,d,u,f,p,m;t.exports=(i=void 0,r=!0,s={class:"avplayer-ui-progress-hover"},a={class:"avplayer-ui-progress-loaded"},n={class:"avplayer-ui-progress-played"},o={class:"avplayer-ui-progress-chapter-item"},l={class:"avplayer-ui-progress-chapter"},c={class:"avplayer-ui-icon-indicator"},h={class:"avplayer-ui-progress-indicator"},d={class:"avplayer-ui-progress-tip"},u={class:"avplayer-ui-progress-inner"},f={class:"libmedia-ui-progress-thumb"},p={type:"text/css"},m={class:"avplayer-ui-progress"},function(t,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G,W,H,j,X,q,Y,K,Q,Z){Z.push({children:function(){var m=[];return m.push({children:function(){var u=[];return u.push({context:z,nativeAttrs:s,nativeStyles:t("width: "+B(C(Y,Y.length-1,"hoverWidth").value)+"%;"),operator:L,tag:"div",type:3}),u.push({context:z,nativeAttrs:a,nativeStyles:t("width: "+B(C(Y,Y.length-1,"loadedWidth").value)+"%;"),operator:L,tag:"div",type:3}),u.push({context:z,nativeAttrs:n,nativeStyles:t("width: "+B(C(Y,Y.length-1,"playedWidth").value)+"%;"),operator:L,tag:"div",type:3}),u.push({children:function(){var r=[];return k(C(Y,Y.length-1,"chapters"),(function(i,s,a,n){r.push({context:z,events:{click:A("click","chapterClick(this)","click","","chapterClick",{execute:function(t,r){return[(e=i[i.length-1],R(e.getScope(),e.keypath)).value]}}),mouseenter:A("mouseenter","chapterEnter(this)","mouseenter","","chapterEnter",{execute:function(t,r){return[(e=i[i.length-1],R(e.getScope(),e.keypath)).value]}}),mouseleave:A("mouseleave","chapterLeave(this)","mouseleave","","chapterLeave",{execute:function(t,r){return[(e=i[i.length-1],R(e.getScope(),e.keypath)).value]}})},key:R(s.text,i[i.length-1].getKeypath("text")).value,nativeAttrs:o,nativeStyles:t("left: "+B(C(i,i.length-1,"left").value)+"%;"),operator:L,tag:"span",type:3})})),r.length?r:i}(),context:z,nativeAttrs:l,operator:L,tag:"div",type:3}),C(Y,Y.length-1,"indicatorUrl").value?u.push({children:function(){var t=[];return t.push({children:function(){var t=[];return t.push({context:z,nativeAttrs:{draggable:"false",height:C(Y,Y.length-1,"indicatorSize").value,src:C(Y,Y.length-1,"indicatorUrl").value,width:C(Y,Y.length-1,"indicatorSize").value},operator:L,tag:"img",type:3}),t.length?t:i}(),context:z,nativeAttrs:c,operator:L,tag:"i",type:3}),t.length?t:i}(),context:z,events:{mousedown:A("mousedown","indicatorDown()","mousedown","","indicatorDown")},nativeAttrs:h,nativeStyles:t("left: "+B(C(Y,Y.length-1,"playedWidth").value)+"%;"),operator:L,tag:"div",type:3}):u.push({isPure:r,operator:U,text:"",type:2}),u.push({context:z,nativeAttrs:d,nativeStyles:t("left: "+B(C(Y,Y.length-1,"hoverWidth").value)+"%; display: "+B(C(Y,Y.length-1,"showTip").value?"block":"none")+";"),operator:L,tag:"div",text:B(C(Y,Y.length-1,"hoverChapter").value||R((e=C(Y,Y.length-1,"formatTime",G&&G.formatTime||W.formatTime).value,"function"==typeof e?e(C(Y,Y.length-1,"hoverTime").value):V.fatal("[formatTime(hoverTime)] is not a function."))).value),type:3}),u.length?u:i}(),context:z,events:{click:A("click","hoverClick()","click","","hoverClick"),mouseenter:A("mouseenter","hoverEnter()","mouseenter","","hoverEnter"),mouseleave:A("mouseleave","hoverLeave()","mouseleave","","hoverLeave"),mousemove:A("mousemove","hoverMove()","mousemove","","hoverMove")},nativeAttrs:u,operator:L,ref:"slider",tag:"div",type:3}),m.push({context:z,isPure:r,isStatic:r,nativeAttrs:f,operator:L,tag:"div",type:3}),m.push({context:z,html:B(C(Y,Y.length-1,"style").value),nativeAttrs:p,operator:L,tag:"style",type:3}),m.length?m:i}(),context:z,nativeAttrs:m,operator:L,tag:"div",type:3})})},42461:t=>{var e,i,r,s,a,n,o,l,c,h,d;t.exports=(e=void 0,i=!0,r={class:"avplayer-ui-settings-title"},s={d:"m8 6.939 3.182-3.182a.75.75 0 1 1 1.061 1.061L9.061 8l3.182 3.182a.75.75 0 1 1-1.061 1.061L8 9.061l-3.182 3.182a.75.75 0 1 1-1.061-1.061L6.939 8 3.757 4.818a.75.75 0 1 1 1.061-1.061L8 6.939z"},a={"data-pointer":"none",space:"preserve",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},n={class:"avplayer-ui-settings-close"},o={class:"avplayer-ui-settings-tabs"},l={class:"avplayer-ui-settings-context"},c={class:"avplayer-ui-settings-panel"},h={type:"text/css"},d={class:"avplayer-ui-settings"},function(t,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z,V,G,W,H,j,X,q){q.push({children:function(){var t=[];return t.push({context:N,nativeAttrs:r,operator:R,tag:"div",text:E(S(H,H.length-1,"language.SETTINGS_TITLE",["language","SETTINGS_TITLE"],i).value),type:3}),t.push({children:[{children:[{context:N,isPure:i,isStatic:i,isSvg:i,nativeAttrs:s,operator:R,tag:"path",type:3}],context:N,isPure:i,isStatic:i,isSvg:i,nativeAttrs:a,operator:R,tag:"svg",type:3}],context:N,events:{click:m("click","close()","click","","close")},nativeAttrs:n,operator:R,tag:"span",type:3}),t.push({children:function(){var t=[];return t.push({children:function(){var t=[];return A(I(H,H.length-1,"list"),(function(e,i,r,s){t.push({context:N,events:{click:m("click","set('tab', id)","click","","set",{execute:function(t,i){return["tab",I(e,e.length-1,"id").value]}})},nativeAttrs:{class:"avplayer-ui-settings-tab "+(I(e,e.length-1,"id").value===I(e,e.length-1,"tab").value?"active":"")},operator:R,tag:"div",text:E(I(e,e.length-1,"name").value),type:3})})),t.length?t:e}(),context:N,nativeAttrs:o,operator:R,tag:"div",type:3}),t.push({context:N,isPure:i,isStatic:i,nativeAttrs:l,operator:R,tag:"div",type:3}),t.length?t:e}(),context:N,nativeAttrs:c,operator:R,tag:"div",type:3}),t.push({context:N,html:E(I(H,H.length-1,"style").value),nativeAttrs:h,operator:R,tag:"style",type:3}),t.length?t:e}(),context:N,nativeAttrs:d,operator:R,tag:"div",type:3})})},82042:t=>{var e,i,r,s;t.exports=(e=void 0,i={class:"libmedia-ui-slider-inner"},r={class:"libmedia-ui-slider-outer"},s={class:"libmedia-ui-slider-thumb"},function(t,a,n,o,l,c,h,d,u,f,p,m,g,v,y,A,b,x,w,k,T,S,I,P,_,E,C,M,R,B,D,U,L,N,O,F,$,z){z.push({children:function(){var t=[];return t.push({children:function(){var t=[];return t.push({context:C,nativeAttrs:i,nativeStyles:a(A(O,O.length-1,"offset").value),operator:S,tag:"div",type:3}),t.length?t:e}(),context:C,nativeAttrs:r,operator:S,ref:"slider",tag:"div",type:3}),t.push({context:C,events:{mousedown:l("mousedown","mousedown()","mousedown","","mousedown")},nativeAttrs:s,nativeStyles:a(A(O,O.length-1,"offset").value),operator:S,tag:"div",type:3}),t.length?t:e}(),context:C,nativeAttrs:{class:"libmedia-ui-slider","data-direction":A(O,O.length-1,"direction").value},operator:S,tag:"div",type:3})})},89739:t=>{t.exports="html{--libmedia-ui-theme:#23ade5;--libmedia-ui-font-color:#fff;--libmedia-ui-background-color:#000;--libmedia-ui-text-shadow-color:rgba(0,0,0,0.502);--libmedia-ui-transition-duration:.2s;--libmedia-ui-padding:10px;--libmedia-ui-border-radius:3px;--libmedia-ui-progress-height:6px;--libmedia-ui-progress-color:rgba(255,255,255,0.251);--libmedia-ui-hover-color:rgba(255,255,255,0.251);--libmedia-ui-loaded-color:rgba(255,255,255,0.251);--libmedia-ui-state-size:80px;--libmedia-ui-state-opacity:.8;--libmedia-ui-header-height:40px;--libmedia-ui-bottom-height:100px;--libmedia-ui-bottom-offset:51px;--libmedia-ui-bottom-gap:5px;--libmedia-ui-chapter-width:8px;--libmedia-ui-chapter-color:rgba(255,255,255,0.502);--libmedia-ui-control-height:46px;--libmedia-ui-control-opacity:.75;--libmedia-ui-control-icon-size:28px;--libmedia-ui-control-icon-scale:1.1;--libmedia-ui-volume-height:120px;--libmedia-ui-slider-thumb-size:14px;--libmedia-ui-slider-thickness:2px;--libmedia-ui-lock-size:36px;--libmedia-ui-indicator-scale:0;--libmedia-ui-indicator-size:16px;--libmedia-ui-fullscreen-web-index:9999;--libmedia-ui-settings-icon-size:24px;--libmedia-ui-settings-max-height:300px;--libmedia-ui-selector-max-height:300px;--libmedia-ui-contextmenus-min-width:250px;--libmedia-ui-subtitle-font-size:20px;--libmedia-ui-subtitle-gap:5px;--libmedia-ui-subtitle-bottom:15px;--libmedia-ui-subtitle-border:#000;--libmedia-ui-widget-background:rgba(0,0,0,0.851);--libmedia-ui-widget-hover-background:rgba(255,255,255,0.102);--libmedia-ui-tip-background:rgba(0,0,0,0.702);--libmedia-ui-tip-font-color:#fff;--libmedia-ui-scrollbar-size:4px;--libmedia-ui-scrollbar-background:rgba(255,255,255,0.251);--libmedia-ui-scrollbar-background-hover:rgba(255,255,255,0.502);--libmedia-ui-mini-progress-height:2px;--libmedia-ui-folder-width:300px}[class*=\"hint--\"]{font-style:normal;position:relative}[class*=\"hint--\"]:before,[class*=\"hint--\"]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate3d(0,0,0)}[class*=\"hint--\"]:hover:before,[class*=\"hint--\"]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=\"hint--\"]:before{content:\"\";z-index:1000001;background:none;border:6px solid rgba(0,0,0,0);position:absolute}[class*=\"hint--\"]:after{color:var(--libmedia-ui-tip-font-color);white-space:nowrap;background:var(--libmedia-ui-tip-background);padding:8px 10px;font-size:12px;line-height:12px}[class*=\"hint--\"][data-hint]:after{content:attr(data-hint)}[data-hint=\"\"]:before,[data-hint=\"\"]:after{display:none !important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:var(--libmedia-ui-tip-background)}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:var(--libmedia-ui-tip-background)}.hint--left:before{border-left-color:var(--libmedia-ui-tip-background)}.hint--right:before{border-right-color:var(--libmedia-ui-tip-background)}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translateX(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translateX(-50%) translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translateX(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translateX(-50%) translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translateX(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translateX(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translateX(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translateX(-100%) translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translateX(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translateX(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translateX(-100%) translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translateX(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=\"hint--\"]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px rgba(0,0,0,0.302)}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translateX(-50%) translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translateX(-100%) translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translateX(-50%) translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translateX(-100%) translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translateX(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translateX(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}.libmedia-ui-selector{text-align:center;border-radius:var(--libmedia-ui-border-radius);opacity:0;pointer-events:none;bottom:var(--libmedia-ui-control-height);max-height:var(--libmedia-ui-selector-max-height);background-color:var(--libmedia-ui-widget-background);transition:all var(--libmedia-ui-transition-duration) ease;flex-direction:column;align-items:center;display:flex;position:absolute;overflow:hidden auto}.libmedia-ui-selector .libmedia-ui-selector-item{flex-shrink:0;justify-content:center;align-items:center;width:100%;padding:10px 15px;line-height:1;display:flex;cursor:pointer}.libmedia-ui-selector .libmedia-ui-selector-item.active{color:var(--libmedia-ui-theme)}.libmedia-ui-selector .libmedia-ui-selector-item:hover{background-color:var(--libmedia-ui-widget-hover-background)}.libmedia-ui-slider{cursor:pointer;width:100%;height:100%;position:relative;justify-content:center;display:flex}.libmedia-ui-slider .libmedia-ui-slider-outer{border-radius:var(--libmedia-ui-border-radius);background-color:rgba(255,255,255,0.251);justify-content:center;display:flex;position:relative;overflow:hidden}.libmedia-ui-slider .libmedia-ui-slider-outer .libmedia-ui-slider-inner{background-color:var(--libmedia-ui-theme);width:100%;height:100%;position:absolute}.libmedia-ui-slider .libmedia-ui-slider-thumb{width:var(--libmedia-ui-slider-thumb-size);height:var(--libmedia-ui-slider-thumb-size);background-color:var(--libmedia-ui-theme);transition:transform var(--libmedia-ui-transition-duration) ease;border-radius:100%;flex-shrink:0;position:absolute;transform:scale(1)}.libmedia-ui-slider[data-direction='vertical'] .libmedia-ui-slider-outer{width:var(--libmedia-ui-slider-thickness);height:100%}.libmedia-ui-slider[data-direction='vertical'] .libmedia-ui-slider-thumb{margin-top:calc(var(--libmedia-ui-slider-thumb-size) / -2)}.libmedia-ui-slider[data-direction='horizontal'] .libmedia-ui-slider-outer{width:100%;height:var(--libmedia-ui-slider-thickness)}.libmedia-ui-slider[data-direction='horizontal'] .libmedia-ui-slider-thumb{margin-right:calc(var(--libmedia-ui-slider-thumb-size) / -2)}.avplayer-ui-container{width:100%;height:100%;user-select:none;color:var(--libmedia-ui-font-color);background-color:var(--libmedia-ui-background-color);text-shadow:0 0 2px var(--libmedia-ui-text-shadow-color)}.avplayer-ui-container *{box-sizing:border-box;outline:none}.avplayer-ui-container svg{fill:var(--libmedia-ui-font-color)}.avplayer-ui-container .avplayer-ui-header{width:100%;height:var(--libmedia-ui-header-height);position:absolute;top:0;text-align:center;padding:0 var(--libmedia-ui-padding);transition:all var(--libmedia-ui-transition-duration) ease;background-size:100% var(--libmedia-ui-header-height);background-image:linear-gradient(to bottom,#000,rgba(0,0,0,0.4),rgba(0,0,0,0))}.avplayer-ui-container .avplayer-ui-header .avplayer-ui-title{line-height:var(--libmedia-ui-header-height);font-size:16px;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.avplayer-ui-container .avplayer-ui-header a{position:absolute;right:calc((var(--libmedia-ui-header-height) - 16px) / 2);top:calc((var(--libmedia-ui-header-height) - 16px) / 2);height:16px}.avplayer-ui-container .avplayer-ui-header a svg{height:16px;width:16px}.avplayer-ui-container .avplayer-ui-player{width:100%;height:100%;position:absolute;top:0;left:0;overflow:hidden;cursor:pointer}.avplayer-ui-container .avplayer-ui-player canvas,.avplayer-ui-container .avplayer-ui-player video{background-color:#000}.avplayer-ui-container .avplayer-ui-footer{padding:0 var(--libmedia-ui-padding);transition:all var(--libmedia-ui-transition-duration) ease;background-size:100% var(--libmedia-ui-bottom-height);background-image:linear-gradient(to top,#000,rgba(0,0,0,0.4),rgba(0,0,0,0));flex-direction:column;justify-content:flex-end;width:100%;height:var(--libmedia-ui-bottom-height);display:flex;position:absolute;bottom:0}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-progress-container{pointer-events:auto;padding-bottom:var(--libmedia-ui-bottom-gap);position:relative;transition:transform var(--libmedia-ui-transition-duration) ease}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control{height:var(--libmedia-ui-control-height);justify-content:space-between;align-items:center;display:flex;position:relative;transition:transform var(--libmedia-ui-transition-duration) ease}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control .avplayer-ui-control-item{cursor:pointer;white-space:nowrap;opacity:var(--libmedia-ui-control-opacity);min-height:var(--libmedia-ui-control-height);min-width:var(--libmedia-ui-control-height);transition:opacity var(--libmedia-ui-transition-duration) ease;flex-shrink:0;justify-content:center;align-items:center;display:flex;position:relative}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control .avplayer-ui-control-item svg{height:var(--libmedia-ui-control-icon-size);width:var(--libmedia-ui-control-icon-size);transform:scale(var(--libmedia-ui-control-icon-scale));transition:transform var(--libmedia-ui-transition-duration) ease}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control .avplayer-ui-control-item:hover{cursor:pointer;opacity:1}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control .avplayer-ui-footer-left{height:100%;display:flex}.avplayer-ui-container .avplayer-ui-footer .avplayer-ui-control .avplayer-ui-footer-right{height:100%;display:flex;justify-content:flex-end}.avplayer-ui-container .avplayer-ui-footer:hover .avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-indicator{transform:scale(1)}.avplayer-ui-container .avplayer-ui-folder-container{position:absolute;top:0;left:0;transition:all var(--libmedia-ui-transition-duration) ease;width:var(--libmedia-ui-folder-width);bottom:calc(var(--libmedia-ui-progress-height) + var(--libmedia-ui-bottom-gap) + var(--libmedia-ui-control-height));box-shadow:2px 0 8px rgba(0,0,0,0.6);background-color:var(--libmedia-ui-widget-background);border-top-right-radius:8px;border-bottom-right-radius:8px}.avplayer-ui-container .avplayer-ui-folder-container .avplayer-ui-folder-toggle{width:24px;height:60px;justify-content:center;align-items:center;display:flex;cursor:pointer;border-top-right-radius:8px;border-bottom-right-radius:8px;box-shadow:2px 0 8px rgba(0,0,0,0.6);transition:all var(--libmedia-ui-transition-duration) ease;position:absolute;right:-24px;top:50%;transform:translateY(-50%);opacity:1}.avplayer-ui-container .avplayer-ui-folder-container .avplayer-ui-folder-toggle svg{width:24px;height:24px;opacity:var(--libmedia-ui-control-opacity);transform:rotate(180deg)}.avplayer-ui-container .avplayer-ui-folder-container .avplayer-ui-folder-toggle:hover svg{opacity:1}.avplayer-ui-container .avplayer-ui-folder-container[data-fold='1']{transform:translateX(calc(var(--libmedia-ui-folder-width) * -1))}.avplayer-ui-container .avplayer-ui-folder-container[data-fold='1'] .avplayer-ui-folder-toggle svg{transform:rotate(0)}.avplayer-ui-container .avplayer-ui-mask{pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute}.avplayer-ui-container .avplayer-ui-mask .avplayer-ui-state{opacity:0;width:var(--libmedia-ui-state-size);height:var(--libmedia-ui-state-size);transition:all var(--libmedia-ui-transition-duration) ease;justify-content:center;align-items:center;display:flex;transform:scale(2)}.avplayer-ui-container .avplayer-ui-mask .avplayer-ui-state img{vertical-align:top;max-width:100%}.avplayer-ui-container .avplayer-ui-mask .avplayer-ui-state[data-show='1']{cursor:pointer;pointer-events:auto;opacity:var(--libmedia-ui-state-opacity);transform:scale(1)}.avplayer-ui-container .avplayer-ui-mask.info{height:calc(100% - var(--libmedia-ui-bottom-height))}.avplayer-ui-container .avplayer-ui-mask.showSettings{height:calc(100% - var(--libmedia-ui-bottom-height))}.avplayer-ui-container .avplayer-ui-pcm-visualization-mask{pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute;transition:all var(--libmedia-ui-transition-duration) ease}.avplayer-ui-container .avplayer-ui-menu{position:fixed;border-radius:var(--libmedia-ui-border-radius);background-color:var(--libmedia-ui-widget-background);transition:all var(--libmedia-ui-transition-duration) ease}.avplayer-ui-container .avplayer-ui-menu .avplayer-ui-menu-item{padding:10px 60px;font-size:14px;cursor:pointer}.avplayer-ui-container .avplayer-ui-menu .avplayer-ui-menu-item:hover{background-color:var(--libmedia-ui-widget-hover-background)}.avplayer-ui-container[data-bar-show='0']{cursor:none}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-player{cursor:none}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-header{transform:translateY(calc(var(--libmedia-ui-header-height) * -1))}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-footer{transform:translateY(var(--libmedia-ui-bottom-height))}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-footer .avplayer-ui-progress-container{transform:translateY(calc((var(--libmedia-ui-bottom-height) - var(--libmedia-ui-bottom-gap) - var(--libmedia-ui-progress-height) * 0.5 - var(--libmedia-ui-control-height)) * -1))}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-folder-container{opacity:0;transform:translateX(calc(var(--libmedia-ui-folder-width) * -1))}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-folder-container .avplayer-ui-folder-toggle{pointer-events:none}.avplayer-ui-container[data-bar-show='0'] .avplayer-ui-pcm-visualization-mask{background-color:rgba(0,0,0,0.5)}@keyframes icon_scale{0%{transform:scale(1);transform-origin:center center}50%{transform:scale(1.2);transform-origin:center center}100%{transform:scale(1);transform-origin:center center}}@keyframes icon_rotate{0%{transform:rotate(0);transform-origin:center center}100%{transform:rotate(120deg);transform-origin:center center}}"},42567:t=>{t.exports=".avplayer-ui-control-audio-track{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-audio-track:hover .libmedia-ui-selector{opacity:1;pointer-events:auto}"},9371:t=>{t.exports=".avplayer-ui-control-fullscreen{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-fullscreen:hover svg{animation:icon_scale .4s ease both}"},85885:t=>{t.exports=".avplayer-ui-control-loop{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-loop:hover svg{animation:icon_scale .4s ease both}"},6187:t=>{t.exports=".avplayer-ui-control-pip{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-pip:hover svg{animation:icon_scale .4s ease both}"},70409:t=>{t.exports=".avplayer-ui-control-play{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-play:hover svg{animation:icon_scale .4s ease both}"},63197:t=>{t.exports=".avplayer-ui-control-play-rate{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-play-rate:hover .libmedia-ui-selector{opacity:1;pointer-events:auto}"},51819:t=>{t.exports=".avplayer-ui-control-settings{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-settings:hover svg{animation:icon_rotate .4s ease both}"},35995:t=>{t.exports=".avplayer-ui-control-subtitle-track{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-subtitle-track:hover .libmedia-ui-selector{opacity:1;pointer-events:auto}"},27983:t=>{t.exports=".avplayer-ui-control-timer{display:flex;align-items:center;justify-content:center;cursor:pointer;padding:0 10px;opacity:var(--libmedia-ui-control-opacity)}.avplayer-ui-control-timer .avplayer-ui-time-label{min-width:66px}.avplayer-ui-control-timer .avplayer-ui-time-div{transform:translateX(-1px)}.avplayer-ui-control-timer:hover{opacity:1}"},27189:t=>{t.exports=".avplayer-ui-control-video-track{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-video-track:hover .libmedia-ui-selector{opacity:1;pointer-events:auto}"},80253:t=>{t.exports=".avplayer-ui-control-volume{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.avplayer-ui-control-volume:hover svg{animation:icon_scale .4s ease both}.avplayer-ui-control-volume:hover .avplayer-ui-volume-panel{opacity:1;pointer-events:auto}.avplayer-ui-control-volume .avplayer-ui-volume-icon{justify-content:center;align-items:center;display:flex}.avplayer-ui-control-volume .avplayer-ui-volume-panel{text-align:center;opacity:0;pointer-events:none;left:0;right:0;bottom:var(--libmedia-ui-control-height);width:var(--libmedia-ui-control-height);height:var(--libmedia-ui-volume-height);transition:all ease;transition:all var(--libmedia-ui-transition-duration) ease 0s;justify-content:center;align-items:center;padding:0 5px;font-size:12px;display:flex;position:absolute;z-index:1}.avplayer-ui-control-volume .avplayer-ui-volume-panel .avplayer-ui-volume-inner{border-radius:var(--libmedia-ui-border-radius);background-color:var(--libmedia-ui-widget-background);flex-direction:column;align-items:center;gap:10px;width:100%;height:100%;padding:10px 0 12px;display:flex}.avplayer-ui-control-volume .avplayer-ui-volume-panel .avplayer-ui-volume-inner .libmedia-ui-slider{flex:1}"},50055:t=>{t.exports=".avplayer-ui-folder{width:100%;height:100%;padding:var(--libmedia-ui-padding) 0;transition:all var(--libmedia-ui-transition-duration) ease}.avplayer-ui-folder ul{margin:0;padding:0;list-style:none}.avplayer-ui-folder svg{width:24px;height:24px}.avplayer-ui-folder .avplayer-ui-folder-open{display:flex;justify-content:center;align-items:center;height:30px;margin-bottom:10px;width:var(--libmedia-ui-folder-width);padding-right:var(--libmedia-ui-padding)}.avplayer-ui-folder .avplayer-ui-folder-open .avplayer-ui-folder-open-dir{transform:scale(.9)}.avplayer-ui-folder .avplayer-ui-folder-open .avplayer-ui-folder-open-dir .avplayer-ui-folder-open-name{margin-left:3px}.avplayer-ui-folder .avplayer-ui-folder-open .avplayer-ui-folder-open-file{transform:scale(.9)}.avplayer-ui-folder .avplayer-ui-folder-open .avplayer-ui-folder-open-file svg{stroke:var(--libmedia-ui-font-color);fill:none}.avplayer-ui-folder .avplayer-ui-folder-open .item{cursor:pointer;display:flex;justify-content:center;align-items:center;opacity:var(--libmedia-ui-control-opacity);transition:opacity var(--libmedia-ui-transition-duration) ease}.avplayer-ui-folder .avplayer-ui-folder-open .item:hover{opacity:1}.avplayer-ui-folder .avplayer-ui-folder-open .avplayer-ui-folder-open-name{display:inline-block;font-size:12px}.avplayer-ui-folder .avplayer-ui-folder-open .item + .item{margin-left:20px}.avplayer-ui-folder .avplayer-ui-url-open{display:flex;justify-content:center;align-items:center;margin-bottom:10px;height:30px;width:var(--libmedia-ui-folder-width);padding:0 var(--libmedia-ui-padding);opacity:var(--libmedia-ui-control-opacity);transition:opacity var(--libmedia-ui-transition-duration) ease}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-url-open-input{flex:1;font-size:12px;border:1px;border-radius:4px;color:var(--libmedia-ui-font-color);outline:none;border:1px solid var(--libmedia-ui-font-color);background:none;height:28px;line-height:28px;margin-left:14px;padding-left:10px}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-url-open-input::placeholder{color:var(--libmedia-ui-font-color)}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-folder-icon{width:30px;transform:scale(.9)}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-folder-icon svg{stroke:var(--libmedia-ui-font-color)}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-folder-icon:hover{cursor:pointer}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-folder-icon:hover svg{animation:icon_scale .4s ease both}.avplayer-ui-folder .avplayer-ui-url-open .avplayer-ui-url-open-live{display:flex;justify-content:center;align-items:center;font-size:12px}.avplayer-ui-folder .avplayer-ui-url-open:hover{opacity:1}.avplayer-ui-folder .avplayer-ui-folder-list-container{position:absolute;top:90px;bottom:0;left:0;right:0;overflow:auto}.avplayer-ui-folder .avplayer-ui-folder-list-container::-webkit-scrollbar{display:none}.avplayer-ui-folder .avplayer-ui-folder-node{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;height:30px;width:var(--libmedia-ui-folder-width);padding-right:var(--libmedia-ui-padding);opacity:var(--libmedia-ui-control-opacity);transition:opacity var(--libmedia-ui-transition-duration) ease}.avplayer-ui-folder .avplayer-ui-folder-node.active{background-color:var(--libmedia-ui-theme) !important}.avplayer-ui-folder .avplayer-ui-folder-node:hover{background-color:var(--libmedia-ui-widget-hover-background);opacity:1}.avplayer-ui-folder .avplayer-ui-folder-expand{cursor:pointer;font-size:0;display:flex;justify-content:center;align-items:center;transition:transform linear .1s;width:24px;height:100%}.avplayer-ui-folder .avplayer-ui-folder-expand svg{transform:rotate(0)}.avplayer-ui-folder .avplayer-ui-folder-expand[data-open='1'] svg{transform:rotate(90deg)}.avplayer-ui-folder .avplayer-ui-folder-icon{display:flex;justify-content:center;align-items:center;width:24px;height:100%}.avplayer-ui-folder .avplayer-ui-folder-icon.mov{margin-left:24px;transform:scale(.9)}.avplayer-ui-folder .avplayer-ui-folder-icon.music{margin-left:24px}.avplayer-ui-folder .avplayer-ui-folder-icon.url{margin-left:24px}.avplayer-ui-folder .avplayer-ui-folder-icon.play,.avplayer-ui-folder .avplayer-ui-folder-icon.delete{cursor:pointer;transform:scale(.8)}.avplayer-ui-folder .avplayer-ui-folder-icon.play:hover svg,.avplayer-ui-folder .avplayer-ui-folder-icon.delete:hover svg{animation:icon_scale .4s ease both}.avplayer-ui-folder .avplayer-ui-folder-node-name{padding:0 5px;min-width:100px;flex-grow:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.avplayer-ui-folder .avplayer-ui-folder-tip{text-shadow:0 -1px var(--libmedia-ui-tip-background);box-shadow:4px 4px 8px var(--libmedia-ui-tip-background);color:var(--libmedia-ui-tip-font-color);white-space:nowrap;background:var(--libmedia-ui-tip-background);padding:8px 10px;font-size:12px;line-height:12px;opacity:0;pointer-events:none;transition:all var(--libmedia-ui-transition-duration) ease .1s,top 0s ease 0s;position:absolute;transform:translate3d(0,0,0);left:100%}.avplayer-ui-folder .avplayer-ui-folder-tip::before{content:\"\";border:5px solid rgba(0,0,0,0);position:absolute;border-right-color:var(--libmedia-ui-tip-background);left:-10px;transform:translateY(1px)}.avplayer-ui-folder .avplayer-ui-folder-tip[data-show='1']{transform:translateX(8px);opacity:1}"},90615:t=>{t.exports=".avplayer-ui-info{pointer-events:auto;background:var(--libmedia-ui-tip-background);border-radius:4px;color:#fff;line-height:18px;padding-bottom:15px;text-align:center;text-align:left;-webkit-font-smoothing:antialiased;position:relative;max-height:80%;max-width:80%;user-select:text;display:flex;flex-direction:column}.avplayer-ui-info .avplayer-ui-info-title{border-bottom:1px solid rgba(255,255,255,0.1);font-size:16px;line-height:40px;text-align:center;height:41px}.avplayer-ui-info .avplayer-ui-info-close{fill:#fff;color:#fff;cursor:pointer;height:22px;position:absolute;right:10px;top:8px;width:22px}.avplayer-ui-info .avplayer-ui-info-panel{flex:1;padding:15px 26px 0;position:relative;overflow:auto;scrollbar-width:thin}.avplayer-ui-info .avplayer-ui-info-panel::-webkit-scrollbar{width:8px;height:8px}.avplayer-ui-info .avplayer-ui-info-panel .avplayer-ui-info-format{font-size:12px;font-weight:500}.avplayer-ui-info .avplayer-ui-info-panel .avplayer-ui-info-line{min-width:290px}.avplayer-ui-info .avplayer-ui-info-panel .avplayer-ui-info-line .avplayer-ui-info-line-title{font-size:12px;font-weight:500;margin-right:10px;text-align:right;text-indent:-99em;width:190px;display:inline-block}.avplayer-ui-info .avplayer-ui-info-panel .avplayer-ui-info-line .avplayer-ui-info-line-value{color:#999;font-size:12px;font-weight:400;margin-right:6px}"},57817:t=>{t.exports=".avplayer-ui-loading-mask{position:absolute;width:100%;height:100%;text-align:center;top:0;left:0;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:all var(--libmedia-ui-transition-duration) ease}.avplayer-ui-loading-mask .avplayer-ui-loading-spinner{top:50%;margin-top:-21px;width:100%;text-align:center;position:absolute}.avplayer-ui-loading-mask .avplayer-ui-loading-spinner .avplayer-ui-circular{height:42px;width:42px;animation:loading-rotate 2s linear infinite}.avplayer-ui-loading-mask .avplayer-ui-loading-spinner .avplayer-ui-circular circle{animation:loading-dash 1.5s ease-in-out infinite;stroke-dasharray:90,150;stroke-dashoffset:0;stroke-width:2;stroke:var(--libmedia-ui-theme);stroke-linecap:round}.avplayer-ui-loading-mask[data-loading='1']{opacity:1;pointer-events:auto}@keyframes loading-rotate{to{transform:rotate(1turn)}}@keyframes loading-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-40px}to{stroke-dasharray:90,150;stroke-dashoffset:-120px}}"},6453:t=>{t.exports=".avplayer-ui-loading-tip{position:absolute;right:20px;bottom:calc(var(--libmedia-ui-bottom-height) + 10px);opacity:1;pointer-events:none;transition:all 1s ease}.avplayer-ui-loading-tip .avplayer-ui-loading-message{transition:bottom .1s ease,transform 1s ease;border-radius:var(--libmedia-ui-border-radius);white-space:nowrap;background-color:var(--libmedia-ui-tip-background);padding:3px 5px;font-size:12px;line-height:1;position:absolute;right:0}.avplayer-ui-loading-tip .avplayer-ui-loading-message[data-last='1']{animation:avplayer-ui-loading-message-last .1s ease}.avplayer-ui-loading-tip[data-show='0']{opacity:0}.avplayer-ui-loading-tip[data-show='0'] .avplayer-ui-loading-message{transform:translateY(-40px)}@keyframes avplayer-ui-loading-message-last{0%{opacity:0}100%{opacity:1}}"},9067:t=>{t.exports=".avplayer-ui-pcm-visualization{width:100%;height:100%}.avplayer-ui-pcm-visualization canvas{width:100%;height:100%}"},57165:t=>{t.exports=".avplayer-ui-progress{cursor:pointer;height:var(--libmedia-ui-progress-height);justify-content:center;align-items:center;display:flex;position:relative}.avplayer-ui-progress:hover .avplayer-ui-progress-inner{height:100%}.avplayer-ui-progress .avplayer-ui-progress-inner{transition:height var(--libmedia-ui-transition-duration) ease;background-color:var(--libmedia-ui-progress-color);align-items:center;width:100%;height:50%;display:flex;position:relative}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-hover{background-color:var(--libmedia-ui-hover-color);width:0%;height:100%;position:absolute}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-loaded{background-color:var(--libmedia-ui-loaded-color);width:0%;height:100%;position:absolute}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-played{background-color:var(--libmedia-ui-theme);width:0%;height:100%;position:absolute}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-chapter{pointer-events:none;width:100%;height:100%;position:absolute}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-indicator{width:var(--libmedia-ui-indicator-size);height:var(--libmedia-ui-indicator-size);transform:scale(var(--libmedia-ui-indicator-scale));margin-left:calc(var(--libmedia-ui-indicator-size) / -2);transition:transform var(--libmedia-ui-transition-duration) ease;border-radius:50%;justify-content:center;align-items:center;display:flex;position:absolute;left:0}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-indicator:hover{transform:scale(1.2) !important}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-indicator .avplayer-ui-icon-indicator{width:100%;height:100%}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-chapter{pointer-events:none;width:100%;height:100%;position:absolute;overflow:hidden}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-chapter .avplayer-ui-progress-chapter-item{pointer-events:auto;transform:translateX(calc(var(--libmedia-ui-chapter-width) / -2));background-color:var(--libmedia-ui-chapter-color);width:var(--libmedia-ui-chapter-width);height:100%;position:absolute}.avplayer-ui-progress .avplayer-ui-progress-inner .avplayer-ui-progress-tip{border-radius:var(--libmedia-ui-border-radius);white-space:nowrap;background-color:var(--libmedia-ui-tip-background);transform:translateX(-50%);padding:3px 5px;font-size:12px;line-height:1;display:none;position:absolute;top:-25px;left:0}.avplayer-ui-progress .libmedia-ui-progress-thumb{bottom:calc(var(--libmedia-ui-bottom-gap) + 10px);border-radius:var(--libmedia-ui-border-radius);pointer-events:none;background-color:var(--libmedia-ui-widget-background);display:none;position:absolute;left:0;box-shadow:0 1px 3px rgba(0,0,0,0.2),0 1px 2px -1px rgba(0,0,0,0.2)}"},9217:t=>{t.exports=".avplayer-ui-settings{pointer-events:auto;background:var(--libmedia-ui-tip-background);border-radius:4px;color:#fff;position:relative;max-height:100%;max-width:80%;width:600px;height:500px;display:flex;flex-direction:column}.avplayer-ui-settings .avplayer-ui-settings-title{border-bottom:1px solid rgba(255,255,255,0.1);font-size:16px;line-height:40px;text-align:center;height:41px}.avplayer-ui-settings .avplayer-ui-settings-close{fill:#fff;color:#fff;cursor:pointer;height:22px;position:absolute;right:10px;top:8px;width:22px}.avplayer-ui-settings .avplayer-ui-settings-panel{flex:1;position:relative;display:flex;overflow:hidden}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-tabs{width:141px;height:100%;padding:20px;overflow:auto;transition:all var(--libmedia-ui-transition-duration) ease;border-right:1px solid rgba(255,255,255,0.1)}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-tabs .avplayer-ui-settings-tab{width:100px;height:36px;text-align:center;line-height:36px;cursor:pointer;border-radius:4px;font-size:14px;opacity:var(--libmedia-ui-control-opacity);background-color:var(--libmedia-ui-widget-hover-background)}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-tabs .avplayer-ui-settings-tab:hover{opacity:1}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-tabs .avplayer-ui-settings-tab.active{opacity:1;background-color:var(--libmedia-ui-theme)}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-tabs .avplayer-ui-settings-tab + .avplayer-ui-settings-tab{margin-top:10px}.avplayer-ui-settings .avplayer-ui-settings-panel .avplayer-ui-settings-context{flex:1;height:100%;overflow:auto;padding:20px}"},92246:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(16030),a=i(4624);class n{constructor(t){(0,r.A)(this,"resampler",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"inputParameters",void 0),(0,r.A)(this,"outputParameters",void 0),this.options=t,this.resampler=new s.A(this.options.resource)}async open(t,e){this.inputParameters=t,this.outputParameters=e,await this.resampler.run(),this.resampler.call("resample_set_input_parameters",t.sampleRate,t.channels,t.format,t.layout||0),this.resampler.call("resample_set_output_parameters",e.sampleRate,e.channels,e.format,e.layout||0);let i=this.resampler.call("resample_init");i<0&&a.h2(`open resampler failed, ret: ${i}`,"src/audioresample/Resampler.ts",84)}resample(t,e,i){return this.resampler.call("resample_process",t,e,i)}getOutputSampleCount(t){return this.resampler.call("resample_nb_sample",t)}close(){this.resampler.call("resample_destroy"),this.resampler.destroy(),this.resampler=null}getInputPCMParameters(){return this.inputParameters}getOutputPCMParameters(){return this.outputParameters}}},70089:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(16030);class a{constructor(t){(0,r.A)(this,"processor",void 0),(0,r.A)(this,"options",void 0),this.options=t,this.processor=new s.A(this.options.resource)}async open(t){await this.processor.run(),this.processor.call("stretchpitch_init"),this.processor.call("stretchpitch_set_channels",t.channels),this.processor.call("stretchpitch_set_samplerate",t.sampleRate)}setRate(t){this.processor.call("stretchpitch_set_rate",t)}setRateChange(t){this.processor.call("stretchpitch_set_rate_change",t)}setTempo(t){this.processor.call("stretchpitch_set_tempo",t)}setTempoChange(t){this.processor.call("stretchpitch_set_tempo_change",t)}setPitch(t){this.processor.call("stretchpitch_set_pitch",t)}setPitchOctaves(t){this.processor.call("stretchpitch_set_pitch_octaves",t)}setPitchSemiTones(t){this.processor.call("stretchpitch_set_pitch_semi_tones",t)}sendSamples(t,e){this.processor.call("stretchpitch_send_samples",t,e)}receiveSamples(t,e){return this.processor.call("stretchpitch_receive_samples",t,e)}flush(){this.processor.call("stretchpitch_flush")}clear(){this.processor.call("stretchpitch_clear")}getUnprocessedSamplesCount(){return this.processor.call("stretchpitch_get_unprocessed_samples_num")}getInputOutputSamplesRatio(){return this.processor.call("stretchpitch_get_input_output_sample_ratio")}getLatency(){return this.processor.call("get_latency")}close(){this.processor.call("stretchpitch_destroy"),this.processor.destroy(),this.processor=null}}},51128:(t,e,i)=>{"use strict";i.d(e,{d:()=>r});const r={86017:"mp3",86018:"mp4a.40",86021:"vorbis",86028:"flac",86076:"opus",65542:"ulaw",65543:"alaw",225:"av01",27:"avc1",173:"hev1",196:"vvc1",139:"vp8",167:"vp09",12:"mp4v"}},1984:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(63939),s=i(51128);function a(t){const e=r.f[15](t+4);let i=r.f[15](t+48),a=s.d[e];return 86018===e&&(a=`${a}.${i}`),a||"unknown"}},21233:(t,e,i)=>{"use strict";i.d(e,{C:()=>s});var r=i(86834);function s(t){return t?!r.A.chrome||r.A.checkVersion(r.A.majorVersion,"94",!0)?"prefer-hardware":"allow":!r.A.chrome||r.A.checkVersion(r.A.majorVersion,"94",!0)?"prefer-software":"deny"}},94663:(t,e,i)=>{"use strict";i.d(e,{A:()=>f});var r=i(63939),s=i(51128),a=i(90412),n=i(14392),o=i(58919),l=i(55611),c=i(20525),h=i(77231),d=i(14686),u=i(90932);function f(t,e){const i=r.f[15](t+4);let f=r.f[15](t+48),p=r.f[15](t+52);!e&&0!==r.f[20](t+12)&&r.f[15](t+16)&&(e=(0,d.s3)(r.f[20](t+12),r.f[15](t+16)));let m=s.d[i],g="";if(27===i)110===f&&(f=100),g=c.GP("%s.%02x00%02x",m,255&f,255&p);else if(173===i){var v;let t=0,i=0,r=0,s=0;(null===(v=e)||void 0===v?void 0:v.length)>13&&(t=e[1]>>>6&3,r=e[1]>>>5&1,i=e[2]|e[3]<<8|e[4]<<16|e[5]<<24,s=240&e[6]);const a={0:"",1:"A",2:"B",3:"C"};g=c.GP("%s.%s%d.%x.%s%d.%x",m,a[t],f,i,0===r?"L":"H",p,s)}else if(196===i){var y;let t=0;if((null===(y=e)||void 0===y?void 0:y.length)>13&&(t=1&e[5]),g=c.GP("%s.%d.%s%d",m,f,0===t?"L":"H",p),e){const t=l.Ui(e);if(t.generalConstraintInfo.length){let e=t.generalConstraintInfo.length-1;for(;e>0&&0===t.generalConstraintInfo[e];)e--;const i=t.generalConstraintInfo.slice(0,e+1);i.length&&(g+=`.C${u.l(new Uint8Array(i),!1)}`)}t.generalSubProfileIdc.length&&(g+=`.S${t.generalSubProfileIdc.map((t=>t.toString(16))).join("+")}`),g+=`.O${t.olsIdx}+${t.numSublayers}`}}else if(225===i)if(e){const t=a.Ui(e);g=c.GP("%s.%d.%02d%s.%02d.%d.%d%d%d",m,t.profile,t.level,t.tier?"H":"M",t.bitDepth,t.monochrome,t.chromaSubsamplingX,t.chromaSubsamplingY,t.chromaSamplePosition)}else g=c.GP("%s.%d.%02dM.08",m,f,p);else if(139===i)if(e){const t=n.U(e);g=c.GP("%s.%02d.%02d.%02d",m,t.profile,t.level,t.bitDepth)}else g=f!==h.N_&&p!==h.N_?c.GP("%s.%02d.%02d.08",m,f,p):m;else if(167===i)if(e){const t=o.Ui(e);g=c.GP("%s.%02d.%02d.%02d.%02d.%02d.%02d.%02d.%02d",m,t.profile,t.level,t.bitDepth,t.chromaSubsampling,t.colorPrimaries,t.colorTrc,t.colorSpace,t.fullRangeFlag)}else g=f!==h.N_&&p!==h.N_?c.GP("%s.%02d.%02d.08.00",m,f,p):c.GP("%s.%02d.%02d.08.00",m,0,40);else g=m||"unknown";return g}},53616:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var r=i(134),s=i(63939),a=i(9705),n=i(26235),o=i(59996),l=i(62624),c=i(9787),h=i(43950);class d{constructor(t){(0,r.A)(this,"options",void 0),(0,r.A)(this,"frame",void 0),(0,r.A)(this,"decoder",void 0),this.options=t}getAVFrame(){return this.frame?this.frame:this.frame={pts:BigInt(0),duration:BigInt(0),rects:[],timeBase:{den:1,num:1}}}outputAVFrame(){this.frame&&(this.options.onReceiveSubtitle&&this.options.onReceiveSubtitle(this.frame),this.frame=null)}receiveAVFrame(){return this.decoder.receiveAVFrame(this.getAVFrame())}async open(t){switch(s.f[15](t+4)){case 94226:this.decoder=new n.A;break;case 94232:this.decoder=new l.A;break;case 94210:case 94225:this.decoder=new h.A;break;case 94213:this.decoder=new c.A;break;case 94212:case 94230:this.decoder=new o.A;break;default:return a.r8}return 0}decode(t){let e=this.decoder.sendAVPacket(t);if(e)return e;for(;;){if(e=this.receiveAVFrame(),1!==e){if(e<0)return e;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.flush();;){if(this.receiveAVFrame()<1)return;this.outputAVFrame()}}close(){this.frame&&(this.frame=null)}}},59996:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(134),s=i(63939),a=i(81023),n=i(71517),o=i(50011);class l extends a.A{constructor(){super(),(0,r.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(t){return this.queue.push({data:(0,n.iI)(t).slice(),pts:s.f[17](t+8),duration:s.f[17](t+48),timeBase:{den:s.f[15](t+76),num:s.f[15](t+72)}}),0}receiveAVFrame(t){if(this.queue.length){const e=this.queue.shift();t.pts=e.pts,t.duration=e.duration,t.timeBase.den=e.timeBase.den,t.timeBase.num=e.timeBase.num;let i=o.decode(e.data);return/^\w+?\s*:/.test(i)||(i="Dialogue: "+i),t.rects.push({type:3,text:i,flags:0}),1}return 0}flush(){return 0}}},81023:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});class r{}},43950:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(134),s=i(63939),a=i(81023),n=i(71517),o=i(50011);class l extends a.A{constructor(){super(),(0,r.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(t){return this.queue.push({data:(0,n.iI)(t).slice(),pts:s.f[17](t+8),duration:s.f[17](t+48),timeBase:{den:s.f[15](t+76),num:s.f[15](t+72)}}),0}receiveAVFrame(t){if(this.queue.length){const e=this.queue.shift();return t.pts=e.pts,t.duration=e.duration,t.timeBase.den=e.timeBase.den,t.timeBase.num=e.timeBase.num,t.rects.push({type:1,text:o.decode(e.data),flags:0}),1}return 0}flush(){return 0}}},9787:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(134),s=i(63939),a=i(81023),n=i(71517),o=i(50011),l=i(4624);class c extends a.A{constructor(){super(),(0,r.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(t){const e=(0,n.iI)(t).slice();if(e.length<2)return 0;const i=e[0]<<8|e[1];if(i+2>e.length)return l.R8(`invalid timed text data, need ${i+2} but got ${e.length}, ignore it`,"src/avcodec/subtitle/decoder/TimedTextDecoder.ts",59),0;const r=o.decode(e.subarray(2,2+i));return this.queue.push({text:r,pts:s.f[17](t+8),duration:s.f[17](t+48),timeBase:{den:s.f[15](t+76),num:s.f[15](t+72)}}),0}receiveAVFrame(t){if(this.queue.length){const e=this.queue.shift();return t.pts=e.pts,t.duration=e.duration,t.timeBase.den=e.timeBase.den,t.timeBase.num=e.timeBase.num,t.rects.push({type:1,text:e.text,flags:0}),1}return 0}flush(){return 0}}},62624:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var r=i(134),s=i(63939),a=i(81023),n=i(50011),o=i(71517),l=i(77231),c=i(38115);class h extends a.A{constructor(){super(),(0,r.A)(this,"queue",void 0),this.queue=[]}sendAVPacket(t){let e=n.decode((0,o.iI)(t));return e?(/<tt/.test(e.trim())?this.queue=this.queue.concat(c.q(e).queue):this.queue.push({pts:s.f[17](t+8),duration:s.f[17](t+48),context:e,region:"Default"}),0):0}receiveAVFrame(t){if(this.queue.length){const e=this.queue.shift();return t.pts=e.pts,t.duration=e.duration,t.timeBase.den=l.qs,t.timeBase.num=1,t.rects.push({type:2,text:e.context,flags:0}),1}return 0}flush(){return 0}}},26235:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var r=i(134),s=i(63939),a=i(81023),n=i(50011),o=i(71517),l=i(54825),c=i(77231);class h extends a.A{constructor(){super(),(0,r.A)(this,"queue",void 0),this.queue=[]}findTimelineTag(t){const e=t.indexOf("<");if(e>=0){const i=t.indexOf(">",e);if(i>e&&/^(\d{2,}:)?\d{2}:\d{2}\.\d{1,3}$/.test(t.substring(e+1,i)))return{start:e,end:i}}return{start:-1,end:-1}}sendAVPacket(t){let e=n.decode((0,o.iI)(t)),i=s.f[17](t+8);const r=i+s.f[17](t+48),a=[];for(;;){const{start:r,end:n}=this.findTimelineTag(e);if(r<0)break;const o=(0,l.j)(e.substring(r+1,n));a.push(e.substring(0,r)),this.queue.push({context:a.join(""),pts:i,duration:o-i,timeBase:{den:s.f[15](t+76),num:s.f[15](t+72)}}),i=o,e=e.substring(n+1)}return a.push(e),this.queue.push({context:a.join(""),pts:i,duration:r-i,timeBase:{den:s.f[15](t+76),num:s.f[15](t+72)}}),0}receiveAVFrame(t){if(this.queue.length){const e=this.queue.shift();return t.pts=e.pts,t.duration=e.duration,t.timeBase.den=c.qs,t.timeBase.num=1,t.rects.push({type:2,text:e.context,flags:0}),1}return 0}flush(){return 0}}},75742:(t,e,i)=>{"use strict";i.d(e,{A:()=>f});var r=i(134),s=i(11473),a=i(16030),n=i(56024),o=i(4624),l=i(95797),c=i(95335),h=i(73749),d=i(67672),u=i(37837);class f{constructor(t){(0,r.A)(this,"options",void 0),(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"frame",void 0),(0,r.A)(this,"decoderOptions",0),this.options=t,this.decoder=new a.A(t.resource)}getAVFrame(){return this.frame?this.frame:this.frame=this.options.avframePool?this.options.avframePool.alloc():(0,n.FP)()}outputAVFrame(){this.frame&&(this.options.onReceiveFrame?this.options.onReceiveFrame(this.frame):this.options.avframePool?this.options.avframePool.release(this.frame):(0,n.xj)(this.frame),this.frame=0)}receiveAVFrame(){return this.decoder.call("decoder_receive",this.getAVFrame())}async open(t,e={}){await this.decoder.run(),c.HP(e).length&&(this.decoderOptions&&(h.AO(this.decoderOptions),s.s_.free(this.decoderOptions),this.decoderOptions=0),this.decoderOptions=(0,u.Gy)(8),c.__(e,((t,e)=>{(d.Yj(t)||d.Yj(e))&&h.a5(this.decoderOptions,e,t)})));let i=0;l.A.jspi?i=await this.decoder.callAsync("decoder_open",t,0,1,this.decoderOptions):(i=this.decoder.call("decoder_open",t,0,1,this.decoderOptions),await this.decoder.childrenThreadReady()),i<0&&o.h2(`open audio decoder failed, ret: ${i}`,"src/avcodec/wasmcodec/AudioDecoder.ts",113)}decode(t){let e=this.decoder.call("decoder_decode",t);if(e)return e;for(;;){if(e=this.receiveAVFrame(),1!==e){if(e<0)return e;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.call("decoder_flush");;){if(this.receiveAVFrame()<1)return;this.outputAVFrame()}}close(){this.decoder.call("decoder_close"),this.decoder.destroy(),this.decoder=null,this.frame&&(this.options.avframePool?this.options.avframePool.release(this.frame):(0,n.xj)(this.frame),this.frame=0),this.decoderOptions&&(h.AO(this.decoderOptions),s.s_.free(this.decoderOptions),this.decoderOptions=0)}}},40417:(t,e,i)=>{"use strict";i.d(e,{A:()=>f});var r=i(134),s=i(11473),a=i(16030),n=i(56024),o=i(4624),l=i(95797),c=i(95335),h=i(73749),d=i(67672),u=i(37837);class f{constructor(t){(0,r.A)(this,"options",void 0),(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"frame",void 0),(0,r.A)(this,"parameters",void 0),(0,r.A)(this,"decoderOptions",0),this.options=t,this.decoder=new a.A(this.options.resource)}getAVFrame(){return this.frame?this.frame:this.frame=this.options.avframePool?this.options.avframePool.alloc():(0,n.FP)()}outputAVFrame(){this.frame&&(this.options.onReceiveFrame?this.options.onReceiveFrame(this.frame):this.options.avframePool?this.options.avframePool.release(this.frame):(0,n.xj)(this.frame),this.frame=0)}receiveAVFrame(){return this.decoder.call("decoder_receive",this.getAVFrame())}async open(t,e=1,i={}){await this.decoder.run(null,e);let r=0;c.HP(i).length&&(this.decoderOptions&&(h.AO(this.decoderOptions),s.s_.free(this.decoderOptions),this.decoderOptions=0),this.decoderOptions=(0,u.Gy)(8),c.__(i,((t,e)=>{(d.Yj(t)||d.Yj(e))&&h.a5(this.decoderOptions,e,t)}))),l.A.jspi?r=await this.decoder.callAsync("decoder_open",t,0,e,this.decoderOptions):(r=this.decoder.call("decoder_open",t,0,e,this.decoderOptions),await this.decoder.childrenThreadReady()),r<0&&o.h2(`open video decoder failed, ret: ${r}`,"src/avcodec/wasmcodec/VideoDecoder.ts",151),this.parameters=t,await this.decoder.childrenThreadReady()}decode(t){let e=this.decoder.call("decoder_decode",t);if(e)return e;for(;;){if(e=this.receiveAVFrame(),1!==e){if(e<0)return e;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.call("decoder_flush");;){if(this.receiveAVFrame()<1)return;this.outputAVFrame()}}close(){this.decoder.call("decoder_close"),this.decoder.destroy(),this.decoder=null,this.frame&&(this.options.avframePool?this.options.avframePool.release(this.frame):(0,n.xj)(this.frame),this.frame=0),this.parameters=0,this.decoderOptions&&(h.AO(this.decoderOptions),s.s_.free(this.decoderOptions),this.decoderOptions=0)}setSkipFrameDiscard(t){this.decoder.call("decoder_discard",t)}}},77104:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var r=i(134),s=i(63939),a=i(1984),n=i(14686),o=i(71517),l=i(22898),c=i(4624);class h{constructor(t){(0,r.A)(this,"options",void 0),(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"parameters",void 0),(0,r.A)(this,"extradata",void 0),(0,r.A)(this,"currentError",void 0),this.options=t}output(t){this.options.onReceiveFrame?this.options.onReceiveFrame(t):t.close()}error(t){this.currentError=t,this.options.onError(t)}async open(t){this.currentError=null,this.parameters=t,this.extradata=null,0!==s.f[20](t+12)&&(this.extradata=(0,n.s3)(s.f[20](t+12),s.f[15](t+16)).slice());const e={codec:(0,a.A)(this.parameters),sampleRate:s.f[15](t+136),numberOfChannels:s.f[15](t+116),description:this.extradata};if(e.description||delete e.description,!(await AudioDecoder.isConfigSupported(e)).supported)throw new Error("not support");if(this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=new AudioDecoder({output:this.output.bind(this),error:this.error.bind(this)}),this.decoder.reset(),this.decoder.configure(e),this.currentError)throw this.currentError}changeExtraData(t){if(t.length===this.extradata.length){let e=!0;for(let i=0;i<t.length;i++)if(t[i]!==this.extradata[i]){e=!1;break}if(e)return}if(this.extradata=t.slice(),this.decoder.reset(),this.decoder.configure({codec:(0,a.A)(this.parameters),sampleRate:s.f[15](this.parameters+136),numberOfChannels:s.f[15](this.parameters+116),description:this.extradata}),this.currentError)throw this.currentError}decode(t,e){const i=(0,o.rU)(t,1);0!==i&&this.changeExtraData((0,n.s3)(s.f[20](i),s.f[15](i+4)));const r=(0,l.A)(t,e);try{this.decoder.decode(r)}catch(t){return c.z3(`decode error, ${t}`,"src/avcodec/webcodec/AudioDecoder.ts",155),-1}return 0}async flush(){await this.decoder.flush()}close(){"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=null}getQueueLength(){return this.decoder.decodeQueueSize}static async isSupported(t){let e=null;0!==s.f[20](t+12)&&(e=(0,n.s3)(s.f[20](t+12),s.f[15](t+16)).slice());const i={codec:(0,a.A)(t),sampleRate:s.f[15](t+136),numberOfChannels:s.f[15](t+116),description:e};return i.description||delete i.description,(await AudioDecoder.isConfigSupported(i)).supported}}},71039:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var r=i(134),s=i(63939),a=i(86834),n=i(94663),o=i(14686),l=i(71517),c=i(21233),h=i(28917),d=i(4624);class u{constructor(t){(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"parameters",void 0),(0,r.A)(this,"extradata",void 0),(0,r.A)(this,"currentError",void 0),(0,r.A)(this,"inputQueue",void 0),(0,r.A)(this,"outputQueue",void 0),(0,r.A)(this,"sort",void 0),(0,r.A)(this,"keyframeRequire",void 0),this.options=t,this.inputQueue=[],this.outputQueue=[],this.sort=a.A.safari}async output(t){if(this.sort){let e=0;for(;e<this.outputQueue.length;e++)if(this.outputQueue[e].timestamp>t.timestamp){this.outputQueue.splice(e,0,t);break}for(e===this.outputQueue.length&&this.outputQueue.push(t);this.outputQueue.length>2&&this.outputQueue[0].timestamp===this.inputQueue[0];){const t=this.outputQueue.shift();this.options.onReceiveFrame?this.options.onReceiveFrame(t):t.close(),this.inputQueue.shift()}}else this.options.onReceiveFrame?this.options.onReceiveFrame(t):t.close()}error(t){this.currentError=t,this.options.onError(t)}changeExtraData(t){var e;if(t.length===this.extradata.length){let e=!0;for(let i=0;i<t.length;i++)if(t[i]!==this.extradata[i]){e=!1;break}if(e)return}this.extradata=t.slice(),this.decoder.reset(),this.decoder.configure({codec:(0,n.A)(this.parameters,t),description:this.extradata,hardwareAcceleration:(0,c.C)(null===(e=this.options.enableHardwareAcceleration)||void 0===e||e)}),this.keyframeRequire=!0}async open(t){var e;this.currentError=null,this.extradata=null,0!==s.f[20](t+12)&&(this.extradata=(0,o.s3)(s.f[20](t+12),s.f[15](t+16)).slice()),this.parameters=t;const i={codec:(0,n.A)(t),codedWidth:s.f[15](t+56),codedHeight:s.f[15](t+60),description:2!==s.f[15](t+160)?this.extradata:void 0,hardwareAcceleration:(0,c.C)(null===(e=this.options.enableHardwareAcceleration)||void 0===e||e)};if(i.description||delete i.description,!(await VideoDecoder.isConfigSupported(i)).supported)throw new Error("not support");if(this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=new VideoDecoder({output:this.output.bind(this),error:this.error.bind(this)}),this.decoder.reset(),this.decoder.configure(i),this.currentError)throw this.currentError;this.keyframeRequire=!0,this.inputQueue.length=0,this.outputQueue.length=0}decode(t){const e=(0,l.rU)(t,1);0!==e&&this.changeExtraData((0,o.s3)(s.f[20](e),s.f[15](e+4)));const i=1&s.f[15](t+36);if(this.keyframeRequire&&!i)return 0;const r=Number(s.f[17](t+8)),a=(0,h.A)(t);if(this.sort){let t=0;for(;t<this.inputQueue.length;t++)if(this.inputQueue[t]>r){this.inputQueue.splice(t,0,r);break}t===this.inputQueue.length&&this.inputQueue.push(r)}try{this.decoder.decode(a)}catch(t){return d.z3(`decode error, ${t}`,"src/avcodec/webcodec/VideoDecoder.ts",223),-1}return i&&(this.keyframeRequire=!1),0}async flush(){if(await this.decoder.flush(),this.sort)for(;this.outputQueue.length;){const t=this.outputQueue.shift();this.options.onReceiveFrame?this.options.onReceiveFrame(t):t.close()}this.keyframeRequire=!0}close(){var t;this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=null,this.currentError=null,null!==(t=this.outputQueue)&&void 0!==t&&t.length&&this.outputQueue.forEach((t=>{t.close()})),this.inputQueue=null,this.outputQueue=null}getQueueLength(){return this.decoder.decodeQueueSize}setSkipFrameDiscard(t){}static async isSupported(t,e){let i=null;0!==s.f[20](t+12)&&(i=(0,o.s3)(s.f[20](t+12),s.f[15](t+16)).slice());const r={codec:(0,n.A)(t),codedWidth:s.f[15](t+56),codedHeight:s.f[15](t+60),description:2!==s.f[15](t+160)?i:void 0,hardwareAcceleration:(0,c.C)(null==e||e)};return r.description||delete r.description,(await VideoDecoder.isConfigSupported(r)).supported}}},44315:(t,e,i)=>{"use strict";i.d(e,{Xv:()=>p,fG:()=>m,oD:()=>f});var r=i(134),s=i(63939),a=i(50932),n=i(15017),o=i(71517),l=i(7417),c=i(73783);const h=l.z1(4,4),d=l.z1(4,4);class u{constructor(){(0,r.A)(this,"packetBuffer",void 0),this.packetBuffer=[]}}class f{constructor(){(0,r.A)(this,"metadataHeaderPadding",-1),(0,r.A)(this,"metadata",void 0),(0,r.A)(this,"streams",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"chapters",void 0),(0,r.A)(this,"privateData",void 0),(0,r.A)(this,"processPrivateData",void 0),(0,r.A)(this,"iformat",void 0),(0,r.A)(this,"oformat",void 0),(0,r.A)(this,"ioReader",void 0),(0,r.A)(this,"ioWriter",void 0),(0,r.A)(this,"errorFlag",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"streamIndex",void 0),(0,r.A)(this,"getDecoderResource",null),this.streams=[],this.errorFlag=0,this.streamIndex=0,this.interval=new u,this.options={},this.privateData={},this.metadata={},this.chapters=[]}get format(){return this.iformat?this.iformat.type:this.oformat?this.oformat.type:-1}getStreamById(t){return this.streams.find((e=>e.id===t))}getStreamByIndex(t){return this.streams.find((e=>e.index===t))}getStreamByMediaType(t){return this.streams.find((e=>{var i;return(null===(i=e.codecpar)||void 0===i?void 0:i.codecType)===t}))}createStream(){const t=new n.A;return t.index=this.streamIndex++,(0,c.s2)(d),t.id=s.f[15](h),a.M[15](h,t.id+1),(0,c.Tl)(d),this.removeStreamByIndex(t.index),this.streams.push(t),t}addStream(t){this.removeStreamByIndex(t.index),this.streams.push(t)}removeStream(t){this.removeStreamByIndex(t.index)}removeStreamById(t){const e=this.streams.findIndex((e=>e.id===t));if(e>-1){const t=this.streams.splice(e,1);t[0]&&t[0].destroy()}}removeStreamByIndex(t){const e=this.streams.findIndex((e=>e.index===t));if(e>-1){const t=this.streams.splice(e,1);t[0]&&t[0].destroy()}}destroy(){this.oformat&&this.oformat.destroy(this),this.iformat&&this.iformat.destroy(this),this.interval.packetBuffer.length&&this.interval.packetBuffer.forEach((t=>{(0,o.Qe)(t)})),this.streams.forEach((t=>{t.destroy()})),this.streams=[],this.interval=null,this.ioReader=this.ioWriter=null,this.oformat=this.iformat=null}}function p(){return new f}function m(){return new f}},15017:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var r=i(134),s=i(80662),a=i.n(s),n=i(74503),o=i(94300),l=i(77162),c=i(77231),h=i(9599);class d{constructor(){(0,r.A)(this,"index",c.N_),(0,r.A)(this,"id",c.N_),(0,r.A)(this,"privData",null),(0,r.A)(this,"codecpar",(0,n.A)(l.A,new l.A)),(0,r.A)(this,"sideData",{}),(0,r.A)(this,"nbFrames",BigInt(0)),(0,r.A)(this,"metadata",{}),(0,r.A)(this,"duration",c.Dh),(0,r.A)(this,"startTime",c.Dh),(0,r.A)(this,"firstDTS",BigInt(0)),(0,r.A)(this,"disposition",0),(0,r.A)(this,"timeBase",(0,n.A)(h.P)),(0,r.A)(this,"sampleIndexes",[]),(0,r.A)(this,"sampleIndexesPosMap",new(a()))}destroy(){this.codecpar&&(this.codecpar.destroy(),(0,o.A)(this.codecpar),this.codecpar=null),this.timeBase&&((0,o.A)(this.timeBase),this.timeBase=null),this.sampleIndexes.length=0,this.sampleIndexesPosMap.clear()}}},64436:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(134),s=i(63939),a=i(37837),n=i(71766);class o{constructor(){(0,r.A)(this,"inCodecpar",void 0),(0,r.A)(this,"inTimeBase",void 0),(0,r.A)(this,"outCodecpar",void 0)}init(t,e){return this.inCodecpar=(0,a.Gy)(168),(0,n.Yi)(this.inCodecpar,t),this.inTimeBase={den:s.f[15](e+4),num:s.f[15](e)},0}destroy(){this.inCodecpar&&((0,n.dn)(this.inCodecpar),this.inCodecpar=0)}}},26173:(t,e,i)=>{"use strict";i.d(e,{A:()=>g});var r=i(134),s=i(63939),a=i(50932),n=i(64436),o=i(71517),l=i(20620),c=i(53e3),h=i(55611),d=i(14686),u=i(9705),f=i(60264),p=i(37837),m=i(4624);class g extends n.A{constructor(...t){super(...t),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"cached",void 0)}init(t,e){return super.init(t,e),this.cache=(0,o._5)(),this.cached=!1,0}destroy(){super.destroy(),(0,o.Qe)(this.cache),this.cache=0}sendAVPacket(t){const e=(0,d.JW)(s.f[20](t+24),s.f[15](t+28));if(1!==s.f[15](t+80)&&(0,f.Bs)(e)){let i;if((0,o.zu)(this.cache,t),27===s.f[15](this.inCodecpar+4)?i=l.oT(e):173===s.f[15](this.inCodecpar+4)?i=c.oT(e):196===s.f[15](this.inCodecpar+4)?i=h.oT(e):m.h2(`not support for codecId: ${s.f[15](this.inCodecpar+4)}`,"src/avformat/bsf/h2645/Annexb2AvccFilter.ts",91),a.M[15](this.cache+80,1),(0,o.NX)(this.cache,i.bufferPointer,i.length),i.key&&a.M[15](this.cache+36,1|s.f[15](this.cache+36)),i.extradata){const t=(0,p.sY)(i.extradata.length);(0,d.lW)(t,i.extradata.length,i.extradata),(0,o.Ow)(this.cache,1,t,i.extradata.length)}}else(0,o.rN)(this.cache,t);return this.cached=!0,0}receiveAVPacket(t){return this.cached?((0,o.Up)(t),(0,o.rN)(t,this.cache),this.cached=!1,0):u.LR}reset(){return 0}}},58469:(t,e,i)=>{"use strict";i.d(e,{Bq:()=>d,Ij:()=>h,XC:()=>c,f7:()=>u,uF:()=>a});var r=i(77231),s=i(37246);const a={1:"Main",2:"LC",3:"LC",4:"LC",5:"HE",6:"HE"},n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,r.N_,r.N_,r.N_],l=[r.N_,1,2,3,4,5,6,7];function c(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e){const{profile:i,sampleRate:s,channels:a}=function(t){let e=r.N_,i=r.N_,s=r.N_;var a,n;return t.length>=2&&(e=t[0]>>3&31,i=null!==(a=o[(7&t[0])<<1|t[1]>>7])&&void 0!==a?a:48e3,s=null!==(n=l[t[1]>>3&15])&&void 0!==n?n:2),{profile:e,sampleRate:i,channels:s}}(e);t.codecpar.profile=i,t.codecpar.sampleRate=s,t.codecpar.chLayout.nbChannels=a}}function h(t){const e=n[t.sampleRate],i=t.chLayout.nbChannels,r=new Uint8Array(2);return r[0]=(31&t.profile)<<3|(14&e)>>1,r[1]=(1&e)<<7|(15&i)<<3,r}function d(t){if(t.length<7)return-1;const e=t[0]<<4|t[1]>>4;if(4095!==e)return-1;const i=1&t[1],r=(192&t[2])>>>6,s=(60&t[2])>>>2,a=(1&t[2])<<2|(192&t[3])>>>6,n=(3&t[3])<<11|t[4]<<3|(224&t[5])>>>5,c=3&t[6];let h=1===i?7:9,d=n-h;return{syncWord:e,profile:r+1,sampleRate:o[s],channels:l[a],aacFrameLength:n,numberOfRawDataBlocksInFrame:c,headerLength:h,framePayloadLength:d}}function u(t,e){function i(){const t=e.readU(2);let i=0;for(let r=0;r<=t;r++)i<<=8,i|=e.readU(8);return i}e||(e=new s.A).appendBuffer(t);const r=e.getPointer(),a={syncWord:0,profile:0,sampleRate:0,channels:0,useSameStreamMux:!1,headerLength:0,framePayloadLength:0,muxLengthBytes:0},n=e.readU(11);if(695!==n)return-1;a.syncWord=n,a.muxLengthBytes=e.readU(13);const c=1===e.readU1();if(a.useSameStreamMux=c,!c){const t=1===e.readU1();if(t&&1===e.readU1())return-1;if(t&&i(),1!==e.readU1())return-1;if(0!==e.readU(6))return-1;if(0!==e.readU(4))return-1;if(0!==e.readU(3))return-1;let r=t?i():0;const s=e.readU(5);r-=5;const n=e.readU(4);r-=4;const c=e.readU(4);if(r-=4,e.readU(3),r-=3,r>0&&e.readU(r),0!==e.readU(3))return-1;if(e.readU(8),1===e.readU1())if(t)i();else{let t=0;for(;;){t<<=8;const i=1===e.readU1();if(t+=e.readU(8),!i)break}}1===e.readU1()&&e.readU(8),a.profile=s+1,a.sampleRate=o[n],a.channels=l[c]}let h=0;for(;;){const t=e.readU(8);if(h+=t,255!==t)break}return a.framePayloadLength=h,a.headerLength=e.getPointer()-r+(8===e.getBitLeft()?0:1),a}},87771:(t,e,i)=>{"use strict";i.d(e,{R:()=>f,j:()=>s});var r=i(37246);const s=[3,4,3,7,259,263,1539,1543],a=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],n=[4,5,6,5],o=[4,6,7,6],l=[48e3,44100,32e3,0],c=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],h=[2,1,2,3,3,4,4,5],d=[1,2,3,6],u=7;function f(t){const e=new r.A(size);e.appendBuffer(t);const i={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitrate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(i.syncWord=e.readU(16),2935!==i.syncWord)return-1;if(i.bitstreamId=31&e.readU(29),i.bitstreamId>16)return-2;if(i.numBlocks=6,i.ac3BitrateCode=-1,i.centerMixLevel=5,i.surroundMixLevel=6,i.dolbySurroundMode=0,i.bitstreamId<=10){if(i.crc1=e.readU(16),i.srCode=e.readU(2),3===i.srCode)return-3;const t=e.readU(6);if(t>37)return-4;i.ac3BitrateCode=t>>1,e.readU(5),i.bitstreamMode=e.readU(3),i.channelMode=e.readU(3),2==i.channelMode?i.dolbySurroundMode=e.readU(2):(1&i.channelMode&&1!=i.channelMode&&(i.centerMixLevel=n[e.readU(2)]),4&i.channelMode&&(i.surroundMixLevel=o[e.readU(2)])),i.lfeOn=e.readU(1),i.srShift=Math.max(i.bitstreamId,8)-8,i.sampleRate=l[i.srCode]>>i.srShift,i.bitrate=1e3*c[i.ac3BitrateCode]>>i.srShift,i.channels=h[i.channelMode]+i.lfeOn,i.frameSize=2*a[t][i.srCode],i.frameType=2,i.substreamId=0}else{if(i.crc1=0,i.frameType=e.readU(2),3==i.frameType)return-5;if(i.substreamId=e.readU(3),i.frameSize=e.readU(11)+1<<1,i.frameSize<u)return-6;if(i.srCode=e.readU(2),3==i.srCode){const t=e.readU(2);if(3==t)return-7;i.sampleRate=l[t]/2,i.srShift=1}else i.numBlocks=d[e.readU(2)],i.sampleRate=l[i.srCode],i.srShift=0;i.channelMode=e.readU(3),i.lfeOn=e.readU(1),i.bitrate=8*i.frameSize*i.sampleRate/(256*i.numBlocks),i.channels=h[i.channelMode]+i.lfeOn}return i.channelLayout=BigInt.asUintN(64,s[i.channelMode]),i.lfeOn&&(i.channelLayout|=BigInt(8)),i}},90412:(t,e,i)=>{"use strict";i.d(e,{Ui:()=>n,XC:()=>a,zk:()=>s});var r=i(37246);const s={0:"Main",1:"High",2:"Professional"};function a(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=4){const i=n(e);t.codecpar.profile=i.profile,t.codecpar.level=i.level}}function n(t){const e=new r.A(t.length);e.appendBuffer(t),e.readU1(),e.readU(7);const i=e.readU(3),s=e.readU(5),a=e.readU1();let n=e.readU1()?10:8;return e.readU1()&&(n=12),{profile:i,level:s,tier:a,bitDepth:n,monochrome:e.readU1(),chromaSubsamplingX:e.readU1(),chromaSubsamplingY:e.readU1(),chromaSamplePosition:e.readU(2)}}},20620:(t,e,i)=>{"use strict";i.d(e,{Jk:()=>k,KD:()=>I,MB:()=>A,S1:()=>x,XC:()=>S,ci:()=>T,oT:()=>w,tZ:()=>y,wf:()=>P});var r=i(63939),s=i(50932),a=i(72739),n=i(729),o=i(31865),l=i(37246),c=i(4624),h=i(14686),d=i(71517),u=i(60264),f=i(37837),p=i(23991),m=i(39381),g="src/avformat/codecs/h264.ts";const v=3,y={66:"Constrained Baseline",77:"Main",100:"High",110:"High10",122:"High422",244:"High444"};function A(t){const e=new o.A(t);e.skip(5);const i=[],r=[],s=[],a=31&e.readUint8();for(let t=0;t<a;t++){const t=e.readUint16();i.push(e.readBuffer(t))}const n=e.readUint8();for(let t=0;t<n;t++){const t=e.readUint16();r.push(e.readBuffer(t))}if(e.remainingSize()>4){e.skip(3);const t=e.readUint8();if(t>0)for(let i=0;i<t;i++){const t=e.readUint16();s.push(e.readBuffer(t))}}return{spss:i,ppss:r,spsExts:s}}function b(t,e,i=[]){t.length>32&&(c.R8(`h264 metadata's sps max length is 32, but get ${t.length}`,g,210),t=t.slice(0,32)),t.length>256&&(c.R8(`h264 metadata's pps max length is 256, but get ${t.length}`,g,214),t=t.slice(0,256));let r=7;r=t.reduce(((t,e)=>t+2+e.length),r),r=e.reduce(((t,e)=>t+2+e.length),r);const s=t[0],o=P(s);66!==o.profile&&77!==o.profile&&88!==o.profile&&(r+=4,i.length&&(r=i.reduce(((t,e)=>t+2+e.length),r)));const l=new Uint8Array(r),h=new n.A(l);return h.writeUint8(1),h.writeUint8(s[1]),h.writeUint8(s[2]),h.writeUint8(s[3]),h.writeUint8(252|v),h.writeUint8(224|31&t.length),a.__(t,(t=>{h.writeUint16(t.length),h.writeBuffer(t)})),h.writeUint8(e.length),a.__(e,(t=>{h.writeUint16(t.length),h.writeBuffer(t)})),66!==o.profile&&77!==o.profile&&88!==o.profile&&(h.writeUint8(252|o.chromaFormatIdc),h.writeUint8(248|o.bitDepthLumaMinus8),h.writeUint8(248|o.bitDepthChromaMinus8),i.length&&a.__(i,(t=>{h.writeUint16(t.length),h.writeBuffer(t)}))),l}function x(t){let e=(0,u.py)(t);if(e.length>1){const t=[],i=[],r=[];if(e.forEach((e=>{const s=31&e[0];7===s?t.push(e):8===s?i.push(e):13===s&&r.push(e)})),t.length&&i.length)return b(t,i,r)}}function w(t){let e,i=(0,u.py)(t),r=!1;if(i.length>1){const t=[],r=[],s=[];i.forEach((e=>{const i=31&e[0];7===i?t.push(e):8===i?r.push(e):13===i&&s.push(e)})),t.length&&r.length&&(e=b(t,r,s)),i=i.filter((t=>{const e=31&t[0];return 9!==e&&8!==e&&7!==e&&13!==e}))}const s=i.reduce(((t,e)=>t+v+1+e.length),0),o=(0,f.sY)(s),l=(0,h.s3)(o,s),c=new n.A(l);return a.__(i,(t=>{3===v?c.writeUint32(t.length):2===v?c.writeUint24(t.length):1===v?c.writeUint16(t.length):c.writeUint8(t.length),c.writeBuffer(t.subarray(0)),5==(31&t[0])&&(r=!0)})),{bufferPointer:o,length:s,key:r,extradata:e}}function k(t,e){var i;if(!(1&r.f[15](t+36)))return;const s=(0,d.iI)(t);if((0,u.Bs)(s))return;const a=null!==(i=e.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:v;let n=[],l=[],c=[],p=[];const m=new o.A(s);for(;m.remainingSize()>0;){let t=0;t=3===a?m.readUint32():2===a?m.readUint24():1===a?m.readUint16():m.readUint8();const e=s.subarray(Number(BigInt.asIntN(32,m.getPos())),Number(BigInt.asIntN(32,m.getPos()))+t);m.skip(t);const i=31&e[0];7===i?n.push(e):8===i?l.push(e):13===i?c.push(e):p.push(e)}if(n.length||l.length){const e=b(n,l,c),i=(0,f.sY)(e.length);(0,h.lW)(i,e.length,e),(0,d.Ow)(t,1,i,e.length)}}function T(t,e=!1){if(!(1&r.f[15](t+36)||e))return;const i=(0,d.iI)(t);if(!(0,u.Bs)(i))return;let a=(0,u.py)(i);if(a.length>1){const e=[],i=[],n=[];if(a.forEach((t=>{const r=31&t[0];7===r?e.push(t):8===r?i.push(t):13===r&&n.push(t)})),e.length&&i.length){const a=b(e,i,n),o=(0,f.sY)(a.length);(0,h.lW)(o,a.length,a),(0,d.Ow)(t,1,o,a.length),s.M[15](t+36,1|r.f[15](t+36))}}}function S(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=3&e[4];const{spss:i}=A(e);if(i.length){const{profile:e,level:r,width:s,height:a}=P(i[0]);t.codecpar.profile=e,t.codecpar.level=r,t.codecpar.width=s,t.codecpar.height=a}}}function I(t,e=4){if(2===r.f[15](t+80))return(0,u.py)((0,h.s3)(r.f[20](t+24),r.f[15](t+28))).some((t=>5==(31&t[0])));{const i=r.f[15](t+28);let s=0;for(;s<i-e;){if(5==(31&m.r8(r.f[20](t+24)+(s+e))))return!0;s+=4===e?m.Sg(r.f[20](t+24)+s):3===e?m.ht(r.f[20](t+24)+s):2===e?m.yd(r.f[20](t+24)+s):m.r8(r.f[20](t+24)+s),s+=e}return!1}}function P(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);const i=(0,u.BN)(t.subarray(e)),r=new l.A(i.length);r.appendBuffer(i),r.readU1(),r.readU(2),r.readU(5);const s=r.readU(8);r.readU1(),r.readU1(),r.readU1(),r.readU1(),r.readU1(),r.readU1(),r.readU(2);const a=r.readU(8);p.xb(r);let n=1,o=0,c=0;if((100==s||110==s||122==s||244==s||44==s||83==s||86==s||118==s||128==s||138==s||139==s||134==s||135==s)&&(n=p.xb(r),3===n&&r.readU1(),o=p.xb(r),c=p.xb(r),r.readU1(),r.readU1())){const t=new Array(8);for(let e=0;e<(3!=n?8:12);e++)t[e]=r.readU1()}const h=p.xb(r),d=p.xb(r);let f=0,m=0;if(0===d)f=p.xb(r);else if(1===d){m=r.readU1(),p.$x(r),p.$x(r);const t=p.xb(r);for(let e=0;e<t;e++)p.$x(r)}p.xb(r),r.readU1();const g=p.xb(r),v=p.xb(r),y=r.readU1();let A=16*(g+1),b=(2-y)*(v+1)*16;y||r.readU1(),r.readU1();const x=r.readU1();if(x){let t=1,e=2-x;1===n?(t=2,e=2*(2-x)):2===x&&(t=2,e=2-x),A-=t*(p.xb(r)+p.xb(r)),b-=e*(p.xb(r)+p.xb(r))}return{profile:s,level:a,width:A,height:b,chromaFormatIdc:n,bitDepthLumaMinus8:o,bitDepthChromaMinus8:c,frameMbsOnlyFlag:y,picOrderCntType:d,log2MaxPicOrderCntLsbMinus4:f,deltaPicOrderAlwaysZeroFlag:m,log2MaxFrameNumMinus4:h}}},53e3:(t,e,i)=>{"use strict";i.d(e,{HL:()=>v,Jk:()=>x,KD:()=>T,S1:()=>A,XC:()=>k,ZU:()=>I,ci:()=>w,dT:()=>m,oT:()=>b,wf:()=>S});var r=i(63939),s=i(50932),a=i(72739),n=i(729),o=i(31865),l=i(37246),c=i(14686),h=i(60264),d=i(71517),u=i(37837),f=i(23991),p=i(39381);const m={1:"Main",2:"Main10",3:"MainStillPicture",4:"Main444"},g=3;function v(t){const e=new o.A(t,!0);e.skip(22);let i=[],r=[],s=[];const a=e.readUint8();for(let t=0;t<a;t++){const t=63&e.readUint8(),a=e.readUint16(),n=[];for(let t=0;t<a;t++){const t=e.readUint16();n.push(e.readBuffer(t))}32===t?i=n:33===t?r=n:34===t&&(s=n)}return{vpss:i,spss:r,ppss:s}}function y(t,e,i){const r=e[0];let s=23;t.length&&(s+=3,s=t.reduce(((t,e)=>t+2+e.length),s)),e.length&&(s+=3,s=e.reduce(((t,e)=>t+2+e.length),s)),i.length&&(s+=3,s=i.reduce(((t,e)=>t+2+e.length),s));const o=new Uint8Array(s),l=new n.A(o,!0),c=S(r);l.writeUint8(1),l.writeUint8(r[1]),l.writeUint8(r[2]),l.writeUint8(r[3]),l.writeUint8(r[4]),l.writeUint8(r[5]),l.writeUint8(r[6]),l.writeUint8(r[7]),l.writeUint8(r[8]),l.writeUint8(r[9]),l.writeUint8(r[10]),l.writeUint8(r[11]),l.writeUint8(c.level),l.writeUint8(1020),l.writeUint8(0),l.writeUint8(16320),l.writeUint8(16320|c.chroma_format_idc),l.writeUint8(8160|c.bit_depth_luma_minus8),l.writeUint8(8160|c.bit_depth_chroma_minus8),l.writeUint16(0),l.writeUint8(8|(1&r[0])<<2|g);let h=0;return t.length&&h++,e.length&&h++,i.length&&h++,l.writeUint8(h),t.length&&(l.writeUint8(160),l.writeUint16(t.length),a.__(t,(t=>{l.writeUint16(t.length),l.writeBuffer(t)}))),e.length&&(l.writeUint8(161),l.writeUint16(e.length),a.__(e,(t=>{l.writeUint16(t.length),l.writeBuffer(t)}))),i.length&&(l.writeUint8(162),l.writeUint16(i.length),a.__(i,(t=>{l.writeUint16(t.length),l.writeBuffer(t)}))),o}function A(t){let e=(0,h.py)(t);if(e.length>=2){const t=[],i=[],r=[];if(e.forEach((e=>{const s=e[0]>>>1&63;32===s?t.push(e):33===s?i.push(e):34===s&&r.push(e)})),i.length&&r.length)return y(t,i,r)}}function b(t){let e,i=!1,r=(0,h.py)(t);if(r.length>=2){const t=[],i=[],s=[];r.forEach((e=>{const r=e[0]>>>1&63;32===r?t.push(e):33===r?i.push(e):34===r&&s.push(e)})),i.length&&s.length&&(e=y(t,i,s),r=r.filter((t=>{const e=t[0]>>>1&63;return 32!==e&&33!==e&&34!==e&&35!==e})))}const s=r.reduce(((t,e)=>t+g+1+e.length),0),o=(0,u.sY)(s),l=(0,c.s3)(o,s),d=new n.A(l);return a.__(r,(t=>{3===g?d.writeUint32(t.length):2===g?d.writeUint24(t.length):1===g?d.writeUint16(t.length):d.writeUint8(t.length),d.writeBuffer(t.subarray(0));const e=t[0]>>>1&63;19!==e&&20!==e&&21!==e||(i=!0)})),{bufferPointer:o,length:s,extradata:e,key:i}}function x(t,e){var i;if(!(1&r.f[15](t+36)))return;const s=(0,d.iI)(t);if((0,h.Bs)(s))return;const a=null!==(i=e.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:g;let n=[],l=[],f=[];const p=new o.A(s);for(;p.remainingSize()>0;){let t=0;t=3===a?p.readUint32():2===a?p.readUint24():1===a?p.readUint16():p.readUint8();const e=s.subarray(Number(BigInt.asIntN(32,p.getPos())),Number(BigInt.asIntN(32,p.getPos()))+t);p.skip(t);const i=e[0]>>>1&63;33===i?l.push(e):34===i?f.push(e):32===i&&n.push(e)}if(l.length||f.length||n.length){const e=y(n,l,f),i=(0,u.sY)(e.length);(0,c.lW)(i,e.length,e),(0,d.Ow)(t,1,i,e.length)}}function w(t,e=!1){if(!(1&r.f[15](t+36)||e))return;const i=(0,d.iI)(t);if(!(0,h.Bs)(i))return;let a=(0,h.py)(i);if(a.length>2){const e=[],i=[],n=[];if(a.forEach((t=>{const r=t[0]>>>1&63;32===r?e.push(t):33===r?i.push(t):34===r&&n.push(t)})),e.length&&i.length&&n.length){const a=y(e,i,n),o=(0,u.sY)(a.length);(0,c.lW)(o,a.length,a),(0,d.Ow)(t,1,o,a.length),s.M[15](t+36,1|r.f[15](t+36))}}}function k(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=3&e[21];const{spss:i}=v(e);if(i.length){const{profile:e,level:r,width:s,height:a}=S(i[0]);t.codecpar.profile=e,t.codecpar.level=r,t.codecpar.width=s,t.codecpar.height=a}}}function T(t,e=4){if(2===r.f[15](t+80))return(0,h.py)((0,c.s3)(r.f[20](t+24),r.f[15](t+28))).some((t=>{const e=t[0]>>>1&63;return 20===e||19===e}));{const i=r.f[15](t+28);let s=0;for(;s<i-e;){const i=p.r8(r.f[20](t+24)+(s+e))>>>1&63;if(20===i||19===i)return!0;s+=4===e?p.Sg(r.f[20](t+24)+s):3===e?p.ht(r.f[20](t+24)+s):2===e?p.yd(r.f[20](t+24)+s):p.r8(r.f[20](t+24)+s),s+=e}return!1}}function S(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);let i=0,r=0,s=0,a=0,n=0,o=0,c=1,d=0,u=0,p=0,m=0;const g=(0,h.BN)(t.subarray(e)),v=new l.A(g.length);v.appendBuffer(g),v.readU1(),v.readU(6),v.readU(6),v.readU(3),v.readU(4);const y=v.readU(3);v.readU1();let A=0;if(y<=6){d=v.readU(2),u=v.readU1(),i=v.readU(5),p=v.readU(32),m=v.readU(48),r=v.readU(8);const t=new Array(6),e=new Array(6);for(let i=0;i<y;i++)t[i]=v.readU1(),e[i]=v.readU1();if(y>0)for(let t=y;t<8;t++)v.readU(2);for(let i=0;i<y;i++)t[i]&&(v.readU(2),v.readU(1),v.readU(5),v.readU(32),v.readU(1),v.readU(1),v.readU(1),v.readU(1),v.readU(44)),e[i]&&v.readU(8);f.xb(v),c=f.xb(v),3===c&&(A=v.readU(1)),s=f.xb(v),a=f.xb(v);let l=0,h=0,g=0,b=0;v.readU1()&&(l=f.xb(v),h=f.xb(v),g=f.xb(v),b=f.xb(v)),n=f.xb(v),o=f.xb(v);let x=2,w=2;0===c?x=w=0:2===c?(x=2,w=1):3===c&&(x=w=1),s-=x*(1<<n+1)*(l+h),a-=w*(1<<n+1)*(g+b)}const b=f.xb(v)+4;for(let t=v.readU1()?0:y;t<y+1;t++)f.xb(v),f.xb(v),f.xb(v);const x=f.xb(v)+3,w=f.xb(v),k=f.xb(v)+2,T=f.xb(v),S=x+w,I=x-1,P=s+(1<<S)-1>>S,_=a+(1<<S)-1>>S;return{profile:i,level:r,width:s,height:a,chroma_format_idc:c,bit_depth_luma_minus8:n,bit_depth_chroma_minus8:o,general_profile_space:d,general_tier_flag:u,general_profile_compatibility_flags:p,constraint_flags:m,separate_colour_plane_flag:A,log2_min_cb_size:x,log2_diff_max_min_coding_block_size:w,log2_min_tb_size:k,log2_diff_max_min_transform_block_size:T,log2_max_trafo_size:T+k,log2_ctb_size:S,log2_min_pu_size:I,ctb_width:P,ctb_height:_,ctb_size:P*_,min_cb_width:s>>x,min_cb_height:a>>x,min_tb_width:s>>k,min_tb_height:a>>k,min_pu_width:s>>I,min_pu_height:a>>I,log2_max_poc_lsb:b}}function I(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);const i=(0,h.BN)(t.subarray(e)),r=new l.A(i.length);return r.appendBuffer(i),{pps_pic_parameter_set_id:f.xb(r),pps_seq_parameter_set_id:f.xb(r),dependent_slice_segment_flag:r.readU1(),output_flag_present_flag:r.readU1(),num_extra_slice_header_bits:r.readU(3)}}},89088:(t,e,i)=>{"use strict";i.d(e,{Au:()=>y,He:()=>A,XC:()=>b,Y2:()=>m,hG:()=>g,oz:()=>v});var r=i(77231);const s=[44100,48e3,32e3,0],a=[22050,24e3,16e3,0],n=[11025,12e3,8e3,0],o=[0,1152,1152,384],l=[0,576,1152,384],c=[0,576,1152,384],h=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],d=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],u=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],f=[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],p=[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1];function m(t,e){switch(t){case 0:return n[e];case 2:return a[e];case 3:return s[e]}return r.N_}function g(t,e){switch(t){case 0:return c[e];case 2:return l[e];case 3:return o[e]}return r.N_}function v(t,e,i){switch(e){case 1:switch(t){case 0:case 2:return p[i];case 3:return u[i]}break;case 2:switch(t){case 0:case 2:return p[i];case 3:return d[i]}case 3:switch(t){case 0:case 2:return f[i];case 3:return h[i]}}return r.N_}function y(t){switch(t){case 1:return 34;case 2:return 33;case 3:return 32}return r.N_}const A={32:"Layer1",33:"Layer2",34:"Layer3"};function b(t,e){if(e&&e.length>=4){const i=e[1]>>>3&3,r=(6&e[1])>>1,s=(12&e[2])>>>2,a=3&~(e[3]>>>6)?2:1,n=y(r),o=m(i,s);t.codecpar.profile=n,t.codecpar.sampleRate=o,t.codecpar.chLayout.nbChannels=a}}},14392:(t,e,i)=>{"use strict";i.d(e,{U:()=>a,X:()=>s});var r=i(37246);function s(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){const i=a(e);t.codecpar.profile=i.profile,t.codecpar.level=i.level}}function a(t){const e=new r.A(t.length);return e.appendBuffer(t.subarray(4)),{profile:e.readU(8),level:e.readU(8),bitDepth:e.readU(4),chromaSubsampling:e.readU(3),fullRangeFlag:e.readU1(),colorPrimaries:e.readU(8),colorTrc:e.readU(8),colorSpace:e.readU(8)}}},58919:(t,e,i)=>{"use strict";i.d(e,{Ui:()=>n,XC:()=>a,wN:()=>s});var r=i(37246);const s={0:"Profile0",1:"Profile1",2:"Profile2",3:"Profile3"};function a(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){const i=n(e);t.codecpar.profile=i.profile,t.codecpar.level=i.level}}function n(t){const e=new r.A(t.length);return e.appendBuffer(t),{profile:e.readU(8),level:e.readU(8),bitDepth:e.readU(4),chromaSubsampling:e.readU(3),fullRangeFlag:e.readU1(),colorPrimaries:e.readU(8),colorTrc:e.readU(8),colorSpace:e.readU(8)}}},55611:(t,e,i)=>{"use strict";i.d(e,{Jk:()=>b,KD:()=>T,QA:()=>w,Ui:()=>I,XC:()=>k,ci:()=>x,oT:()=>A,wf:()=>S});var r=i(63939),s=i(50932),a=i(72739),n=i(729),o=i(31865),l=i(37246),c=i(14686),h=i(60264),d=i(71517),u=i(37837),f=i(23991),p=i(83314),m=i(39381);const g=3;function v(t){const e=t.readU(9),i=t.readU(3),r=t.readU(2),s=t.readU(2),a=t.readU(3);t.readU(5),t.readU(2);const n=t.readU(6),o=t.readU(7),l=t.readU(1),c=t.readU(8),h=t.readU(1),d=t.readU(1),u=[],f=[];if(n){for(let e=0;e<n-1;e++)u[e]=t.readU(8);u[n-1]=t.readU(6)}else t.readU(6);if(i>1){let e=0;for(let r=i-2;r>=0;--r)e|=t.readU(1)<<r;for(let e=i;e<=8&&i>1;++e)t.readU(1);for(let r=i-2;r>=0;--r)e&1<<r&&(f[r]=t.readU(8))}const p=t.readU(8),m=[];if(p)for(let e=0;e<p;e++)m.push(t.readU(8));return{olsIdx:e,numSublayers:i,bitDepthMinus8:a,chromaFormatIdc:s,constantFrameRate:r,generalProfileIdc:o,generalTierFlag:l,generalLevelIdc:c,ptlFrameOnlyConstraintFlag:h,ptlMultilayerEnabledFlag:d,generalConstraintInfo:u,sublayerLevelIdc:f,generalSubProfileIdc:m,maxPictureWidth:t.readU(16),maxPictureHeight:t.readU(16),avgFramerate:t.readU(16)}}function y(t,e,i){const r=e[0];let s;if(r){const t=S(r);let e=t.generalConstraintInfo;e.length||(e=new Array(12).fill(0));const i=new p.A;if(i.writeU(9,0),i.writeU(3,t.spsMaxSublayersMinus1+1),i.writeU(2,1),i.writeU(2,t.chromaFormatIdc),i.writeU(3,t.bitDepthMinus8),i.writeU(5,31),i.writeU(2,0),i.writeU(6,e.length),i.writeU(7,t.profile),i.writeU1(t.tierFlag),i.writeU(8,t.level),i.writeU1(t.ptlFrameOnlyConstraintFlag),i.writeU1(t.ptlMultilayerEnabledFlag),e.length){for(let t=0;t<e.length-1;t++)i.writeU(8,e[t]);i.writeU(6,e[e.length-1])}else i.writeU(6,63);if(t.spsMaxSublayersMinus1+1>1){let e=0;for(let i=t.spsMaxSublayersMinus1-1;i>=0;i--)e=e<<1|t.ptlSublayerLevelPresentFlag[i];i.writeU(t.spsMaxSublayersMinus1,e);for(let e=t.spsMaxSublayersMinus1+1;e<=8&&t.spsMaxSublayersMinus1>0;++e)i.writeU1(0);for(let e=t.spsMaxSublayersMinus1-1;e>=0;e--)t.ptlSublayerLevelPresentFlag[e]&&i.writeU(8,t.sublayerLevelIdc[e])}i.writeU(8,t.generalSubProfileIdc.length);for(let e=0;e<t.generalSubProfileIdc.length;e++)i.writeU(8,t.sublayerLevelIdc[e]);i.writeU(16,t.width),i.writeU(16,t.height),i.writeU(16,0),i.padding(),s=i.getBuffer().subarray(0,i.getPointer())}let o=2+(s?s.length:0);t.length&&(o+=3,o=t.reduce(((t,e)=>t+2+e.length),o)),e.length&&(o+=3,o=e.reduce(((t,e)=>t+2+e.length),o)),i.length&&(o+=3,o=i.reduce(((t,e)=>t+2+e.length),o));const l=new Uint8Array(o),c=new n.A(l,!0);c.writeUint8(g<<1|(s?1:0)|248),s&&c.writeBuffer(s);let h=0;return t.length&&h++,e.length&&h++,i.length&&h++,c.writeUint8(h),t.length&&(c.writeUint8(142),c.writeUint16(t.length),a.__(t,(t=>{c.writeUint16(t.length),c.writeBuffer(t)}))),e.length&&(c.writeUint8(143),c.writeUint16(e.length),a.__(e,(t=>{c.writeUint16(t.length),c.writeBuffer(t)}))),i.length&&(c.writeUint8(144),c.writeUint16(i.length),a.__(i,(t=>{c.writeUint16(t.length),c.writeBuffer(t)}))),l}function A(t){let e,i=!1,r=(0,h.py)(t);if(r.length>=2){const t=[],i=[],s=[];r.forEach((e=>{const r=e[1]>>>3&31;14===r?t.push(e):15===r?i.push(e):16===r&&s.push(e)})),i.length&&s.length&&(e=y(t,i,s),r=r.filter((t=>{const e=t[1]>>>3&31;return 14!==e&&15!==e&&16!==e&&20!==e})))}const s=r.reduce(((t,e)=>t+g+1+e.length),0),o=(0,u.sY)(s),l=(0,c.s3)(o,s),d=new n.A(l);return a.__(r,(t=>{3===g?d.writeUint32(t.length):2===g?d.writeUint24(t.length):1===g?d.writeUint16(t.length):d.writeUint8(t.length),d.writeBuffer(t.subarray(0));const e=t[1]>>>3&31;8!==e&&7!==e&&9!==e&&10!==e||(i=!0)})),{bufferPointer:o,length:s,extradata:e,key:i}}function b(t,e){var i;if(!(1&r.f[15](t+36)))return;const s=(0,d.iI)(t);if((0,h.Bs)(s))return;const a=null!==(i=e.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:g;let n=[],l=[],f=[];const p=new o.A(s);for(;p.remainingSize()>0;){let t=0;t=3===a?p.readUint32():2===a?p.readUint24():1===a?p.readUint16():p.readUint8();const e=s.subarray(Number(BigInt.asIntN(32,p.getPos())),Number(BigInt.asIntN(32,p.getPos()))+t);p.skip(t);const i=e[1]>>>3&31;15===i?l.push(e):16===i?f.push(e):14===i&&n.push(e)}if(l.length||f.length||n.length){const e=y(n,l,f),i=(0,u.sY)(e.length);(0,c.lW)(i,e.length,e),(0,d.Ow)(t,1,i,e.length)}}function x(t,e=!1){if(!(1&r.f[15](t+36)||e))return;const i=(0,d.iI)(t);if(!(0,h.Bs)(i))return;let a=(0,h.py)(i);if(a.length>2){const e=[],i=[],n=[];if(a.forEach((t=>{const r=t[1]>>>3&31;14===r?e.push(t):15===r?i.push(t):16===r&&n.push(t)})),e.length&&i.length&&n.length){const a=y(e,i,n),o=(0,u.sY)(a.length);(0,c.lW)(o,a.length,a),(0,d.Ow)(t,1,o,a.length),s.M[15](t+36,1|r.f[15](t+36))}}}function w(t,e){const{profile:i,level:r,width:s,height:a}=S(e);t.codecpar.profile=i,t.codecpar.level=r,t.codecpar.width=s,t.codecpar.height=a}function k(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=e[0]>>>1&3;const{spss:i}=function(t){const e=new o.A(t,!0);if(1&e.readUint8()){const i=new l.A;i.appendBuffer(t.subarray(1)),v(i),e.skip(i.getPointer())}let i=[],r=[],s=[];const a=e.readUint8();for(let t=0;t<a;t++){const t=31&e.readUint8();let a=1;13!==t&&12!==t&&(a=e.readUint16());const n=[];for(let t=0;t<a;t++){const t=e.readUint16();n.push(e.readBuffer(t))}14===t?i=n:15===t?r=n:16===t&&(s=n)}return{vpss:i,spss:r,ppss:s}}(e);i.length&&w(t,i[0])}}function T(t,e=4){if(2===r.f[15](t+80))return(0,h.py)((0,c.s3)(r.f[20](t+24),r.f[15](t+28))).some((t=>{const e=t[1]>>>3&31;return 8===e||7===e}));{const i=r.f[15](t+28);let s=0;for(;s<i-e;){const i=m.r8(r.f[20](t+24)+(s+e+1))>>>3&31;if(8===i||7===i)return!0;s+=4===e?m.Sg(r.f[20](t+24)+s):3===e?m.ht(r.f[20](t+24)+s):2===e?m.yd(r.f[20](t+24)+s):m.r8(r.f[20](t+24)+s),s+=e}return!1}}function S(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);let i=0,r=0,s=0,a=0,n=0,o=1,c=0,d=0,u=0;const p=[],m=[],g=[],v=[],y=(0,h.BN)(t.subarray(e)),A=new l.A(y.length);A.appendBuffer(y),A.readU1(),A.readU1(),A.readU(6),A.readU(5),A.readU(3),A.readU(8);const b=A.readU(3);o=A.readU(2);const x=A.readU(2);if(A.readU(1)){if(i=A.readU(7),c=A.readU(1),r=A.readU(8),d=A.readU(1),u=A.readU(1),A.readU(1)){for(let t=0;t<8;t++)p[t]=A.readU(8);p[8]=A.readU(7);const t=A.readU(8);A.readU(t)}A.skipPadding();for(let t=b-1;t>=0;t--)m[t]=A.readU(1);A.skipPadding();for(let t=b-1;t>=0;t--)m[t]&&(g[t]=A.readU(8));const t=A.readU(8);if(t)for(let e=0;e<t;e++)v[e]=A.readU(32)}A.readU1(),A.readU1()&&A.readU1();const w=s=f.xb(A),k=a=f.xb(A);if(A.readU1()&&(f.xb(A),f.xb(A),f.xb(A),f.xb(A)),A.readU1()){const t=f.xb(A),e=x+5,i=1<<e,r=w/(1<<e),s=k/(1<<e),a=Math.ceil(Math.log2(r)),n=Math.ceil(Math.log2(s));let o=0,l=0,c=0;t>0&&(c=A.readU1(),l=A.readU1());for(let e=0;t>0&&e<=t;e++)l&&0!=e||(e>0&&w>i&&A.readU(a),e>0&&k>i&&A.readU(n),e<t&&w>i&&A.readU(a),e<t&&k>i&&A.readU(n)),c||A.readU(2);if(o=f.xb(A)+1,A.readU(1)&&A.readU(1))for(let e=0;e<=t;e++)A.readU(o)}n=f.xb(A),A.readU(1),A.readU(1);const T=A.readU(4),S=A.readU(1);let I=0;S&&(I=f.xb(A));const P=[],_=A.readU(2);for(let t=0;t<8*_;t++)P[t]=A.readU(1);return{profile:i,level:r,width:s,height:a,chromaFormatIdc:o,bitDepthMinus8:n,generalProfileSpace:0,tierFlag:c,generalConstraintInfo:p,generalSubProfileIdc:v,ptlFrameOnlyConstraintFlag:d,ptlMultilayerEnabledFlag:u,spsMaxSublayersMinus1:b,ptlSublayerLevelPresentFlag:m,sublayerLevelIdc:g,sps_log2_max_pic_order_cnt_lsb_minus4:T,sps_poc_msb_cycle_flag:S,sps_poc_msb_cycle_len_minus1:I,sps_num_extra_ph_bytes:_,sps_extra_ph_bit_present_flag:P}}function I(t){0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(t=function(t){let e=(0,h.py)(t);if(e.length>=2){const t=[],i=[],r=[];if(e.forEach((e=>{const s=e[1]>>>3&31;14===s?t.push(e):15===s?i.push(e):16===s&&r.push(e)})),i.length&&r.length)return y(t,i,r)}}(t));const e=new l.A;return e.appendBuffer(t),1&e.readU(8)?v(e):{}}},16160:(t,e,i)=>{"use strict";i.d(e,{V:()=>s,v:()=>r});const r=256e3,s=BigInt(5e3)},75:(t,e,i)=>{"use strict";i.d(e,{Cj:()=>I,Ib:()=>k,ho:()=>w,jF:()=>P});var r=i(61499),s=i(63939),a=i(36981),n=i(29170),o=i(9599),l=i(95335),c=i(72739),h=i(77231),d=i(31425),u=i(44328),f=i(71517),p=i(16160),m=i(9705),g=i(4624),v=i(40417),y=i(75742),A=i(56024),b="src/avformat/demux.ts";const x={fastOpen:!1,maxAnalyzeDuration:1e3};async function w(t,e={}){const i=l.X$({},x,e);return t.ioReader||g.h2("need IOReader",b,65),t.iformat||g.h2("need iformat",b,68),2===t.iformat.type&&(i.maxAnalyzeDuration=Math.max(i.maxAnalyzeDuration,2e3)),t.iformat.init(t),t.options=i,t.iformat.readHeader(t)}async function k(t){const e=t.iformat.getAnalyzeStreamsCount(),i={},m={},g={};let b=0;const x=[];let w=0;const k={},T={};function S(){if(!t.getDecoderResource)return!0;for(let e=0;e<t.streams.length;e++)if(k[t.streams[e].index]&&!T[t.streams[e].index])return!1;return!0}for(;!(t.streams.length>=e&&(0,d.$)(t)&&t.options.fastOpen&&S());){b||(b=(0,f._5)());let e=!1;if(w=await I(t,b),0!==w)break;const c=t.getStreamByIndex(s.f[15](b+32));if(s.f[15](b+28)&&(e=!0,x.push(b),i[c.index]||(c.firstDTS=s.f[17](b+16),c.startTime=s.f[17](b+8),i[c.index]=!0),s.f[17](b+8)<c.startTime&&(c.startTime=s.f[17](b+8)),m[c.index]?m[c.index].push(s.f[17](b+16)):m[c.index]=[s.f[17](b+16)],g[c.index]?g[c.index]+=s.f[15](b+28):g[c.index]=s.f[15](b+28),!T[c.index]&&t.getDecoderResource)){let e=k[c.index];if(!e){const i=await t.getDecoderResource(c.codecpar.codecType,c.codecpar.codecId);i&&(1===c.codecpar.codecType?e=new y.A({resource:i,onReceiveFrame:t=>{c.codecpar.format=s.f[15](t+80),c.codecpar.frameSize=s.f[15](t+76),c.codecpar.sampleRate=s.f[15](t+152),c.codecpar.chLayout=(0,n.A)(t+288,a.r),(0,A.xj)(t),T[c.index]=!0},onError:()=>{T[c.index]=!0}}):0===c.codecpar.codecType&&(i.threadModule&&delete i.threadModule,e=new v.A({resource:i,onReceiveFrame:t=>{c.codecpar.format=s.f[15](t+80),c.codecpar.colorSpace=s.f[15](t+220),c.codecpar.colorPrimaries=s.f[15](t+212),c.codecpar.colorTrc=s.f[15](t+216),c.codecpar.chromaLocation=s.f[15](t+224),c.codecpar.sampleAspectRatio=(0,n.A)(t+92,o.P),c.codecpar.width=s.f[15](t+68),c.codecpar.height=s.f[15](t+72),(0,A.xj)(t),T[c.index]=!0},onError:()=>{T[c.index]=!0}})),await e.open(c.codecpar[r.o9]),k[c.index]=e)}e&&e.decode(b)}if(m[c.index]&&12===m[c.index].length){let t=BigInt(0);for(let e=1;e<m[c.index].length;e++)t+=m[c.index][e]-m[c.index][e-1];let e=Number(t)/(m[c.index].length-1);if(1===c.codecpar.codecType&&c.codecpar.sampleRate>0)c.codecpar.frameSize=Math.round(e/c.timeBase.den*c.timeBase.num*c.codecpar.sampleRate);else if(0===c.codecpar.codecType){const t=c.timeBase.den*c.timeBase.num/e;c.codecpar.framerate.num=Math.round(t),c.codecpar.framerate.den=1}const i=Number(s.f[17](b+16)-c.firstDTS)*c.timeBase.num/c.timeBase.den;i&&(c.codecpar.bitrate=BigInt(Math.floor(8*g[c.index]/i)))}if(s.f[17](b+16)-c.startTime>(0,u.k)(BigInt(Math.floor(t.options.maxAnalyzeDuration)),h.i0,c.timeBase)){l.__(m,((e,i)=>{const r=t.getStreamByIndex(+i);if(e&&e.length>1){let t=BigInt(0);for(let i=1;i<e.length;i++)t+=e[i]-e[i-1];let i=Number(t)/(m[r.index].length-1);if(1===r.codecpar.codecType&&r.codecpar.sampleRate>0)r.codecpar.frameSize=Math.round(i/r.timeBase.den*r.timeBase.num*r.codecpar.sampleRate);else if(0===r.codecpar.codecType){const t=r.timeBase.den*r.timeBase.num/i;r.codecpar.framerate.num=Math.round(t),r.codecpar.framerate.den=1}const a=Number(s.f[17](b+16)-r.firstDTS)*r.timeBase.num/r.timeBase.den;a&&(r.codecpar.bitrate=BigInt(Math.floor(8*g[r.index]/a)))}})),e&&(b=0);break}e&&(b=0)}return b&&(0,f.Qe)(b),x.length&&(t.interval.packetBuffer=x.concat(t.interval.packetBuffer)),l.__(k,(t=>{t&&t.close()})),-1048576===w?0:0!==w?w:(2===t.iformat.type&&1&t.ioReader.flags&&await async function(t){const e=await t.ioReader.fileSize();if(e<=BigInt(0))return;const i=t.interval.packetBuffer;t.interval.packetBuffer=[];let r=t.ioReader.getPos(),a=0;for(;a<4;){const i=e-BigInt(Math.floor(p.v<<a)),n=await t.iformat.seek(t,null,i,2);n>BigInt(0)&&(r=n);const o={},l=(0,f._5)();for(;!(await I(t,l)<0);){let e=s.f[17](l+8);const i=t.getStreamByIndex(s.f[15](l+32));i.startTime!==h.Dh?e-=i.startTime:e-=i.firstDTS,e>BigInt(0)&&((i.duration===h.Dh||!o[s.f[15](l+32)]||i.duration<e&&Math.abs(Number(e-i.duration))<60*i.timeBase.den/i.timeBase.num)&&(i.duration=e),o[l.streamIndex]=e)}(0,f.Qe)(l);let d=!0;if(c.__(t.streams,(t=>{if(t.duration===h.Dh)return d=!1,!1})),d)break;a++}c.__(t.interval.packetBuffer,(t=>{(0,f.Qe)(t)})),t.interval.packetBuffer=i,await t.iformat.seek(t,null,r,2)}(t),0)}function T(t,e){const i=c.El(t.sampleIndexes,(t=>t.pts<s.f[17](e+8)?1:-1)),r={dts:s.f[17](e+16),pts:s.f[17](e+8),pos:s.f[17](e+56),size:s.f[15](e+28),duration:s.f[17](e+48),flags:s.f[15](e+36)};i>-1?(t.sampleIndexesPosMap.set(s.f[17](e+56),i),t.sampleIndexes.splice(i,0,r)):(t.sampleIndexesPosMap.set(s.f[17](e+56),t.sampleIndexes.length),t.sampleIndexes.push(r))}async function S(t,e){const i=t.getStreamByIndex(s.f[15](e+32));let r=0;if(i&&(27===i.codecpar.codecId||173===i.codecpar.codecId||196===i.codecpar.codecId||86018===i.codecpar.codecId))if(!s.f[15](e+28)&&(0,f.fQ)(e,1))for(;;){const i=(0,f._5)();if(r=await t.iformat.readAVPacket(t,i),0!==r){if(t.interval.packetBuffer.length){let i=t.interval.packetBuffer.shift();return(0,f.Up)(e),(0,f.rN)(e,i),(0,f.Qe)(i),S(t,e)}return r}if(s.f[15](i+32)!==s.f[15](e+32))t.interval.packetBuffer.push(i);else{if(s.f[15](i+28))return(0,f.Zx)(e,i),(0,f.Qe)(i),0;(0,f.Up)(e),(0,f.rN)(e,i),(0,f.Qe)(i)}}else if(32&s.f[15](e+36))return I(t,e);if(1&t.ioReader.flags&&!i.sampleIndexesPosMap.has(s.f[17](e+56)))if(0===i.codecpar.codecType)1&s.f[15](e+36)&&T(i,e);else if(1===i.codecpar.codecType){const t=c.El(i.sampleIndexes,(t=>t.pts<s.f[17](e+8)?1:-1));(!i.sampleIndexes.length||t<0&&(0,u.k)(s.f[17](e+8)-i.sampleIndexes[i.sampleIndexes.length-1].pts,(0,n.A)(e+72,o.P),h.i0)>=p.V||t>0&&t<i.sampleIndexes.length-1&&(0,u.k)(s.f[17](e+8)-i.sampleIndexes[t-1].pts,(0,n.A)(e+72,o.P),h.i0)>=p.V||0===t&&(0,u.k)(i.sampleIndexes[0].pts-s.f[17](e+8),(0,n.A)(e+72,o.P),h.i0)>=p.V)&&T(i,e)}return 0}async function I(t,e){let i=0;if((0,f.Up)(e),t.interval.packetBuffer.length){const i=t.interval.packetBuffer.shift();return(0,f.rN)(e,i),(0,f.Qe)(i),S(t,e)}return i=await t.iformat.readAVPacket(t,e),0!==i?((0,f.Up)(e),i):S(t,e)}async function P(t,e,i,r){let s=e>-1?t.streams.find((t=>t.index===e)):null;if(s||(s=t.getStreamByMediaType(0),s||(s=t.getStreamByMediaType(1)),s||(s=t.getStreamByMediaType(3))),!s)return g.z3(`not found any stream to seek, streamIndex: ${s.index}`,b,547),BigInt(m.LR);g.Yz(`seek in ${0===s.codecpar.codecType?"video":"audio"} stream, streamIndex: ${s.index}, timestamp: ${i}, flags: ${r}`,b,551),i=(0,u.k)(i,h.i0,s.timeBase);const a=await t.iformat.seek(t,s,i,r);return a>=BigInt(0)?(c.__(t.interval.packetBuffer,(t=>{(0,f.Qe)(t)})),t.interval.packetBuffer.length=0,BigInt(0)):a}},548:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>E,L_:()=>P,eG:()=>I,yl:()=>S});var r=i(69736),s=i.n(r),a=i(61499),n=i(63939),o=i(9599),l=i(29170),c=i(44315),h=i(95335),d=i(62751),u=i(67672),f=i(44328),p=i(77231),m=i(20525),g=i(62100),v=i(58469),y=i(20620),A=i(53e3),b=i(90412),x=i(58919),w=i(89088);function k(t){t<0&&(t=BigInt(0));const e=Number(BigInt.asIntN(32,t%BigInt(1e3))),i=Number(BigInt.asIntN(32,t/BigInt(1e3)%BigInt(60))),r=Number(BigInt.asIntN(32,t/BigInt(1e3)/BigInt(60)%BigInt(60))),s=Number(BigInt.asIntN(32,t/BigInt(1e3)/BigInt(3600)));return m.GP("%02d:%02d:%02d.%03d",s,r,i,e)}function T(t){return t<BigInt(1e4)?(0,g.A)(Number(BigInt.asIntN(32,t)))+" bps/s":Number(BigInt.asIntN(32,t/BigInt(1e3)))+" kbps/s"}function S(t,e,i="unknown"){let r=i;return h.__(t,((t,i)=>{if(e===t)return r=i,!1})),r}function I(t,e){return 1===t?S(d.n1,e):0===t?S(d._R,e):3===t?S(d.Xp,e):"unknown"}function P(t){return S(d.iW,t)}function _(t,e){switch(t){case 86018:return v.uF[e]||"LC";case 86017:return w.He[e]||"Layer3";case 27:return y.tZ[e]||"High";case 173:return A.dT[e]||"Main";case 225:return b.zk[e]||"Main";case 167:return x.wN[e]||"Profile0"}}function E(t,e){let i="";return t.forEach(((t,r)=>{if(t instanceof c.oD){const e=[];for(let i=0;i<t.streams.length;i++){const r=t.streams[i];e.push({index:r.index,id:r.id,codecpar:r.codecpar[a.o9],nbFrames:r.nbFrames,metadata:r.metadata,duration:r.duration,startTime:r.startTime,disposition:r.disposition,timeBase:r.timeBase})}t={metadata:t.metadata,format:t.format,chapters:t.chapters,streams:e}}i+=function(t,e,i){let r=`${i.tag} #${e}, ${S(d.iW,t.format)}, from '${i.from}':\n`;s()(t.metadata).length&&(r+="  Metadata:\n",h.__(t.metadata,((t,e)=>{u.Ik(t)&&u.YO(t)||(r+=`    ${e}: ${t}\n`)})));let a=BigInt(0),c=BigInt(0),m=-BigInt(1);return t.streams.forEach((t=>{const e=(0,f.k)(t.duration,t.timeBase,p.i0),i=(0,f.k)(t.startTime,t.timeBase,p.i0);e>a&&(a=e),(i<m||m===-BigInt(1))&&(m=i),c+=n.f[17](t.codecpar+32)})),r+=`  Duration: ${k(a)}, start: ${k(m)}, bitrate: ${T(c)}\n`,t.streams.forEach(((t,i)=>{r+=function(t,e,i){const r=S(d.Mb,n.f[15](t.codecpar)),a=[];if(1===n.f[15](t.codecpar)){const e=_(n.f[15](t.codecpar+4),n.f[15](t.codecpar+48)),i=S(d.n1,n.f[15](t.codecpar+4));a.push(`${i}${e?` (${e})`:""}`),a.push(`${n.f[15](t.codecpar+136)} Hz`);let r=`${n.f[15](t.codecpar+116)} channels`;1===n.f[15](t.codecpar+116)?r="mono":2===n.f[15](t.codecpar+116)&&(r="stereo"),a.push(r),a.push(S(d.Sz,n.f[15](t.codecpar+28))),n.f[17](t.codecpar+32)>BigInt(0)&&a.push(`${T(n.f[17](t.codecpar+32))}`)}else if(0===n.f[15](t.codecpar)){const e=_(n.f[15](t.codecpar+4),n.f[15](t.codecpar+48)),i=S(d._R,n.f[15](t.codecpar+4));if(a.push(`${i}${e?` (${e})`:""}`),n.f[15](t.codecpar+28)!==p.N_){const e=S(d.qO,n.f[15](t.codecpar+28)),i=S(d.mX,n.f[15](t.codecpar+84),"tv"),r=S(d._m,n.f[15](t.codecpar+96),"bt709");a.push(`${e}(${i}, ${r})`)}const r={num:n.f[15](t.codecpar+56)*n.f[15](t.codecpar+64),den:n.f[15](t.codecpar+60)*n.f[15](t.codecpar+68)};(0,f.iU)(r),a.push(`${n.f[15](t.codecpar+56)}x${n.f[15](t.codecpar+60)} [SAR: ${n.f[15](t.codecpar+64)}:${n.f[15](t.codecpar+68)} DAR ${r.num}:${r.den}]`),n.f[17](t.codecpar+32)>BigInt(0)&&a.push(`${T(n.f[17](t.codecpar+32))}`),(0,f.lb)((0,l.A)(t.codecpar+72,o.P))>0&&(a.push(`${(0,f.lb)((0,l.A)(t.codecpar+72,o.P)).toFixed(2)} fps`),a.push(`${(0,f.lb)((0,l.A)(t.codecpar+72,o.P)).toFixed(2)} tbr`)),a.push(`${c=BigInt(Math.floor((0,f.lb)({num:t.timeBase.den,den:t.timeBase.num}))),c<BigInt(1e4)?(0,g.A)(Number(BigInt.asIntN(32,c))):Number(BigInt.asIntN(32,c/BigInt(1e3)))+"k"} tbn`)}else if(3===n.f[15](t.codecpar)){const e=S(d.Xp,n.f[15](t.codecpar+4));a.push(e),n.f[17](t.codecpar+32)>BigInt(0)&&a.push(`${T(n.f[17](t.codecpar+32))}`)}else n.f[17](t.codecpar+32)>BigInt(0)&&a.push(`${T(n.f[17](t.codecpar+32))}`);var c;let m="";t.disposition&&(m=" ",1&t.disposition&&(m+=`(${S(d.Ki,1)}) `),2&t.disposition&&(m+=`(${S(d.Ki,2)}) `),4&t.disposition&&(m+=`(${S(d.Ki,4)}) `),8&t.disposition&&(m+=`(${S(d.Ki,8)}) `),16&t.disposition&&(m+=`(${S(d.Ki,16)}) `),32&t.disposition&&(m+=`(${S(d.Ki,32)}) `),64&t.disposition&&(m+=`(${S(d.Ki,64)}) `),128&t.disposition&&(m+=`(${S(d.Ki,128)}) `),256&t.disposition&&(m+=`(${S(d.Ki,256)}) `),512&t.disposition&&(m+=`(${S(d.Ki,512)}) `),1024&t.disposition&&(m+=`(${S(d.Ki,1024)}) `),2048&t.disposition&&(m+=`(${S(d.Ki,2048)}) `),65536&t.disposition&&(m+=`(${S(d.Ki,65536)}) `),131072&t.disposition&&(m+=`(${S(d.Ki,131072)}) `),262144&t.disposition&&(m+=`(${S(d.Ki,262144)}) `),524288&t.disposition&&(m+=`(${S(d.Ki,524288)}) `),1048576&t.disposition&&(m+=`(${S(d.Ki,1048576)}) `));let v=`${i}Stream #${e}:${t.index} ${r}: ${a.join(", ")}${m}\n`;return s()(t.metadata).length&&(v+=`${i}  Metadata:\n`,h.__(t.metadata,((t,e)=>{u.Ik(t)||u.YO(t)||(v+=`${i}    ${e}: ${t}\n`)}))),v}(t,e,"  ")})),r}(t,r,e[r])})),i}},51597:(t,e,i)=>{"use strict";i.d(e,{A:()=>s,E:()=>a});var r=i(134);class s{constructor(){(0,r.A)(this,"type",-1)}destroy(t){}}const a={13:[86018],8:[86017,86019,86018,12,27],15:[86028],0:[86017,86018,86051,69645,86049,65543,65542,12,27,173,225,167,196],5:[139,167],6:[86021,86076,86018,86017,86028,86032,86020,86056,65557,65537,65536,139,167,225,27,173,196,12,30,94226],7:[86021,86076,139,167,225,94226],1:[86021,86076,86018,86017,86028,86051,86019,86056,167,225,27,173,196,12,94226,94213],12:[86017],2:[86076,86018,86017,86019,,86020,86065,86056,12,225,27,173,196],3:[86058,86016,86017,86019,,86020,2,12,27,173,196],4:[86021],14:[],16:[94226],18:[94230,94212],17:[94225],19:[94232],9:[27],10:[173],11:[196]}},69765:(t,e,i)=>{"use strict";i.d(e,{A:()=>M});var r=i(134),s=i(61499),a=i(63939),n=i(9599),o=i(29170),l=i(51597),c=i(9690),h=i(65977),d=i(75473),u=i(38106),f=i(3384),p=i(35336),m=i(72739),g=i(4624),v=i(92647),y=i(79804),A=i(77231),b=i(95335),x=i(20841),w=i(59989),k=i(44328),T=i(71517),S=i(26173),I=i(67672),P=i(87771),_=i(14686),E="src/avformat/formats/OMovFormat.ts";const C={fragmentMode:0,movMode:0,fragment:!1,fastOpen:!1,defaultBaseIsMoof:!1};class M extends l.A{constructor(t={}){super(),(0,r.A)(this,"type",1),(0,r.A)(this,"context",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"annexb2AvccFilter",void 0),this.options=b.X$({},C,t),this.context=(0,c.A)()}init(t){t.ioWriter.setEndian(!0);const e=t.getStreamByMediaType(0);return e&&(this.annexb2AvccFilter=new S.A,this.annexb2AvccFilter.init(e.codecpar[s.o9],e.timeBase[s.o9])),0}destroy(t){super.destroy(t),this.annexb2AvccFilter&&(this.annexb2AvccFilter.destroy(),this.annexb2AvccFilter=null)}enableStreams(t){const e=[],i=[];for(let t=0;t<5;t++)e[t]=0,i[t]=-1;m.__(t.streams,((t,r)=>{if(-1===t.codecpar.codecType||t.codecpar.codecType>=5)return!0;i[t.codecpar.codecType]<0&&(i[t.codecpar.codecType]=r),1&t.disposition&&(e[t.codecpar.codecType]++,t.privData.flags|=1)}));for(let r=0;r<5;r++)switch(r){case 0:case 1:case 3:e[r]>1&&(t.streams[e[r]].privData.perStreamGrouping=!0),!e[r]&&i[r]>=0&&(t.streams[i[r]].privData.flags|=1)}}writeHeader(t){if(this.context.majorBrand=(0,h.A)("isom"),this.context.minorVersion=512,this.context.compatibleBrand=[(0,h.A)("isom")],this.context.timescale=1e3,this.options.fragment&&(this.context.compatibleBrand.push((0,h.A)("iso6")),this.context.fragment=!0),1===this.options.movMode&&(this.context.isom=!0,this.context.majorBrand=(0,h.A)("qt  "),this.context.compatibleBrand=[this.context.majorBrand]),1!==this.options.movMode){this.context.compatibleBrand.push((0,h.A)("iso2"));const e=t.getStreamByMediaType(0);e&&27===e.codecpar.codecId&&this.context.compatibleBrand.push((0,h.A)("avc1")),this.context.compatibleBrand.push((0,h.A)("mp41"))}if(d.l7(t.ioWriter,this.context),this.context.holdMoovPos=t.ioWriter.getPos(),this.options.fragment)this.context.currentFragment={pos:BigInt(0),currentTrack:null,sequence:1,tracks:[],size:0,firstWrote:!1},m.__(t.streams,((t,e)=>{const i=(0,u.A)();t.privData=i,i.chunkOffsets=[],i.cttsSampleCounts=[],i.cttsSampleOffsets=[],i.stscFirstChunk=[],i.stscSamplesPerChunk=[],i.stscSampleDescriptionIndex=[],i.stssSampleNumbers=[],i.sampleSizes=[],i.sttsSampleCounts=[],i.sttsSampleDeltas=[],i.alternateGroup=e;const r=(0,f.A)();r.baseIsMoof=this.options.defaultBaseIsMoof,r.streamIndex=t.index,r.trackId=this.context.nextTrackId++,i.trackId=r.trackId,r.ioWriter=new p.A,r.ioWriter.onFlush=t=>(r.buffers.push(t.slice()),0),this.context.currentFragment.tracks.push(r)})),this.enableStreams(t),d.dI(t.ioWriter,t,this.context),t.ioWriter.flush();else{m.__(t.streams,((t,e)=>{const i=(0,u.A)();t.privData=i,i.trackId=this.context.nextTrackId++,i.chunkOffsets=[],i.cttsSampleCounts=[],i.cttsSampleOffsets=[],i.stscFirstChunk=[],i.stscSamplesPerChunk=[],i.stscSampleDescriptionIndex=[],i.stssSampleNumbers=[],i.sampleSizes=[],i.sttsSampleCounts=[],i.sttsSampleDeltas=[],i.alternateGroup=e})),this.enableStreams(t);const e=t.ioWriter.getPos();t.ioWriter.writeUint32(0),t.ioWriter.writeUint32((0,h.A)("mdat")),this.context.boxsPositionInfo.push({pos:e,type:"mdat",size:0})}return 0}updateCurrentChunk(t){let e=this.context.currentChunk;if(!e.sampleCount)return;const i=t.streams.find((t=>t.index===e.streamIndex)).privData;i.chunkCount++,i.chunkOffsets.push(e.pos),i.stscFirstChunk.length?i.lastStscCount!==e.sampleCount&&(i.stscFirstChunk.push(i.chunkCount),i.stscSamplesPerChunk.push(e.sampleCount),i.stscSampleDescriptionIndex.push(1),i.lastStscCount=e.sampleCount):(i.stscFirstChunk.push(i.chunkCount),i.stscSamplesPerChunk.push(e.sampleCount),i.stscSampleDescriptionIndex.push(1),i.lastStscCount=e.sampleCount)}checkMdat(t,e){const i=this.context.boxsPositionInfo[this.context.boxsPositionInfo.length-1];if("mdat"!==i.type)return void g.z3("last box is not mdat",E,302);const r=t.ioWriter.getPos(),s=Number(r-i.pos);s+e>A.f7&&(i.size=s,t.ioWriter.writeUint32(0),t.ioWriter.writeUint32((0,h.A)("mdat")),this.context.boxsPositionInfo.push({pos:r,type:"mdat",size:0}))}updateCurrentFragment(t,e){if(this.context.currentFragment.firstWrote){m.__(this.context.currentFragment.tracks,(i=>{const r=t.streams.find((t=>t.index===i.streamIndex));if(!i.sampleCount||!r)return!0;const s=r.privData;var a;i.baseDataOffset=t.ioWriter.getPos(),i.sampleDurations.length?e&&i.sampleDurations.length===i.sampleSizes.length-1&&i.sampleDurations.push(Number(e-s.lastDts)):1===r.codecpar.codecType?e?i.sampleDurations.push(Number(e-s.lastDts)):r.codecpar.frameSize>0?i.sampleDurations.push(Number((0,k.k)(BigInt(r.codecpar.frameSize/r.codecpar.sampleRate*A.SF),A.KR,r.timeBase))):(r.codecpar.codecId,i.sampleDurations.push(Number((0,k.k)(BigInt(1024/r.codecpar.sampleRate*A.SF),A.KR,r.timeBase)))):0===r.codecpar.codecType?e?i.sampleDurations.push(Number(e-s.lastDts)):(0,k.lb)(r.codecpar.framerate)>0?i.sampleDurations.push(Number((0,k.k)(BigInt(Math.floor(1/(0,k.lb)(r.codecpar.framerate)*A.SF)),A.KR,r.timeBase))):i.sampleDurations.push(r.timeBase.den/(30*r.timeBase.num)>>>0):i.sampleDurations.push(0),s.lastDuration=i.sampleDurations[i.sampleSizes.length-1],(1===i.sampleFlags.length||(0,w.A)(i.sampleFlags,1))&&(i.firstSampleFlags=i.sampleFlags[0],i.defaultSampleFlags=null!==(a=i.sampleFlags[1])&&void 0!==a?a:i.firstSampleFlags,i.sampleFlags=[]),(1===i.sampleSizes.length||(0,w.A)(i.sampleSizes))&&(i.defaultSampleSize=i.sampleSizes[0],i.sampleSizes=[]),(1===i.sampleDurations.length||(0,w.A)(i.sampleDurations))&&(i.defaultSampleDuration=i.sampleDurations[0],i.sampleDurations=[]),1===r.codecpar.codecType?i.defaultSampleFlags=33554432:i.sampleFlags.length&&(i.defaultSampleFlags=i.sampleFlags[0]),i.sampleSizes.length&&(i.defaultSampleSize=i.sampleSizes[0]),i.sampleDurations.length&&(i.defaultSampleDuration=i.sampleDurations[0])})),t.ioWriter.flush(),d.Ro(t.ioWriter,t,this.context);let i=this.context.currentFragment.size+8;const r=[];let s=8;m.__(this.context.currentFragment.tracks,(e=>{if(!e.sampleCount)return!0;e.ioWriter.flush();const a=(0,v.A)(Uint8Array,e.buffers);e.dataOffset=i,i+=a.length,s+=a.length,r.push(a),(0,x.A)(t.ioWriter,e.dataOffsetPos,e.dataOffset,"int32"),e.buffers=[],e.sampleFlags=[],e.sampleSizes=[],e.sampleDurations=[],e.sampleCompositionTimeOffset=[],e.sampleCount=0,e.firstSampleFlags=0})),t.ioWriter.writeUint32(s),t.ioWriter.writeUint32((0,h.A)("mdat")),m.__(r,(e=>{t.ioWriter.writeBuffer(e)})),(0,y.A)(t.ioWriter,this.context),t.ioWriter.flush(),this.context.currentFragment.firstWrote=!1,this.context.currentFragment.sequence++}}handleEAC3(t,e){this.context.ac3Info||(this.context.ac3Info={done:!1,numBlocks:0,dataRate:0,ac3BitrateCode:-1,numIndSub:0,substream:[]});const i=this.context.ac3Info,r=P.R((0,_.s3)(a.f[20](t+24),a.f[15](t+28)));if(I.ai(r))i.done=!0;else if(i.dataRate=Math.max(i.dataRate,r.bitrate/1e3),i.ac3BitrateCode=Math.max(i.ac3BitrateCode,r.ac3BitrateCode),!i.done){if(r.bitstreamId<=10&&0!=r.substreamId)return;if(0===r.frameType||2==r.frameType){var s;if(r.substreamId>i.numIndSub+1)return;if(r.substreamId==i.numIndSub+1)return;if(r.substreamId<i.numIndSub||0==r.substreamId&&null!==(s=i.substream[0])&&void 0!==s&&s.bsid)return void(i.done=!0)}else if(0!=r.substreamId)return;if(i.substream[r.substreamId]||(i.substream[r.substreamId]={fscod:0,bsid:0,bsmod:0,acmod:0,lfeon:0,numDepSub:0,chanLoc:0}),i.substream[r.substreamId].fscod=r.srCode,i.substream[r.substreamId].bsid=r.bitstreamId,i.substream[r.substreamId].bsmod=r.bitstreamMode,i.substream[r.substreamId].acmod=r.channelMode,i.substream[r.substreamId].lfeon=r.lfeOn,86019===e.codecpar.codecId)return void(i.done=!0)}}writeAVPacket(t,e){if(!a.f[15](e+28))return g.R8(`packet's size is 0: ${a.f[15](e+32)}, ignore it`,E,543),0;const i=t.getStreamByIndex(a.f[15](e+32));if(!i)return void g.R8(`can not found the stream width the avpacket's streamIndex: ${a.f[15](e+32)}, ignore it`,E,550);const r=i.privData,s=(0,k.k)(a.f[17](e+16),(0,o.A)(e+72,n.P),i.timeBase),l=(0,k.k)(a.f[17](e+8)<BigInt(0)?a.f[17](e+16):a.f[17](e+8),(0,o.A)(e+72,n.P),i.timeBase);if(27!==i.codecpar.codecId&&173!==i.codecpar.codecId&&196!==i.codecpar.codecId||2!==a.f[15](e+80)?86019!==i.codecpar.codecId&&86056!==i.codecpar.codecId||this.context.ac3Info&&this.context.ac3Info.done||this.handleEAC3(e,i):(this.annexb2AvccFilter.sendAVPacket(e),this.annexb2AvccFilter.receiveAVPacket(e)),this.context.fragment){const c=this.context.currentFragment.tracks.find((t=>t.streamIndex===a.f[15](e+32)));if(c){if((0===this.options.fragmentMode&&0===i.codecpar.codecType&&1&a.f[15](e+36)||1===this.options.fragmentMode)&&(1===this.context.currentFragment.tracks.length?this.updateCurrentFragment(t,s):this.updateCurrentFragment(t)),c.ioWriter.writeBuffer((0,T.iI)(e)),c.sampleSizes.length||(c.baseMediaDecodeTime=s),c.sampleSizes.length&&(!c.sampleDurations[c.sampleSizes.length-1]||c.sampleDurations[c.sampleSizes.length-1]<=0)&&(c.sampleDurations[c.sampleSizes.length-1]=Number(s-r.lastDts)),a.f[17](e+48)>0&&c.sampleDurations.push(Number((0,k.k)(a.f[17](e+48),(0,o.A)(e+72,n.P),i.timeBase))),c.sampleSizes.push(a.f[15](e+28)),0===i.codecpar.codecType){let t=0;1&a.f[15](e+36)?t|=33554432:t|=16842752,c.sampleCompositionTimeOffset.push(Number((l||s)-s)),c.sampleFlags.push(t)}c.sampleCount++,r.lastPts=l>r.lastPts?l:r.lastPts,r.lastDts=s,this.context.currentFragment.firstWrote=!0}else g.R8(`can not found track width streamIndex ${a.f[15](e+32)}, ignore it`,E,636)}else{this.checkMdat(t,a.f[15](e+28));const n=t.ioWriter.getPos();let o=this.context.currentChunk;if(o?o.streamIndex!==a.f[15](e+32)?(this.updateCurrentChunk(t),o.streamIndex=a.f[15](e+32),o.sampleCount=1,o.pos=n):o.sampleCount++:o=this.context.currentChunk={pos:n,streamIndex:a.f[15](e+32),sampleCount:1},t.ioWriter.writeBuffer((0,T.iI)(e)),r.sampleSizes.push(a.f[15](e+28)),0===i.codecpar.codecType&&1&a.f[15](e+36)&&r.stssSampleNumbers.push(r.sampleSizes.length),r.firstWrote){const t=Number(s-r.lastDts);r.sttsSampleCounts.length&&r.sttsSampleDeltas[r.sttsSampleDeltas.length-1]===t?r.sttsSampleCounts[r.sttsSampleCounts.length-1]++:(r.sttsSampleCounts.push(1),r.sttsSampleDeltas.push(t))}else r.startDts=s,r.startCT=Number((l||s)-s),r.firstWrote=!0;if(0===i.codecpar.codecType){const t=Number((l||s)-s);r.cttsSampleCounts.length&&r.cttsSampleOffsets[r.cttsSampleOffsets.length-1]===t?r.cttsSampleCounts[r.cttsSampleCounts.length-1]++:(r.cttsSampleCounts.push(1),r.cttsSampleOffsets.push(t))}r.lastPts=(l||s)>r.lastPts?l||s:r.lastPts,r.lastDts=s}return 0}writeTrailer(t){if(this.context.fragment)m.__(this.context.currentFragment.tracks,(e=>{const i=t.streams.find((t=>t.index===e.streamIndex)).privData;e.sampleCount&&(e.sampleDurations.length?e.sampleDurations.push(e.sampleDurations[e.sampleDurations.length-1]):e.sampleDurations=[i.lastDuration])})),this.updateCurrentFragment(t),t.ioWriter.writeUint32(8),t.ioWriter.writeString("mfra"),t.ioWriter.flush();else{this.updateCurrentChunk(t);let e,i=BigInt(0);m.__(t.streams,(t=>{const r=t.privData;r.sampleSizes.length&&(r.sttsSampleDeltas.length?r.sttsSampleCounts[r.sttsSampleCounts.length-1]++:(r.sttsSampleCounts=[1],r.sttsSampleDeltas=[0])),r.lastPts>i&&(i=r.lastPts,e=t.timeBase)})),i&&(this.context.duration=(0,k.k)(i,e,{den:1e3,num:1}));const r=this.context.boxsPositionInfo[this.context.boxsPositionInfo.length-1];if("mdat"!==r.type&&g.z3("last box is not mdat",E,752),r.size=Number(t.ioWriter.getPos()-r.pos),(0,y.A)(t.ioWriter,this.context),this.options.fastOpen){t.ioWriter.flush();let e=[];const i=t.ioWriter.onFlush;t.ioWriter.onFlush=t=>(e.push(t.slice()),0),d.dI(t.ioWriter,t,this.context),t.ioWriter.flush();let r=(0,v.A)(Uint8Array,e);m.__(t.streams,(t=>{const e=t.privData;if(e.chunkOffsets.length)for(let t=0;t<e.chunkOffsets.length;t++)e.chunkOffsets[t]+=BigInt(Math.floor(r.length))})),e=[],d.dI(t.ioWriter,t,this.context),t.ioWriter.flush(),r=(0,v.A)(Uint8Array,e),i&&i(r,this.context.holdMoovPos),t.ioWriter.onFlush=i}else d.dI(t.ioWriter,t,this.context),t.ioWriter.flush()}return 0}flush(t){return this.options.fragment&&(m.__(this.context.currentFragment.tracks,(e=>{const i=t.streams.find((t=>t.index===e.streamIndex)).privData;e.sampleCount&&(e.sampleDurations.length?e.sampleDurations.push(e.sampleDurations[e.sampleDurations.length-1]):e.sampleDurations=[i.lastDuration])})),this.updateCurrentFragment(t)),t.ioWriter.flush(),0}}},5028:(t,e,i)=>{"use strict";i.d(e,{Q:()=>r});const r=["ReadOrder","Layer","Start","End","Style","Name","MarginL","MarginR","MarginV","Effect","Text"]},51785:(t,e,i)=>{"use strict";i.d(e,{Bp:()=>c,Ew:()=>d,wj:()=>u}),i(7210);var r=i(4624),s=i(5028),a=i(54825),n=i(44453),o=i(93935),l="src/avformat/formats/ass/iass.ts";function c(t){return function(t,e){const i=e.match(/Format\s*:\s*(.*)/i)[1].split(/\s*,\s*/),s=[];for(let e=0;e<i.length;e++){const a=t.find((t=>t.toLowerCase()===i[e].toLowerCase()));a||r.R8(`not support ass field(${i[e]})`,l,40),s.push(a||i[e])}return s}(s.Q,t)}function h(t,e){let i=e.split(",");if(i.length>t.length){const e=i.slice(t.length-1).join(",");i=i.slice(0,t.length-1),i.push(e)}return i}function d(t,e,i,r){const[,,s]=e.match(/^(\w+?)\s*:\s*(.*)/i),n=h(t,s);return{start:(0,a.j)(n[i]),end:(0,a.j)(n[r])}}function u(t,e){const[,i,r]=e.match(/^(\w+?)\s*:\s*(.*)/i);let s=0;switch(i){case"Comment":s=2;break;case"Dialogue":s=1;break;case"Command":s=6;break;case"Movie":s=5;break;case"Picture":s=3;break;case"Sound":s=4}const l=h(t,r),c={type:s};for(let e=0;e<l.length;e++){c[t[e]]=l[e];const i=t[e],r=l[e].trim();switch(i){case"Layer":case"MarginL":case"MarginR":case"MarginV":c[i]=+r;break;case"Start":case"End":c[i]=(0,a.j)(r);break;case"Effect":c[i]=(0,n.d)(r);break;case"Text":c[i]=(0,o.r)(r);break;default:c[i]=r}}return c}},21071:(t,e,i)=>{"use strict";i.d(e,{_l:()=>r,gQ:()=>s});const r=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],s=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco"]},3384:(t,e,i)=>{"use strict";function r(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[]}}i.d(e,{A:()=>r})},9690:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(77231);function s(){return{isom:!1,timescale:r.N_,duration:r.Dh,foundMoov:!1,foundMdat:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:r.N_,volume:r.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},38106:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(77231);function s(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,timescale:0,duration:BigInt(0),trackId:r.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],fragIndexes:[],lastPts:BigInt(0),lastDts:BigInt(0),startDts:BigInt(0),startCT:0,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},79804:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(72739);function s(t,e){const i=t.getPos(),s=t.getPointer(),a=i-BigInt(Math.floor(s)),n=[];r.__(e.boxsPositionInfo,(e=>{e.pos<i&&e.pos>=a?(t.seekInline(s+Number(e.pos-i)),t.writeUint32(e.size)):n.push(e)})),r.__(n,(e=>{t.seek(e.pos),t.writeUint32(e.size)})),n.length?t.seek(i):t.seekInline(s),e.boxsPositionInfo=[]}},14202:(t,e,i)=>{"use strict";i.d(e,{BB:()=>s,Ip:()=>a,Jl:()=>r});const r={1:function(t){return[{type:"tkhd"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"smhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]},0:function(t){return[{type:"tkhd"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"vmhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]}},s={1:function(t){return[{type:"tkhd"},{type:"edts"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"smhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]},0:function(t){return[{type:"tkhd"},{type:"edts"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"vmhd"},t.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stss"},{type:"ctts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]}},a=[{type:"tfhd"},{type:"tfdt"},{type:"trun"}]},6660:(t,e,i)=>{"use strict";i.d(e,{Q9:()=>a,f3:()=>n,uf:()=>o,zs:()=>s});var r=i(65977);const s={86018:64,86017:105,86076:173,86028:193,86021:221,12:32,27:33,173:35,196:51,167:177,0:0},a={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},n={vide:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},o={[(0,r.A)("mp4a")]:86018,1836253269:86017,[(0,r.A)("Opus")]:86076,[(0,r.A)("fLaC")]:86028,[(0,r.A)("spex")]:86051,[(0,r.A)("SPXN")]:86051,[(0,r.A)("ac-3")]:86019,[(0,r.A)("sac3")]:86019,[r.A.mp4v]:12,[(0,r.A)("av01")]:225,[(0,r.A)("vp08")]:139,[(0,r.A)("vp09")]:167,[(0,r.A)("avc1")]:27,[(0,r.A)("hev1")]:173,[(0,r.A)("hvc1")]:173,[(0,r.A)("vvc1")]:196,[(0,r.A)("vvi1")]:196,[(0,r.A)("text")]:94213,[(0,r.A)("tx3g")]:94213}},75473:(t,e,i)=>{"use strict";i.d(e,{Ro:()=>u,dI:()=>d,l7:()=>c});var r=i(65977),s=i(21071),a=i(72739),n=i(80025),o=i(14202),l=i(79804);function c(t,e){t.flush();const i=t.getPointer(),s=t.getPos();t.writeUint32(0),t.writeUint32((0,r.A)("ftyp")),t.writeUint32(e.majorBrand||(0,r.A)("isom")),t.writeUint32(e.minorVersion||512),a.__(e.compatibleBrand,(e=>{t.writeUint32(e)})),function(t,e,i){const r=t.getPointer();t.seekInline(e),t.writeUint32(i),t.seekInline(r)}(t,i,Number(t.getPos()-s)),e.isom?(t.writeUint32(8),t.writeUint32((0,r.A)("wide"))):e.fragment||(t.writeUint32(8),t.writeUint32((0,r.A)("free")))}function h(t,e,i,o){a.__(e,(e=>{if(!e)return!0;if(n.A[e.type])n.A[e.type](t,i,o);else if(e.children){const s=t.getPos();t.writeUint32(0),t.writeUint32((0,r.A)(e.type)),h(t,e.children,i,o),o.boxsPositionInfo.push({pos:s,type:e.type,size:Number(t.getPos()-s)})}else!function(t,e){const i=a.zy(s._l,e);t.writeUint32(i?12:8),t.writeUint32((0,r.A)(e)),i&&t.writeUint32(0)}(t,e.type)}))}function d(t,e,i){const s=t.getPos();if(t.writeUint32(0),t.writeUint32((0,r.A)("moov")),n.A.mvhd(t,null,i),a.__(e.streams,(e=>{const s=t.getPos();t.writeUint32(0),t.writeUint32((0,r.A)("trak")),h(t,i.fragment?o.Jl[e.codecpar.codecType](i):o.BB[e.codecpar.codecType](i),e,i),i.boxsPositionInfo.push({pos:s,type:"trak",size:Number(t.getPos()-s)})})),i.fragment){const s=t.getPos();t.writeUint32(0),t.writeUint32((0,r.A)("mvex")),a.__(e.streams,(e=>{n.A.trex(t,e,i)})),i.boxsPositionInfo.push({pos:s,type:"mvex",size:Number(t.getPos()-s)})}i.boxsPositionInfo.push({pos:s,type:"moov",size:Number(t.getPos()-s)}),(0,l.A)(t,i)}function u(t,e,i){const s=t.getPos();t.writeUint32(0),t.writeUint32((0,r.A)("moof")),n.A.mfhd(t,null,i),a.__(i.currentFragment.tracks,(s=>{if(!s.sampleCount)return!0;const a=t.getPos();t.writeUint32(0),t.writeUint32((0,r.A)("traf"));const n=e.streams.find((t=>t.privData.trackId===s.trackId));h(t,o.Ip,n,i),i.boxsPositionInfo.push({pos:a,type:"traf",size:Number(t.getPos()-a)})}));const l=Number(t.getPos()-s);i.boxsPositionInfo.push({pos:s,type:"moof",size:l}),i.currentFragment.size=l}},39878:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(14686);function s(t,e,i){var s;t.writeUint32(null!==(s=8+e.codecpar.extradataSize)&&void 0!==s?s:0),t.writeString("av1C"),i.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,r.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},61600:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(14686);function s(t,e,i){var s;t.writeUint32(null!==(s=8+e.codecpar.extradataSize)&&void 0!==s?s:0),t.writeString("avcC"),i.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,r.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},93861:(t,e,i)=>{"use strict";function r(t,e,i){t.writeUint32(20),t.writeString("btrt"),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0)}i.d(e,{A:()=>r})},34445:(t,e,i)=>{"use strict";function r(t,e,i){const r=e.privData.chunkOffsets||[];t.writeUint32(8+8*r.length),t.writeString("co64"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(r.length);for(let e=0;e<r.length;e++)t.writeUint64(r[e])}i.d(e,{A:()=>r})},853:(t,e,i)=>{"use strict";function r(t,e,i){const r=e.sideData[28];if(r)t.writeUint32(12+r.length),t.writeString("colr"),t.writeString("prof"),t.writeBuffer(r);else{const i=2===e.codecpar.colorRange;t.writeUint32(19),t.writeString("colr"),t.writeString("nclx"),t.writeUint16(e.codecpar.colorPrimaries),t.writeUint16(e.codecpar.colorTrc),t.writeUint16(e.codecpar.colorSpace),t.writeUint8(i?128:0)}}i.d(e,{A:()=>r})},18387:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(4624),s="src/avformat/formats/mov/writing/ctts.ts";function a(t,e,i){const a=e.privData,n=a.cttsSampleCounts||[],o=a.cttsSampleOffsets||[];n.length!==o.length&&r.R8("ctts sampleCounts's length is not match sampleOffsets's length",s,39);const l=Math.min(n.length,o.length);t.writeUint32(16+8*l),t.writeString("ctts"),t.writeUint8(1),t.writeUint24(0),t.writeUint32(l);for(let e=0;e<l;e++)t.writeUint32(n[e]),t.writeInt32(o[e])}},80648:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(83314);function s(t,e,i){t.writeUint32(11),t.writeString("dac3");const s=new r.A(3),a=i.ac3Info;s.writeU(2,a.substream[0].fscod),s.writeU(5,a.substream[0].bsid),s.writeU(3,a.substream[0].bsmod),s.writeU(3,a.substream[0].acmod),s.writeU(1,a.substream[0].lfeon),s.writeU(5,a.ac3BitrateCode),s.writeU(5,0),t.writeBuffer(s.getBuffer())}},55668:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(83314);function s(t,e,i){const s=i.ac3Info,a=new r.A(2+(34*(s.numIndSub+1)+7>>3));a.writeU(13,s.dataRate),a.writeU(3,s.numIndSub);for(let t=0;t<s.numIndSub;t++)a.writeU(2,s.substream[t].fscod),a.writeU(5,s.substream[t].bsid),a.writeU(1,0),a.writeU(1,0),a.writeU(3,s.substream[t].bsmod),a.writeU(3,s.substream[t].acmod),a.writeU(1,s.substream[t].lfeon),a.writeU(5,0),a.writeU(4,s.substream[t].numDepSub),s.substream[t].numDepSub?a.writeU(9,s.substream[t].chanLoc):a.writeU(1,0);a.padding();const n=a.getPointer();t.writeUint32(8+n),t.writeString("dec3"),t.writeBuffer(a.getBuffer().subarray(0,n))}},47280:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(14686),s=i(4624),a="src/avformat/formats/mov/writing/dfla.ts";function n(t,e,i){let n;i.fragment&&e.sideData[1]?(n=e.sideData[1],delete e.sideData[1]):e.codecpar.extradata&&(n=(0,r.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),n?(t.writeUint32(n.length+16),t.writeString("dfLa"),t.writeUint8(0),t.writeUint24(0),t.writeUint8(128),t.writeUint24(n.length),t.writeBuffer(n)):s.z3("invalid extradata",a,56)}},82181:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(14686),s=i(31865);function a(t,e,i){let a;if(i.fragment&&e.sideData[1]?(a=e.sideData[1],delete e.sideData[1]):e.codecpar.extradata&&(a=(0,r.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),!a||a.length<19)t.writeUint32(19),t.writeString("dOps"),t.writeUint8(0),t.writeUint8(e.codecpar.chLayout.nbChannels),t.writeUint16(e.codecpar.initialPadding),t.writeUint32(e.codecpar.sampleRate),t.writeUint16(0),t.writeUint8(0);else{const e=new s.A(a,!1);t.writeUint32(a.length),t.writeString("dOps"),t.writeUint8(0),e.seek(9),t.writeUint8(e.readUint8()),t.writeUint16(e.readUint16()),t.writeUint32(e.readUint32()),t.writeUint16(e.readUint16()),t.writeBuffer(a.subarray(18))}}},12412:(t,e,i)=>{"use strict";function r(t,e,i){t.writeUint32(28),t.writeString("dref"),t.writeUint32(0),t.writeUint32(1),t.writeUint32(12),t.writeString("url "),t.writeUint32(1)}i.d(e,{A:()=>r})},44473:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(77231),s=i(44328);function a(t,e,i){const a=e.privData;let n=(0,s.k)(a.lastPts,e.timeBase,{den:i.timescale,num:1}),o=a.startCT;const l=(0,s.k)(a.startDts+BigInt(Math.floor(o)),e.timeBase,{den:a.timescale,num:1});let c=n<r.go?0:1;c|=l<r.go?0:1;const h=1+(l>0?1:0),d=24+h*(1===c?20:12);t.writeUint32(d),t.writeString("edts"),t.writeUint32(d-8),t.writeString("elst"),t.writeUint8(c),t.writeUint24(0),t.writeUint32(h),l>0?(1===c?(t.writeUint64(l),t.writeInt64(r.Dh)):(t.writeUint32(Number(l)),t.writeInt32(-1)),t.writeUint32(65536)):(o=-Math.min(Number(a.startDts),0),n+=l),i.fragment&&(n=BigInt(0)),1===c?(t.writeUint64(n),t.writeInt64(BigInt(Math.floor(o)))):(t.writeUint32(Number(n)),t.writeInt32(o)),t.writeUint32(65536)}},4652:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(6660),s=i(14686);function a(t,e,i){t.writeUint8(e);for(let e=3;e>0;e--)t.writeUint8(i>>7*e|128);t.writeUint8(127&i)}function n(t,e,i){const n=e.privData,o=e.codecpar.extradata?5+e.codecpar.extradataSize:0,l=t.getPos();t.writeUint32(0),t.writeString("esds"),t.writeUint32(0),a(t,3,21+o+5+1),t.writeUint16(n.trackId),t.writeUint8(0),a(t,4,13+o),(86016===e.codecpar.codecId||86017===e.codecpar.codecId)&&e.codecpar.sampleRate>24e3?t.writeUint8(107):t.writeUint8(r.zs[e.codecpar.codecId]),94208===e.codecpar.codecId?t.writeUint8(225):1===e.codecpar.codecType?t.writeUint8(21):t.writeUint8(17),t.writeUint24(0),t.writeUint32(0),t.writeUint32(0),e.codecpar.extradata&&(a(t,5,e.codecpar.extradataSize),t.writeBuffer((0,s.s3)(e.codecpar.extradata,e.codecpar.extradataSize))),a(t,6,1),t.writeUint8(2),i.boxsPositionInfo.push({pos:l,type:"esds",size:Number(t.getPos()-l)})}},87384:(t,e,i)=>{"use strict";function r(t,e,i,r,s,a,n){t.writeUint32(e<<16),t.writeUint32(i<<16),t.writeUint32(0),t.writeUint32(r<<16),t.writeUint32(s<<16),t.writeUint32(0),t.writeUint32(a<<16),t.writeUint32(n<<16),t.writeUint32(1073741824)}i.d(e,{A:()=>r})},17923:(t,e,i)=>{"use strict";function r(t,e,i){const r=t.getPos();t.writeUint32(0),t.writeString("hdlr"),t.writeUint8(0),t.writeUint24(0);let s="dhlr",a="url ",n="DataHandler";e&&(s="mhlr",1===e.codecpar.codecType?(a="soun",n="SoundHandler"):0===e.codecpar.codecType?(a="vide",n="VideoHandler"):3===e.codecpar.codecType?(a="text",n="SubtitleHandler"):(e.metadata.handlerName&&(n=e.metadata.handlerName),e.metadata.hdlrType&&(a=e.metadata.hdlrType))),t.writeString(s),t.writeString(a),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),e&&!i.isom||t.writeUint8(n.length),t.writeString(n),e&&!i.isom&&t.writeUint8(0),i.boxsPositionInfo.push({pos:r,type:"hdlr",size:Number(t.getPos()-r)})}i.d(e,{A:()=>r})},78669:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(14686);function s(t,e,i){var s;t.writeUint32(null!==(s=8+e.codecpar.extradataSize)&&void 0!==s?s:0),t.writeString("hvcC"),i.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,r.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},6e3:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(77231);function s(t,e,i){const s=e.privData.lastPts,a=e.metadata.creationTime||0,n=e.metadata.modificationTime||0,o=e.metadata.language||21956;let l=s<BigInt(r.f7)?0:1;l=a<r.f7?0:1,l=n<r.f7?0:1,t.writeUint32(1===l?44:32),t.writeString("mdhd"),t.writeUint8(l),t.writeUint24(0),1===l?(t.writeUint64(a),t.writeUint64(n)):(t.writeUint32(Number(a)),t.writeUint32(Number(n))),t.writeUint32(e.timeBase.den),1===l?t.writeUint64(s):t.writeUint32(Number(s)),t.writeUint16(o),t.writeUint16(0)}},31130:(t,e,i)=>{"use strict";function r(t,e,i){t.writeUint32(16),t.writeString("mfhd"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(i.currentFragment.sequence)}i.d(e,{A:()=>r})},48669:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(17923);function s(t,e,i){(0,r.A)(t,null,i)}},7114:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(77231),s=i(87384);function a(t,e,i){const a=i.duration,n=i.creationTime||0,o=i.modificationTime||0,l=i.timescale||0;let c=i.nextTrackId||1;i.fragment&&(c=2);let h=a<BigInt(r.f7)?0:1;h=n<r.f7?0:1,h=o<r.f7?0:1,t.writeUint32(1===h?120:108),t.writeString("mvhd"),t.writeUint8(h),t.writeUint24(0),1===h?(t.writeUint64(n),t.writeUint64(o)):(t.writeUint32(Number(n)),t.writeUint32(Number(o))),t.writeUint32(l),1===h?t.writeUint64(a):t.writeUint32(Number(a)),t.writeUint32(65536),t.writeUint16(256),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),(0,s.A)(t,1,0,0,1,0,0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(c)}},65629:(t,e,i)=>{"use strict";function r(t,e,i){t.writeUint32(16),t.writeString("pasp"),t.writeUint32(1),t.writeUint32(1)}i.d(e,{A:()=>r})},11573:(t,e,i)=>{"use strict";function r(t,e,i){t.writeUint32(16),t.writeString("smhd"),t.writeUint32(0),t.writeUint16(0),t.writeUint16(0)}i.d(e,{A:()=>r})},2204:(t,e,i)=>{"use strict";function r(t,e,i){const r=e.privData.chunkOffsets||[];t.writeUint32(16+4*r.length),t.writeString("stco"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(r.length);for(let e=0;e<r.length;e++)t.writeUint32(Number(r[e]))}i.d(e,{A:()=>r})},84360:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(4624),s="src/avformat/formats/mov/writing/stsc.ts";function a(t,e,i){const a=e.privData,n=a.stscFirstChunk,o=a.stscSamplesPerChunk,l=a.stscSampleDescriptionIndex;n.length===o.length&&n.length===l.length||r.R8("ctts firstChunk's length is not match samplesPerChunk's length or sampleDescriptionIndex's length",s,42);const c=Math.min(n.length,o.length,l.length);t.writeUint32(16+12*c),t.writeString("stsc"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(c);for(let e=0;e<c;e++)t.writeUint32(n[e]),t.writeUint32(o[e]),t.writeUint32(l[e])}},69301:(t,e,i)=>{"use strict";i.d(e,{A:()=>x});var r=i(61600),s=i(78669),a=i(1263),n=i(99193),o=i(39878),l=i(47280),c=i(82181),h=i(4652),d=i(853),u=i(65629),f=i(93861),p=i(57756),m=i(80648),g=i(55668),v=i(14686),y=i(61619);const A={27:"avc1",173:"hvc1",196:"vvc1",225:"av01",167:"vp09",86019:"ac-3",86056:"ec-3"};function b(t){if(t.codecTag)return(0,y.A)(t.codecTag);let e=A[t.codecId];return e||(e=0===t.codecType?"mp4v":1===t.codecType?86076===t.codecId?"Opus":86028===t.codecId?"fLaC":"mp4a":3===t.codecType?"text":"none"),e}function x(t,e,i){const y=t.getPos();t.writeUint32(0),t.writeString("stsd"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(1),1===e.codecpar.codecType?function(t,e,i){const r=t.getPos(),s=b(e.codecpar),a=i.isom?1:0;t.writeUint32(0),t.writeString(s),t.writeUint32(0),t.writeUint16(0),t.writeUint16(1),t.writeUint16(a),t.writeUint16(0),t.writeUint32(0),i.isom?(t.writeUint16(e.codecpar.chLayout.nbChannels),65541===e.codecpar.codecId||65540===e.codecpar.codecId?t.writeUint16(8):69643===e.codecpar.codecId?t.writeUint16(e.codecpar.bitsPerCodedSample):t.writeUint16(16),t.writeUint16(-2)):(86028===e.codecpar.codecId||86032===e.codecpar.codecId||86076===e.codecpar.codecId?t.writeUint16(e.codecpar.chLayout.nbChannels):t.writeUint16(2),86028===e.codecpar.codecId||86032===e.codecpar.codecId?t.writeUint16(e.codecpar.bitsPerCodedSample):t.writeUint16(16),t.writeUint16(0)),t.writeUint16(0),86076===e.codecpar.codecId?t.writeUint16(48e3):86060===e.codecpar.codecId?t.writeUint32(e.codecpar.sampleRate):t.writeUint16(e.codecpar.sampleRate),86060!==e.codecpar.codecId&&t.writeUint16(0),1===a&&(t.writeUint32(e.codecpar.frameSize),t.writeUint32(0),t.writeUint32(0),t.writeUint32(2)),!i.isom||86018!==e.codecpar.codecId&&86019!==e.codecpar.codecId&&86056!==e.codecpar.codecId&&73728!==e.codecpar.codecId&&86032!==e.codecpar.codecId&&69638!==e.codecpar.codecId&&69633!==e.codecpar.codecId&&86035!==e.codecpar.codecId?86028===e.codecpar.codecId?(0,l.A)(t,e,i):86076===e.codecpar.codecId?(0,c.A)(t,e,i):86019===e.codecpar.codecId?(0,m.A)(t,e,i):86056===e.codecpar.codecId?(0,g.A)(t,e,i):"mp4a"==s&&(0,h.A)(t,e,i):(0,p.A)(t,e,i),i.isom||(0,f.A)(t,e,i),i.boxsPositionInfo.push({pos:r,type:s,size:Number(t.getPos()-r)})}(t,e,i):0===e.codecpar.codecType?function(t,e,i){const l=t.getPos(),c=b(e.codecpar),p=13==e.codecpar.codecId&&15==e.codecpar.format||13==e.codecpar.codecId&&1==e.codecpar.format||202==e.codecpar.codecId||203==e.codecpar.codecId||156==e.codecpar.codecId||127==e.codecpar.codecId;t.writeUint32(0),t.writeString(c),t.writeUint32(0),t.writeUint16(0),t.writeUint16(1),t.writeUint16(p?2:0),t.writeUint16(0),i.isom?(t.writeString("FFMP"),13===e.codecpar.codecId||p?(t.writeUint32(0),t.writeUint32(1024)):(t.writeUint32(512),t.writeUint32(512))):(t.writeUint32(0),t.writeUint32(0),t.writeUint32(0)),t.writeUint16(e.codecpar.width),t.writeUint16(e.codecpar.height),t.writeUint32(4718592),t.writeUint32(4718592),t.writeUint32(0),t.writeUint16(1);let m=e.metadata.compressorName||"";if(m=m.slice(0,31),t.writeUint8(m.length),t.writeString(m),m.length<31){let e=31-m.length;for(;e>0;)t.writeUint8(0),e--}i.isom&&e.codecpar.bitsPerCodedSample?t.writeUint16(e.codecpar.bitsPerCodedSample):t.writeUint16(24),t.writeUint16(65535),"mp4v"===c?(0,h.A)(t,e,i):27===e.codecpar.codecId?(0,r.A)(t,e,i):173===e.codecpar.codecId?(0,s.A)(t,e,i):196===e.codecpar.codecId?(0,a.A)(t,e,i):167===e.codecpar.codecId?(0,n.A)(t,e,i):225===e.codecpar.codecId&&(0,o.A)(t,e,i),(0,d.A)(t,e,i),(0,u.A)(t,e,i),i.isom||(0,f.A)(t,e,i),i.boxsPositionInfo.push({pos:l,type:c,size:Number(t.getPos()-l)})}(t,e,i):3===e.codecpar.codecType&&function(t,e,i){const r=t.getPos(),s=b(e.codecpar);t.writeUint32(0),t.writeString(s),t.writeUint32(0),t.writeUint16(0),t.writeUint16(1),94208===e.codecpar.codecId?(0,h.A)(t,e,i):e.codecpar.extradata&&t.writeBuffer((0,v.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),i.isom||(0,f.A)(t,e,i),i.boxsPositionInfo.push({pos:r,type:s,size:Number(t.getPos()-r)})}(t,e,i),i.boxsPositionInfo.push({pos:y,type:"esds",size:Number(t.getPos()-y)})}},20184:(t,e,i)=>{"use strict";function r(t,e,i){const r=e.privData.stssSampleNumbers;t.writeUint32(16+4*r.length),t.writeString("stss"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(r.length);for(let e=0;e<r.length;e++)t.writeUint32(r[e])}i.d(e,{A:()=>r})},57247:(t,e,i)=>{"use strict";function r(t,e,i){const r=e.privData.sampleSizes;t.writeUint32(20+4*r.length),t.writeString("stsz"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(0),t.writeUint32(r.length);for(let e=0;e<r.length;e++)t.writeUint32(r[e])}i.d(e,{A:()=>r})},86051:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(4624),s="src/avformat/formats/mov/writing/stts.ts";function a(t,e,i){const a=e.privData,n=a.sttsSampleCounts||[],o=a.sttsSampleDeltas||[];n.length!==o.length&&r.R8("stts sampleCounts's length is not match sampleDeltas's length",s,39);const l=Math.min(n.length,o.length);t.writeUint32(16+8*l),t.writeString("stts"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(l);for(let e=0;e<l;e++)t.writeUint32(n[e]),t.writeInt32(o[e])}},11251:(t,e,i)=>{"use strict";function r(t,e,i){const r=i.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId)),s=r?r.baseMediaDecodeTime:BigInt(0);t.writeUint32(20),t.writeString("tfdt"),t.writeUint8(1),t.writeUint24(0),t.writeUint64(s)}i.d(e,{A:()=>r})},11903:(t,e,i)=>{"use strict";function r(t,e,i){const r=i.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId));let s=57;r.baseIsMoof&&(s&=-2,s|=131072);const a=t.getPos();t.writeUint32(0),t.writeString("tfhd"),t.writeUint8(0),t.writeUint24(s),t.writeUint32(r.trackId),1&s&&t.writeUint64(r.baseDataOffset),8&s&&t.writeUint32(r.defaultSampleDuration),16&s&&t.writeUint32(r.defaultSampleSize),32&s&&t.writeUint32(r.defaultSampleFlags),i.boxsPositionInfo.push({pos:a,type:"tfhd",size:Number(t.getPos()-a)})}i.d(e,{A:()=>r})},59868:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(77231),s=i(87384),a=i(44328);function n(t,e,i){const n=e.privData,o=(0,a.k)(n.lastPts,e.timeBase,{den:i.timescale,num:1}),l=e.metadata.creationTime||0,c=e.metadata.modificationTime||0,h=n.layer||0,d=n.alternateGroup||0;let u=e.codecpar.width>0?e.codecpar.width:0,f=e.codecpar.height>0?e.codecpar.height:0;u<r.zg&&(u<<=16),f<r.zg&&(f<<=16);let p=o<BigInt(r.f7)?0:1;p=l<r.f7?0:1,p=c<r.f7?0:1;let m=2;1&n.flags&&(m|=1),t.writeUint32(1===p?100:92),t.writeString("tkhd"),t.writeUint8(p),t.writeUint24(m),1===p?(t.writeUint64(l),t.writeUint64(c)):(t.writeUint32(Number(l)),t.writeUint32(Number(c))),t.writeUint32(n.trackId),t.writeUint32(0),1===p?t.writeUint64(o):t.writeUint32(Number(o)),t.writeUint32(0),t.writeUint32(0),t.writeInt16(h),t.writeInt16(n.perStreamGrouping?d:e.codecpar.codecType),1===e.codecpar.codecType?t.writeInt16(256):t.writeInt16(0),t.writeInt16(0),(0,s.A)(t,1,0,0,1,0,0),t.writeUint32(u),t.writeUint32(f)}},35010:(t,e,i)=>{"use strict";function r(t,e,i){var r,s,a;const n=i.currentFragment.tracks.find((t=>t.trackId===e.privData.trackId)),o=i.trexs.find((t=>{t.trackId,e.privData.trackId})),l=null!==(r=null==o?void 0:o.duration)&&void 0!==r?r:0,c=null!==(s=null==o?void 0:o.size)&&void 0!==s?s:0,h=null!==(a=null==o?void 0:o.flags)&&void 0!==a?a:0;t.writeUint32(32),t.writeString("trex"),t.writeUint8(0),t.writeUint24(0),t.writeUint32(n.trackId),t.writeUint32(1),t.writeUint32(l),t.writeUint32(c),t.writeUint32(h)}i.d(e,{A:()=>r})},48516:(t,e,i)=>{"use strict";function r(t,e,i){const r=e.privData,s=i.currentFragment.tracks.find((t=>t.trackId===r.trackId)),a=s.firstSampleFlags||0,n=s.dataOffset||0,o=s.sampleDurations,l=s.sampleSizes,c=s.sampleFlags,h=s.sampleCompositionTimeOffset,d=s.sampleCount,u=o.length>0,f=l.length>0,p=c.length>0,m=h.length>0,g=0!==a;let v=1;g&&(v|=4),u&&(v|=256),f&&(v|=512),p&&(v|=1024),m&&(v|=2048);const y=t.getPos();t.writeUint32(0),t.writeString("trun"),t.writeUint8(1),t.writeUint24(v),t.writeUint32(d),s.dataOffsetPos=t.getPos(),t.writeInt32(n),g&&t.writeUint32(a);for(let e=0;e<d;e++)u&&t.writeUint32(o[e]||0),f&&t.writeUint32(l[e]||0),p&&t.writeUint32(c[e]||0),m&&t.writeInt32(h[e]||0);i.boxsPositionInfo.push({pos:y,type:"trun",size:Number(t.getPos()-y)})}i.d(e,{A:()=>r})},54012:(t,e,i)=>{"use strict";function r(t,e,i){t.writeUint32(20),t.writeString("vmhd"),t.writeUint8(0),t.writeUint24(1),t.writeUint64(BigInt(0))}i.d(e,{A:()=>r})},99193:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(14686);function s(t,e,i){var s;t.writeUint32(null!==(s=12+e.codecpar.extradataSize)&&void 0!==s?s:0),t.writeString("vpcC"),t.writeUint8(1),t.writeUint24(0),i.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,r.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},1263:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(14686);function s(t,e,i){var s;t.writeUint32(null!==(s=8+e.codecpar.extradataSize)&&void 0!==s?s:0),t.writeString("vvcC"),t.writeUint8(0),t.writeUint24(0),i.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,r.s3)(e.codecpar.extradata,e.codecpar.extradataSize))}},57756:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(14686),s=i(4652);function a(t,e,i){const a=t.getPos();t.writeUint32(0),t.writeString("wave"),86035!==e.codecpar.codecId&&(t.writeUint32(12),t.writeString("frma"),t.writeUint32(e.codecpar.codecTag)),86018===e.codecpar.codecId?(t.writeUint32(12),t.writeString("mp4a"),t.writeUint32(0),(0,s.A)(t,e,i)):i.fragment&&e.sideData[1]?(t.writeBuffer(e.sideData[1]),delete e.sideData[1]):e.codecpar.extradata&&t.writeBuffer((0,r.s3)(e.codecpar.extradata,e.codecpar.extradataSize)),t.writeUint32(8),t.writeUint32(0),i.boxsPositionInfo.push({pos:a,type:"wave",size:Number(t.getPos()-a)})}},80025:(t,e,i)=>{"use strict";i.d(e,{A:()=>S});var r=i(86051),s=i(18387),a=i(20184),n=i(57247),o=i(84360),l=i(2204),c=i(34445),h=i(6e3),d=i(7114),u=i(59868),f=i(17923),p=i(69301),m=i(54012),g=i(44473),v=i(11573),y=i(12412),A=i(35010),b=i(31130),x=i(11903),w=i(11251),k=i(48516),T=i(48669);const S={stts:r.A,ctts:s.A,stss:a.A,stsz:n.A,stsc:o.A,stco:l.A,co64:c.A,mdhd:h.A,mvhd:d.A,tkhd:u.A,hdlr:f.A,stsd:p.A,vmhd:m.A,edts:g.A,smhd:v.A,dref:y.A,trex:A.A,mfhd:b.A,tfhd:x.A,tfdt:w.A,trun:k.A,minf_hdlr:T.A}},38115:(t,e,i)=>{"use strict";i.d(e,{q:()=>o});var r=i(79331),s=i(67672),a=i(72739),n=i(54825);function o(t){const e=(0,r.A)(t,{aloneValueName:"context"});if(!e.tt)return{queue:[],head:{}};const i=[];function o(t){let e="";return a.__(t,(t=>{s.Yj(t)?e+=t:t.context?e+=`<${t.tagName}>${t.context}</${t.tagName}>`:e+=`<${t.tagName}/>`})),e}function l(t,e,r){var a;const l=(0,n.j)(e||t.begin);let c=t.context||"",h=t.region||"Default";s.YO(c)&&(c=o(c)),null!==(a=t.span)&&void 0!==a&&a.context&&(t.span.region&&(h=t.span.region),s.Yj(t.span.context)?c+=t.span.context:c+=o(t.span.context)),i.push({context:c,pts:l,region:h,duration:t.dur?(0,n.j)(t.dur):(0,n.j)(r||t.end)-l})}function c(t,e,i){s.YO(t)?a.__(t,(t=>{l(t,e,i)})):l(t,e,i)}return e.tt.body&&e.tt.body.div&&(s.YO(e.tt.body.div)?a.__(e.tt.body.div,(t=>{t.p&&c(t.p,t.begin,t.end)})):e.tt.body.div.p&&c(e.tt.body.div.p,e.tt.body.div.begin,e.tt.body.end)),{queue:i,head:e.tt.head||{}}}},59989:(t,e,i)=>{"use strict";function r(t,e=0){if(!t)return!1;if(t.length<2)return!0;let i=t[e],r=e+1;for(;r<t.length&&i===t[r];r++);return r===t.length}i.d(e,{A:()=>r})},31425:(t,e,i)=>{"use strict";i.d(e,{$:()=>n});var r=i(77231),s=i(72739),a=i(44328);function n(t){let e=!0;return s.__(t.streams,(t=>{switch(t.codecpar.codecType){case 1:t.codecpar.chLayout.nbChannels!==r.N_&&t.codecpar.sampleRate!==r.N_&&t.codecpar.frameSize!==r.N_&&t.codecpar.bitrate!==BigInt(0)||(e=!1);break;case 0:0!==(0,a.lb)(t.codecpar.framerate)&&t.codecpar.width!==r.N_&&t.codecpar.height!==r.N_&&t.codecpar.bitrate!==BigInt(0)||(e=!1),27!==t.codecpar.codecId&&173!==t.codecpar.codecId&&196!==t.codecpar.codecId&&12!==t.codecpar.codecId||t.codecpar.profile!==r.N_&&t.codecpar.level!==r.N_||(e=!1)}})),e}},61619:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(67672);function s(t,e=4){let i="";for(let s=0;s<e;s++)r.ai(t)?(i=String.fromCharCode(255&t)+i,t>>>=8):(i=String.fromCharCode(Number(t&BigInt(255)))+i,t>>=BigInt(8));return i}},65977:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(4624),s="src/avformat/function/mktag.ts";function a(t){4!==t.length&&r.R8(`tag length is not 4, tag: ${t}`,s,30);let e=0;for(let i=0;i<4;i++)e=e<<8|t.charCodeAt(i);return e}},20841:(t,e,i)=>{"use strict";function r(t,e,i,r){const s=t.getPos(),a=t.getPointer(),n=s-BigInt(Math.floor(a));let o=!1;switch(e<s&&e>=n?(t.seekInline(a+Number(e-s)),o=!0):t.seek(e),r){case"uint8":t.writeUint8(255&i);break;case"int8":t.writeInt8(i);break;case"uint16":t.writeUint16(65535&i);break;case"int16":t.writeInt16(i);break;case"uint32":t.writeUint32(i>>>0);break;case"int32":t.writeInt32(i);break;case"uint64":t.writeUint64(BigInt.asUintN(64,i));break;case"int64":t.writeInt64(i);break;case"float":t.writeFloat(i);break;case"double":t.writeDouble(i)}o?t.seekInline(a):t.seek(s)}i.d(e,{A:()=>r})},92174:(t,e,i)=>{"use strict";i.d(e,{XA:()=>v,bX:()=>A,bx:()=>g,dJ:()=>y,ho:()=>m});var r=i(80662),s=i.n(r),a=i(63939),n=i(50932),o=i(95335),l=i(4624),c=i(51597),h=i(72739),d=i(9705),u=i(548),f="src/avformat/mux.ts";const p={paddingZero:!1};function m(t,e={}){const i=o.X$({},p,e);t.ioWriter||l.h2("need ioWriter",f,52),t.oformat||l.h2("need oformat",f,55),t.options=i,t.processPrivateData={first:new(s())};let r=c.E[t.oformat.type];if(r)for(let e=0;e<t.streams.length;e++){const i=t.streams[e].codecpar.codecId;if(14===t.oformat.type){if(i<65536||i>69683)return l.z3(`format ${(0,u.L_)(t.oformat.type)} not support codecId ${(0,u.eG)(t.streams[e].codecpar.codecType,i)}`,f,71),d.r8}else if(!h.zy(r,i))return l.z3(`format ${(0,u.L_)(t.oformat.type)} not support codecId ${(0,u.eG)(t.streams[e].codecpar.codecType,i)}`,f,76),d.r8}return t.oformat.init(t)}function g(t){return t.oformat.writeHeader(t),0}function v(t,e){const i=t.processPrivateData;return i.first.has(a.f[15](e+32))||(a.f[17](e+16)>BigInt(0)?i.first.set(a.f[15](e+32),a.f[17](e+16)):i.first.set(a.f[15](e+32),BigInt(0))),t.options.paddingZero&&(n.M[17](e+16,a.f[17](e+16)-i.first.get(a.f[15](e+32))),n.M[17](e+8,a.f[17](e+8)-i.first.get(a.f[15](e+32)))),t.oformat.writeAVPacket(t,e)}function y(t){return t.oformat.writeTrailer(t),0}function A(t){t.oformat.flush(t)}},70509:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(134);class s{constructor(){(0,r.A)(this,"onFlush",void 0)}}},97801:(t,e,i)=>{"use strict";i.d(e,{A:()=>f});var r=i(134),s=i(70509),a=i(13258),n=i(51678),o=i(13724),l=i(4624),c="src/avnetwork/bsp/aes/AESDecryptPipe.ts";const h=16;let d=!0;const u=new Uint8Array(h).fill(h);class f extends s.A{constructor(t=1048576){super(),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"aesSoftDecryptor",void 0),(0,r.A)(this,"aesWebDecryptor",void 0),(0,r.A)(this,"aesTargetDecryptor",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"endPointer",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"iv",void 0),(0,r.A)(this,"key",void 0),this.size=t,this.pointer=0,this.endPointer=0,this.ended=!1,this.buffer=new Uint8Array(t),this.aesSoftDecryptor=new a.A,n.A.isSupport()&&d&&(this.aesWebDecryptor=new n.A),this.aesTargetDecryptor=this.aesWebDecryptor||this.aesSoftDecryptor}remainingLength(){return this.endPointer-this.pointer}async expandKey(t,e){this.key=t,this.iv=e,this.aesWebDecryptor&&await this.aesWebDecryptor.expandKey(t),this.aesSoftDecryptor.expandKey(t)}async flush_(t){for(;;){const e=await this.onFlush(t);if(-1048575!==e)return e;await new o.A(0)}}async flush(){if(this.size-this.remainingLength()<=0)return;this.pointer<this.endPointer?this.pointer&&(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer):this.endPointer=0,this.pointer=0;const t=await this.flush_(this.buffer.subarray(this.endPointer));if(t<0){if(-1048576===t)return void(this.ended=!0);l.h2(`AESPipe error, flush failed, ret: ${t}`,c,120)}this.endPointer+=t}removePadding(t){const e=t.length,i=e&&new DataView(t.buffer).getUint8(e-1);return i?t.subarray(0,e-i):t}async decrypt(t){let e,i=0;this.aesTargetDecryptor!==this.aesWebDecryptor||this.ended||(e=this.buffer.subarray(this.pointer+t,this.pointer+t+h).slice(),this.buffer.set((await this.aesWebDecryptor.encryptPadding(u,this.buffer.subarray(this.pointer+t-h,this.pointer+t))).subarray(0,h),this.pointer+t),i=h);try{const r=this.buffer.subarray(this.pointer,this.pointer+t+i),s=await this.aesTargetDecryptor.decrypt(r,this.iv);return this.iv=r.slice(r.length-h-i,r.length-i).buffer,e&&this.buffer.set(e,this.pointer+t),this.pointer+=t,new Uint8Array(s)}catch(i){if(this.aesTargetDecryptor=this.aesWebDecryptor)return l.R8("web aes decrypt failed, try to use soft decryptor",c,169),e&&this.buffer.set(e,this.pointer+t),this.aesTargetDecryptor=this.aesSoftDecryptor,d=!1,this.decrypt(t);l.h2("aes decrypt failed",c,179)}}async read(t){for(;!this.ended&&this.remainingLength()<48;)await this.flush();if(0===this.remainingLength())return-1048576;const e=Math.min(Math.floor((this.remainingLength()-(this.ended?0:32))/h)*h,t.length);let i=await this.decrypt(e);return this.ended&&this.aesTargetDecryptor===this.aesSoftDecryptor&&(i=this.removePadding(i)),t.set(i),i.length}}},49847:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(82800);class s extends r.A{constructor(){super()}get ext(){throw new Error("need implemented ext getter")}get name(){return"CustomIOLoader."+Math.random()}get minBuffer(){throw new Error("need implemented minBuffer getter")}}},41576:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>v});var r=i(134),s=i(80662),a=i.n(s),n=i(54001),o=i.n(n),l=i(13724),c=i(82800),h=i(95335),d=i(4624),u=i(78417),f=i(77580),p=i(86932),m=i(9705),g="src/avnetwork/ioLoader/DashIOLoader.ts";class v extends c.A{constructor(...t){super(...t),(0,r.A)(this,"info",void 0),(0,r.A)(this,"range",void 0),(0,r.A)(this,"mediaPlayList",void 0),(0,r.A)(this,"fetchMediaPlayListPromise",void 0),(0,r.A)(this,"minBuffer",void 0),(0,r.A)(this,"audioResource",void 0),(0,r.A)(this,"videoResource",void 0),(0,r.A)(this,"subtitleResource",void 0)}createResource(t){return{type:t,fetchedMap:new(a()),fetchedHistoryList:[],loader:null,segmentIndex:0,currentUri:"",selectedIndex:0,segments:[],initSegmentPadding:"",initedSegment:""}}async fetchMediaPlayList(t){if(!t){if(this.fetchMediaPlayListPromise)return;this.fetchMediaPlayListPromise=new(o())((e=>{t=e}))}const e={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};this.info.headers&&h.__(this.info.headers,((t,i)=>{e.headers[i]=t})),this.info.withCredentials&&(e.credentials="include"),this.info.referrerPolicy&&(e.referrerPolicy=this.info.referrerPolicy);try{const s=await fetch(this.info.url,e),a=await s.text();if(this.mediaPlayList=(0,u.A)(a,this.info.url),this.minBuffer=this.mediaPlayList.minBufferTime,this.options.isLive){var i,r;const e=this.mediaPlayList.minBufferTime/this.mediaPlayList.maxSegmentDuration,s=Math.max(this.mediaPlayList.mediaList.audio&&(null===(i=this.mediaPlayList.mediaList.audio[0])||void 0===i?void 0:i.mediaSegments.length)||0,this.mediaPlayList.mediaList.video&&(null===(r=this.mediaPlayList.mediaList.video[0])||void 0===r?void 0:r.mediaSegments.length)||0);if(s<e)return await new l.A((e-s)*this.mediaPlayList.maxSegmentDuration),d.R8(`wait for min buffer time, buffer: ${s*this.mediaPlayList.maxSegmentDuration}, need: ${e*this.mediaPlayList.maxSegmentDuration}`,g,143),this.fetchMediaPlayList(t)}if("vod"===this.mediaPlayList.type?this.options.isLive=!1:this.options.isLive=!0,this.mediaPlayList.mediaList.audio.length){const t=this.mediaPlayList.mediaList.audio[this.audioResource.selectedIndex];t.file?this.audioResource.segments=[t.file]:this.options.isLive&&this.audioResource.initedSegment===t.initSegment?this.audioResource.segments=t.mediaSegments.map((t=>t.url)):(this.audioResource.segments=[t.initSegment].concat(t.mediaSegments.map((t=>t.url))),this.audioResource.initedSegment=t.initSegment)}if(this.mediaPlayList.mediaList.video.length){const t=this.mediaPlayList.mediaList.video[this.videoResource.selectedIndex];t.file?this.videoResource.segments=[t.file]:this.options.isLive&&this.videoResource.initedSegment===t.initSegment?this.videoResource.segments=t.mediaSegments.map((t=>t.url)):(this.videoResource.segments=[t.initSegment].concat(t.mediaSegments.map((t=>t.url))),this.videoResource.initedSegment=t.initSegment)}if(this.mediaPlayList.mediaList.subtitle.length){const t=this.mediaPlayList.mediaList.subtitle[this.subtitleResource.selectedIndex];t.file?this.subtitleResource.segments=[t.file]:this.options.isLive&&this.subtitleResource.initedSegment===t.initSegment?this.subtitleResource.segments=t.mediaSegments.map((t=>t.url)):(this.subtitleResource.segments=[t.initSegment].concat(t.mediaSegments.map((t=>t.url))),this.subtitleResource.initedSegment=t.initSegment)}return t(),this.fetchMediaPlayListPromise=null,this.status=2,this.retryCount=0,this.mediaPlayList}catch(e){if(this.retryCount<this.options.retryCount)return this.retryCount++,d.z3(`failed fetch mpd file, retry(${this.retryCount}/3)`,g,215),await new l.A(2===this.status?this.options.retryInterval:5),this.fetchMediaPlayList(t);this.status=3,t(),d.h2(`DashLoader: exception, fetch slice error, error: ${e.message}`,g,223)}}async open(t,e){return 0!==this.status?m.lh:(this.info=t,this.range=e,this.range.to||(this.range.to=-1),this.range.from=Math.max(this.range.from,0),this.videoResource=this.createResource("video"),this.audioResource=this.createResource("audio"),this.subtitleResource=this.createResource("subtitle"),this.status=1,this.retryCount=0,await this.fetchMediaPlayList(),0)}async readResource(t,e){let i=0;if(e.loader){if(i=await e.loader.read(t),-1048576!==i)return i;if(this.options.isLive)e.fetchedMap.set(e.currentUri,!0),10===e.fetchedHistoryList.length&&e.fetchedMap.delete(e.fetchedHistoryList.shift()),e.fetchedHistoryList.push(e.currentUri);else if(e.segmentIndex++,e.segmentIndex>=e.segments.length)return-1048576;e.loader=null}if(this.options.isLive){const i=e.segments.filter((t=>!e.fetchedMap.get(t)));if(!i.length){if(this.mediaPlayList.isEnd)return-1048576;const i=(this.mediaPlayList.duration||this.mediaPlayList.minimumUpdatePeriod)-((0,p.A)()-this.mediaPlayList.timestamp)/1e3;if(i>0&&await new l.A(Math.max(i,2)),this.fetchMediaPlayListPromise){if(await this.fetchMediaPlayListPromise,3===this.status)return-1048576}else await this.fetchMediaPlayList();return this.readResource(t,e)}return e.currentUri=i[0],e.loader=new f.A(h.X$({},this.options,{disableSegment:!0,loop:!1})),await e.loader.open({url:e.currentUri},{from:0,to:-1}),e.loader.read(t)}return e.loader=new f.A(h.X$({},this.options,{disableSegment:!0,loop:!1})),e.initSegmentPadding?(await e.loader.open({url:e.initSegmentPadding},{from:0,to:-1}),e.initSegmentPadding=null,e.segmentIndex--):await e.loader.open({url:e.segments[e.segmentIndex]},{from:0,to:-1}),e.loader.read(t)}async read(t,e){return"audio"===e.mediaType?this.readResource(t,this.audioResource):"video"===e.mediaType?this.readResource(t,this.videoResource):"subtitle"===e.mediaType?this.readResource(t,this.subtitleResource):m.UY}async seekResource(t,e){e.loader&&(await e.loader.abort(),e.loader=null);let i=Number(BigInt.asIntN(32,t));if(e.segments){let t=0;const r="audio"===e.type?this.mediaPlayList.mediaList.audio:"video"===e.type?this.mediaPlayList.mediaList.video:this.mediaPlayList.mediaList.subtitle,s=r[e.selectedIndex].mediaSegments;if(null!=s&&s.length)for(let e=0;e<s.length;e++)if(i>=1e3*s[e].start&&i<1e3*s[e].end){t=e;break}e.segmentIndex=t+(r[e.selectedIndex].initSegment?1:0)}}async seek(t,e){return"audio"===e.mediaType&&this.audioResource.loader&&await this.seekResource(t,this.audioResource),"video"===e.mediaType&&this.videoResource.loader&&await this.seekResource(t,this.videoResource),"subtitle"===e.mediaType&&this.subtitleResource.loader&&await this.seekResource(t,this.subtitleResource),4===this.status&&(this.status=2),0}async size(){return BigInt(0)}async abort(){this.videoResource.loader&&(await this.videoResource.loader.abort(),this.videoResource.loader=null),this.audioResource.loader&&(await this.audioResource.loader.abort(),this.audioResource.loader=null),this.subtitleResource.loader&&(await this.subtitleResource.loader.abort(),this.subtitleResource.loader=null)}async stop(){await this.abort(),this.status=0}getDuration(){return this.mediaPlayList.duration}hasVideo(){var t;return(null===(t=this.mediaPlayList)||void 0===t?void 0:t.mediaList.video.length)>0}hasAudio(){var t;return(null===(t=this.mediaPlayList)||void 0===t?void 0:t.mediaList.audio.length)>0}hasSubtitle(){var t;return(null===(t=this.mediaPlayList)||void 0===t?void 0:t.mediaList.subtitle.length)>0}getVideoList(){return this.hasVideo()?{list:this.mediaPlayList.mediaList.video.map((t=>({width:t.width,height:t.height,frameRate:t.frameRate,codecs:t.codecs}))),selectedIndex:this.videoResource.selectedIndex}:{list:[],selectedIndex:0}}getAudioList(){return this.hasAudio()?{list:this.mediaPlayList.mediaList.audio.map((t=>({lang:t.lang,codecs:t.codecs}))),selectedIndex:this.audioResource.selectedIndex}:{list:[],selectedIndex:0}}getSubtitleList(){return this.hasSubtitle()?{list:this.mediaPlayList.mediaList.subtitle.map((t=>({lang:t.lang,codecs:t.codecs}))),selectedIndex:this.subtitleResource.selectedIndex}:{list:[],selectedIndex:0}}selectVideo(t){if(t!==this.videoResource.selectedIndex&&this.hasVideo()&&t>=0&&t<this.mediaPlayList.mediaList.video.length){this.videoResource.selectedIndex=t;const e=this.mediaPlayList.mediaList.video[this.videoResource.selectedIndex];e.file?this.videoResource.segments=[e.file]:(this.videoResource.segments=[e.initSegment].concat(e.mediaSegments.map((t=>t.url))),this.videoResource.initSegmentPadding=e.initSegment)}}selectAudio(t){if(t!==this.audioResource.selectedIndex&&this.hasAudio()&&t>=0&&t<this.mediaPlayList.mediaList.audio.length){this.audioResource.selectedIndex=t;const e=this.mediaPlayList.mediaList.audio[this.audioResource.selectedIndex];e.file?this.audioResource.segments=[e.file]:(this.audioResource.segments=[e.initSegment].concat(e.mediaSegments.map((t=>t.url))),this.audioResource.initSegmentPadding=e.initSegment)}}selectSubtitle(t){if(t!==this.subtitleResource.selectedIndex&&this.hasSubtitle()&&t>=0&&t<this.mediaPlayList.mediaList.subtitle.length){this.subtitleResource.selectedIndex=t;const e=this.mediaPlayList.mediaList.subtitle[this.subtitleResource.selectedIndex];e.file?this.subtitleResource.segments=[e.file]:(this.subtitleResource.segments=[e.initSegment].concat(e.mediaSegments.map((t=>t.url))),this.subtitleResource.initSegmentPadding=e.initSegment)}}getMinBuffer(){return this.minBuffer}}},77580:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var r=i(134),s=i(29967),a=i.n(s),n=i(13724),o=i(82800),l=i(95335),c=i(4624),h=i(9705),d="src/avnetwork/ioLoader/FetchIOLoader.ts";class u extends o.A{constructor(t={}){super(t),(0,r.A)(this,"contentLength",void 0),(0,r.A)(this,"receivedLength",void 0),(0,r.A)(this,"info",void 0),(0,r.A)(this,"range",void 0),(0,r.A)(this,"startBytes",void 0),(0,r.A)(this,"endBytes",void 0),(0,r.A)(this,"eofIndex",void 0),(0,r.A)(this,"abortController",void 0),(0,r.A)(this,"reader",void 0),(0,r.A)(this,"buffers",void 0)}async open(t,e){var i;if(this.info=t,this.range=e,this.range.to||(this.range.to=-1),this.range.from=Math.max(this.range.from,0),this.eofIndex<0&&(this.eofIndex=e.to),this.startBytes=0,this.endBytes=-1,this.receivedLength=0,this.buffers=[],this.range&&!this.options.isLive&&(this.startBytes=null!==(i=this.range.from)&&void 0!==i?i:0),this.status=1,!this.options.isLive&&!this.options.disableSegment){const t={method:"HEAD",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};this.info.headers&&l.__(this.info.headers,((e,i)=>{t.headers[i]=e})),this.info.withCredentials&&(t.credentials="include"),this.info.referrerPolicy&&(t.referrerPolicy=this.info.referrerPolicy),AbortController&&(this.abortController=new AbortController,t.signal=this.abortController.signal);try{const e=await fetch(this.info.url,t);if(e.ok&&e.status>=200&&e.status<=299){const t=e.headers.get("X-Content-Length")||e.headers.get("Content-Length");null!=t&&(this.contentLength=a()(t),this.range.to<0&&(this.eofIndex=this.contentLength+this.range.to)),this.endBytes=Math.min(this.startBytes+this.options.preload-1,this.eofIndex),this.status=2}else this.endBytes=-1}catch(t){this.endBytes=-1}}return 0}async openReader(){const t={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};this.info.headers&&l.__(this.info.headers,((e,i)=>{t.headers[i]=e})),this.options.isLive||this.options.disableSegment||(t.headers.range=`bytes=${this.startBytes}-${this.endBytes>0?this.endBytes:""}`),this.info.withCredentials&&(t.credentials="include"),this.info.referrerPolicy&&(t.referrerPolicy=this.info.referrerPolicy),this.abortController&&this.abortController.abort(),"function"==typeof AbortController&&(this.abortController=new AbortController,t.signal=this.abortController.signal);try{const e=await fetch(this.info.url,t);e.ok&&e.status>=200&&e.status<=299?this.reader=e.body.getReader():(this.status=3,c.h2(`FetchStreamLoader: Http code invalid, ${e.status} ${e.statusText}`,d,192))}catch(t){if(this.retryCount<this.options.retryCount&&(!this.options.isLive||!this.receivedLength))return this.retryCount++,this.status=1,await new n.A(this.options.retryInterval),this.openReader();c.h2(`FetchStreamLoader: exception ${t.message}`,d,205)}}async readInterval(t,e=0){let i=0;for(;this.buffers.length&&i<t.length;){const e=this.buffers.shift();e.length>t.length-i?(t.set(e.subarray(0,t.length-i),i),this.buffers.unshift(e.subarray(t.length-i)),i=t.length):(t.set(e,i),i+=e.length)}if(i>=t.length)return t.length+e;if(4===this.status)return i>0?i+e:e>0?e:-1048576;this.reader||await this.openReader();const{value:r,done:s}=await this.reader.read();return s?null!==this.contentLength&&this.receivedLength+this.range.from<this.endBytes+1?(this.status=3,void c.h2("Fetch stream meet Early-EOF",d,244)):this.options.isLive||this.options.disableSegment||this.receivedLength+this.range.from>=this.eofIndex?(this.status=4,this.startBytes=0,i>0?i+e:e>0?e:-1048576):(await this.reader.cancel(),this.abortController&&this.abortController.abort(),this.reader=null,this.startBytes=this.endBytes+1,this.endBytes=Math.min(this.startBytes+this.options.preload-1,this.eofIndex),this.readInterval(t.subarray(i),i)):(this.receivedLength+=r.length,r.length>t.length-i?(t.set(r.subarray(0,t.length-i),i),this.buffers.push(r.subarray(t.length-i)),t.length+e):(t.set(r,i),i+=r.length,i+e))}async read(t){return this.readInterval(t)}async seek(t){return this.contentLength?(await this.abort(),this.receivedLength=Number(t)-this.range.from,this.startBytes=Number(t),this.options.disableSegment||(this.endBytes=Math.min(this.startBytes+this.options.preload,this.eofIndex)),this.buffers.length=0,4===this.status&&(this.status=2),0):h.NU}async size(){return this.options.isLive?BigInt(0):BigInt(Math.floor(this.contentLength||0))}async abort(){this.reader&&(await this.reader.cancel(),this.abortController&&this.abortController.abort(),this.reader=null)}async stop(){await this.abort(),this.status=0}}},79686:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(134),s=i(54001),a=i.n(s),n=i(82800),o=i(67672);class l extends n.A{constructor(...t){super(...t),(0,r.A)(this,"info",void 0),(0,r.A)(this,"range",void 0),(0,r.A)(this,"readPos",void 0),(0,r.A)(this,"endPos",void 0),(0,r.A)(this,"reader",void 0),(0,r.A)(this,"readerResolve",void 0)}async open(t,e){return this.info=t,this.range=e,this.readPos=0,this.endPos=this.info.file.size,e.from>0&&(this.readPos=e.from),e.to>0&&(this.endPos=e.to),this.status=2,0}async readBufferByReader(t){this.reader||(this.reader=new FileReader,this.reader.onloadend=t=>{this.readerResolve&&this.readerResolve(t.target.result)});const e=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;return new(a())((i=>{this.readerResolve=i,this.reader.readAsArrayBuffer(e.call(this.info.file,this.readPos,this.readPos+t))}))}async read(t){if(this.readPos>=this.endPos)return this.status,-1048576;const e=Math.min(t.length,this.endPos-this.readPos);return o.Pc(Blob.prototype.arrayBuffer)?t.set(new Uint8Array(await this.info.file.slice(this.readPos,this.readPos+e).arrayBuffer()),0):t.set(new Uint8Array(await this.readBufferByReader(e)),0),this.readPos+=e,this.readPos>=this.endPos&&(this.status=4),e}async seek(t){return this.readPos=Number(t),4===this.status&&(this.status=2),0}async size(){return BigInt(Math.floor(this.info.file.size))}async stop(){this.status=0}}},15433:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>v});var r=i(134),s=i(80662),a=i.n(s),n=i(13724),o=i(82800),l=i(95335),c=i(8507),h=i(48182),d=i(77580),u=i(86932),f=i(4624),p=i(97801),m=i(67672),g="src/avnetwork/ioLoader/HlsIOLoader.ts";class v extends o.A{constructor(...t){super(...t),(0,r.A)(this,"info",void 0),(0,r.A)(this,"range",void 0),(0,r.A)(this,"masterPlaylist",void 0),(0,r.A)(this,"mediaPlayList",void 0),(0,r.A)(this,"mediaPlayListIndex",void 0),(0,r.A)(this,"fetchedMap",void 0),(0,r.A)(this,"fetchedHistoryList",void 0),(0,r.A)(this,"mediaListUrl",void 0),(0,r.A)(this,"segmentIndex",void 0),(0,r.A)(this,"currentUri",void 0),(0,r.A)(this,"loader",void 0),(0,r.A)(this,"minBuffer",void 0),(0,r.A)(this,"keyMap",void 0),(0,r.A)(this,"currentIV",void 0),(0,r.A)(this,"currentKey",void 0),(0,r.A)(this,"aesDecryptPipe",void 0),(0,r.A)(this,"initLoaded",void 0)}async fetchMasterPlayList(){const t={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};this.info.headers&&l.__(this.info.headers,((e,i)=>{t.headers[i]=e})),this.info.withCredentials&&(t.credentials="include"),this.info.referrerPolicy&&(t.referrerPolicy=this.info.referrerPolicy);try{const i=await fetch(this.info.url,t),r=await i.text(),s=(0,h.A)(r);if(s.isMasterPlaylist)this.masterPlaylist=s;else{if(this.mediaPlayList=s,this.options.isLive&&(!this.mediaPlayList.segments||this.mediaPlayList.segments.length<2)){var e;let t=5;return null!==(e=this.mediaPlayList.segments)&&void 0!==e&&e.length&&(t=this.mediaPlayList.segments[0].duration*(2-this.mediaPlayList.segments.length)),f.R8(`wait for min buffer time, now segments: ${this.mediaPlayList.segments.length}`,g,123),await new n.A(t),this.fetchMasterPlayList()}this.minBuffer=this.mediaPlayList.duration||0,this.mediaPlayList.endlist&&(this.options.isLive=!1),this.mediaListUrl=this.info.url}return s}catch(t){if(this.retryCount<this.options.retryCount)return this.retryCount++,f.z3(`failed fetch m3u8 file, retry(${this.retryCount}/3)`,g,140),await new n.A(5),this.fetchMasterPlayList();this.status=3,f.h2("HLSLoader: exception, fetch slice error",g,146)}}async fetchMediaPlayList(){let t;if(this.masterPlaylist){const e=this.masterPlaylist.variants[this.mediaPlayListIndex];e||f.h2("no media playlist",g,158),t=e.uri}else t=this.mediaListUrl;/^https?/.test(t)||(t=c.ll(this.info.url,t)),this.mediaListUrl=t;const e={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};this.info.headers&&l.__(this.info.headers,((t,i)=>{e.headers[i]=t})),this.info.withCredentials&&(e.credentials="include"),this.info.referrerPolicy&&(e.referrerPolicy=this.info.referrerPolicy);try{const r=await fetch(t,e),s=await r.text();if(this.mediaPlayList=(0,h.A)(s),this.options.isLive&&(!this.mediaPlayList.segments||this.mediaPlayList.segments.length<2)){var i;let t=5;return null!==(i=this.mediaPlayList.segments)&&void 0!==i&&i.length&&(t=this.mediaPlayList.segments[0].duration*(2-this.mediaPlayList.segments.length)),f.R8(`wait for min buffer time, now segments: ${this.mediaPlayList.segments.length}`,g,203),await new n.A(t),this.fetchMediaPlayList()}return this.minBuffer=this.mediaPlayList.duration||0,this.mediaPlayList.endlist&&(this.options.isLive=!1),this.status=2,this.retryCount=0,this.mediaPlayList}catch(t){if(this.retryCount<this.options.retryCount)return this.retryCount++,f.z3(`failed fetch m3u8 file, retry(${this.retryCount}/3)`,g,222),await new n.A(this.options.retryInterval),this.fetchMasterPlayList();this.status=3,f.h2("HLSLoader: exception, fetch slice error",g,228)}}async open(t,e){return this.info=t,this.range=e,this.range.to||(this.range.to=-1),this.range.from=Math.max(this.range.from,0),this.mediaPlayListIndex=0,this.segmentIndex=0,this.fetchedMap=new(a()),this.fetchedHistoryList=[],this.status=1,this.retryCount=0,this.keyMap=new(a()),await this.fetchMasterPlayList(),!this.mediaPlayList&&this.masterPlaylist&&await this.fetchMediaPlayList(),this.initLoaded=!0,this.mediaPlayList.segments.length&&this.mediaPlayList.segments[0].map&&(this.initLoaded=!1),0}async checkNeedDecrypt(t,e){if(!t.key)return;const i=t.key.uri;if(this.keyMap.has(i)?this.currentKey=this.keyMap.get(i):(this.currentKey=await(await fetch((0,c.ll)(this.mediaListUrl,i))).arrayBuffer(),this.keyMap.set(i,this.currentKey)),t.key.iv)this.currentIV=t.key.iv.buffer;else{const t=new Uint8Array(16);new DataView(t.buffer).setUint32(12,e,!1),this.currentIV=t.buffer}this.aesDecryptPipe=new p.A,this.aesDecryptPipe.onFlush=async t=>this.loader.read(t),await this.aesDecryptPipe.expandKey(this.currentKey,this.currentIV)}async read(t){let e=0;if(this.loader){if(e=this.aesDecryptPipe?await this.aesDecryptPipe.read(t):await this.loader.read(t),-1048576!==e)return e;if(this.initLoaded){if(this.options.isLive)this.fetchedMap.set(this.currentUri,!0),10===this.fetchedHistoryList.length&&this.fetchedMap.delete(this.fetchedHistoryList.shift()),this.fetchedHistoryList.push(this.currentUri),this.segmentIndex++;else if(this.segmentIndex++,this.segmentIndex>=this.mediaPlayList.segments.length)return f.pq("hls segments ended",g,324),this.status=4,-1048576}else this.initLoaded=!0;this.loader=null}if(this.options.isLive){const e=this.mediaPlayList.segments.filter((t=>!this.fetchedMap.get(t.uri)));if(!e.length){if(this.mediaPlayList.endlist)return this.status=4,-1048576;const e=(this.minBuffer-((0,u.A)()-this.mediaPlayList.timestamp)/1e3)/2;return e>0&&await new n.A(e),await this.fetchMediaPlayList(),this.read(t)}this.currentUri=e[0].uri,this.initLoaded&&await this.checkNeedDecrypt(e[0],this.segmentIndex),this.loader=new d.A(l.X$({},this.options,{disableSegment:!0,loop:!1}));const i=(0,c.ll)(this.mediaListUrl,this.initLoaded?this.currentUri:e[0].map.uri),r={from:0,to:-1},s=this.initLoaded?e[0].byterange:e[0].map.byterange;return s&&(r.from=s.offset,r.to=s.offset+s.length),await this.loader.open({url:i},r),this.aesDecryptPipe?this.aesDecryptPipe.read(t):this.loader.read(t)}{this.loader=new d.A(l.X$({},this.options,{disableSegment:!0,loop:!1}));let e=this.mediaPlayList.segments[this.segmentIndex];for(;!e.uri;)e=this.mediaPlayList.segments[++this.segmentIndex];this.initLoaded&&await this.checkNeedDecrypt(e,this.segmentIndex);const i=(0,c.ll)(this.mediaListUrl,this.initLoaded?e.uri:e.map.uri),r={from:0,to:-1},s=this.initLoaded?e.byterange:e.map.byterange;return s&&(r.from=s.offset,r.to=s.offset+s.length),await this.loader.open({url:i},r),this.aesDecryptPipe?this.aesDecryptPipe.read(t):this.loader.read(t)}}async seek(t){this.loader&&(await this.loader.abort(),this.loader=null);let e=0,i=Number(t),r=0;for(let t=0;t<this.mediaPlayList.segments.length;t++)if(m.ai(this.mediaPlayList.segments[t].duration)&&(e+=this.mediaPlayList.segments[t].duration,1e3*e>=i)){r=t;break}return this.segmentIndex=r,4===this.status&&(this.status=2),0}async size(){return BigInt(0)}async abort(){this.loader&&(await this.loader.abort(),this.loader=null)}async stop(){await this.abort(),this.status=0}getDuration(){return this.mediaPlayList.duration}getVideoList(){var t,e;return{list:null!==(t=null===(e=this.masterPlaylist)||void 0===e?void 0:e.variants.map((t=>{var e,i,r,s,a;return{width:null!==(e=null===(i=t.resolution)||void 0===i?void 0:i.width)&&void 0!==e?e:0,height:null!==(r=null===(s=t.resolution)||void 0===s?void 0:s.height)&&void 0!==r?r:0,frameRate:null!==(a=t.frameRate)&&void 0!==a?a:0,codecs:t.codecs}})))&&void 0!==t?t:[],selectedIndex:0}}selectVideo(t){this.mediaPlayListIndex=t,this.fetchMediaPlayList()}getMinBuffer(){return this.minBuffer}}},82800:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(95335);const a={isLive:!0,preload:5242880,retryCount:20,retryInterval:1};class n{constructor(t={}){(0,r.A)(this,"options",void 0),(0,r.A)(this,"status",void 0),(0,r.A)(this,"retryCount",void 0),(0,r.A)(this,"retryTimeout",void 0),this.options=t,this.status=0,this.retryCount=0,this.options=s.X$({},a),s.X$(this.options,t)}}},18667:(t,e,i)=>{"use strict";i.d(e,{A:()=>C});var r=i(54001),s=i.n(r),a=i(63939),n=i(50932),o=i(12264),l=i(29170),c=i(9599),h=i(44527),d=i(9705),u=i(84149),f=i(75742),p=i(4624),m=i(16041),g=i(77104),v=i(84290),y=i(72739),A=i(86932),b=i(36204),x=i(44328),w=i(77231),k=i(94561),T=i(72703),S=i(71762),I=i(37837),P=i(71766),_=i(67672),E="src/avpipeline/AudioDecodePipeline.ts";class C extends h.A{constructor(){super()}createWebcodecDecoder(t){return new g.A({onError:e=>{p.z3(`audio decode error, taskId: ${t.taskId}, error: ${e}`,E,93),t.openReject&&(t.openReject(d.r8),t.openReject=null)},onReceiveFrame(e){const i=(0,b.t)(e,t.avframePool.alloc());n.M[17](i+104,(0,x.k)(a.f[17](i+104),w.KR,t.timeBase)),n.M[15](i+124,t.timeBase.den),n.M[15](i+120,t.timeBase.num),t.frameCaches.push(i),n.M[17](t.stats+56,a.f[17](t.stats+56)+BigInt(1)),t.lastDecodeTimestamp&&n.M[15](t.stats+240,Math.max((0,A.A)()-t.lastDecodeTimestamp,a.f[15](t.stats+240))),t.lastDecodeTimestamp=(0,A.A)(),e.close()}})}createWasmcodecDecoder(t,e){return new f.A({resource:e,onError:e=>{p.z3(`audio decode error, taskId: ${t.taskId}, error: ${e}`,E,124),t.openReject&&(t.openReject(d.r8),t.openReject=null)},onReceiveFrame(e){t.frameCaches.push(e),n.M[17](t.stats+56,a.f[17](t.stats+56)+BigInt(1)),t.lastDecodeTimestamp&&n.M[15](t.stats+240,Math.max((0,A.A)()-t.lastDecodeTimestamp,a.f[15](t.stats+240))),t.lastDecodeTimestamp=(0,A.A)()},avframePool:t.avframePool})}async pullAVPacketInternal(t,e){const i=await e.request("pull");if(_.ai(i))return i;{const e=t.avpacketPool.alloc();return(0,S.r0)(i,e),e}}async createTask(t){const e=new u.Ay(t.leftPort),i=new u.Ay(t.rightPort),r=[],s=new m.A((0,l.A)(t.avframeList,o.A),t.avframeListMutex),h={...t,resource:await(0,k.A)(t.resource),frameCaches:r,inputEnd:!1,decoder:null,parameters:0,lastDecodeTimestamp:0,avframePool:s,avpacketPool:new v.A((0,l.A)(t.avpacketList,o.A),t.avpacketListMutex),openReject:null};return h.resource?h.decoder=this.createWasmcodecDecoder(h,h.resource):h.decoder=this.createWebcodecDecoder(h),this.tasks.set(t.taskId,h),i.on(u.S3,(async s=>{switch(s.method){case"pull":if(r.length){const t=r.shift();i.reply(s,t);break}if(!h.inputEnd){for(;;){if(r.length){const t=r.shift();i.reply(s,t);break}const o=await this.pullAVPacketInternal(h,e);if(-1048576===o){if(await h.decoder.flush(),h.inputEnd=!0,r.length){const t=r.shift();i.reply(s,t);break}p.pq(`audio decoder ended, taskId: ${h.taskId}`,E,218),i.reply(s,-1048576);break}if(!(o>0)){p.z3(`audio decode pull avpacket error, taskId: ${t.taskId}, ret: ${o}`,E,236),i.reply(s,o);break}{const e=h.decoder.decode(o,(0,x.k)(a.f[17](o+8),(0,l.A)(o+72,c.P),w.KR));h.avpacketPool.release(o),e<0&&(n.M[15](h.stats+48,a.f[15](h.stats+48)+1),p.z3(`audio decode error, taskId: ${t.taskId}, ret: ${e}`,E,231))}}break}i.reply(s,-1048576)}})),0}async open(t,e,i={}){const r=this.tasks.get(t);if(r){r.wasmDecoderOptions=i;const t=(0,I.Gy)(168);return(0,T.A)(e)?(0,P.Yi)(t,e):(0,S.T8)(e,t),r.parameters&&(0,P.dn)(r.parameters),r.parameters=t,new(s())((async(e,i)=>{r.openReject=e;try{await r.decoder.open(t,r.wasmDecoderOptions)}catch(t){return p.z3(`open audio decoder failed, error: ${t}`,E,273),void e(d.r8)}e(0)}))}p.h2("task not found",E,280)}async reopenDecoder(t,e,i,r){const a=this.tasks.get(t);if(a){r&&(a.wasmDecoderOptions=r);const t=(0,I.Gy)(168);let n;return(0,T.A)(e)?(0,P.Yi)(t,e):(0,S.T8)(e,t),a.parameters&&(0,P.dn)(a.parameters),a.parameters=t,i?(i=await(0,k.A)(i),n=this.createWasmcodecDecoder(a,i)):n=this.createWebcodecDecoder(a),new(s())((async(e,r)=>{a.openReject=e;try{await n.open(t),i&&(a.resource=i),a.decoder.close(),a.decoder=n,p.Yz(`reopen audio decoder, taskId: ${a.taskId}`,E,323)}catch(t){return p.z3(`reopen audio decoder failed, error: ${t}`,E,326),void e(d.r8)}e(0)}))}p.h2("task not found",E,333)}async resetTask(t){const e=this.tasks.get(t);e&&(e.decoder&&await e.decoder.flush(),y.__(e.frameCaches,(t=>{e.avframePool.release(t)})),e.frameCaches.length=0,e.inputEnd=!1,e.lastDecodeTimestamp=(0,A.A)(),p.pq(`reset audio decoder, taskId: ${e.taskId}`,E,349))}async registerTask(t){return this.tasks.has(t.taskId)?d.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.rightPort.close(),e.leftPort.close(),e.decoder.close(),e.frameCaches.forEach((t=>{e.avframePool.release(t)})),e.parameters&&(0,P.dn)(e.parameters),this.tasks.delete(t))}}},59377:(t,e,i)=>{"use strict";i.d(e,{A:()=>D});var r=i(134),s=i(80662),a=i.n(s),n=i(54001),o=i.n(n),l=i(61499),c=i(74503),h=i(12264),d=i(29170),u=i(63939),f=i(50932),p=i(94300),m=i(44527),g=i(9705),v=i(84149),y=i(4624),A=i(73783),b=i(16041),x=i(92246),w=i(10278),k=i(47442),T=i(37837),S=i(70089),I=i(14686),P=i(44328),_=i(77231),E=i(86932),C=i(13724),M=i(43607),R=i(94561),B="src/avpipeline/AudioRenderPipeline.ts";class D extends m.A{constructor(){super(),(0,r.A)(this,"avPCMBufferPool",void 0),(0,r.A)(this,"avPCMBufferList",void 0),(0,r.A)(this,"avPCMBufferListMutex",void 0),this.avPCMBufferList=(0,c.A)(h.A),this.avPCMBufferListMutex=(0,c.A)(A.eu),this.avPCMBufferPool=new k.A(this.avPCMBufferList,this.avPCMBufferListMutex[l.o9])}async createTask(t){const e=new v.Ay(t.leftPort),i=new v.Ay(t.rightPort),r=new v.Ay(t.controlPort),s={...t,leftIPCPort:e,rightIPCPort:i,controlIPCPort:r,resamplerResource:await(0,R.A)(t.resamplerResource),stretchpitcherResource:await(0,R.A)(t.stretchpitcherResource),resampler:null,stretchpitcher:new(a()),outPCMBuffer:null,waitPCMBuffer:0,waitAVFrame:0,waitPCMBufferPos:0,frameEnded:!1,stretchpitcherEnded:!1,playRate:1,playTempo:1,playPitch:1,useStretchpitcher:!1,lastNotifyPTS:BigInt(0),currentPTS:_.Dh,firstPlayed:!1,seeking:!1,pausing:!1,seekSync:null,receivePCMSync:null,paddingAVFrame:0,fakePlayStartTimestamp:0,fakePlaySamples:BigInt(0),fakePlayTimer:null,fakePlay:!1,lastRenderTimestamp:0,avframePool:new b.A((0,d.A)(t.avframeList,h.A),t.avframeListMutex)};s.startPTS=(0,P.k)(s.startPTS,s.timeBase,_.i0);for(let e=0;e<t.playChannels;e++){const i=new S.A({resource:s.stretchpitcherResource});s.stretchpitcher.set(e,i),await i.open({sampleRate:t.playSampleRate,channels:1}),i.setTempo(s.playTempo),i.setPitch(s.playPitch),i.setRate(s.playRate)}const n=this;async function m(){let t;if(s.paddingAVFrame?(t=s.paddingAVFrame,s.paddingAVFrame=0):t=await s.leftIPCPort.request("pull"),-1048576===t){for(let t=0;t<s.playChannels;t++)s.stretchpitcher.get(t).flush();return y.pq(`audio render ended, taskId: ${s.taskId}`,B,206),-1048576}if(t<0)return y.z3(`pull audio frame failed, taskId: ${s.taskId}`,B,210),t;{if(1!==s.playRate||1!==s.playTempo||1!==s.playPitch||s.enableJitterBuffer?s.useStretchpitcher=!0:s.useStretchpitcher=!1,!s.firstPlayed){const e=(0,P.k)(u.f[17](t+104),s.timeBase,_.i0);s.firstPlayed=!0,y.Yz(`got first audio frame, pts: ${u.f[17](t+104)}(${e}ms), taskId: ${s.taskId}`,B,232)}s.currentPTS=(0,P.k)(u.f[17](t+104),s.timeBase,_.i0),f.M[17](s.stats+72,u.f[17](s.stats+72)+BigInt(1)),s.lastRenderTimestamp&&f.M[15](s.stats+244,Math.max((0,E.A)()-s.lastRenderTimestamp,u.f[15](s.stats+244))),s.lastRenderTimestamp=(0,E.A)();let e=!0;if(u.f[15](t+152)!==s.playSampleRate||u.f[15](t+80)!==s.playFormat||u.f[15](t+292)!==s.playChannels){if(s.resampler){const e=s.resampler.getInputPCMParameters();e.format===u.f[15](t+80)&&e.sampleRate===u.f[15](t+152)||(s.resampler.close(),s.resampler=null)}s.resampler||(s.resampler=new x.A({resource:s.resamplerResource}),await s.resampler.open({sampleRate:u.f[15](t+152),format:u.f[15](t+80),channels:u.f[15](t+292)},{sampleRate:s.playSampleRate,format:s.playFormat,channels:s.playChannels}));let e=n.avPCMBufferPool.alloc(),i=s.resampler.resample(u.f[20](t+64),e,u.f[15](t+76));if(i<0)return y.z3(`resample error, ret: ${i}, taskId: ${s.taskId}`,B,280),i;if(s.useStretchpitcher){for(let t=0;t<s.playChannels;t++)s.stretchpitcher.get(t).sendSamples(u.f[20](u.f[20](e)+4*t),u.f[15](e+8));n.avPCMBufferPool.release(e)}else s.waitPCMBuffer=e,s.waitPCMBufferPos=0}else if(s.useStretchpitcher)for(let e=0;e<s.playChannels;e++)s.stretchpitcher.get(e).sendSamples(u.f[20](u.f[20](t+64)+4*e),u.f[15](t+76));else{let i=n.avPCMBufferPool.alloc();f.M[15](i+8,u.f[15](t+76)),f.M[15](i+12,u.f[15](t+76)),f.M[15](i+20,u.f[15](t+152)),f.M[15](i+16,u.f[15](t+292)),f.M[20](i,u.f[20](t+64)),s.waitAVFrame=t,s.waitPCMBuffer=i,s.waitPCMBufferPos=0,e=!1}f.M[15](s.stats+4,u.f[15](t+152)),f.M[15](s.stats,u.f[15](t+292)),f.M[15](s.stats+8,u.f[15](t+76)),e&&s.avframePool.release(t)}return 0}async function g(t){let e=0;if(s.seeking&&await new(o())((t=>{s.receivePCMSync=t})),s.enableJitterBuffer&&u.f[15](s.stats+32)/u.f[15](s.stats+236)*1e3<=u.f[15](s.stats+272)&&n.setPlayRate(s.taskId,1),s.frameEnded&&s.useStretchpitcher){let i=0;for(let r=0;r<s.playChannels;r++){const a=s.stretchpitcher.get(r);u.f[20](u.f[20](t)+4*r)&&(i=a.receiveSamples(u.f[20](u.f[20](t)+4*r)+4*e,u.f[15](t+12)-e))}if(e+i<u.f[15](t+12)){s.stretchpitcherEnded=!0;for(let i=0;i<s.playChannels;i++)(0,I.sO)(u.f[20](u.f[20](t)+4*i)+e,0,4*(u.f[15](t+12)-e))}return f.M[15](t+8,e),0}for(;e<u.f[15](t+12);){let i=0;if(s.useStretchpitcher)for(let r=0;r<s.playChannels;r++){const a=s.stretchpitcher.get(r);u.f[20](u.f[20](t)+4*r)&&(i=a.receiveSamples(u.f[20](u.f[20](t)+4*r)+4*e,u.f[15](t+12)-e))}else if(s.waitPCMBuffer){if(i=Math.min(u.f[15](s.waitPCMBuffer+8)-s.waitPCMBufferPos,u.f[15](t+12)-e),i){for(let r=0;r<s.playChannels;r++)(0,I.Mr)(u.f[20](u.f[20](t)+4*r)+4*e,u.f[20](u.f[20](s.waitPCMBuffer)+4*r)+4*s.waitPCMBufferPos,4*i);s.waitPCMBufferPos+=i}u.f[15](s.waitPCMBuffer+8)===s.waitPCMBufferPos&&(s.waitAVFrame&&(f.M[20](s.waitPCMBuffer,0),f.M[15](s.waitPCMBuffer+12,0),s.avframePool.release(s.waitAVFrame),s.waitAVFrame=0),n.avPCMBufferPool.release(s.waitPCMBuffer),s.waitPCMBuffer=0)}if(e+=i,e<u.f[15](t+12)){let i=await m();if(-1048576===i){if(s.frameEnded=!0,s.useStretchpitcher){for(let r=0;r<s.playChannels;r++){const a=s.stretchpitcher.get(r);u.f[20](u.f[20](t)+4*r)&&(a.flush(),i=a.receiveSamples(u.f[20](u.f[20](t)+4*r)+4*e,u.f[15](t+12)-e))}if(e+i<u.f[15](t+12)){s.stretchpitcherEnded=!0;for(let i=0;i<s.playChannels;i++)(0,I.sO)(u.f[20](u.f[20](t)+4*i)+e,0,4*(u.f[15](t+12)-e))}e+=i}break}if(i<0)return i}}f.M[15](t+8,e);const i=((s.useStretchpitcher?s.stretchpitcher.get(0).getLatency():0)+(3*u.f[15](t+12)>>>1))/s.playSampleRate*1e3>>>0,r=M.T9(s.currentPTS-BigInt(Math.floor(i)),BigInt(0));return f.M[17](s.stats+320,r),s.currentPTS-s.lastNotifyPTS>=BigInt(1e3)&&(s.lastNotifyPTS=s.currentPTS,s.controlIPCPort.notify("syncPts",{pts:r})),s.seekSync&&(s.seekSync(),s.seekSync=null),0}return i.on(v.S3,(async t=>{switch(t.method){case"pull":{if(s.fakePlay&&(s.fakePlay=!1,s.fakePlayTimer&&(clearTimeout(s.fakePlayTimer),s.fakePlayTimer=null),s.fakePlaySamples=BigInt(0),s.fakePlayStartTimestamp=0),s.frameEnded&&(s.stretchpitcherEnded||!s.useStretchpitcher))return void i.reply(t,-1048576);const e=t.params.buffer,r=await g(e);i.reply(t,r);break}case"pullBuffer":{if(s.fakePlay&&(s.fakePlay=!1,s.fakePlayTimer&&(clearTimeout(s.fakePlayTimer),s.fakePlayTimer=null),s.fakePlaySamples=BigInt(0),s.fakePlayStartTimestamp=0),s.frameEnded&&(s.stretchpitcherEnded||!s.useStretchpitcher))return void i.reply(t,-1048576);const e=t.params.nbSamples;if(!s.outPCMBuffer||s.outPCMBuffer.maxnbSamples!==e){s.outPCMBuffer&&((0,T.aI)(s.outPCMBuffer.data),(0,T.aI)(s.outPCMBuffer[l.o9]),(0,p.A)(s.outPCMBuffer)),s.outPCMBuffer=(0,c.A)(w.A),s.outPCMBuffer.data=(0,T.sY)(4*s.playChannels);const t=(0,T.Gy)(4*e*s.playChannels);for(let i=0;i<s.playChannels;i++)f.M[20](s.outPCMBuffer.data+4*i,t+4*e*i);s.outPCMBuffer.maxnbSamples=e}const r=await g(s.outPCMBuffer[l.o9]);if(r<0)return void i.reply(t,r);const a=(0,I.s3)(u.f[20](s.outPCMBuffer.data),4*s.outPCMBuffer.nbSamples*s.playChannels).slice();i.reply(t,a.buffer,null,[a.buffer]);break}}})),this.tasks.set(t.taskId,s),0}checkUseStretchpitcher(t){const e=1!==t.playRate||1!==t.playTempo||1!==t.playPitch||t.enableJitterBuffer;if(t.useStretchpitcher&&!e)for(let e=0;e<t.playChannels;e++)t.stretchpitcher.get(e).flush()}setPlayRate(t,e){const i=this.tasks.get(t);if(i){i.enableJitterBuffer&&u.f[15](i.stats+32)/u.f[15](i.stats+236)*1e3<=u.f[15](i.stats+272)&&(e=1),i.playRate=e;for(let t=0;t<i.playChannels;t++)i.stretchpitcher.get(t).setRate(e);this.checkUseStretchpitcher(i)}}async setPlayTempo(t,e){const i=this.tasks.get(t);if(i){i.playTempo=e;for(let t=0;t<i.playChannels;t++)i.stretchpitcher.get(t).setTempo(e);this.checkUseStretchpitcher(i)}}setPlayPitch(t,e){const i=this.tasks.get(t);if(i){i.playPitch=e;for(let t=0;t<i.playChannels;t++)i.stretchpitcher.get(t).setPitch(e);this.checkUseStretchpitcher(i)}}async beforeSeek(t){const e=this.tasks.get(t);if(e){if(e.fakePlay||e.pausing?e.fakePlayTimer&&(clearTimeout(e.fakePlayTimer),e.fakePlayTimer=null):(y.Yz(`wait current pull front frame before seek, taskId: ${e.taskId}`,B,612),await new(o())((t=>{e.seekSync=t}))),e.seeking=!0,e.stretchpitcher.size)for(const t of e.stretchpitcher.keys())e.stretchpitcher.get(t).clear();e.waitPCMBuffer&&(e.waitAVFrame&&(f.M[20](e.waitPCMBuffer,0),f.M[15](e.waitPCMBuffer+12,0),e.avframePool.release(e.waitAVFrame),e.waitAVFrame=0),this.avPCMBufferPool.release(e.waitPCMBuffer),e.waitPCMBuffer=0),y.Yz(`before seek end, taskId: ${e.taskId}`,B,643)}}async syncSeekTime(t,e,i){const r=this.tasks.get(t);if(r){let s=!1;for(;;){let a=(0,E.A)(),n=u.f[15](r.stats+120);for(;!s&&i&&u.f[15](r.stats+120)>i;)await new C.A(0),(0,E.A)()-a>200&&n===u.f[15](r.stats+120)&&(s=!0),n!==u.f[15](r.stats+120)&&(n=u.f[15](r.stats+120),a=(0,E.A)());let o=await r.leftIPCPort.request("pull");if(o<0){y.R8(`pull audio frame end after seek, taskId: ${t}`,B,673),r.frameEnded=!0;break}if(e<BigInt(0)){y.pq(`use the first audio frame because of the seek time${e} < 0`,B,679);break}const l=(0,P.k)(u.f[17](o+104),r.timeBase,_.i0);if(l-r.startPTS>=e){r.paddingAVFrame=o,r.frameEnded=!1,r.lastNotifyPTS=l,f.M[17](r.stats+320,l);break}r.avframePool.release(o)}y.Yz(`sync seek time end, taskId: ${r.taskId}`,B,704)}}async afterSeek(t,e){const i=this.tasks.get(t);i&&(i.seeking=!1,i.receivePCMSync&&(i.receivePCMSync(),i.receivePCMSync=null),i.pausing||(i.fakePlay&&(i.fakePlayStartTimestamp=(0,E.A)(),i.fakePlaySamples=BigInt(0),this.fakePlayNext(i)),i.lastRenderTimestamp=(0,E.A)()),y.Yz(`after seek end, taskId: ${i.taskId}`,B,726))}async restart(t){const e=this.tasks.get(t);if(e){var i;if(e.lastNotifyPTS=BigInt(0),e.frameEnded=!1,e.firstPlayed=!1,e.stretchpitcherEnded=!1,null!==(i=e.stretchpitcher)&&void 0!==i&&i.size)for(let t=0;t<e.playChannels;t++){var r;null===(r=e.stretchpitcher.get(t))||void 0===r||r.clear()}e.fakePlayTimer&&clearTimeout(e.fakePlayTimer),e.fakePlaySamples=BigInt(0),e.fakePlayStartTimestamp=0,e.lastRenderTimestamp=(0,E.A)(),y.Yz(`restart task, taskId: ${e.taskId}`,B,749)}}async fakePlayNext(t){const e=await t.leftIPCPort.request("pull");if(e<0)return t.frameEnded=!0,y.pq(`audio fake render ended, taskId: ${t.taskId}`,B,760),void t.controlIPCPort.notify("ended");if(!t.fakePlay||t.pausing)return void t.avframePool.release(e);let i=u.f[15](e+76)/u.f[15](e+152)*1e3>>>0;i/=t.playRate*t.playTempo,t.currentPTS=(0,P.k)(u.f[17](e+104),t.timeBase,_.i0);const r=BigInt(Math.floor((0,E.A)()-t.fakePlayStartTimestamp))*BigInt(0|u.f[15](e+152))/BigInt(1e3);i-=Number(r-t.fakePlaySamples)/u.f[15](e+152)*1e3>>>0,t.fakePlaySamples+=BigInt(0|u.f[15](e+76)),t.avframePool.release(e),t.currentPTS-t.lastNotifyPTS>=BigInt(1e3)&&(t.lastNotifyPTS=t.currentPTS,t.controlIPCPort.notify("syncPts",{pts:t.currentPTS})),t.fakePlayTimer=setTimeout((()=>{t.fakePlayTimer=null,this.fakePlayNext(t)}),i)}async fakePlay(t){const e=this.tasks.get(t);e&&(e.fakePlayStartTimestamp=(0,E.A)(),e.fakePlay=!0,e.fakePlaySamples=BigInt(0),this.fakePlayNext(e),y.pq(`start fake play, taskId: ${e.taskId}`,B,805))}async pause(t){const e=this.tasks.get(t);e&&(e.pausing=!0,e.fakePlay&&e.fakePlayTimer&&(clearTimeout(e.fakePlayTimer),e.fakePlayTimer=null),y.pq(`task paused, taskId: ${e.taskId}`,B,820))}async unpause(t){const e=this.tasks.get(t);e&&(e.pausing=!1,e.fakePlay&&(e.fakePlayStartTimestamp=(0,E.A)(),e.fakePlaySamples=BigInt(0),e.lastRenderTimestamp=(0,E.A)(),this.fakePlayNext(e)),y.pq(`task unpaused, taskId: ${e.taskId}`,B,835))}async registerTask(t){return this.tasks.has(t.taskId)?g.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);if(e){if(e.resampler&&e.resampler.close(),e.stretchpitcher.size){for(const t of e.stretchpitcher.keys())e.stretchpitcher.get(t).close();e.stretchpitcher.clear()}e.outPCMBuffer&&((0,T.aI)(e.outPCMBuffer.data),(0,T.aI)(e.outPCMBuffer[l.o9]),(0,p.A)(e.outPCMBuffer)),e.waitPCMBuffer&&(e.waitAVFrame&&(f.M[20](e.waitPCMBuffer,0),f.M[15](e.waitPCMBuffer+12,0),e.avframePool.release(e.waitAVFrame)),this.avPCMBufferPool.release(e.waitPCMBuffer),e.waitPCMBuffer=0),e.paddingAVFrame&&e.avframePool.release(e.paddingAVFrame),e.leftIPCPort.destroy(),e.rightIPCPort.destroy(),this.tasks.delete(t)}}async clear(){await super.clear(),this.avPCMBufferList.clear((t=>{u.f[20](t)&&((0,T.aI)(u.f[20](t)),(0,T.aI)(t))}),20),(0,p.A)(this.avPCMBufferList),(0,p.A)(this.avPCMBufferListMutex)}}},72480:(t,e,i)=>{"use strict";i.d(e,{A:()=>N});var r=i(80662),s=i.n(r),a=i(61499),n=i(12264),o=i(29170),l=i(63939),c=i(50932),h=i(9599),d=i(44527),u=i(9705),f=i(84149),p=i(44315),m=i(24175),g=i(75),v=i(37837),y=i(79630),A=i(4624),b=i(84290),x=i(39148),w=i(72739),k=i(44328),T=i(77231),S=i(43607),I=i(71517),P=i(14686),_=i(49032),E=i(94561),C=i(39638),M=i(26429),R=i(71762),B=i(72703),D=i(67672),U="src/avpipeline/DemuxPipeline.ts";const L=-1;class N extends d.A{constructor(){super()}createTask(t){let e,i;if(t.mainTaskId){const r=this.tasks.get(t.mainTaskId);e=r.leftIPCPort,i=r.controlIPCPort}else e=new f.Ay(t.leftPort),t.controlPort&&(i=new f.Ay(t.controlPort));const r=t.bufferLength||1048576,a=(0,v.sY)(r);if(!a)return u.gR;const l=new y.A(a,r),c=new m.A(r,!0,l);t.isLive||(c.flags|=1),t.flags&&(c.flags|=t.flags),c.onFlush=async i=>{const r={pointer:i.byteOffset,length:i.length};t.ioloaderOptions&&(r.ioloaderOptions=t.ioloaderOptions);try{const t=await e.request("read",r);return D.ai(t)?t:((0,P.lW)(r.pointer,t.length,t),t.length)}catch(t){return-1048574}},c.onSeek=async i=>{try{const r={pos:i};return t.ioloaderOptions&&(r.ioloaderOptions=t.ioloaderOptions),e.request("seek",r)}catch(t){return-1048574}},c.onSize=async()=>{try{return e.request("size")}catch(t){return BigInt(-1048574)}};const h=(0,p.Xv)();return h.ioReader=c,h.getDecoderResource=async(t,e)=>{if(!i)return;const r=await i.request("getDecoderResource",{codecId:e,mediaType:t});return(0,E.A)(r,0===t)},this.tasks.set(t.taskId,{...t,leftIPCPort:e,rightIPCPorts:new(s()),controlIPCPort:i,formatContext:h,ioReader:c,buffer:a,cacheAVPackets:new(s()),cacheRequests:new(s()),streamIndexFlush:new(s()),realFormat:-1,demuxEnded:!1,loop:null,gopCounter:0,lastKeyFramePts:BigInt(0),lastAudioDts:BigInt(0),lastVideoDts:BigInt(0),avpacketPool:new b.A((0,o.A)(t.avpacketList,n.A),t.avpacketListMutex)}),0}async openStream(t,e=3e3){const r=this.tasks.get(t);if(r){let t,s,a=await r.leftIPCPort.request("open");if(a<0)return A.z3(`open ioloader failed, ret: ${a}`,U,255),a;try{t=await(0,_.A)(r.ioReader,r.format),r.format=t}catch(t){return u.LR}switch(t){case 0:s=new((await i.e(969).then(i.bind(i,28773))).default);break;case 1:s=new((await i.e(531).then(i.bind(i,92047))).default);break;case 2:s=new((await i.e(331).then(i.bind(i,59331))).default);break;case 3:s=new((await i.e(855).then(i.bind(i,83855))).default);break;case 5:s=new((await i.e(634).then(i.bind(i,16634))).default);break;case 4:s=new((await i.e(979).then(i.bind(i,69979))).default);break;case 12:s=new((await i.e(839).then(i.bind(i,6839))).default);break;case 6:case 7:s=new((await i.e(941).then(i.bind(i,34577))).default);break;case 13:s=new((await i.e(94).then(i.bind(i,47094))).default);break;case 15:s=new((await i.e(453).then(i.bind(i,18453))).default);break;case 14:s=new((await i.e(791).then(i.bind(i,3791))).default);break;case 16:s=new((await i.e(611).then(i.bind(i,85611))).default);break;case 17:s=new((await i.e(70).then(i.bind(i,78070))).default);break;case 18:s=new((await i.e(344).then(i.bind(i,47344))).default);break;case 19:s=new((await i.e(854).then(i.bind(i,98854))).default);break;case 9:s=new((await i.e(299).then(i.bind(i,5299))).default);break;case 10:s=new((await i.e(487).then(i.bind(i,85487))).default);break;case 11:s=new((await i.e(808).then(i.bind(i,95808))).default);break;default:return A.z3("format not support",U,435),u.E$}return r.realFormat=t,r.formatContext.iformat=s,g.ho(r.formatContext,{maxAnalyzeDuration:e,fastOpen:r.isLive})}A.h2("task not found",U,450)}async getFormat(t){const e=this.tasks.get(t);if(e)return e.realFormat;A.h2("task not found",U,460)}async analyzeStreams(t){const e=this.tasks.get(t);if(e){await g.Ib(e.formatContext);const t=[];for(let i=0;i<e.formatContext.streams.length;i++){const r=e.formatContext.streams[i];t.push({index:r.index,id:r.id,codecpar:r.codecpar[a.o9],nbFrames:r.nbFrames,metadata:r.metadata,duration:r.duration,startTime:r.startTime,disposition:r.disposition,timeBase:{den:r.timeBase.den,num:r.timeBase.num}})}return{metadata:e.formatContext.metadata,format:e.realFormat,chapters:e.formatContext.chapters,streams:t}}A.h2("task not found",U,496)}replyAVPacket(t,e,i,r){if((0,C.A)()&&!M.USE_THREADS&&(0,B.A)(r)){const s=(0,R.wm)(r),a=[s.data.buffer];return s.sideData.length&&s.sideData.forEach((t=>{a.push(t.data.buffer)})),e.reply(i,s,null,a),void t.avpacketPool.release(r)}e.reply(i,r)}async connectStreamTask(t,e,i){const r=this.tasks.get(t);if(r){const t=new f.Ay(i);r.cacheAVPackets.set(e,[]),t.streamIndex=e,t.on(f.S3,(async e=>{switch(e.method){case"pull":{const i=r.cacheAVPackets.get(t.streamIndex);if(i.length){const s=i.shift();0!==r.stats&&(1===r.formatContext.streams[l.f[15](s+32)].codecpar.codecType?c.M[15](r.stats+32,l.f[15](r.stats+32)-1):0===r.formatContext.streams[l.f[15](s+32)].codecpar.codecType&&c.M[15](r.stats+120,l.f[15](r.stats+120)-1)),this.replyAVPacket(r,t,e,s)}else r.demuxEnded?t.reply(e,-1048576):(r.cacheRequests.set(t.streamIndex,e),r.loop&&r.loop.isStarted()&&r.loop.resetInterval());break}}})),r.rightIPCPorts.set(e,t),A.Yz(`connect stream ${e}, taskId: ${r.taskId}`,U,557)}else A.h2("task not found",U,560)}async changeConnectStream(t,e,i,r=!0){const s=this.tasks.get(t);if(s){if(e===i)return;const t=s.cacheAVPackets.get(i),a=s.rightIPCPorts.get(i),n=s.cacheRequests.get(i);t||A.R8(`oldStreamIndex ${i} not found`,U,578),await s.loop.stopBeforeNextTick(),r?(w.__(t,(t=>{s.avpacketPool.release(t)})),t.length=0):s.streamIndexFlush.set(e,!0),a.streamIndex=e,s.cacheAVPackets.set(e,t),s.rightIPCPorts.set(e,a),s.cacheAVPackets.delete(i),s.rightIPCPorts.delete(i),n&&(s.cacheRequests.set(e,n),s.cacheRequests.delete(i)),r||s.loop.start(),A.Yz(`changed connect stream, new ${e}, old: ${i}, force: ${r}, taskId: ${s.taskId}`,U,610)}else A.h2("task not found",U,613)}async startDemux(t,e,i){const r=this.tasks.get(t);r?(i=Math.max(i,2===r.format?20:10),r.loop&&r.loop.destroy(),r.loop=new x.A((async()=>{if(!e){let t=!1;if(r.cacheAVPackets.forEach(((e,s)=>{const a=r.formatContext.streams.find((t=>t.index===s));e.length<i&&(3!==a.codecpar.codecType||1===r.cacheAVPackets.size)&&(t=!0)})),!t)return void r.loop.emptyTask()}const s=r.avpacketPool.alloc();let a=await g.Cj(r.formatContext,s);if(a){r.avpacketPool.release(s),-1048576!==a&&A.z3(`demux error, ret: ${a}, taskId: ${t}`,U,773),r.demuxEnded=!0,A.pq(`demuxer ended, taskId: ${r.taskId}`,U,778);for(let t of r.cacheRequests.keys())r.cacheAVPackets.get(t).length||(r.rightIPCPorts.get(t).reply(r.cacheRequests.get(t),-1048576),r.cacheRequests.delete(t));r.loop.stop()}else{const t=l.f[15](s+32);if(0!==r.stats)if(1===r.formatContext.streams[t].codecpar.codecType&&r.cacheAVPackets.has(t)){if(c.M[17](r.stats+24,l.f[17](r.stats+24)+BigInt(1)),c.M[17](r.stats+16,l.f[17](r.stats+16)+BigInt(0|l.f[15](s+28))),l.f[17](r.stats+24)>1&&l.f[17](s+16)>r.lastAudioDts){const e=r.cacheAVPackets.get(t);e&&e.length?c.M[15](r.stats+236,Math.round(l.f[15](s+76)/l.f[15](s+72)/(Number(BigInt.asIntN(32,l.f[17](s+16)-l.f[17](e[0]+16)))/e.length))):c.M[15](r.stats+236,Math.round(l.f[15](s+76)/l.f[15](s+72)/Number(BigInt.asIntN(32,l.f[17](s+16)-r.lastAudioDts))))}r.lastAudioDts=l.f[17](s+16)}else if(0===r.formatContext.streams[t].codecpar.codecType&&r.cacheAVPackets.has(t)){if(c.M[17](r.stats+112,l.f[17](r.stats+112)+BigInt(1)),c.M[17](r.stats+104,l.f[17](r.stats+104)+BigInt(0|l.f[15](s+28))),1&l.f[15](s+36)?(c.M[17](r.stats+176,l.f[17](r.stats+176)+BigInt(1)),l.f[17](r.stats+176)>1&&l.f[17](s+8)>r.lastKeyFramePts&&(c.M[15](r.stats+96,r.gopCounter),r.gopCounter=1,c.M[15](r.stats+92,Number(BigInt.asIntN(32,(0,k.k)(l.f[17](s+8)-r.lastKeyFramePts,(0,o.A)(s+72,h.P),T.i0))))),r.lastKeyFramePts=l.f[17](s+8)):r.gopCounter++,l.f[17](r.stats+112)>1&&l.f[17](s+16)>r.lastVideoDts){const e=r.cacheAVPackets.get(t);e&&e.length?c.M[15](r.stats+224,Math.round(l.f[15](s+76)/l.f[15](s+72)/(Number(BigInt.asIntN(32,l.f[17](s+16)-l.f[17](e[0]+16)))/e.length))):c.M[15](r.stats+224,Math.round(l.f[15](s+76)/l.f[15](s+72)/Number(BigInt.asIntN(32,l.f[17](s+16)-r.lastVideoDts))))}r.lastVideoDts=l.f[17](s+16)}if(r.streamIndexFlush.get(t)){const e=r.formatContext.streams.find((e=>e.index===t));if(!(0,I.rU)(s,1)&&e&&e.codecpar.extradataSize){const t=(0,v.sY)(e.codecpar.extradataSize);(0,P.Mr)(t,e.codecpar.extradata,e.codecpar.extradataSize),(0,I.Ow)(s,1,t,e.codecpar.extradataSize)}r.streamIndexFlush.set(t,!1)}r.cacheRequests.has(t)?(this.replyAVPacket(r,r.rightIPCPorts.get(t),r.cacheRequests.get(t),s),r.cacheRequests.delete(t)):r.cacheAVPackets.has(t)?(r.cacheAVPackets.get(t).push(s),0!==r.stats&&(1===r.formatContext.streams[t].codecpar.codecType?c.M[15](r.stats+32,l.f[15](r.stats+32)+1):0===r.formatContext.streams[t].codecpar.codecType&&c.M[15](r.stats+120,l.f[15](r.stats+120)+1)),3===r.formatContext.streams[t].codecpar.codecType&&r.cacheAVPackets.get(t).length>i&&r.avpacketPool.release(r.cacheAVPackets.get(t).shift())):r.rightIPCPorts.has(L)?r.cacheRequests.has(L)?(this.replyAVPacket(r,r.rightIPCPorts.get(L),r.cacheRequests.get(L),s),r.cacheRequests.delete(L)):r.cacheAVPackets.get(L).push(s):r.avpacketPool.release(s)}}),0,0,!0,!1),r.loop.start(),A.Yz(`start demux loop, taskId: ${r.taskId}`,U,793)):A.h2("task not found",U,796)}async seek(t,e,i,r=-1){const s=this.tasks.get(t);if(s){if(s.loop){await s.loop.stopBeforeNextTick();let t=await g.jF(s.formatContext,r,e,i);if(t>=BigInt(0)){s.cacheAVPackets.forEach((t=>{w.__(t,(t=>{s.avpacketPool.release(t)})),t.length=0})),0!==s.stats&&s.cacheAVPackets.forEach(((t,e)=>{const i=s.formatContext.streams.find((t=>t.index===e));1===i.codecpar.codecType?c.M[15](s.stats+32,0):0===i.codecpar.codecType&&c.M[15](s.stats+120,0)}));const i=s.avpacketPool.alloc();for(;t=await g.Cj(s.formatContext,i),!(t<0||s.cacheAVPackets.has(l.f[15](i+32))););if(t>=0){s.demuxEnded=!1;const t=l.f[15](i+32);s.cacheAVPackets.get(t).push(i),0!==s.stats&&(1===s.formatContext.streams[l.f[15](i+32)].codecpar.codecType?c.M[15](s.stats+32,l.f[15](s.stats+32)+1):0===s.formatContext.streams[l.f[15](i+32)].codecpar.codecType&&c.M[15](s.stats+120,l.f[15](s.stats+120)+1)),s.loop.start();let e=l.f[17](i+8);return s.formatContext.streams[t].startTime!==T.Dh?e-=s.formatContext.streams[t].startTime:e-=s.formatContext.streams[t].firstDTS,(0,k.k)(S.T9(e,BigInt(0)),(0,o.A)(i+72,h.P),T.i0)}return A.R8(`got first packet failed after seek, taskId: ${s.taskId}`,U,864),s.avpacketPool.release(i),s.demuxEnded=!0,e}return t}{A.pq("seek before demux loop start",U,875);let t=await g.jF(s.formatContext,-1,e,i);return t<0?t:e}}}async croppingAVPacketQueue(t,e){const i=this.tasks.get(t);i&&i.cacheAVPackets.forEach(((t,r)=>{const s=i.formatContext.streams[r].codecpar.codecType,a=l.f[17](t[t.length-1]+16);let n=t.length-2;for(n=t.length-2;n>=0&&!((1&l.f[15](t[n]+36)||1===s)&&(0,k.k)(a-l.f[17](t[n]+16),(0,o.A)(t[n]+72,h.P),T.i0)>=e);n--);n>0&&(t.splice(0,n).forEach((t=>{i.avpacketPool.release(t)})),0!==i.stats&&(1===s?c.M[15](i.stats+32,t.length):0===s&&c.M[15](i.stats+120,t.length)))}))}async registerTask(t){return this.tasks.has(t.taskId)?u.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.loop&&(await e.loop.stopBeforeNextTick(),e.loop.destroy()),e.leftIPCPort.destroy(),e.rightIPCPorts.forEach((t=>{t.destroy()})),e.rightIPCPorts.clear(),e.formatContext.destroy(),(0,v.Eb)(e.buffer),e.cacheAVPackets.forEach((t=>{t.forEach((t=>{e.avpacketPool.release(t)}))})),this.tasks.delete(t))}}},87243:(t,e,i)=>{"use strict";i.d(e,{A:()=>f});var r=i(63939),s=i(50932),a=i(44527),n=i(77580),o=i(9705),l=i(84149),c=i(14686),h=i(79686),d=i(4624),u="src/avpipeline/IOPipeline.ts";class f extends a.A{constructor(){super()}async createTask(t){let e;switch(t.type){case 0:e=new n.A(t.options);break;case 1:e=new h.A(t.options);break;case 2:e=new((await Promise.resolve().then(i.bind(i,15433))).default)(t.options);break;case 3:e=new((await Promise.resolve().then(i.bind(i,41576))).default)(t.options)}if(!e)return o.UY;const a=new l.Ay(t.rightPort),f={...t,ioLoader:e,ipcPort:a};return a.on(l.S3,(async i=>{switch(i.method){case"open":try{const r=await e.open(t.info,t.range);if(r<0){d.z3(`loader open error, ${r}, taskId: ${t.taskId}`,u,116),a.reply(i,null,r);break}a.reply(i,r)}catch(e){d.z3(`loader open error, ${e}, taskId: ${t.taskId}`,u,123),a.reply(i,null,e)}break;case"read":{const n=i.params.pointer,l=i.params.length,h=i.params.ioloaderOptions,p=(0,c.JW)(n,l);try{const t=await e.read(p,h);s.M[17](f.stats+192,r.f[17](f.stats+192)+BigInt(0|t)),a.reply(i,t)}catch(e){d.z3(`loader read error, ${e}, taskId: ${t.taskId}`,u,144),a.reply(i,o.LR)}break}case"seek":{const r=i.params.pos,s=i.params.ioloaderOptions;try{const n=await e.seek(r,s);if(n<0){d.z3(`loader seek error, ${n}, taskId: ${t.taskId}`,u,160),a.reply(i,null,n);break}a.reply(i,n)}catch(e){d.z3(`loader seek error, ${e}, taskId: ${t.taskId}`,u,167),a.reply(i,null,e)}break}case"size":a.reply(i,await e.size())}})),this.tasks.set(t.taskId,f),0}async open(t){const e=this.tasks.get(t);if(e)return await e.ioLoader.open(e.info,e.range),0}async getDuration(t){const e=this.tasks.get(t);if(e)return 2===e.type||3===e.type?e.ioLoader.getDuration():0}async hasAudio(t){const e=this.tasks.get(t);return!(!e||3!==e.type)&&e.ioLoader.hasAudio()}async hasVideo(t){const e=this.tasks.get(t);return!(!e||3!==e.type)&&e.ioLoader.hasVideo()}async hasSubtitle(t){const e=this.tasks.get(t);return!(!e||3!==e.type)&&e.ioLoader.hasSubtitle()}async getVideoList(t){const e=this.tasks.get(t);if(e){if(3===e.type)return e.ioLoader.getVideoList();if(2===e.type)return e.ioLoader.getVideoList()}return{list:[],selectedIndex:0}}async getAudioList(t){const e=this.tasks.get(t);return e&&3===e.type?e.ioLoader.getAudioList():{list:[],selectedIndex:0}}async getSubtitleList(t){const e=this.tasks.get(t);return e&&3===e.type?e.ioLoader.getSubtitleList():{list:[],selectedIndex:0}}async selectVideo(t,e){const i=this.tasks.get(t);if(i)if(3===i.type)i.ioLoader.selectVideo(e);else if(2===i.type)return i.ioLoader.selectVideo(e)}async selectAudio(t,e){const i=this.tasks.get(t);i&&3===i.type&&i.ioLoader.selectAudio(e)}async selectSubtitle(t,e){const i=this.tasks.get(t);i&&3===i.type&&i.ioLoader.selectSubtitle(e)}async getMinBuffer(t){const e=this.tasks.get(t);if(e){if(3===e.type)return e.ioLoader.getMinBuffer();if(2===e.type)return e.ioLoader.getMinBuffer()}return 0}async registerTask(t){return this.tasks.has(t.taskId)?o.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(await e.ioLoader.stop(),e.ipcPort.destroy(),this.tasks.delete(t))}}},44527:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(134),s=i(80662),a=i.n(s),n=i(4624);class o{constructor(){(0,r.A)(this,"tasks",void 0),this.tasks=new(a())}async clear(){if(this.tasks.size)for(const t of this.tasks.keys())await this.unregisterTask(t)}async setLogLevel(t){n.V$(t)}async getTaskCount(){return this.tasks.size}}},31138:(t,e,i)=>{"use strict";i.d(e,{A:()=>M});var r=i(54001),s=i.n(r),a=i(63939),n=i(50932),o=i(12264),l=i(29170),c=i(9599),h=i(44527),d=i(9705),u=i(84149),f=i(40417),p=i(71039),m=i(4624),g=i(16041),v=i(67672),y=i(72739),A=i(13724),b=i(84290),x=i(39638),w=i(44328),k=i(86932),T=i(95797),S=i(72703),I=i(94561),P=i(71762),_=i(37837),E=i(71766),C="src/avpipeline/VideoDecodePipeline.ts";class M extends h.A{constructor(){super()}createWebcodecDecoder(t,e=!0){return new p.A({onError:e=>{if(t.hardwareRetryCount>3||!t.firstDecoded)t.targetDecoder===t.hardwareDecoder&&(t.targetDecoder=t.softwareDecoder,t.hardwareDecoder.close(),t.hardwareDecoder=null,t.decoderReady=this.openSoftwareDecoder(t),m.R8(`video decode error width hardware(${t.hardwareRetryCount}), taskId: ${t.taskId}, error: ${e}, try to fallback to software decoder`,C,126));else{t.hardwareRetryCount++;try{m.pq(`retry open hardware decoder(${t.hardwareRetryCount}), taskId: ${t.taskId}`,C,132),t.decoderReady=t.hardwareDecoder.open(t.parameters)}catch(e){m.R8(`retry open hardware decoder failed, fallback to software decoder, taskId: ${t.taskId}`,C,136)}}t.needKeyFrame=!0,t.leftIPCPort.request("requestKeyframe")},onReceiveFrame(e){t.firstDecoded=!0,t.frameCaches.push(e),n.M[17](t.stats+144,a.f[17](t.stats+144)+BigInt(1)),t.lastDecodeTimestamp&&n.M[15](t.stats+248,Math.max((0,k.A)()-t.lastDecodeTimestamp,a.f[15](t.stats+248))),t.lastDecodeTimestamp=(0,k.A)()},enableHardwareAcceleration:e})}createWasmcodecDecoder(t,e){return new f.A({resource:e,onError:e=>{m.z3(`video decode error, taskId: ${t.taskId}, error: ${e}`,C,162),t.openReject&&(t.openReject(d.r8),t.openReject=null)},onReceiveFrame(e){t.firstDecoded=!0,t.frameCaches.push(e),n.M[17](t.stats+144,a.f[17](t.stats+144)+BigInt(1)),t.lastDecodeTimestamp&&n.M[15](t.stats+248,Math.max((0,k.A)()-t.lastDecodeTimestamp,a.f[15](t.stats+248))),t.lastDecodeTimestamp=(0,k.A)()},avframePool:t.avframePool})}async pullAVPacketInternal(t,e){const i=await e.request("pull");if(v.ai(i))return i;{const e=t.avpacketPool.alloc();return(0,P.r0)(i,e),e}}async createTask(t){const e=new u.Ay(t.leftPort),i=new u.Ay(t.rightPort),r=[],c=new g.A((0,l.A)(t.avframeList,o.A),t.avframeListMutex),h={...t,resource:await(0,I.A)(t.resource,!0),leftIPCPort:e,rightIPCPort:i,softwareDecoder:null,hardwareDecoder:null,frameCaches:r,inputEnd:!1,targetDecoder:null,needKeyFrame:!0,parameters:0,hardwareRetryCount:0,lastDecodeTimestamp:0,firstDecoded:!1,decoderReady:null,softwareDecoderOpened:!1,avframePool:c,avpacketPool:new b.A((0,l.A)(t.avpacketList,o.A),t.avpacketListMutex)};return h.softwareDecoder=h.resource?this.createWasmcodecDecoder(h,h.resource):T.A.videoDecoder?this.createWebcodecDecoder(h,!1):null,h.softwareDecoder?(T.A.videoDecoder&&t.enableHardware&&(h.hardwareDecoder=this.createWebcodecDecoder(h)),h.targetDecoder=h.hardwareDecoder||h.softwareDecoder,this.tasks.set(t.taskId,h),i.on(u.S3,(async o=>{switch(o.method){case"pull":if(r.length){const t=r.shift();i.reply(o,t,null,(0,S.A)(t)||v.ai(t)?null:[t]);break}if(!h.inputEnd){for(;;){if(r.length){const t=r.shift();i.reply(o,t,null,(0,S.A)(t)||v.ai(t)?null:[t]);break}h.decoderReady&&(await h.decoderReady,h.decoderReady=null);const l=await this.pullAVPacketInternal(h,e);if(-1048576===l){if(h.targetDecoder===h.hardwareDecoder){let t=await s().race([new A.A(2),h.targetDecoder.flush()]);v.ai(t)&&m.R8(`video hardware decoder flush failed, ignore it, taskId: ${h.taskId}`,C,277)}else await h.targetDecoder.flush();if(h.inputEnd=!0,h.targetDecoder===h.hardwareDecoder&&await new A.A(0),r.length){const t=r.shift();i.reply(o,t,null,h.targetDecoder===h.hardwareDecoder?[t]:null);break}m.pq(`video decoder ended, taskId: ${h.taskId}`,C,294),i.reply(o,-1048576);break}if(!(l>0)){m.z3(`video decode pull avpacket error, taskId: ${t.taskId}, ret: ${l}`,C,399),i.reply(o,l);break}{if(h.needKeyFrame){if(!(1&a.f[15](l+36))){h.avpacketPool.release(l);continue}h.needKeyFrame=!1}let e=h.targetDecoder.decode(l);if(e<0){if(n.M[15](h.stats+136,a.f[15](h.stats+136)+1),h.targetDecoder instanceof p.A&&h.softwareDecoder){if(m.R8(`video decode error width hardware, taskId: ${h.taskId}, error: ${e}, try to fallback to software decoder`,C,321),h.targetDecoder===h.hardwareDecoder)h.hardwareDecoder.close(),h.hardwareDecoder=null;else{if(!h.resource){m.z3(`cannot fallback to wasm video decoder because of resource not found , taskId: ${t.taskId}`,C,332),i.reply(o,d.r8);break}h.softwareDecoder.close(),h.softwareDecoder=this.createWasmcodecDecoder(h,h.resource)}try{await this.openSoftwareDecoder(h),h.targetDecoder=h.softwareDecoder}catch(e){m.z3(`video software decoder open error, taskId: ${t.taskId}`,C,342),i.reply(o,d.r8);break}if(!(1&a.f[15](l+36))){h.avpacketPool.release(l),h.needKeyFrame=!0,h.leftIPCPort.request("requestKeyframe");continue}if(e=h.targetDecoder.decode(l),e>=0){h.avpacketPool.release(l);continue}if(h.targetDecoder instanceof p.A&&h.resource){m.R8(`video decode error width webcodecs soft decoder, taskId: ${h.taskId}, error: ${e}, try to fallback to wasm software decoder`,C,356),h.softwareDecoder.close(),h.softwareDecoder=this.createWasmcodecDecoder(h,h.resource),h.softwareDecoderOpened=!1;try{await this.openSoftwareDecoder(h),h.targetDecoder=h.softwareDecoder}catch(e){m.z3(`video wasm software decoder open error, taskId: ${t.taskId}`,C,366),i.reply(o,d.r8);break}if(e=h.targetDecoder.decode(l),e>=0){h.avpacketPool.release(l);continue}}}h.avpacketPool.release(l),m.z3(`video decode error, taskId: ${t.taskId}, ret: ${e}`,C,385),i.reply(o,e);break}for(h.avpacketPool.release(l);h.targetDecoder instanceof p.A&&h.targetDecoder.getQueueLength()>20;)await new A.A(0)}}break}m.pq(`video decoder ended, taskId: ${h.taskId}`,C,406),i.reply(o,-1048576)}})),0):(m.z3("software decoder not support",C,234),d.lh)}async openSoftwareDecoder(t){if(t.softwareDecoder&&!t.softwareDecoderOpened){const e=t.parameters;let i=1;if((0,x.A)()){let t=a.f[15](e+56)*a.f[15](e+60),r=(0,w.lb)((0,l.A)(e+72,c.P));t>=2073600&&t<=2211840?(173!==a.f[15](e+4)&&196!==a.f[15](e+4)&&225!==a.f[15](e+4)||(i=2),r>30?(i=2,173!==a.f[15](e+4)&&196!==a.f[15](e+4)&&225!==a.f[15](e+4)||(i=4)):r>60&&(i=4,173!==a.f[15](e+4)&&196!==a.f[15](e+4)&&225!==a.f[15](e+4)||(i=6))):t>2211840&&t<=8294400?(i=4,173!==a.f[15](e+4)&&196!==a.f[15](e+4)&&225!==a.f[15](e+4)||(i=6)):t>8294400&&(i=6,173!==a.f[15](e+4)&&196!==a.f[15](e+4)&&225!==a.f[15](e+4)||(i=8)),i=Math.min(i,navigator.hardwareConcurrency)}try{await t.softwareDecoder.open(e,i,t.wasmDecoderOptions)}catch(r){if(!(t.softwareDecoder instanceof p.A&&t.resource))throw r;m.R8(`webcodecs software decoder open failed, ${r}, try to fallback to wasm software decoder`,C,477),t.softwareDecoder.close(),t.softwareDecoder=this.createWasmcodecDecoder(t,t.resource),await t.softwareDecoder.open(e,i),t.targetDecoder=t.softwareDecoder}t.softwareDecoderOpened=!0}}async reopenDecoder(t,e,i,r){const a=this.tasks.get(t);if(a){const t=(0,_.Gy)(168);let n;(0,S.A)(e)?(0,E.Yi)(t,e):(0,P.T8)(e,t),a.parameters&&(0,E.dn)(a.parameters),a.parameters=t,r&&(a.wasmDecoderOptions=r),i&&(i=await(0,I.A)(i,!0)),n=a.preferWebCodecs&&T.A.videoDecoder&&p.A.isSupported(t,!1)?this.createWebcodecDecoder(a,!1):i?this.createWasmcodecDecoder(a,i):T.A.videoDecoder?this.createWebcodecDecoder(a,!1):null;let o=T.A.videoDecoder&&a.enableHardware?this.createWebcodecDecoder(a,!0):null;return new(s())((async(e,r)=>{if(a.openReject=e,a.softwareDecoder&&a.softwareDecoder.close(),a.hardwareDecoder&&a.hardwareDecoder.close(),a.softwareDecoder=n,a.hardwareDecoder=o,a.targetDecoder=a.hardwareDecoder||a.softwareDecoder,a.hardwareRetryCount=0,a.hardwareDecoder)try{await a.hardwareDecoder.open(t),m.Yz(`reopen video hardware decoder, taskId: ${a.taskId}`,C,552)}catch(t){m.z3(`cannot reopen hardware decoder, ${t}, taskId: ${a.taskId}`,C,555),a.hardwareDecoder.close(),a.hardwareDecoder=null,a.targetDecoder=a.softwareDecoder}if(i&&(a.resource=i),a.targetDecoder===a.softwareDecoder)try{await this.openSoftwareDecoder(a),m.Yz(`reopen video soft decoder, taskId: ${a.taskId}`,C,570)}catch(t){if(m.z3(`reopen video software decoder failed, error: ${t}`,C,573),!a.hardwareDecoder)return void e(d.r8)}e(0)}))}m.h2("task not found",C,583)}async open(t,e,i={}){const r=this.tasks.get(t);if(r){r.wasmDecoderOptions=i;const t=(0,_.Gy)(168);if((0,S.A)(e)?(0,E.Yi)(t,e):(0,P.T8)(e,t),r.parameters&&(0,E.dn)(r.parameters),r.parameters=t,r.preferWebCodecs&&T.A.videoDecoder&&p.A.isSupported(t,!1)&&r.softwareDecoder instanceof f.A){r.softwareDecoder.close();const t=this.createWebcodecDecoder(r,!1);r.softwareDecoder===r.targetDecoder&&(r.targetDecoder=t),r.softwareDecoder=t}return new(s())((async(e,i)=>{if(r.openReject=e,r.hardwareDecoder)try{await r.hardwareDecoder.open(t)}catch(t){m.z3(`cannot open hardware decoder, ${t}`,C,623),r.hardwareDecoder.close(),r.hardwareDecoder=null,r.targetDecoder=r.softwareDecoder}if(r.targetDecoder===r.softwareDecoder)try{await this.openSoftwareDecoder(r)}catch(t){if(m.z3(`open video software decoder failed, error: ${t}`,C,635),!r.hardwareDecoder)return void e(d.r8)}e(0)}))}m.h2("task not found",C,645)}async setPlayRate(t,e){const i=this.tasks.get(t);if(i&&i.softwareDecoder){let t=-16,r=(0,w.lb)((0,l.A)(i.parameters+72,c.P));t=r>=120?e<=1?-16:e<1.5||e<3?8:32:r>=60?e<1.5?-16:e<3?8:e<8?24:32:-16,i.softwareDecoder.setSkipFrameDiscard(t)}}async resetTask(t){const e=this.tasks.get(t);e&&(e.targetDecoder===e.softwareDecoder?await e.targetDecoder.flush():e.targetDecoder===e.hardwareDecoder&&(e.hardwareDecoder.close(),e.hardwareDecoder=this.createWebcodecDecoder(e),await e.hardwareDecoder.open(e.parameters),e.targetDecoder=e.hardwareDecoder),y.__(e.frameCaches,(t=>{(0,S.A)(t)?e.avframePool.release(t):t.close()})),e.frameCaches.length=0,e.needKeyFrame=!0,e.inputEnd=!1,e.lastDecodeTimestamp=(0,k.A)(),m.pq(`reset video decoder, taskId: ${e.taskId}`,C,716))}async registerTask(t){return this.tasks.has(t.taskId)?d.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.rightPort.close(),e.leftPort.close(),e.softwareDecoder&&e.softwareDecoder.close(),e.hardwareDecoder&&e.hardwareDecoder.close(),e.frameCaches.forEach((t=>{(0,S.A)(t)?e.avframePool.release(t):t.close()})),e.parameters&&(0,E.dn)(e.parameters),this.tasks.delete(t))}async getTasksInfo(){const t=[];return this.tasks.forEach((e=>{t.push({codecId:a.f[15](e.parameters+4),width:a.f[15](e.parameters+56),height:a.f[15](e.parameters+60),framerate:(0,w.lb)((0,l.A)(e.parameters+72,c.P)),hardware:e.targetDecoder===e.hardwareDecoder})})),t}}},33968:(t,e,i)=>{"use strict";i.d(e,{A:()=>z});var r=i(54001),s=i.n(r),a=i(12264),n=i(29170),o=i(63939),l=i(50932),c=i(44527),h=i(9705),d=i(84149),u=i(67672),f=i(72739),p=i(16041),m=i(95797),g=i(39148),v=i(86932),y=i(44328),A=i(77231),b=i(86834),x=i(4624),w=i(43607),k=i(15045),T=i(88103),S=i(54750),I=i(55196),P=i(43813),_=i(99293),E=i(37977),C=i(1052),M=i(90058),R=i(39638),B=i(7972),D=i(72703),U="src/avpipeline/VideoRenderPipeline.ts";const L=[E.A,C.A];L.push(M.A);const N=[I.A,P.A];var O;N.push(_.A),function(t){t[t.None=0]="None",t[t.Accelerate=1]="Accelerate",t[t.Decelerate=2]="Decelerate"}(O||(O={}));let F=!1;const $=["bt2020","bt2100","st2048","p3-dcl","hlg"];class z extends c.A{constructor(){super()}async createTask(t){const e=new d.Ay(t.leftPort),i=new d.Ay(t.controlPort),r={...t,leftIPCPort:e,controlIPCPort:i,render:null,currentPTS:A.Dh,firstPTS:BigInt(0),startTimestamp:BigInt(0),playRate:BigInt(100),targetRate:BigInt(100),frontFrame:null,backFrame:null,renderFrame:null,renderFrameCount:BigInt(0),loop:null,renderRedyed:!1,adjust:O.None,adjustDiff:BigInt(0),lastAdjustTimestamp:BigInt(0),firstRendered:!1,canvasUpdated:!1,renderCreating:!1,pauseTimestamp:0,pauseCurrentPts:BigInt(0),lastNotifyPTS:BigInt(0),skipRender:!1,isSupport:()=>!1,frontBuffered:!1,ended:!1,seeking:!1,seekSync:null,afterPullResolver:null,pausing:!1,lastRenderTimestamp:0,avframePool:new p.A((0,n.A)(t.avframeList,a.A),t.avframeListMutex)};return r.startPTS=(0,y.k)(r.startPTS,r.timeBase,A.i0),i.on(d.Wo,(async t=>{switch(t.method){case"syncPts":{const e=t.params.pts,i=Math.abs(Number(e-r.currentPTS));i>100&&r.currentPTS>BigInt(0)&&(e>r.currentPTS?(r.adjust=O.Accelerate,x.Yz(`video render sync pts accelerate, targetPTS: ${e}, currentPTS: ${r.currentPTS}, diff: ${i}, taskId: ${r.taskId}`,U,234)):(r.adjust=O.Decelerate,x.Yz(`video render sync pts decelerate, targetPTS: ${e}, currentPTS: ${r.currentPTS}, diff: ${i} taskId: ${r.taskId}`,U,238)),r.adjustDiff=BigInt(Math.floor(i)));break}case"skipRender":r.skipRender=t.params.skipRender}})),this.tasks.set(t.taskId,r),0}swap(t){if(t.seeking)return;if(t.backFrame&&((0,D.A)(t.backFrame)?t.avframePool.release(t.backFrame):t.backFrame.close()),t.backFrame=null,!t.frontBuffered)return!1;if(t.backFrame=t.frontFrame,t.frontFrame=null,t.ended)return;t.frontBuffered=!1;const e=(0,v.A)();return t.leftIPCPort.request("pull").then((i=>{if(t.afterPullResolver&&t.afterPullResolver(),u.ai(i)&&i<0)return t.ended=!0,void(t.frontFrame=null);const r=(0,v.A)()-e;if(r>1e3&&(t.startTimestamp+=BigInt(Math.floor(r))),t.frontFrame=i,t.frontBuffered=!0,t.seekSync)return t.seekSync(),void(t.seekSync=null);t.backFrame||this.swap(t)})),!0}async createRender(t,e,i=!1){var r;if(!t.renderCreating)if(t.renderCreating=!0,t.renderRedyed=!1,t.render&&t.render.destroy(),(0,D.A)(e)?t.enableWebGPU&&m.A.webgpu&&!F?f.__(L,(i=>{if(i.isSupport(e))return t.render=new i(t.canvas,{devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode,onRenderContextLost:()=>{t.canvasUpdated=!1,t.renderRedyed=!1,x.R8("render context lost",U,372),t.controlIPCPort.notify("updateCanvas")}}),t.isSupport=i.isSupport,!1})):f.__(N,(i=>{if(i.isSupport(e))return t.render=new i(t.canvas,{devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode,onRenderContextLost:()=>{t.canvasUpdated=!1,t.renderRedyed=!1,x.R8("render context lost",U,390),t.controlIPCPort.notify("updateCanvas")}}),t.isSupport=i.isSupport,!1})):t.enableWebGPU&&m.A.webgpu&&!F&&((b.A.chrome||b.A.newEdge)&&b.A.checkVersion(b.A.majorVersion,"116",!0)||b.A.safari&&b.A.checkVersion(b.A.majorVersion,"17.4",!0)||b.A.firefox&&b.A.checkVersion(b.A.majorVersion,"129",!0))&&(r=e.colorSpace.primaries,!f.zy($,r))?(t.render=new S.A(t.canvas,{devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode,onRenderContextLost:()=>{t.canvasUpdated=!1,t.renderRedyed=!1,x.R8("render context lost",U,342),t.controlIPCPort.notify("updateCanvas")}}),t.isSupport=S.A.isSupport):(t.render=new T.A(t.canvas,{devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode}),t.isSupport=T.A.isSupport),t.render){try{var s,a,n;await t.render.init(),t.render.viewport(t.viewportWidth,t.viewportHeight),t.render.setRotate(null!==(s=t.renderRotate)&&void 0!==s?s:0),t.render.enableHorizontalFlip(null!==(a=t.flipHorizontal)&&void 0!==a&&a),t.render.enableVerticalFlip(null!==(n=t.flipVertical)&&void 0!==n&&n),t.render.render(e),t.render.clear()}catch(r){if(t.render instanceof k.A)return F=!0,t.renderCreating=!1,x.R8("not support webgpu render, try to fallback to webgl render",U,418),this.createRender(t,e,!0);if(i)return t.renderCreating=!1,x.R8("canvas context lost after fallback, wait for recreate canvas",U,423),void t.controlIPCPort.notify("updateCanvas")}t.renderRedyed=!0,t.renderCreating=!1}else t.renderCreating=!1}async play(t){const e=this.tasks.get(t);if(e){if(e.loop&&x.h2("task has already call play",U,436),e.backFrame=await e.leftIPCPort.request("pull"),u.ai(e.backFrame)&&e.backFrame<0)return e.backFrame=0,x.pq(`video render ended, taskId: ${e.taskId}`,U,443),void e.controlIPCPort.notify("ended");e.frontFrame=await e.leftIPCPort.request("pull"),e.frontBuffered=!0,e.ended=!1,u.ai(e.frontFrame)&&e.frontFrame<0&&(e.ended=!0,e.frontBuffered=!1,e.frontFrame=0);const t=this;await this.createRender(e,e.backFrame),e.firstPTS=(0,y.k)((0,D.A)(e.backFrame)?o.f[17](e.backFrame+104):BigInt(Math.floor(e.backFrame.timestamp)),e.timeBase,A.i0),x.Yz(`got first video frame, pts: ${(0,D.A)(e.backFrame)?o.f[17](e.backFrame+104):BigInt(Math.floor(e.backFrame.timestamp))}(${e.firstPTS}ms), taskId: ${e.taskId}`,U,469),e.firstPTS<BigInt(1e3)&&(e.firstPTS=BigInt(0)),e.currentPTS=e.firstPTS,e.startTimestamp=BigInt(Math.floor((0,v.A)()))-e.firstPTS*BigInt(100)/e.playRate;const i=(0,R.A)(),r=i&&m.A.shareArrayBuffer?0:10;e.loop=new g.A((()=>{if(!e.backFrame)return void(e.ended?(e.render&&e.renderRedyed&&e.render.clear(),e.loop.stop(),e.adjust=O.None,x.pq(`video render ended, taskId: ${e.taskId}`,U,497),e.controlIPCPort.notify("ended")):e.loop.emptyTask());if(!e.isSupport(e.backFrame)){if(e.render)return e.renderRedyed=!1,e.renderFrame=e.backFrame,void e.controlIPCPort.notify("updateCanvas");this.createRender(e,e.backFrame)}const r=(0,y.k)((0,D.A)(e.backFrame)?o.f[17](e.backFrame+104):BigInt(Math.floor(e.backFrame.timestamp)),e.timeBase,A.i0);if(r<e.currentPTS){if(!(e.currentPTS-r>BigInt(5e3)))return x.R8(`dropping frame with pts ${r}, which is earlier then the last rendered frame(${e.currentPTS}), taskId: ${e.taskId}`,U,527),void this.swap(e);e.startTimestamp=BigInt(Math.floor((0,v.A)()))-r*BigInt(100)/e.targetRate}else r-e.currentPTS>BigInt(5e3)&&(e.startTimestamp=BigInt(Math.floor((0,v.A)()))-r*BigInt(100)/e.targetRate);if(e.adjust===O.Accelerate){if(e.adjustDiff<=0)e.adjust=O.None,e.startTimestamp=BigInt(Math.floor((0,v.A)()))-r*BigInt(100)/e.targetRate,e.lastAdjustTimestamp=BigInt(0);else if(BigInt(Math.floor((0,v.A)()))-e.lastAdjustTimestamp>=BigInt(200)){const t=e.adjustDiff<=BigInt(100)?e.adjustDiff:w.jk(e.adjustDiff,BigInt(100))*BigInt(100)/e.targetRate;e.startTimestamp-=t,e.adjustDiff-=t,x.Yz(`video render accelerate startTimestamp sub: ${t}, taskId: ${e.taskId}`,U,552),e.lastAdjustTimestamp=BigInt(Math.floor((0,v.A)()))}}else if(e.adjust===O.Decelerate)if(e.adjustDiff<=0)e.adjust=O.None,e.startTimestamp=BigInt(Math.floor((0,v.A)()))-r*BigInt(100)/e.targetRate,e.lastAdjustTimestamp=BigInt(0);else if(BigInt(Math.floor((0,v.A)()))-e.lastAdjustTimestamp>=BigInt(300)){const t=e.adjustDiff<BigInt(50)?e.adjustDiff:w.jk(e.adjustDiff,BigInt(50))*BigInt(100)/e.targetRate;e.startTimestamp+=t,e.adjustDiff-=t,x.Yz(`video render decelerate startTimestamp add: ${t}, taskId: ${e.taskId}`,U,573),e.lastAdjustTimestamp=BigInt(Math.floor((0,v.A)()))}e.enableJitterBuffer&&o.f[15](e.stats+120)/o.f[15](e.stats+224)*1e3<=o.f[15](e.stats+272)&&t.setPlayRate(e.taskId,1);const s=r*BigInt(100)/e.playRate+e.startTimestamp-BigInt(Math.floor((0,v.A)()));s<=0?(e.renderRedyed&&!e.skipRender&&(i||-s<BigInt(100)||e.renderFrameCount&BigInt(1))?(e.render.render(e.backFrame),l.M[17](e.stats+328,r),l.M[17](e.stats+160,o.f[17](e.stats+160)+BigInt(1)),e.lastRenderTimestamp&&l.M[15](e.stats+252,Math.max((0,v.A)()-e.lastRenderTimestamp,o.f[15](e.stats+252))),e.lastRenderTimestamp=(0,v.A)()):l.M[15](e.stats+168,o.f[15](e.stats+168)+1),e.renderFrameCount++,(0,D.A)(e.backFrame)?(l.M[15](e.stats+84,o.f[15](e.backFrame+68)),l.M[15](e.stats+88,o.f[15](e.backFrame+72))):(l.M[15](e.stats+84,e.backFrame.displayWidth),l.M[15](e.stats+88,e.backFrame.displayHeight)),e.firstRendered||(e.controlIPCPort.notify(e.canvasUpdated?"firstRenderedAfterUpdateCanvas":"firstRendered"),e.firstRendered=!0,e.canvasUpdated=!1),e.playRate!==e.targetRate&&(e.startTimestamp=BigInt(Math.floor((0,v.A)()))-r*BigInt(100)/e.targetRate,e.playRate=e.targetRate),e.currentPTS=r,r-e.lastNotifyPTS>=BigInt(1e3)&&(e.lastNotifyPTS=r,e.controlIPCPort.notify("syncPts",{pts:r})),this.swap(e)):e.loop.emptyTask()}),0,r),e.loop.start()}else x.h2("task not found",U,645)}async restart(t){const e=this.tasks.get(t);e&&(e.loop||x.h2("task has not played",U,653),e.loop.isStarted()&&x.h2("task has already run",U,657),e.backFrame&&((0,D.A)(e.backFrame)?e.avframePool.release(e.backFrame):e.backFrame.close()),e.frontFrame&&((0,D.A)(e.frontFrame)?e.avframePool.release(e.frontFrame):e.frontFrame.close()),e.backFrame=await e.leftIPCPort.request("pull"),e.frontFrame=await e.leftIPCPort.request("pull"),e.frontBuffered=!0,e.ended=!1,e.adjust=O.None,e.lastNotifyPTS=A.Dh,e.firstRendered=!1,e.firstPTS=(0,y.k)((0,D.A)(e.backFrame)?o.f[17](e.backFrame+104):BigInt(Math.floor(e.backFrame.timestamp)),e.timeBase,A.i0),e.currentPTS=e.firstPTS,e.firstPTS<BigInt(1e3)&&(e.firstPTS=BigInt(0)),e.startTimestamp=BigInt(Math.floor((0,v.A)()))-e.firstPTS*BigInt(100)/e.playRate,e.loop.start())}async pause(t){const e=this.tasks.get(t);e&&(e.loop||x.h2("task has not played",U,708),e.pauseTimestamp=(0,v.A)(),e.pauseCurrentPts=e.currentPTS,e.loop.stop(),e.pausing=!0,x.pq(`task paused, taskId: ${e.taskId}`,U,715))}async unpause(t){const e=this.tasks.get(t);if(e){if(e.seeking)return;e.loop||x.h2("task has not played",U,726),e.startTimestamp+=BigInt(Math.floor((0,v.A)()-e.pauseTimestamp)),e.startTimestamp-=e.currentPTS-e.pauseCurrentPts,e.seeking||e.loop.start(),e.pausing=!1,e.lastRenderTimestamp=(0,v.A)(),x.pq(`task unpaused, taskId: ${e.taskId}`,U,736)}}async updateCanvas(t,e){const i=this.tasks.get(t);i?(i.canvas=e,i.render&&(i.render.destroy(),i.render=null),i.isSupport=()=>!1,i.canvasUpdated=!0,i.firstRendered=!1,i.renderRedyed=!1):x.h2("task not found",U,754)}async setPlayRate(t,e){const i=this.tasks.get(t);i&&(i.enableJitterBuffer&&o.f[15](i.stats+120)/o.f[15](i.stats+224)*1e3<=o.f[15](i.stats+272)&&(e=1),i.targetRate=BigInt(Math.floor(Math.floor(100*e))))}async setRenderMode(t,e){const i=this.tasks.get(t);i&&i.render&&(i.renderMode=e,i.render.setRenderMode(e),(0,B.A)((()=>{i.pausing&&i.backFrame&&i.render&&i.render.render(i.backFrame)})))}async setRenderRotate(t,e){const i=this.tasks.get(t);i&&i.render&&(i.renderRotate=e,i.render.setRotate(e),(0,B.A)((()=>{i.pausing&&i.backFrame&&i.render&&i.render.render(i.backFrame)})))}async enableHorizontalFlip(t,e){const i=this.tasks.get(t);i&&i.render&&(i.flipHorizontal=e,i.render.enableHorizontalFlip(e),(0,B.A)((()=>{i.pausing&&i.backFrame&&i.render&&i.render.render(i.backFrame)})))}async enableVerticalFlip(t,e){const i=this.tasks.get(t);i&&i.render&&(i.flipVertical=e,i.render.enableVerticalFlip(e),(0,B.A)((()=>{i.pausing&&i.backFrame&&i.render&&i.render.render(i.backFrame)})))}async resize(t,e,i){const r=this.tasks.get(t);r&&r.render&&(r.render.viewport(e,i),(0,B.A)((()=>{r.pausing&&r.backFrame&&r.render&&r.render.render(r.backFrame)})))}async setSkipRender(t,e){const i=this.tasks.get(t);i&&(i.skipRender=e,l.M[15](i.stats+252,0),i.lastRenderTimestamp=(0,v.A)())}async beforeSeek(t){const e=this.tasks.get(t);e&&(e.ended||e.frontBuffered||(x.Yz(`wait current pull front frame before seek, taskId: ${e.taskId}`,U,859),await new(s())((t=>{e.seekSync=t}))),e.seeking=!0,e.loop.stop(),e.backFrame&&((0,D.A)(e.backFrame)?e.avframePool.release(e.backFrame):e.backFrame.close()),e.frontFrame&&((0,D.A)(e.frontFrame)?e.avframePool.release(e.frontFrame):e.frontFrame.close()),e.frontFrame=null,e.backFrame=null,e.currentPTS=A.Dh,x.Yz(`before seek end, taskId: ${e.taskId}`,U,887))}async syncSeekTime(t,e,i){const r=this.tasks.get(t);if(r){for(;;){if(r.backFrame=await r.leftIPCPort.request("pull"),u.ai(r.backFrame)&&r.backFrame<0)return r.ended=!0,r.seeking=!1,r.adjust=O.None,r.backFrame=null,x.R8(`pull video frame end after seek, taskId: ${t}`,U,903),void r.controlIPCPort.notify("ended");if(e<BigInt(0)){x.pq(`use the first video frame because of the seek time${e} < 0`,U,909);break}const i=(0,y.k)((0,D.A)(r.backFrame)?o.f[17](r.backFrame+104):BigInt(Math.floor(r.backFrame.timestamp)),r.timeBase,A.i0);if(i-r.startPTS>=e){l.M[17](r.stats+328,i);break}(0,D.A)(r.backFrame)?r.avframePool.release(r.backFrame):r.backFrame.close()}x.Yz(`sync seek time end, taskId: ${r.taskId}`,U,937)}}async afterSeek(t,e){const i=this.tasks.get(t);if(i){if(i.ended)return;i.startTimestamp=BigInt(Math.floor((0,v.A)()))-(e+i.startPTS)*BigInt(100)/i.playRate,i.frontFrame=await i.leftIPCPort.request("pull"),u.ai(i.frontFrame)&&i.frontFrame<0?(i.frontFrame=null,i.frontBuffered=!1,i.ended=!0):i.frontBuffered=!0,i.ended=!1,i.adjust=O.None,i.lastRenderTimestamp=(0,v.A)(),i.currentPTS=(0,y.k)((0,D.A)(i.backFrame)?o.f[17](i.backFrame+104):BigInt(Math.floor(i.backFrame.timestamp)),i.timeBase,A.i0),l.M[17](i.stats+328,i.currentPTS),x.Yz(`got first video frame, pts: ${(0,D.A)(i.backFrame)?o.f[17](i.backFrame+104):BigInt(Math.floor(i.backFrame.timestamp))}(${i.currentPTS}ms), taskId: ${i.taskId}`,U,972),i.seeking=!1,i.pausing?i.backFrame&&(i.render.render(i.backFrame),i.pauseCurrentPts=i.currentPTS,i.pauseTimestamp=(0,v.A)()):i.loop.start(),x.Yz(`after seek end, taskId: ${i.taskId}`,U,988)}}async renderNextFrame(t){const e=this.tasks.get(t);if(e&&e.backFrame){const t=(0,y.k)((0,D.A)(e.backFrame)?o.f[17](e.backFrame+104):BigInt(Math.floor(e.backFrame.timestamp)),e.timeBase,A.i0);e.render.render(e.backFrame),l.M[17](e.stats+328,t),l.M[17](e.stats+160,o.f[17](e.stats+160)+BigInt(1)),e.currentPTS=t,this.swap(e)}}async registerTask(t){return this.tasks.has(t.taskId)?h.lh:await this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);if(e){const i=!!e.loop;e.loop&&(await e.loop.stopBeforeNextTick(),e.loop.destroy(),e.loop=null),!i||e.ended||e.frontFrame||await new(s())((t=>{e.afterPullResolver=t})),e.render&&(e.render.destroy(),e.render=null),e.backFrame&&((0,D.A)(e.backFrame)&&e.backFrame>0?e.avframePool.release(e.backFrame):e.backFrame.close(),e.backFrame=null),e.frontFrame&&((0,D.A)(e.frontFrame)&&e.frontFrame>0?e.avframePool.release(e.frontFrame):e.frontFrame.close(),e.frontFrame=null),e.leftIPCPort.destroy(),e.controlIPCPort.destroy(),this.tasks.delete(t)}}}},30128:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085);class h{constructor(){(0,a.A)(this,"min",void 0),(0,a.A)(this,"max",void 0)}}r=h.prototype,(s=new(o())).set("min",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("max",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,4),(0,c.A)(r,l.g7,8),(0,c.A)(r,l.JY,s);class d{constructor(){(0,a.A)(this,"channels",void 0),(0,a.A)(this,"sampleRate",void 0),(0,a.A)(this,"audioFrameSize",void 0),(0,a.A)(this,"audioPacketBytes",void 0),(0,a.A)(this,"audioPacketCount",void 0),(0,a.A)(this,"audioPacketQueueLength",void 0),(0,a.A)(this,"audioDropPacketCount",void 0),(0,a.A)(this,"audioDecodeErrorPacketCount",void 0),(0,a.A)(this,"audioEncodeErrorFrameCount",void 0),(0,a.A)(this,"audioFrameDecodeCount",void 0),(0,a.A)(this,"audioPacketEncodeCount",void 0),(0,a.A)(this,"audioFrameRenderCount",void 0),(0,a.A)(this,"audioFrameDropCount",void 0),(0,a.A)(this,"width",void 0),(0,a.A)(this,"height",void 0),(0,a.A)(this,"keyFrameInterval",void 0),(0,a.A)(this,"gop",void 0),(0,a.A)(this,"videoPacketBytes",void 0),(0,a.A)(this,"videoPacketCount",void 0),(0,a.A)(this,"videoPacketQueueLength",void 0),(0,a.A)(this,"videoDropPacketCount",void 0),(0,a.A)(this,"videoDecodeErrorPacketCount",void 0),(0,a.A)(this,"videoEncodeErrorFrameCount",void 0),(0,a.A)(this,"videoFrameDecodeCount",void 0),(0,a.A)(this,"videoPacketEncodeCount",void 0),(0,a.A)(this,"videoFrameRenderCount",void 0),(0,a.A)(this,"videoFrameDropCount",void 0),(0,a.A)(this,"keyFrameCount",void 0),(0,a.A)(this,"bufferDropBytes",void 0),(0,a.A)(this,"bufferReceiveBytes",void 0),(0,a.A)(this,"bufferOutputBytes",void 0),(0,a.A)(this,"audioBitrate",void 0),(0,a.A)(this,"videoBitrate",void 0),(0,a.A)(this,"videoDecodeFramerate",void 0),(0,a.A)(this,"videoRenderFramerate",void 0),(0,a.A)(this,"videoEncodeFramerate",void 0),(0,a.A)(this,"audioDecodeFramerate",void 0),(0,a.A)(this,"audioRenderFramerate",void 0),(0,a.A)(this,"audioEncodeFramerate",void 0),(0,a.A)(this,"audioFrameDecodeIntervalMax",void 0),(0,a.A)(this,"audioFrameRenderIntervalMax",void 0),(0,a.A)(this,"videoFrameDecodeIntervalMax",void 0),(0,a.A)(this,"videoFrameRenderIntervalMax",void 0),(0,a.A)(this,"bandwidth",void 0),(0,a.A)(this,"jitter",void 0),(0,a.A)(this,"jitterBuffer",void 0),(0,a.A)(this,"audioStutter",void 0),(0,a.A)(this,"videoStutter",void 0),(0,a.A)(this,"audiocodec",void 0),(0,a.A)(this,"videocodec",void 0),(0,a.A)(this,"firstAudioMuxDts",void 0),(0,a.A)(this,"lastAudioMuxDts",void 0),(0,a.A)(this,"firstVideoMuxDts",void 0),(0,a.A)(this,"lastVideoMuxDts",void 0),(0,a.A)(this,"audioCurrentTime",void 0),(0,a.A)(this,"videoCurrentTime",void 0)}}!function(t){var e=new(o());e.set("channels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("audioFrameSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("audioPacketBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("audioPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),e.set("audioPacketQueueLength",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),e.set("audioDropPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),e.set("audioDecodeErrorPacketCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),e.set("audioEncodeErrorFrameCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:52,8:0}),e.set("audioFrameDecodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),e.set("audioPacketEncodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("audioFrameRenderCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),e.set("audioFrameDropCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),e.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),e.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),e.set("keyFrameInterval",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),e.set("gop",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:96,8:0}),e.set("videoPacketBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),e.set("videoPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),e.set("videoPacketQueueLength",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:120,8:0}),e.set("videoDropPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:128,8:0}),e.set("videoDecodeErrorPacketCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),e.set("videoEncodeErrorFrameCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),e.set("videoFrameDecodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),e.set("videoPacketEncodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),e.set("videoFrameRenderCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:160,8:0}),e.set("videoFrameDropCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:168,8:0}),e.set("keyFrameCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:176,8:0}),e.set("bufferDropBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:184,8:0}),e.set("bufferReceiveBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:192,8:0}),e.set("bufferOutputBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:200,8:0}),e.set("audioBitrate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:208,8:0}),e.set("videoBitrate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:212,8:0}),e.set("videoDecodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:216,8:0}),e.set("videoRenderFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:220,8:0}),e.set("videoEncodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:224,8:0}),e.set("audioDecodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:228,8:0}),e.set("audioRenderFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:232,8:0}),e.set("audioEncodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:236,8:0}),e.set("audioFrameDecodeIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:240,8:0}),e.set("audioFrameRenderIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:244,8:0}),e.set("videoFrameDecodeIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:248,8:0}),e.set("videoFrameRenderIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:252,8:0}),e.set("bandwidth",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:256,8:0}),e.set("jitter",{0:19,1:0,2:0,3:0,4:0,5:0,6:0,7:264,8:0}),e.set("jitterBuffer",{0:h,1:0,2:0,3:0,4:0,5:0,6:0,7:272,8:0}),e.set("audioStutter",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:280,8:0}),e.set("videoStutter",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:284,8:0}),e.set("firstAudioMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:288,8:0}),e.set("lastAudioMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:296,8:0}),e.set("firstVideoMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:304,8:0}),e.set("lastVideoMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:312,8:0}),e.set("audioCurrentTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:320,8:0}),e.set("videoCurrentTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:328,8:0}),(0,c.A)(t,l.Og,!0),(0,c.A)(t,l.dc,8),(0,c.A)(t,l.g7,336),(0,c.A)(t,l.JY,e)}(d.prototype)},61634:(t,e,i)=>{"use strict";i.d(e,{A:()=>Bt,K:()=>Mt});var r=i(134),s=i(66681),a=i.n(s),n=i(54001),o=i.n(n),l=i(73146),c=i.n(l),h=i(80662),d=i.n(h),u=i(61499),f=i(74503),p=i(63939),m=i(9599),g=i(29170),v=i(77162),y=i(94300),A=i(87243),b=i(72480),x=i(31138),w=i(18667),k=i(88506),T=i(96172),S=i(8284),I=i(67672),P=i(95335),_=i(76045),E=i(56024),C=i(71517),M=i(59377),R=i(33968),B=i(8507),D=i(26429),U=i(41324),L=i(88397),N=i(11473),O=i(11628),F=i(28090),$=i(47595),z=i(4624),V=i(95797),G=i(48641),W=i(36),H=i(86834),j=i(44328),X=i(77231),q=i(14686),Y=i(67593),K=i(94663),Q=i(10333),Z=i(85224),J=i(25115),tt=i(21233),et=i(13724),it=i(78201),rt=i(73783),st=i(43607),at=i(76750),nt=i(2368),ot=i(1984),lt=i(62751),ct=i(548),ht=i(72739),dt=i(24310),ut=i(93147),ft=i(40031),pt=i(94561),mt=i(44690),gt=i(84149),vt=i(9705),yt=i(77580),At=i(79686),bt=i(49847),xt=i(15433),wt=i(41576),kt=i(52277),Tt=i(71762),St=i(29998),It=i(40097),Pt=i(21678),_t=i(21862),Et="src/avplayer/AVPlayer.ts";const Ct={1:"cover",0:"contain"},Mt=[27,173,12,196,225,139,167,30,86018,86017,86076,86028,86051,86021,86019,86056,86020,94226,94225,94230,94212,94232,94213,94210],Rt={enableHardware:!0,enableWebGPU:!0,enableWorker:!0,loop:!1,jitterBufferMax:10,jitterBufferMin:4,lowLatency:!1,preLoadTime:4};class Bt extends T.A{constructor(t){super(!0),(0,r.A)(this,"VideoDecoderThread",void 0),(0,r.A)(this,"VideoRenderThread",void 0),(0,r.A)(this,"VideoPipelineProxy",void 0),(0,r.A)(this,"GlobalData",void 0),(0,r.A)(this,"taskId",void 0),(0,r.A)(this,"subTaskId",void 0),(0,r.A)(this,"subtitleTaskId",void 0),(0,r.A)(this,"ext",void 0),(0,r.A)(this,"source",void 0),(0,r.A)(this,"ioIPCPort",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"ioloader2DemuxerChannel",void 0),(0,r.A)(this,"demuxer2VideoDecoderChannel",void 0),(0,r.A)(this,"demuxer2AudioDecoderChannel",void 0),(0,r.A)(this,"videoDecoder2VideoRenderChannel",void 0),(0,r.A)(this,"audioDecoder2AudioRenderChannel",void 0),(0,r.A)(this,"audioRender2AudioWorkletChannel",void 0),(0,r.A)(this,"audioSourceNode",void 0),(0,r.A)(this,"gainNode",void 0),(0,r.A)(this,"formatContext",void 0),(0,r.A)(this,"canvas",void 0),(0,r.A)(this,"updateCanvas",void 0),(0,r.A)(this,"video",void 0),(0,r.A)(this,"audio",void 0),(0,r.A)(this,"controller",void 0),(0,r.A)(this,"volume",void 0),(0,r.A)(this,"playRate",void 0),(0,r.A)(this,"renderMode",void 0),(0,r.A)(this,"renderRotate",void 0),(0,r.A)(this,"flipHorizontal",void 0),(0,r.A)(this,"flipVertical",void 0),(0,r.A)(this,"useMSE",void 0),(0,r.A)(this,"audioEnded",void 0),(0,r.A)(this,"videoEnded",void 0),(0,r.A)(this,"status",void 0),(0,r.A)(this,"lastStatus",void 0),(0,r.A)(this,"statsController",void 0),(0,r.A)(this,"jitterBufferController",void 0),(0,r.A)(this,"selectedVideoStream",void 0),(0,r.A)(this,"selectedAudioStream",void 0),(0,r.A)(this,"selectedSubtitleStream",void 0),(0,r.A)(this,"lastSelectedInnerSubtitleStreamIndex",void 0),(0,r.A)(this,"subtitleRender",void 0),(0,r.A)(this,"externalSubtitleTasks",void 0),this.options=P.X$({},Rt,t),this.taskId=(0,S.A)(),this.status=0,this.volume=1,this.playRate=1,this.renderMode=0,this.renderRotate=0,this.flipHorizontal=!1,this.flipVertical=!1,this.GlobalData=(0,f.A)(kt.M),this.statsController=new it.A(this.GlobalData[u.o9]+32,!(D.USE_THREADS||!V.A.worker||!this.options.enableWorker),this),this.externalSubtitleTasks=[],this.lastSelectedInnerSubtitleStreamIndex=-1,rt.Ts(this.GlobalData[u.o9]+24),rt.Ts(this.GlobalData[u.o9]+28),z.pq(`create player, taskId: ${this.taskId}`,Et,371)}get currentTime(){var t;return this.useMSE?BigInt(Math.floor(1e3*((null===(t=this.video||this.audio)||void 0===t?void 0:t.currentTime)||0))):this.selectedAudioStream?this.GlobalData.stats.audioCurrentTime:this.selectedVideoStream?this.GlobalData.stats.videoCurrentTime:BigInt(0)}isCodecIdSupported(t){return t>65536&&t<=65572||ht.zy(Mt,t)}findBestStream(t,e){if(this.options.findBestStream)return this.options.findBestStream(t,e);const i=t.filter((t=>p.f[15](t.codecpar)===e));if(i.length){if(1===i.length)return i[0];const t=i.find((t=>!!(1&t.disposition)));return t&&this.isCodecIdSupported(p.f[15](t.codecpar+4))?t:i.find((t=>this.isCodecIdSupported(p.f[15](t.codecpar+4))))||i[0]}}async checkUseMSE(){{if(!V.A.mse)return!1;if(!V.A.wasmBaseSupported)return!0;const t=this.findBestStream(this.formatContext.streams,0),e=this.findBestStream(this.formatContext.streams,1);if(t&&!(0,at.A)().isTypeSupported((0,Q.A)(t.codecpar)))return z.R8(`can not support mse for codec: ${(0,Q.A)(t.codecpar)}, taskId: ${this.taskId}`,Et,432),!1;if(e&&!(0,at.A)().isTypeSupported((0,Z.A)(e.codecpar)))return z.R8(`can not support mse for codec: ${(0,Z.A)(e.codecpar)}, taskId: ${this.taskId}`,Et,436),!1;if(this.options.checkUseMES)return this.options.checkUseMES(this.formatContext.streams);if(t){if((0,dt.A)(t.codecpar))return z.pq("use mse because of hdr",Et,448),!0;if(p.f[15](t.codecpar+56)*p.f[15](t.codecpar+60)>2073600){if(!V.A.videoDecoder)return!0;let e=null;if(0!==p.f[20](t.codecpar+12)&&(e=(0,q.s3)(p.f[20](t.codecpar+12),p.f[15](t.codecpar+16))),!(await VideoDecoder.isConfigSupported({codec:(0,K.A)(t.codecpar),codedWidth:p.f[15](t.codecpar+56),codedHeight:p.f[15](t.codecpar+60),description:e,hardwareAcceleration:(0,tt.C)(!0)})).supported)return!0}else if(p.f[15](t.codecpar+56)*p.f[15](t.codecpar+60)==2073600&&H.A.safari&&!H.A.checkVersion(H.A.version,"16.1",!0)&&(0,j.lb)((0,g.A)(t.codecpar+72,m.P))>30)return!0}}return!1}createCanvas(){const t=document.createElement("canvas");return t.id="avplayer-canvas-"+(0,S.A)(),t.className="avplayer-canvas",t.width=this.options.container.offsetWidth*devicePixelRatio,t.height=this.options.container.offsetHeight*devicePixelRatio,t.style.cssText="\n      width: 100%;\n      height: 100%;\n    ",t.ondragstart=()=>!1,a()(t,"currentTime",{enumerable:!0,configurable:!1,get:()=>Number(this.currentTime)/1e3,set:t=>{this.seek(BigInt(Math.floor(Math.floor(1e3*t))))}}),t}createVideo(){this.video&&this.options.container.removeChild(this.video);const t=document.createElement("video");t.autoplay=!0,t.className="avplayer-video",t.style.cssText="\n      width: 100%;\n      height: 100%;\n    ",this.options.container.appendChild(t),this.video=t}createAudio(){this.audio&&this.options.container.removeChild(this.audio);const t=document.createElement("audio");t.autoplay=!0,t.className="avplayer-audio",this.options.container.appendChild(t),this.audio=t}handleTimeupdate(t){let e=0;t.ontimeupdate=()=>{const i=t.currentTime;Math.abs(i-e)>=1&&(6===this.status&&(this.fire(F.E9,[this.currentTime]),Bt.MSEThread.setCurrentTime(this.taskId,i)),e=i)},t.onended=()=>{this.audioEnded=!0,this.videoEnded=!0,this.handleEnded()},t.onwaiting=()=>{this.audio===t?this.GlobalData.stats.audioStutter++:(this.GlobalData.stats.audioStutter++,this.GlobalData.stats.videoStutter++)},t.oncanplay=()=>{6===this.status&&t.play()}}async handleEnded(){if(this.audioEnded&&this.videoEnded)if(z.pq(`player ended, taskId: ${this.taskId}`,Et,577),this.options.loop&&!this.options.isLive){z.pq(`loop play, taskId: ${this.taskId}`,Et,581),this.isHls()?await Bt.DemuxerThread.seek(this.taskId,BigInt(0),16):this.isDash()?(await Bt.DemuxerThread.seek(this.taskId,BigInt(0),16),this.subTaskId&&await Bt.DemuxerThread.seek(this.subTaskId,BigInt(0),16),this.subtitleTaskId&&await Bt.DemuxerThread.seek(this.subtitleTaskId,BigInt(0),16)):await Bt.DemuxerThread.seek(this.taskId,BigInt(0),8);for(let t=0;t<this.externalSubtitleTasks.length;t++)await Bt.DemuxerThread.seek(this.externalSubtitleTasks[0].taskId,BigInt(0),8);if(this.fire(F.E9,[BigInt(0)]),this.useMSE){var t;null!==(t=this.video||this.audio)&&void 0!==t&&t.src&&URL.revokeObjectURL((this.video||this.audio).src),await Bt.MSEThread.restart(this.taskId);const r=await Bt.MSEThread.getMediaSource(this.taskId);var e,i;r&&(V.A.workerMSE&&r instanceof MediaSourceHandle?(this.video||this.audio).srcObject=r:(this.video||this.audio).src=URL.createObjectURL(r),this.video?(this.video.currentTime=0,this.video.playbackRate=this.playRate):this.audio&&(this.audio.currentTime=0,this.audio.playbackRate=this.playRate),await o().all([null===(e=this.video)||void 0===e?void 0:e.play(),null===(i=this.audio)||void 0===i?void 0:i.play()]))}else this.audioDecoder2AudioRenderChannel&&(await Bt.AudioDecoderThread.resetTask(this.taskId),await Bt.AudioRenderThread.restart(this.taskId)),this.audioSourceNode&&(await this.audioSourceNode.request("restart"),"suspended"===Bt.audioContext.state&&await Bt.AudioRenderThread.fakePlay(this.taskId),this.audioEnded=!1),this.videoDecoder2VideoRenderChannel&&(await this.VideoDecoderThread.resetTask(this.taskId),await this.VideoRenderThread.restart(this.taskId),this.videoEnded=!1);this.subtitleRender&&(this.subtitleRender.reset(),this.subtitleRender.start())}else{var r;null!==(r=this.video||this.audio)&&void 0!==r&&r.src&&URL.revokeObjectURL((this.video||this.audio).src),this.video&&(this.options.container.removeChild(this.video),this.video=null),this.audio&&(this.options.container.removeChild(this.audio),this.audio=null),this.canvas&&(this.options.container.removeChild(this.canvas),this.canvas=null),await this.stop(),this.fire(F.hV)}}isHls(){return"m3u8"===this.ext||"m3u"===this.ext}isDash(){return"mpd"===this.ext}async getResource(t,e,i){const r=null!=e?`${t}-${e}`:t;if(Bt.Resource.has(r))return Bt.Resource.get(r);const s=this.options.getWasm(t,e,i);if(s){let t;if(H.A.safari&&!H.A.checkVersion(H.A.version,"16.1",!0)&&(I.Yj(s)||I.sv(s)))if(I.Yj(s)){const e={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"},i=await fetch(s,e);t=await i.arrayBuffer()}else t=s;else t=await(0,pt.A)(s,0===i);return Bt.Resource.set(r,t),t}}createSubtitleRender(t,e){var i,r,s,a;this.subtitleRender=new ft.A({dom:this.canvas||this.video||this.options.container,getCurrentTime:()=>this.currentTime,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,codecpar:t.codecpar,container:this.options.container,videoWidth:null!==(i=p.f[15]((null===(r=this.selectedVideoStream)||void 0===r?void 0:r.codecpar)+56))&&void 0!==i?i:0,videoHeight:null!==(s=p.f[15]((null===(a=this.selectedVideoStream)||void 0===a?void 0:a.codecpar)+60))&&void 0!==s?s:0}),this.subtitleRender.setDemuxTask(e),this.selectedSubtitleStream=t,e===this.taskId&&(this.lastSelectedInnerSubtitleStreamIndex=t.index),Bt.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(e)).invoke(e,t.index,this.subtitleRender.getDemuxerPort(e))}async loadExternalSubtitle(t){if(1!==this.status&&2!==this.status||z.h2("player has already destroyed",Et,775),t.source||z.h2("external subtitle must has source",Et,779),this.externalSubtitleTasks.some((e=>e.source===t.source)))return void z.R8("external subtitle has already loaded",Et,783);const e=(0,S.A)(),i=(0,Y.A)(this.options.enableWorker),r=P.X$({taskId:e,streamId:-1,ioloader2DemuxerChannel:i},t);let s="",a=0;I.Yj(t.source)?(s=B.qg(t.source).file.split(".").pop(),a=await Bt.IOThread.registerTask.transfer(i.port1).invoke({type:0,info:{url:t.source},range:{from:-1,to:-1},taskId:e,options:{isLive:this.options.isLive},rightPort:i.port1,stats:this.GlobalData[u.o9]+32})):(s=t.source.name.split(".").pop(),a=await Bt.IOThread.registerTask.transfer(i.port1).invoke({type:1,info:{file:t.source},range:{from:-1,to:-1},taskId:e,options:{isLive:this.options.isLive},rightPort:i.port1,stats:this.GlobalData[u.o9]+32})),a<0&&z.h2(`register io task failed, ret: ${a}, taskId: ${this.taskId}`,Et,844),await Bt.DemuxerThread.registerTask.transfer(i.port2).invoke({taskId:e,leftPort:i.port2,format:lt.HR[s],stats:0,isLive:!1,flags:0,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24}),a=await Bt.DemuxerThread.openStream(e),a<0&&z.h2(`open external subtitle failed, ret: ${a}, taskId: ${e}`,Et,861);let n=await Bt.DemuxerThread.analyzeStreams(e);!I.ai(n)&&n.streams.length||z.h2(`analyze stream failed, ret: ${n}`,Et,865);const o=n.streams[0];this.formatContext.streams.push(o),r.streamId=o.id,t.lang&&(o.metadata.language=t.lang),t.title&&(o.metadata.title=t.title);const l=7===this.status||6===this.status||8===this.status||9===this.status;return l&&await Bt.DemuxerThread.seek(e,this.currentTime,8),l&&!this.subtitleRender?(this.createSubtitleRender(o,e),this.subtitleRender.start()):this.subtitleRender&&await Bt.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(e)).invoke(e,o.index,this.subtitleRender.getDemuxerPort(e)),await Bt.DemuxerThread.startDemux(e,!1,10),this.externalSubtitleTasks.push(r),this.fire(F.xv),0}async load(t,e=[]){z.pq(`call load, taskId: ${this.taskId}`,Et,915),this.status=3,this.fire(F.F5),this.controller=new O.A(this,this.options.enableWorker),this.ioloader2DemuxerChannel=(0,Y.A)(this.options.enableWorker),(0,q.sO)(this.GlobalData[u.o9]+32,0,336),this.externalSubtitleTasks.length=0,await Bt.startDemuxPipeline(this.options.enableWorker);let i=0;var r;if(I.Yj(t)?(this.ext=B.qg(t).file.split(".").pop(),i=await Bt.IOThread.registerTask.transfer(this.ioloader2DemuxerChannel.port1).invoke({type:null!==(r=lt.$$[this.ext])&&void 0!==r?r:0,info:{url:t},range:{from:-1,to:-1},taskId:this.taskId,options:{isLive:this.options.isLive},rightPort:this.ioloader2DemuxerChannel.port1,stats:this.GlobalData[u.o9]+32})):t instanceof File?(this.options.isLive=!1,this.ext=t.name.split(".").pop(),i=await Bt.IOThread.registerTask.transfer(this.ioloader2DemuxerChannel.port1).invoke({type:1,info:{file:t},range:{from:-1,to:-1},taskId:this.taskId,options:{isLive:!1},rightPort:this.ioloader2DemuxerChannel.port1,stats:this.GlobalData[u.o9]+32})):t instanceof bt.A?(this.ext=t.ext,this.ioIPCPort=new gt.Ay(this.ioloader2DemuxerChannel.port1),this.ioIPCPort.on(gt.S3,(async e=>{switch(e.method){case"open":try{const i=await t.open();if(i<0){z.z3(`custom loader open error, ${i}, taskId: ${this.taskId}`,Et,983),this.ioIPCPort.reply(e,null,i);break}this.ioIPCPort.reply(e,i)}catch(t){z.z3(`loader open error, ${t}, taskId: ${this.taskId}`,Et,990),this.ioIPCPort.reply(e,null,t)}break;case"read":{const i=e.params.pointer,r=e.params.length,s=e.params.ioloaderOptions,a=Bt.IODemuxProxy?new Uint8Array(r):(0,q.JW)(i,r);try{const i=await t.read(a,s);this.GlobalData.stats.bufferReceiveBytes+=BigInt(0|i),this.ioIPCPort.reply(e,Bt.IODemuxProxy?a:i,null,Bt.IODemuxProxy?[a.buffer]:null)}catch(t){z.z3(`loader read error, ${t}, taskId: ${this.taskId}`,Et,1008),this.ioIPCPort.reply(e,vt.LR)}break}case"seek":{const i=e.params.pos,r=e.params.ioloaderOptions;try{const s=await t.seek(i,r);if(s<0){z.z3(`custom loader seek error, ${s}, taskId: ${this.taskId}`,Et,1024),this.ioIPCPort.reply(e,null,s);break}this.ioIPCPort.reply(e,s)}catch(t){z.z3(`loader seek error, ${t}, taskId: ${this.taskId}`,Et,1031),this.ioIPCPort.reply(e,null,t)}break}case"size":this.ioIPCPort.reply(e,await t.size())}}))):z.h2("invalid source",Et,1045),i<0&&z.h2(`register io task failed, ret: ${i}, taskId: ${this.taskId}`,Et,1049),this.isDash()){await Bt.IOThread.open(this.taskId);const t=await Bt.IOThread.hasAudio(this.taskId),e=await Bt.IOThread.hasVideo(this.taskId);t&&e?(this.subTaskId=(0,S.A)(),await Bt.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:lt.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.options.isLive,flags:2,ioloaderOptions:{mediaType:"audio"},avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24}),await Bt.DemuxerThread.registerTask({taskId:this.subTaskId,mainTaskId:this.taskId,flags:2,format:lt.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.options.isLive,ioloaderOptions:{mediaType:"video"},avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})):await Bt.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:lt.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.options.isLive,flags:2,ioloaderOptions:{mediaType:t?"audio":"video"},avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})}else await Bt.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:lt.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.options.isLive,flags:this.isHls()?2:0,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24});(this.isDash()||this.isHls())&&await Bt.IOThread.hasSubtitle(this.taskId)&&(this.subtitleTaskId=(0,S.A)(),await Bt.DemuxerThread.registerTask({taskId:this.subtitleTaskId,mainTaskId:this.taskId,flags:2,format:lt.HR[this.ext],stats:this.GlobalData[u.o9]+32,isLive:this.options.isLive,ioloaderOptions:{mediaType:"subtitle"},avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})),this.fire(F.Gd,[0]),i=await Bt.DemuxerThread.openStream(this.taskId),i<0&&z.h2(`open stream failed, ret: ${i}, taskId: ${this.taskId}`,Et,1150),this.fire(F.Gd,[1,this.ext]);let s=await Bt.DemuxerThread.analyzeStreams(this.taskId);if(!I.ai(s)&&s.streams.length||z.h2(`analyze stream failed, ret: ${s}`,Et,1157),this.subTaskId){i=await Bt.DemuxerThread.openStream(this.subTaskId),i<0&&z.h2(`open stream failed, ret: ${i}, taskId: ${this.subTaskId}`,Et,1163);const t=await Bt.DemuxerThread.analyzeStreams(this.subTaskId);!I.ai(t)&&t.streams.length||z.h2(`analyze stream failed, ret: ${t}`,Et,1167),s.streams=s.streams.concat(t.streams)}if(this.subtitleTaskId){i=await Bt.DemuxerThread.openStream(this.subtitleTaskId),i<0&&z.h2(`open subtitle stream failed, ret: ${i}, taskId: ${this.subtitleTaskId}`,Et,1175);const t=await Bt.DemuxerThread.analyzeStreams(this.subtitleTaskId);!I.ai(t)&&t.streams.length||z.h2(`analyze subtitle stream failed, ret: ${t}`,Et,1179),s.streams=s.streams.concat(t.streams)}this.formatContext=s,this.source=t;for(let t=0;t<e.length;t++)await this.loadExternalSubtitle(e[t]);if(s.streams.forEach((t=>{1===p.f[15](t.codecpar)?this.GlobalData.stats.audiocodec=(0,ot.A)(t.codecpar):0===p.f[15](t.codecpar)&&(this.GlobalData.stats.videocodec=(0,K.A)(t.codecpar))})),z.pq("\n"+(0,ct.Ay)([s],[{from:I.Yj(t)?t:t.name,tag:"Input"}]),Et,1200),this.isHls()||this.isDash()){const t=1e3*await Bt.IOThread.getDuration(this.taskId);if(t>0)for(let e=0;e<this.formatContext.streams.length;e++)this.formatContext.streams[e].duration=(0,j.k)(BigInt(Math.floor(t)),X.i0,this.formatContext.streams[e].timeBase)}if(this.options.isLive&&this.options.lowLatency){const t=Math.max(this.source instanceof bt.A?this.source.minBuffer:await Bt.IOThread.getMinBuffer(this.taskId),this.options.jitterBufferMin);let e=this.options.jitterBufferMax;e<=t&&(e=t+(this.isHls()||this.isDash()?t:1)),this.jitterBufferController=new nt.A({stats:this.GlobalData[u.o9]+32,jitterBuffer:this.GlobalData.stats[u.o9]+272,lowLatencyStart:!(this.isHls()||this.isDash()),useMse:this.useMSE,max:e,min:t,observer:{onCroppingBuffer:t=>{var e;z.Yz(`cropping buffer by jitter buffer, max: ${t}, taskId: ${this.taskId}`,Et,1241),null===(e=Bt.DemuxerThread)||void 0===e||e.croppingAVPacketQueue(this.taskId,BigInt(0|t))},onSetPlayRate:t=>{z.Yz(`set play rate by jitter buffer, rate: ${t}, taskId: ${this.taskId}`,Et,1245),this.useMSE?(Bt.MSEThread.setPlayRate(this.taskId,t),this.video?this.video.playbackRate=t:this.audio&&(this.audio.playbackRate=t)):(this.audioDecoder2AudioRenderChannel&&Bt.AudioRenderThread.setPlayTempo(this.taskId,t),this.videoDecoder2VideoRenderChannel&&this.VideoRenderThread.setPlayRate(this.taskId,t))}}})}this.status=4,this.fire(F.S2)}async play(t={audio:!0,video:!0,subtitle:!0}){if(z.pq(`call play, options: ${c()(t)}, status: ${this.status} taskId: ${this.taskId}`,Et,1298),6===this.status)return;t.audio||t.video||(z.R8(`video and audio must play one, ignore options, we will try to play video and audio, taskId: ${this.taskId}`,Et,1305),t.audio=!0,t.video=!0);const e=[];if(7===this.status)return this.selectedAudioStream&&this.selectedVideoStream&&this.GlobalData.stats.videoCurrentTime-this.GlobalData.stats.audioCurrentTime>BigInt(400)&&await Bt.AudioRenderThread.syncSeekTime(this.taskId,this.GlobalData.stats.videoCurrentTime),this.useMSE?(e.push(Bt.MSEThread.unpause(this.taskId)),this.audio?this.audio.play():this.video&&this.video.play()):(this.audioSourceNode&&(e.push(this.audioSourceNode.request("unpause")),e.push(Bt.AudioRenderThread.unpause(this.taskId))),this.videoDecoder2VideoRenderChannel&&e.push(this.VideoRenderThread.unpause(this.taskId))),o().all(e).then((()=>{this.status=6,this.fire(F.CN),this.jitterBufferController&&this.jitterBufferController.start(),this.subtitleRender&&this.subtitleRender.start()}));if(this.status=5,this.fire(F.d6),this.useMSE=await this.checkUseMSE(),this.audioEnded=!0,this.videoEnded=!0,this.useMSE){await Bt.startMSEPipeline(this.options.enableWorker),Bt.MSEThread.setPlayRate(this.taskId,this.playRate);const e=this.findBestStream(this.formatContext.streams,0),i=this.findBestStream(this.formatContext.streams,1);let r=!1;await Bt.MSEThread.registerTask.transfer(this.controller.getMuxerControlPort()).invoke({taskId:this.taskId,stats:this.GlobalData[u.o9]+32,controlPort:this.controller.getMuxerControlPort(),isLive:this.options.isLive,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,enableJitterBuffer:!!this.jitterBufferController}),e&&t.video&&(this.fire(F.Gd,[3,e]),r=!0,this.selectedVideoStream=e,this.videoEnded=!1,this.demuxer2VideoDecoderChannel=(0,Y.A)(this.options.enableWorker),await Bt.DemuxerThread.connectStreamTask.transfer(this.demuxer2VideoDecoderChannel.port1).invoke(this.subTaskId||this.taskId,e.index,this.demuxer2VideoDecoderChannel.port1),await Bt.MSEThread.addStream.transfer(this.demuxer2VideoDecoderChannel.port2).invoke(this.taskId,e.index,(0,Tt.Wu)(e.codecpar),e.timeBase,e.startTime,this.demuxer2VideoDecoderChannel.port2)),i&&t.audio&&(this.fire(F.Gd,[2,i]),this.selectedAudioStream=i,this.audioEnded=!1,this.demuxer2AudioDecoderChannel=(0,Y.A)(this.options.enableWorker),await Bt.DemuxerThread.connectStreamTask.transfer(this.demuxer2AudioDecoderChannel.port1).invoke(this.taskId,i.index,this.demuxer2AudioDecoderChannel.port1),await Bt.MSEThread.addStream.transfer(this.demuxer2AudioDecoderChannel.port2).invoke(this.taskId,i.index,(0,Tt.Wu)(i.codecpar),i.timeBase,i.startTime,this.demuxer2AudioDecoderChannel.port2)),r?this.createVideo():this.createAudio();const s=await Bt.MSEThread.getMediaSource(this.taskId);s&&(V.A.workerMSE&&s instanceof MediaSourceHandle?(this.video||this.audio).srcObject=s:(this.video||this.audio).src=URL.createObjectURL(s),this.handleTimeupdate(this.video||this.audio))}else{let i=BigInt(0),r=BigInt(0);const s=this.findBestStream(this.formatContext.streams,0),a=this.findBestStream(this.formatContext.streams,1);if(s&&t.video){this.fire(F.Gd,[3,s]),this.selectedVideoStream=s,await Bt.startVideoRenderPipeline(this.options.enableWorker),await this.createVideoDecoderThread(this.options.enableWorker),r=(0,j.k)(s.startTime,s.timeBase,X.i0),this.demuxer2VideoDecoderChannel=(0,Y.A)(this.options.enableWorker),this.videoDecoder2VideoRenderChannel=(0,Y.A)(this.options.enableWorker);let t=await this.getResource("decoder",p.f[15](s.codecpar+4),p.f[15](s.codecpar));t||(V.A.videoDecoder?(await VideoDecoder.isConfigSupported({codec:(0,K.A)(s.codecpar)})).supported||z.h2(`${(0,ct.eG)(p.f[15](s.codecpar),p.f[15](s.codecpar+4))} codecId ${p.f[15](s.codecpar+4)} not support`,Et,1463):z.h2(`${(0,ct.eG)(p.f[15](s.codecpar),p.f[15](s.codecpar+4))} codecId ${p.f[15](s.codecpar+4)} not support`,Et,1467)),await this.VideoDecoderThread.registerTask.transfer(this.demuxer2VideoDecoderChannel.port2,this.videoDecoder2VideoRenderChannel.port1).invoke({taskId:this.taskId,resource:t,leftPort:this.demuxer2VideoDecoderChannel.port2,rightPort:this.videoDecoder2VideoRenderChannel.port1,stats:this.GlobalData[u.o9]+32,enableHardware:this.options.enableHardware,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,preferWebCodecs:!(0,dt.A)(s.codecpar)&&!(0,ut.A)(s.codecpar)}),await this.VideoDecoderThread.open(this.taskId,(0,Tt.Wu)(s.codecpar))<0&&z.h2(`cannot open video ${(0,ct.eG)(p.f[15](s.codecpar),p.f[15](s.codecpar+4))} decoder`,Et,1490),await Bt.DemuxerThread.connectStreamTask.transfer(this.demuxer2VideoDecoderChannel.port1).invoke(this.subTaskId||this.taskId,s.index,this.demuxer2VideoDecoderChannel.port1),this.VideoDecoderThread.setPlayRate(this.taskId,this.playRate)}if(a&&t.audio){this.fire(F.Gd,[2,a]),this.selectedAudioStream=a,await Bt.startAudioPipeline(this.options.enableWorker),"suspended"===Bt.audioContext.state&&await o().race([Bt.audioContext.resume(),new et.A(.1)]),i=(0,j.k)(a.startTime,a.timeBase,X.i0),this.demuxer2AudioDecoderChannel=(0,Y.A)(this.options.enableWorker),this.audioDecoder2AudioRenderChannel=(0,Y.A)(this.options.enableWorker);let t=await this.getResource("decoder",p.f[15](a.codecpar+4),p.f[15](a.codecpar));t||(V.A.audioDecoder?(await AudioDecoder.isConfigSupported({codec:(0,ot.A)(a.codecpar),sampleRate:p.f[15](a.codecpar+136),numberOfChannels:p.f[15](a.codecpar+116)})).supported||z.h2(`${(0,ct.eG)(p.f[15](a.codecpar),p.f[15](a.codecpar+4))} codecId ${p.f[15](a.codecpar+4)} not support`,Et,1526):z.h2(`${(0,ct.eG)(p.f[15](a.codecpar),p.f[15](a.codecpar+4))} codecId ${p.f[15](a.codecpar+4)} not support`,Et,1530)),await Bt.AudioDecoderThread.registerTask.transfer(this.demuxer2AudioDecoderChannel.port2,this.audioDecoder2AudioRenderChannel.port1).invoke({taskId:this.taskId,resource:t,leftPort:this.demuxer2AudioDecoderChannel.port2,rightPort:this.audioDecoder2AudioRenderChannel.port1,stats:this.GlobalData[u.o9]+32,timeBase:{num:a.timeBase.num,den:a.timeBase.den},avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28}),await Bt.AudioDecoderThread.open(this.taskId,(0,Tt.Wu)(a.codecpar))<0&&z.h2(`cannot open audio ${(0,ct.eG)(p.f[15](a.codecpar),p.f[15](a.codecpar+4))} decoder`,Et,1555),await Bt.DemuxerThread.connectStreamTask.transfer(this.demuxer2AudioDecoderChannel.port1).invoke(this.taskId,a.index,this.demuxer2AudioDecoderChannel.port1)}if(this.videoDecoder2VideoRenderChannel){this.canvas=this.createCanvas(),this.options.container.appendChild(this.canvas);const t=(0,$.A)()&&(D.USE_THREADS||V.A.worker)?this.canvas.transferControlToOffscreen():this.canvas,i=this.formatContext.streams.find((t=>0===p.f[15](t.codecpar)));await this.VideoRenderThread.registerTask.transfer(this.videoDecoder2VideoRenderChannel.port2,this.controller.getVideoRenderControlPort(),t).invoke({taskId:this.taskId,leftPort:this.videoDecoder2VideoRenderChannel.port2,controlPort:this.controller.getVideoRenderControlPort(),canvas:t,renderMode:this.renderMode,renderRotate:this.renderRotate,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,timeBase:{num:i.timeBase.num,den:i.timeBase.den},viewportWidth:this.options.container.offsetWidth,viewportHeight:this.options.container.offsetHeight,devicePixelRatio,stats:this.GlobalData[u.o9]+32,enableWebGPU:this.options.enableWebGPU,startPTS:i.startTime,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,enableJitterBuffer:!!this.jitterBufferController&&!this.audioDecoder2AudioRenderChannel}),this.videoEnded=!1,this.VideoRenderThread.setPlayRate(this.taskId,this.playRate),e.push(this.VideoRenderThread.play(this.taskId))}if(this.audioDecoder2AudioRenderChannel){const t=this.formatContext.streams.find((t=>1===p.f[15](t.codecpar)));this.audioRender2AudioWorkletChannel=new MessageChannel;const i=Math.max(p.f[15](t.codecpar+116),Math.min(Bt.audioContext.destination.channelCount,2));let r,s=await this.getResource("resampler"),a=await this.getResource("stretchpitcher");s||z.h2("resampler not found",Et,1622),a||z.h2("stretch pitcher not found",Et,1625),await Bt.AudioRenderThread.registerTask.transfer(this.audioDecoder2AudioRenderChannel.port2,this.audioRender2AudioWorkletChannel.port1,this.controller.getAudioRenderControlPort()).invoke({taskId:this.taskId,leftPort:this.audioDecoder2AudioRenderChannel.port2,rightPort:this.audioRender2AudioWorkletChannel.port1,controlPort:this.controller.getAudioRenderControlPort(),playFormat:8,playSampleRate:Bt.audioContext.sampleRate,playChannels:i,resamplerResource:s,stretchpitcherResource:a,stats:this.GlobalData[u.o9]+32,timeBase:{num:t.timeBase.num,den:t.timeBase.den},startPTS:t.startTime,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,enableJitterBuffer:!!this.jitterBufferController}),r=V.A.audioWorklet?L.A:G.A,this.audioSourceNode=new r(Bt.audioContext,{onEnded:()=>{this.onAudioEnded()},onFirstRendered:()=>{this.onFirstAudioRendered()},onStutter:()=>{this.onAudioStutter()}},{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[i],isMainWorker:!!Bt.AudioPipelineProxy}),D.USE_THREADS&&V.A.audioWorklet&&(!H.A.safari||H.A.checkVersion(H.A.version,"16.1",!0))&&await this.audioSourceNode.request("init",{memory:N.ce}),Bt.AudioRenderThread.setPlayTempo(this.taskId,this.playRate),this.gainNode=Bt.audioContext.createGain(),this.gainNode.connect(Bt.audioContext.destination),this.audioSourceNode.connect(this.gainNode),this.setVolume(this.volume),this.audioEnded=!1,e.push(this.audioSourceNode.request("start",{port:this.audioRender2AudioWorkletChannel.port2,channels:i},[this.audioRender2AudioWorkletChannel.port2]))}this.audioDecoder2AudioRenderChannel?this.controller.setTimeUpdateListenType(1):this.videoDecoder2VideoRenderChannel&&this.controller.setTimeUpdateListenType(0),this.videoDecoder2VideoRenderChannel&&this.audioDecoder2AudioRenderChannel&&st.tn(r-i)>BigInt(1e4)&&this.controller.setEnableAudioVideoSync(!1)}const i=this.findBestStream(this.formatContext.streams,3);if(i&&t.subtitle&&this.isCodecIdSupported(p.f[15](i.codecpar+4))){const t=this.externalSubtitleTasks.find((t=>t.streamId===i.id));this.createSubtitleRender(i,t?t.taskId:this.subtitleTaskId||this.taskId)}if(this.subtitleRender&&this.externalSubtitleTasks.length)for(let t=0;t<this.externalSubtitleTasks.length;t++){const e=this.formatContext.streams.find((e=>e.id===this.externalSubtitleTasks[t].streamId));e!==i&&await Bt.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(this.externalSubtitleTasks[t].taskId)).invoke(this.externalSubtitleTasks[t].taskId,e.index,this.subtitleRender.getDemuxerPort(this.externalSubtitleTasks[t].taskId))}let r=10;return I.Yj(this.source)&&!this.options.isLive&&this.formatContext.streams.forEach((t=>{r=Math.max(Math.ceil((0,j.lb)((0,g.A)(t.codecpar+72,m.P))*this.options.preLoadTime),r)})),e.push(Bt.DemuxerThread.startDemux(this.taskId,this.options.isLive,r)),this.subTaskId&&e.push(Bt.DemuxerThread.startDemux(this.subTaskId,this.options.isLive,r)),this.subtitleTaskId&&e.push(Bt.DemuxerThread.startDemux(this.subtitleTaskId,this.options.isLive,r)),o().all(e).then((async()=>{var t,e;if(this.status=6,this.useMSE)await o().all([null===(t=this.video)||void 0===t?void 0:t.play(),null===(e=this.audio)||void 0===e?void 0:e.play()]).catch((t=>{if(this.video)return this.video.muted=!0,this.fire(F.IY),z.R8("the audioContext was not started. It must be resumed after a user gesture",Et,1769),this.video.play();throw t}));else if(this.audioSourceNode&&"suspended"===Bt.audioContext.state){if("suspended"===Bt.audioContext.state&&(this.fire(F.IY),z.R8("the audioContext was not started. It must be resumed after a user gesture",Et,1781)),!this.videoDecoder2VideoRenderChannel)throw new Error("the audioContext was not started. It must be resumed after a user gesture");Bt.AudioRenderThread.fakePlay(this.taskId),this.controller.setTimeUpdateListenType(0)}this.fire(F.CN),this.statsController.start(),this.jitterBufferController&&this.jitterBufferController.start(),this.subtitleRender&&this.subtitleRender.start()}))}async pause(){if(z.pq(`call pause, taskId: ${this.taskId}`,Et,1809),!this.options.isLive){const t=[];return this.useMSE?(this.audio&&this.audio.pause(),this.video&&this.video.pause(),t.push(Bt.MSEThread.pause(this.taskId))):(this.audioSourceNode&&(t.push(this.audioSourceNode.request("pause")),t.push(Bt.AudioRenderThread.pause(this.taskId))),this.videoDecoder2VideoRenderChannel&&t.push(this.VideoRenderThread.pause(this.taskId))),o().all(t).then((()=>{8===this.status?this.lastStatus=7:this.status=7,this.fire(F.NN),this.jitterBufferController&&this.jitterBufferController.stop(),this.subtitleRender&&this.subtitleRender.pause()}))}z.R8(`pause can only used in vod, taskId: ${this.taskId}`,Et,1849)}async doSeek(t,e,i={}){var r,s;this.useMSE?await Bt.MSEThread.beforeSeek(this.taskId):await o().all([null===(r=Bt.AudioRenderThread)||void 0===r?void 0:r.beforeSeek(this.taskId),null===(s=this.VideoRenderThread)||void 0===s?void 0:s.beforeSeek(this.taskId)]),i.onBeforeSeek&&await i.onBeforeSeek();let a=-BigInt(1);if(this.isHls()?a=await Bt.DemuxerThread.seek(this.taskId,t,16):this.isDash()?(a=await Bt.DemuxerThread.seek(this.taskId,t,16),this.subTaskId&&await Bt.DemuxerThread.seek(this.subTaskId,t,16)):a=await Bt.DemuxerThread.seek(this.taskId,t,8,e),this.subtitleTaskId&&await Bt.DemuxerThread.seek(this.subtitleTaskId,t,16),a>=BigInt(0)?z.Yz(`seeked to packet timestamp: ${a}, taskId: ${this.taskId}`,Et,1891):z.z3(`demuxer seek failed, code: ${a}, taskId: ${this.taskId}`,Et,1894),this.useMSE)if(a>=BigInt(0)){const e=await Bt.MSEThread.afterSeek(this.taskId,a>t?a:t);this.video?this.video.currentTime=e:this.audio&&(this.audio.currentTime=e)}else await Bt.MSEThread.afterSeek(this.taskId,X.Dh);else{let e=20;var n,l,c,h,d,u,f,v,y,A;this.formatContext.streams.forEach((t=>{0===p.f[15](t.codecpar)&&(e=Math.max(Math.ceil((0,j.lb)((0,g.A)(t.codecpar+72,m.P))),e))})),a>=BigInt(0)?(await o().all([null===(n=Bt.AudioDecoderThread)||void 0===n?void 0:n.resetTask(this.taskId),null===(l=this.VideoDecoderThread)||void 0===l?void 0:l.resetTask(this.taskId)]),await o().all([null===(c=Bt.AudioRenderThread)||void 0===c?void 0:c.syncSeekTime(this.taskId,a>t?a:t,e),null===(h=this.VideoRenderThread)||void 0===h?void 0:h.syncSeekTime(this.taskId,a>t?a:t,e)]),await o().all([null===(d=Bt.AudioRenderThread)||void 0===d?void 0:d.afterSeek(this.taskId,a>t?a:t),null===(u=this.VideoRenderThread)||void 0===u?void 0:u.afterSeek(this.taskId,a>t?a:t)])):(await o().all([null===(f=Bt.AudioRenderThread)||void 0===f?void 0:f.syncSeekTime(this.taskId,X.Dh,e),null===(v=this.VideoRenderThread)||void 0===v?void 0:v.syncSeekTime(this.taskId,X.Dh,e)]),await o().all([null===(y=Bt.AudioRenderThread)||void 0===y?void 0:y.afterSeek(this.taskId,X.Dh),null===(A=this.VideoRenderThread)||void 0===A?void 0:A.afterSeek(this.taskId,X.Dh)])),this.jitterBufferController&&this.jitterBufferController.reset()}for(let t=0;t<this.externalSubtitleTasks.length;t++)await Bt.DemuxerThread.seek(this.externalSubtitleTasks[t].taskId,this.currentTime,8);this.subtitleRender&&this.subtitleRender.reset()}async seek(t){if(z.pq(`call seek, timestamp: ${t}, taskId: ${this.taskId}`,Et,1970),this.formatContext.streams.length)if(8!==this.status)if(this.options.isLive)z.R8(`seek can only used in vod, taskId: ${this.taskId}`,Et,2003);else{this.lastStatus=this.status,this.status=8,this.fire(F.Nz);let e=-1;this.selectedVideoStream?e=this.selectedVideoStream.index:this.selectedAudioStream&&(e=this.selectedAudioStream.index),await this.doSeek(t,e),this.status=this.lastStatus,this.fire(F.mQ)}else z.R8(`player is seeking now, taskId: ${this.taskId}`,Et,1978);else z.z3(`cannot found any stream to seek, taskId: ${this.taskId}`,Et,1973)}getStreams(){return this.formatContext.streams.map((t=>({...t,mediaType:(0,ct.yl)(lt.Mb,p.f[15](t.codecpar)),codecparProxy:(0,g.A)(t.codecpar,v.A)})))}getSelectedVideoStreamId(){return this.selectedVideoStream?this.selectedVideoStream.id:-1}getSelectedAudioStreamId(){return this.selectedAudioStream?this.selectedAudioStream.id:-1}getSelectedSubtitleStreamId(){return this.selectedSubtitleStream?this.selectedSubtitleStream.id:-1}getChapters(){return this.formatContext.chapters}getDuration(){if(!this.options.isLive){let t=BigInt(0);return this.formatContext.streams.forEach((e=>{if(1===p.f[15](e.codecpar)||0===p.f[15](e.codecpar)){const i=(0,j.k)(e.duration,{den:e.timeBase.den,num:e.timeBase.num},X.i0);i>t&&(t=i)}})),t}return BigInt(0)}async stop(){var t;if(z.pq(`call stop, taskId: ${this.taskId}`,Et,2107),0!==this.status){this.audioSourceNode&&(await this.audioSourceNode.request("stop"),this.audioSourceNode.disconnect(),this.audioSourceNode=null),this.VideoRenderThread&&await this.VideoRenderThread.unregisterTask(this.taskId),Bt.AudioRenderThread&&await Bt.AudioRenderThread.unregisterTask(this.taskId),this.VideoDecoderThread&&await this.VideoDecoderThread.unregisterTask(this.taskId),Bt.AudioDecoderThread&&await Bt.AudioDecoderThread.unregisterTask(this.taskId),Bt.MSEThread&&await Bt.MSEThread.unregisterTask(this.taskId),Bt.DemuxerThread&&(await Bt.DemuxerThread.unregisterTask(this.taskId),this.subTaskId&&await Bt.DemuxerThread.unregisterTask(this.subTaskId),this.subtitleTaskId&&await Bt.DemuxerThread.unregisterTask(this.subtitleTaskId)),Bt.IOThread&&await Bt.IOThread.unregisterTask(this.taskId),this.ioIPCPort&&(await this.source.stop(),this.ioIPCPort.destroy(),this.ioIPCPort=null);for(let t=0;t<this.externalSubtitleTasks.length;t++)await Bt.DemuxerThread.unregisterTask(this.externalSubtitleTasks[t].taskId),await Bt.IOThread.unregisterTask(this.externalSubtitleTasks[t].taskId);this.subtitleRender&&(this.subtitleRender.destroy(),this.subtitleRender=null),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=null),this.controller&&this.controller.destroy(),null!==(t=this.video||this.audio)&&void 0!==t&&t.src&&URL.revokeObjectURL((this.video||this.audio).src),this.video&&(this.options.container.removeChild(this.video),this.video=null),this.audio&&(this.options.container.removeChild(this.audio),this.audio=null),this.canvas&&(this.options.container.removeChild(this.canvas),this.canvas=null),this.ioloader2DemuxerChannel=null,this.demuxer2VideoDecoderChannel=null,this.demuxer2AudioDecoderChannel=null,this.videoDecoder2VideoRenderChannel=null,this.audioDecoder2AudioRenderChannel=null,this.audioRender2AudioWorkletChannel=null,this.selectedAudioStream=null,this.selectedVideoStream=null,this.selectedSubtitleStream=null,this.lastSelectedInnerSubtitleStreamIndex=-1,this.source=null,this.ext="",this.statsController.stop(),this.jitterBufferController&&(this.jitterBufferController.stop(),this.jitterBufferController=null),this.fire(F.yd),this.status=0}else z.R8(`player has already stopped, taskId: ${this.taskId}`,Et,2110)}setPlaybackRate(t){var e,i,r,s;this.options.isLive?z.R8(`setPlaybackRate can only used in playback, taskId: ${this.taskId}`,Et,2235):(this.playRate=(0,W.A)(t,.5,2),this.useMSE?(null===(e=Bt.MSEThread)||void 0===e||e.setPlayRate(this.taskId,this.playRate),this.video?this.video.playbackRate=this.playRate:this.audio&&(this.audio.playbackRate=this.playRate)):(null===(i=Bt.AudioRenderThread)||void 0===i||i.setPlayTempo(this.taskId,this.playRate),null===(r=this.VideoRenderThread)||void 0===r||r.setPlayRate(this.taskId,this.playRate),null===(s=this.VideoDecoderThread)||void 0===s||s.setPlayRate(this.taskId,this.playRate)),z.pq(`player call setPlaybackRate, set ${this.playRate}, taskId: ${this.taskId}`,Et,2232))}getPlaybackRate(){return this.playRate}async resume(){var t;"suspended"===(null===(t=Bt.audioContext)||void 0===t?void 0:t.state)&&(await o().race([Bt.audioContext.resume(),new et.A(.1)]),"suspended"===Bt.audioContext.state?z.R8("the audioContext was not allowed to start. It must be resumed after a user gesture",Et,2258):(this.audioSourceNode&&this.controller.setTimeUpdateListenType(1),this.video&&(this.video.muted=!1))),this.video?(this.video.muted=!1,this.video.played||await this.video.play()):this.audio&&(this.audio.muted=!1,this.audio.played||await this.audio.play()),z.pq(`call resume, taskId: ${this.taskId}`,Et,2282)}getVolume(){return this.volume}setVolume(t,e=!1){this.volume=(0,W.A)(t,0,3),this.gainNode&&Bt.audioContext?(this.gainNode.gain.cancelScheduledValues(Bt.audioContext.currentTime),H.A.firefox&&!e?this.gainNode.gain.setValueAtTime(this.volume,Bt.audioContext.currentTime+1):0===this.gainNode.gain.value||0===this.volume||e?this.gainNode.gain.value=this.volume:this.gainNode.gain.exponentialRampToValueAtTime(this.volume,Bt.audioContext.currentTime+1)):this.video?this.video.volume=this.volume:this.audio&&(this.audio.volume=this.volume),this.fire(F.Wu,[this.volume]),z.pq(`player call setVolume, set ${t}, used ${this.volume}, taskId: ${this.taskId}`,Et,2326)}getRenderMode(){return this.renderMode}setRenderMode(t){var e;this.renderMode=t,this.useMSE&&this.video?this.video.style["object-fit"]=Ct[this.renderMode]:null===(e=this.VideoRenderThread)||void 0===e||e.setRenderMode(this.taskId,t),z.pq(`player call setRenderMode, mode: ${t}, taskId: ${this.taskId}`,Et,2356)}getVideoTransformContext(){let t="";return 0!==this.renderRotate&&(t+=`rotateZ(${this.renderRotate}deg)`),this.flipHorizontal&&(t+=(t.length?" ":"")+"scaleX(-1)"),this.flipVertical&&(t+=(t.length?" ":"")+"scaleY(-1)"),t}setRotate(t){var e;this.renderRotate=t,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(e=this.VideoRenderThread)||void 0===e||e.setRenderRotate(this.taskId,t),z.pq(`player call setRotate, angle: ${t}, taskId: ${this.taskId}`,Et,2386)}enableHorizontalFlip(t){var e;this.flipHorizontal=t,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(e=this.VideoRenderThread)||void 0===e||e.enableHorizontalFlip(this.taskId,t),z.pq(`player call enableHorizontalFlip, enable: ${t}, taskId: ${this.taskId}`,Et,2397)}enableVerticalFlip(t){var e;this.flipVertical=t,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(e=this.VideoRenderThread)||void 0===e||e.enableVerticalFlip(this.taskId,t),z.pq(`player call enableVerticalFlip, enable: ${t}, taskId: ${this.taskId}`,Et,2408)}setLoop(t){this.options.loop=t,z.pq(`call setLoop, enable: ${t}, taskId: ${this.taskId}`,Et,2420)}setSubtitleDelay(t){this.subtitleRender&&this.getSubtitleDelay()!==t&&(this.subtitleRender.setDelay(BigInt(0|t)),z.pq(`set subtitle delay ${t}`,Et,2433),this.fire(F.W1,[t]))}getSubtitleDelay(){return this.subtitleRender?Number(BigInt.asIntN(32,this.subtitleRender.getDelay())):0}setSubtitleEnable(t){if(this.subtitleRender&&this.selectedSubtitleStream)if(t){const t=this.externalSubtitleTasks.find((t=>t.streamId===this.selectedSubtitleStream.id));t&&Bt.DemuxerThread.seek(t.taskId,this.currentTime,8),this.subtitleRender.reset(),this.subtitleRender.start()}else this.subtitleRender.stop()}resize(t,e){var i;this.useMSE||null===(i=this.VideoRenderThread)||void 0===i||i.resize(this.taskId,t,e),z.pq(`player call resize, width: ${t}, height: ${e}, taskId: ${this.taskId}`,Et,2484)}isMSE(){return this.useMSE}isLive(){return this.options.isLive}async getVideoList(){var t;return null===(t=Bt.IOThread)||void 0===t?void 0:t.getVideoList(this.taskId)}async getAudioList(){var t;return null===(t=Bt.IOThread)||void 0===t?void 0:t.getAudioList(this.taskId)}async getSubtitleList(){var t;return null===(t=Bt.IOThread)||void 0===t?void 0:t.getSubtitleList(this.taskId)}getStatus(){return this.status}hasAudio(){return!!this.selectedAudioStream}hasVideo(){return!!this.selectedVideoStream}hasSubtitle(){return!!this.selectedSubtitleStream}getSource(){return this.source}getFormatContext(){return this.formatContext}getExternalSubtitle(){return this.externalSubtitleTasks.map((t=>({source:t.source,lang:t.lang,title:t.title})))}getOptions(){return this.options}setIsLive(t){this.options.isLive=t}getAudioOutputNode(){return this.gainNode}isPictureInPicture(){return this.useMSE?this.video&&document.pictureInPictureElement===this.video:!(!this.canvas||"object"!=typeof documentPictureInPicture)&&documentPictureInPicture.window&&documentPictureInPicture.window.document.body.querySelector("#"+this.canvas.id)===this.canvas}async selectVideo(t){var e;if(this.isHls()||this.isDash())return z.pq(`call IOThread selectVideo, index: ${t}, taskId: ${this.taskId}`,Et,2649),null===(e=Bt.IOThread)||void 0===e?void 0:e.selectVideo(this.taskId,t);{const e=this.formatContext.streams.find((e=>e.id===t));if(this.selectedVideoStream&&e&&0===p.f[15](e.codecpar)&&e!==this.selectedVideoStream){if(9===this.status)return void z.R8(`player is changing now, taskId: ${this.taskId}`,Et,2657);this.lastStatus=this.status,this.status=9,this.fire(F.Wt,[0,e.id,this.selectedVideoStream.id]),this.useMSE?await this.doSeek(this.currentTime,e.index,{onBeforeSeek:async()=>{await Bt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.selectedVideoStream.index),await Bt.MSEThread.reAddStream(this.taskId,e.index,(0,Tt.Wu)(e.codecpar),e.timeBase,e.startTime)}}):await this.doSeek(this.currentTime,e.index,{onBeforeSeek:async()=>{await Bt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.selectedVideoStream.index),await this.VideoDecoderThread.reopenDecoder(this.taskId,(0,Tt.Wu)(e.codecpar),await this.getResource("decoder",p.f[15](e.codecpar+4),0))}}),z.pq(`changed selected video stream, from ${this.selectedVideoStream.id} to ${e.id}, taskId: ${this.taskId}`,Et,2685),this.selectedVideoStream=e,this.subtitleRender&&this.subtitleRender.updateVideoResolution(p.f[15](e.codecpar+56),p.f[15](e.codecpar+60)),this.status=this.lastStatus,this.fire(F.Rj,[0,e.id,this.selectedVideoStream.id])}else z.z3(`call selectVideo failed, id: ${t}, taskId: ${this.taskId}`,Et,2696)}}async selectAudio(t){var e;if(this.isHls()||this.isDash())return z.pq(`call IOThread selectAudio, index: ${t}, taskId: ${this.taskId}`,Et,2709),null===(e=Bt.IOThread)||void 0===e?void 0:e.selectAudio(this.taskId,t);{const e=this.formatContext.streams.find((e=>e.id===t));if(this.selectedAudioStream&&e&&1===p.f[15](e.codecpar)&&e!==this.selectedAudioStream){if(9===this.status)return void z.R8(`player is changing now, taskId: ${this.taskId}`,Et,2716);if(this.lastStatus=this.status,this.status=9,this.fire(F.Wt,[1,e.id,this.selectedAudioStream.id]),p.f[15](e.codecpar+4)!==p.f[15](this.selectedAudioStream.codecpar+4)||this.useMSE&&(p.f[15](e.codecpar+136)!==p.f[15](this.selectedAudioStream.codecpar+136)||p.f[15](e.codecpar+116)!==p.f[15](this.selectedAudioStream.codecpar+116))){let t=e.index;this.selectedVideoStream&&(t=this.selectedVideoStream.index),this.useMSE?await this.doSeek(this.currentTime,t,{onBeforeSeek:async()=>{await Bt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.selectedAudioStream.index),await Bt.MSEThread.reAddStream(this.taskId,e.index,(0,Tt.Wu)(e.codecpar),e.timeBase,e.startTime)}}):await this.doSeek(this.currentTime,t,{onBeforeSeek:async()=>{await Bt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.selectedAudioStream.index),await Bt.AudioDecoderThread.reopenDecoder(this.taskId,(0,Tt.Wu)(e.codecpar),await this.getResource("decoder",p.f[15](e.codecpar+4),1))}})}else await Bt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.selectedAudioStream.index,!1);z.pq(`changed selected audio stream, from ${this.selectedAudioStream.id} to ${e.id}, taskId: ${this.taskId}`,Et,2757),this.selectedAudioStream=e,this.status=this.lastStatus,this.fire(F.Rj,[1,e.id,this.selectedAudioStream.id])}else z.z3(`call selectAudio failed, id: ${t}, taskId: ${this.taskId}`,Et,2766)}}async selectSubtitle(t){if(this.isHls()||this.isDash()){var e;z.pq(`call IOThread selectSubtitle, index: ${t}, taskId: ${this.taskId}`,Et,2779),await(null===(e=Bt.IOThread)||void 0===e?void 0:e.selectSubtitle(this.taskId,t)),this.subtitleTaskId&&await Bt.DemuxerThread.seek(this.subtitleTaskId,this.currentTime,16),this.subtitleRender&&(this.subtitleRender.reset(),this.subtitleRender.start())}else{const e=this.formatContext.streams.find((e=>e.id===t));if(this.selectedSubtitleStream&&e&&3===p.f[15](e.codecpar)&&e!==this.selectedSubtitleStream){if(9===this.status)return void z.R8(`player is changing now, taskId: ${this.taskId}`,Et,2793);this.lastStatus=this.status,this.status=9,this.fire(F.Wt,[3,e.id,this.selectedSubtitleStream.id]),this.subtitleRender.reopenDecoder(e.codecpar);const t=this.externalSubtitleTasks.find((t=>t.streamId===e.id));t?(this.subtitleRender.setDemuxTask(t.taskId),this.subtitleRender.reset(),await Bt.DemuxerThread.seek(t.taskId,this.currentTime,8,e.index)):(this.subtitleRender.setDemuxTask(this.taskId),-1===this.lastSelectedInnerSubtitleStreamIndex?await Bt.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(this.taskId)).invoke(this.taskId,e.index,this.subtitleRender.getDemuxerPort(this.taskId)):await Bt.DemuxerThread.changeConnectStream(this.taskId,e.index,this.lastSelectedInnerSubtitleStreamIndex,!1),this.externalSubtitleTasks.find((t=>t.streamId===this.selectedSubtitleStream.id))&&this.subtitleRender.reset(),this.lastSelectedInnerSubtitleStreamIndex=e.index),this.subtitleRender&&this.subtitleRender.start(),z.pq(`changed selected subtitle stream, from ${this.selectedSubtitleStream.id} to ${e.id}, taskId: ${this.taskId}`,Et,2832),this.selectedSubtitleStream=e,this.status=this.lastStatus,this.fire(F.Rj,[3,e.id,this.selectedSubtitleStream.id])}else z.z3(`call selectSubtitle failed, id: ${t}, taskId: ${this.taskId}`,Et,2840)}}async playNextFrame(){!this.useMSE&&7===this.status&&this.selectedVideoStream&&await this.VideoRenderThread.renderNextFrame(this.taskId)}enterFullscreen(){const t=this.options.container;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),z.pq(`player call enterFullscreen, taskId: ${this.taskId}`,Et,2871)}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),z.pq(`player call exitFullscreen, taskId: ${this.taskId}`,Et,2887)}snapshot(t="png",e=1){if(this.useMSE&&this.video){const i=document.createElement("canvas");return i.width=this.video.videoWidth,i.height=this.video.videoHeight,i.getContext("2d").drawImage(this.video,0,0),i.toDataURL(`image/${t}`,e)}if(this.canvas)return this.canvas.toDataURL(`image/${t}`,e)}getStats(){return this.GlobalData.stats}async destroy(){z.pq(`call destroy, taskId: ${this.taskId}`,Et,2926),2!==this.status?(await this.stop(),this.VideoPipelineProxy&&(await this.VideoDecoderThread.clear(),await this.VideoRenderThread.clear(),await this.VideoPipelineProxy.destroy(),this.VideoDecoderThread=null,this.VideoPipelineProxy=null),this.VideoDecoderThread&&(await this.VideoDecoderThread.clear(),(0,k.nE)(this.VideoDecoderThread),this.VideoDecoderThread=null),this.VideoRenderThread=null,this.GlobalData&&(this.GlobalData.avframeList.clear((t=>{(0,E.to)(t)}),20),this.GlobalData.avpacketList.clear((t=>{(0,C.Up)(t)}),20),rt.zr(this.GlobalData[u.o9]+24),rt.zr(this.GlobalData[u.o9]+28),(0,y.A)(this.GlobalData),this.GlobalData=null),this.status=2):z.R8(`player has already destroyed, taskId: ${this.taskId}`,Et,2929)}onVideoEnded(){this.videoEnded=!0,this.handleEnded()}onAudioEnded(){this.audioEnded=!0,this.handleEnded()}onCanvasUpdated(){this.updateCanvas=this.createCanvas();const t=(0,$.A)()&&D.USE_THREADS?this.updateCanvas.transferControlToOffscreen():this.updateCanvas;this.VideoRenderThread.updateCanvas.transfer(t).invoke(this.taskId,t)}async onGetDecoderResource(t,e){return this.getResource("decoder",e,t)}onFirstVideoRendered(){z.pq(`first video frame rendered, taskId: ${this.taskId}`,Et,3009),this.fire(F.NX)}onFirstAudioRendered(){z.pq(`first audio frame rendered, taskId: ${this.taskId}`,Et,3017),this.fire(F.Sw)}onAudioStutter(){6===this.status&&this.GlobalData.stats.audioStutter++}onVideoStutter(){6===this.status&&this.GlobalData.stats.videoStutter++}onFirstVideoRenderedAfterUpdateCanvas(){this.updateCanvas&&(this.canvas&&this.options.container.removeChild(this.canvas),this.canvas=this.updateCanvas,this.options.container.appendChild(this.canvas),this.updateCanvas=null)}onTimeUpdate(t){this.fire(F.E9,[t])}onMSESeek(t){this.audio?this.audio.currentTime=t:this.video&&(this.video.currentTime=t)}async createVideoDecoderThread(t=!0){this.VideoDecoderThread||(!D.USE_THREADS&&V.A.worker&&t&&(0,$.A)()?(this.VideoPipelineProxy=new Pt.A,await this.VideoPipelineProxy.run(),this.VideoPipelineProxy.setLogLevel(Bt.level),this.VideoDecoderThread=this.VideoPipelineProxy.VideoDecodePipeline,this.VideoRenderThread=this.VideoPipelineProxy.VideoRenderPipeline):(this.VideoDecoderThread=await(0,k.pt)(x.A,{name:"VideoDecoderThread"},31138).run(),this.VideoDecoderThread.setLogLevel(Bt.level),this.VideoRenderThread=Bt.VideoRenderThread))}static async startDemuxPipeline(t=!0){return Bt.DemuxThreadReady?Bt.DemuxThreadReady:Bt.DemuxThreadReady=new(o())((async e=>{!D.USE_THREADS&&V.A.worker&&t?(Bt.IODemuxProxy=new St.A,await Bt.IODemuxProxy.run(),Bt.IODemuxProxy.setLogLevel(Bt.level),Bt.IOThread=Bt.IODemuxProxy.IOPipeline,Bt.DemuxerThread=Bt.IODemuxProxy.DemuxPipeline):(Bt.IOThread=await(0,k.pt)(A.A,{name:"IOThread"},87243).run(),Bt.IOThread.setLogLevel(Bt.level),Bt.DemuxerThread=await(0,k.pt)(b.A,{name:"DemuxerThread"},72480).run(),Bt.DemuxerThread.setLogLevel(Bt.level)),e()}))}static async startAudioPipeline(t=!0){return Bt.AudioThreadReady?Bt.AudioThreadReady:Bt.AudioThreadReady=new(o())((async e=>{Bt.audioContext||(Bt.audioContext=new(AudioContext||webkitAudioContext)),V.A.audioWorklet&&await(0,U.A)(Bt.audioContext,!D.USE_THREADS||H.A.safari&&!H.A.checkVersion(H.A.version,"16.1",!0)?34268:5676),!D.USE_THREADS&&V.A.worker&&t?(Bt.AudioPipelineProxy=new It.A,await Bt.AudioPipelineProxy.run(),Bt.AudioPipelineProxy.setLogLevel(Bt.level),Bt.AudioDecoderThread=Bt.AudioPipelineProxy.AudioDecodePipeline,Bt.AudioRenderThread=Bt.AudioPipelineProxy.AudioRenderPipeline):(Bt.AudioDecoderThread=await(0,k.pt)(w.A,{name:"AudioDecoderThread"},18667).run(),Bt.AudioDecoderThread.setLogLevel(Bt.level),Bt.AudioRenderThread=await(0,k.pt)(M.A,{name:"AudioRenderThread"},59377).run(),Bt.AudioRenderThread.setLogLevel(Bt.level)),e()}))}static async startVideoRenderPipeline(t=!0){return Bt.VideoThreadReady?Bt.VideoThreadReady:Bt.VideoThreadReady=new(o())((async e=>{!D.USE_THREADS&&V.A.worker&&t&&(0,$.A)()||(Bt.VideoRenderThread=await(0,k.pt)(R.A,{name:"VideoRenderThread",disableWorker:!(0,$.A)()},33968).run(),Bt.VideoRenderThread.setLogLevel(Bt.level)),e()}))}static async startMSEPipeline(t=!0){return Bt.MSEThreadReady?Bt.MSEThreadReady:Bt.MSEThreadReady=new(o())((async e=>{!D.USE_THREADS&&V.A.worker&&t?(Bt.MSEPipelineProxy=new _t.A,await Bt.MSEPipelineProxy.run(),Bt.MSEPipelineProxy.setLogLevel(Bt.level),Bt.MSEThread=Bt.MSEPipelineProxy.MSEPipeline):(Bt.MSEThread=await(0,k.pt)(J.A,{name:"MSEThread",disableWorker:!V.A.workerMSE},25115).run(),Bt.MSEThread.setLogLevel(Bt.level)),e()}))}static async startPipelines(t=!0){await Bt.startDemuxPipeline(t),await Bt.startAudioPipeline(t),await Bt.startVideoRenderPipeline(t),await Bt.startMSEPipeline(t),z.pq("AVPlayer pipelines started",Et,3207)}static async stopPipelines(){Bt.VideoRenderThread&&(await Bt.VideoRenderThread.clear(),(0,k.nE)(Bt.VideoRenderThread)),Bt.AudioPipelineProxy&&(await Bt.AudioRenderThread.clear(),await Bt.AudioDecoderThread.clear(),await Bt.AudioPipelineProxy.destroy(),Bt.AudioRenderThread=null,Bt.AudioDecoderThread=null),Bt.AudioRenderThread&&(await Bt.AudioRenderThread.clear(),(0,k.nE)(Bt.AudioRenderThread)),Bt.AudioDecoderThread&&(await Bt.AudioDecoderThread.clear(),(0,k.nE)(Bt.AudioDecoderThread)),Bt.IODemuxProxy&&(await Bt.DemuxerThread.clear(),await Bt.IOThread.clear(),await Bt.IODemuxProxy.destroy(),Bt.DemuxerThread=null,Bt.IOThread=null),Bt.DemuxerThread&&(await Bt.DemuxerThread.clear(),(0,k.nE)(Bt.DemuxerThread)),Bt.IOThread&&(await Bt.IOThread.clear(),(0,k.nE)(Bt.IOThread)),Bt.MSEPipelineProxy&&(await Bt.MSEThread.clear(),Bt.MSEPipelineProxy.destroy(),Bt.MSEThread=null),Bt.MSEThread&&(await Bt.MSEThread.clear(),(0,k.nE)(Bt.MSEThread)),Bt.AudioPipelineProxy=null,Bt.AudioDecoderThread=null,Bt.IODemuxProxy=null,Bt.DemuxerThread=null,Bt.IOThread=null,Bt.audioContext=null,Bt.MSEThread=null,z.pq("AVPlayer pipelines stopped",Et,3271)}static setLogLevel(t){Bt.level=t,z.V$(t),Bt.IOThread&&Bt.IOThread.setLogLevel(t),Bt.DemuxerThread&&Bt.DemuxerThread.setLogLevel(t),Bt.AudioDecoderThread&&Bt.AudioDecoderThread.setLogLevel(t),Bt.AudioRenderThread&&Bt.AudioRenderThread.setLogLevel(t),Bt.VideoRenderThread&&Bt.VideoRenderThread.setLogLevel(t),Bt.MSEThread&&Bt.MSEThread.setLogLevel(t),z.pq(`set log level: ${t}`,Et,3303)}on(t,e,i={}){return super.on(t,P.X$({fn:e},i)),this}one(t,e,i={}){return super.on(t,P.X$({fn:e,max:1},i)),this}}(0,r.A)(Bt,"Util",{compile:_.A,browser:H.A,os:mt.A}),(0,r.A)(Bt,"IOLoader",{CustomIOLoader:bt.A,FetchIOLoader:yt.A,FileIOLoader:At.A,HlsIOLoader:xt.default,DashIOLoader:wt.default}),(0,r.A)(Bt,"level",z.rD),(0,r.A)(Bt,"DemuxThreadReady",void 0),(0,r.A)(Bt,"AudioThreadReady",void 0),(0,r.A)(Bt,"VideoThreadReady",void 0),(0,r.A)(Bt,"MSEThreadReady",void 0),(0,r.A)(Bt,"IODemuxProxy",void 0),(0,r.A)(Bt,"AudioPipelineProxy",void 0),(0,r.A)(Bt,"MSEPipelineProxy",void 0),(0,r.A)(Bt,"IOThread",void 0),(0,r.A)(Bt,"DemuxerThread",void 0),(0,r.A)(Bt,"AudioDecoderThread",void 0),(0,r.A)(Bt,"AudioRenderThread",void 0),(0,r.A)(Bt,"VideoRenderThread",void 0),(0,r.A)(Bt,"MSEThread",void 0),(0,r.A)(Bt,"audioContext",void 0),(0,r.A)(Bt,"Resource",new(d()))},11628:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(84149),a=i(67593);class n{constructor(t,e){(0,r.A)(this,"videoRenderControlChannel",void 0),(0,r.A)(this,"audioRenderControlChannel",void 0),(0,r.A)(this,"muxerControlChannel",void 0),(0,r.A)(this,"demuxerControlChannel",void 0),(0,r.A)(this,"videoRenderControlIPCPort",void 0),(0,r.A)(this,"audioRenderControlIPCPort",void 0),(0,r.A)(this,"muxerControlIPCPort",void 0),(0,r.A)(this,"demuxerControlIPCPort",void 0),(0,r.A)(this,"observer",void 0),(0,r.A)(this,"visibilityHidden",void 0),(0,r.A)(this,"onVisibilityChange",void 0),(0,r.A)(this,"timeUpdateListenType",void 0),(0,r.A)(this,"enableAudioVideoSync",void 0),this.observer=t,this.videoRenderControlChannel=(0,a.A)(e),this.audioRenderControlChannel=(0,a.A)(e),this.muxerControlChannel=(0,a.A)(e),this.demuxerControlChannel=(0,a.A)(e),this.videoRenderControlIPCPort=new s.Ay(this.videoRenderControlChannel.port2),this.audioRenderControlIPCPort=new s.Ay(this.audioRenderControlChannel.port2),this.muxerControlIPCPort=new s.Ay(this.muxerControlChannel.port2),this.demuxerControlIPCPort=new s.Ay(this.demuxerControlChannel.port2),this.enableAudioVideoSync=!0,this.videoRenderControlIPCPort.on(s.Wo,(t=>{switch(t.method){case"ended":this.observer.onVideoEnded();break;case"updateCanvas":this.observer.onCanvasUpdated();break;case"firstRendered":this.observer.onFirstVideoRendered();break;case"firstRenderedAfterUpdateCanvas":this.observer.onFirstVideoRenderedAfterUpdateCanvas();break;case"syncPts":0===this.timeUpdateListenType&&this.observer.onTimeUpdate(t.params.pts)}})),this.audioRenderControlIPCPort.on(s.Wo,(t=>{switch(t.method){case"syncPts":this.enableAudioVideoSync&&this.videoRenderControlIPCPort.notify("syncPts",t.params),1===this.timeUpdateListenType&&this.observer.onTimeUpdate(t.params.pts);break;case"ended":this.observer.onAudioEnded()}})),this.muxerControlIPCPort.on(s.Wo,(t=>{"seek"===t.method&&this.observer.onMSESeek(t.params.time)})),this.demuxerControlIPCPort.on(s.S3,(async t=>{"getDecoderResource"===t.method&&this.demuxerControlIPCPort.reply(t,await this.observer.onGetDecoderResource(t.params.mediaType,t.params.codecId))})),this.onVisibilityChange=t=>{this.visibilityHidden="hidden"===document.visibilityState&&!this.observer.isPictureInPicture(),this.videoRenderControlIPCPort.notify("skipRender",{skipRender:this.visibilityHidden})},this.visibilityHidden="hidden"===document.visibilityState&&!this.observer.isPictureInPicture(),document.addEventListener("visibilitychange",this.onVisibilityChange)}getVideoRenderControlPort(){return this.videoRenderControlChannel.port1}getAudioRenderControlPort(){return this.audioRenderControlChannel.port1}getMuxerControlPort(){return this.muxerControlChannel.port1}getDemuxerControlPort(){return this.demuxerControlChannel.port1}setTimeUpdateListenType(t){this.timeUpdateListenType=t}setEnableAudioVideoSync(t){this.enableAudioVideoSync=t}destroy(){this.videoRenderControlIPCPort&&this.videoRenderControlIPCPort.destroy(),this.audioRenderControlIPCPort&&this.audioRenderControlIPCPort.destroy(),this.muxerControlIPCPort&&this.muxerControlIPCPort.destroy(),this.demuxerControlIPCPort&&this.demuxerControlIPCPort.destroy(),this.onVisibilityChange&&(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.onVisibilityChange=null),this.videoRenderControlIPCPort=this.audioRenderControlIPCPort=this.muxerControlIPCPort=this.videoRenderControlChannel=this.audioRenderControlChannel=this.demuxerControlChannel=this.muxerControlChannel=null}}},2368:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(134),s=i(63939),a=i(50932),n=i(54058),o=i(38724);const l=200;class c{constructor(t){(0,r.A)(this,"timer",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"data",void 0),(0,r.A)(this,"lastIncomingPacketCount",void 0),(0,r.A)(this,"shutterCount",void 0),(0,r.A)(this,"lastShutterCount",void 0),(0,r.A)(this,"isFirst",void 0),(0,r.A)(this,"max",void 0),(0,r.A)(this,"min",void 0),(0,r.A)(this,"targetPlaybackRate",void 0),(0,r.A)(this,"currentPlaybackRate",void 0),(0,r.A)(this,"playbackRateTimer",void 0),(0,r.A)(this,"options",void 0),this.options=t,this.interval=1e3,this.isFirst=!0,this.data=[],this.lastIncomingPacketCount=BigInt(0),this.shutterCount=0,this.lastShutterCount=0,this.max=1e3*t.max>>>0,this.min=1e3*t.min>>>0,a.M[15](this.options.jitterBuffer,this.min),a.M[15](this.options.jitterBuffer+4,this.max),t.lowLatencyStart&&a.M[15](this.options.jitterBuffer+4,this.min+l),this.targetPlaybackRate=1,this.currentPlaybackRate=1,this.playbackRateTimer=new n.A((()=>{if(this.currentPlaybackRate>this.targetPlaybackRate){const t=Math.max(this.targetPlaybackRate,this.currentPlaybackRate-.01);this.options.observer.onSetPlayRate(t),this.currentPlaybackRate=t}else if(this.currentPlaybackRate<this.targetPlaybackRate){const t=Math.min(this.targetPlaybackRate,this.currentPlaybackRate+.01);this.options.observer.onSetPlayRate(t),this.currentPlaybackRate=t}else this.playbackRateTimer.stop()}),0,200),this.timer=new o.A(this.onTimer.bind(this),1e3,this.interval)}start(){this.timer.start(),this.isFirst=!0,this.lastIncomingPacketCount=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112),this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+284)+s.f[15](this.options.stats+280),this.computePlayRate()}stop(){this.timer.stop(),this.data.length=0,this.isFirst=!0,this.playbackRateTimer.isStarted()&&(this.playbackRateTimer.stop(),this.targetPlaybackRate=this.currentPlaybackRate=1,this.options.observer.onSetPlayRate(1))}reset(){this.data.length=0,this.isFirst=!0,this.lastIncomingPacketCount=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112),this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+284)+s.f[15](this.options.stats+280),this.targetPlaybackRate=this.currentPlaybackRate=1}setPlayRate(t){this.targetPlaybackRate=t,this.options.useMse?(this.options.observer.onSetPlayRate(this.targetPlaybackRate),this.currentPlaybackRate=this.targetPlaybackRate):this.currentPlaybackRate===t||this.playbackRateTimer.isStarted()||this.playbackRateTimer.start()}computePlayRate(){let t=s.f[15](this.options.stats+236)?s.f[15](this.options.stats+32)/s.f[15](this.options.stats+236)*1e3:s.f[15](this.options.stats+224)?s.f[15](this.options.stats+120)/s.f[15](this.options.stats+224)*1e3:0;t<s.f[15](this.options.jitterBuffer)>>1&&t<2?this.setPlayRate(.8):t<s.f[15](this.options.jitterBuffer)-l&&t<2?this.setPlayRate(.95):t>s.f[15](this.options.jitterBuffer+4)+l?this.setPlayRate(1.05):this.setPlayRate(1),t>this.max<<1&&this.options.observer.onCroppingBuffer(s.f[15](this.options.jitterBuffer+4))}process(){const t=this.data.reduce(((t,e,i)=>t+e*(i+1)),0)/55,e=this.data.reduce(((e,i)=>e+Math.pow(i-t,2)),0)/this.data.length,i=Math.sqrt(e),r=Math.round(t/(this.interval/1e3)),n=s.f[15](this.options.stats+224)+s.f[15](this.options.stats+236);r<n>>1||this.shutterCount>3?(a.M[15](this.options.jitterBuffer,Math.min(2*s.f[15](this.options.jitterBuffer),this.max-l)),a.M[15](this.options.jitterBuffer+4,Math.min(2*s.f[15](this.options.jitterBuffer+4),this.max))):r>=n&&i<50?(a.M[15](this.options.jitterBuffer,Math.max(s.f[15](this.options.jitterBuffer)-l,this.min)),a.M[15](this.options.jitterBuffer+4,Math.max(s.f[15](this.options.jitterBuffer+4)-l,this.min+l))):i>100?(a.M[15](this.options.jitterBuffer,Math.min(s.f[15](this.options.jitterBuffer)+l,this.max-l)),a.M[15](this.options.jitterBuffer+4,Math.min(s.f[15](this.options.jitterBuffer+4)+l,this.max))):i<20?s.f[15](this.options.jitterBuffer)===this.min?a.M[15](this.options.jitterBuffer+4,Math.max(s.f[15](this.options.jitterBuffer+4)-l,this.min+l)):a.M[15](this.options.jitterBuffer,Math.max(s.f[15](this.options.jitterBuffer)-l,this.min)):s.f[15](this.options.jitterBuffer+4)===this.max?a.M[15](this.options.jitterBuffer,Math.min(s.f[15](this.options.jitterBuffer)+l,this.max-l)):a.M[15](this.options.jitterBuffer+4,Math.min(s.f[15](this.options.jitterBuffer+4)+l,this.max)),this.computePlayRate(),a.M[19](this.options.stats+264,i)}onTimer(){const t=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112);this.isFirst?this.isFirst=!1:this.data.push(Number(BigInt.asIntN(32,t-this.lastIncomingPacketCount))),this.lastIncomingPacketCount=t,s.f[15](this.options.stats+284)+s.f[15](this.options.stats+280)>this.lastShutterCount?this.shutterCount++:this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+284)+s.f[15](this.options.stats+280),this.data.length>10&&this.data.shift(),10===this.data.length&&this.process()}}},78201:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(134),s=i(63939),a=i(50932),n=i(54058);class o{constructor(t,e,i){(0,r.A)(this,"stats",void 0),(0,r.A)(this,"timer",void 0),(0,r.A)(this,"videoFrameRenderCount",void 0),(0,r.A)(this,"videoFrameDecodeCount",void 0),(0,r.A)(this,"audioFrameRenderCount",void 0),(0,r.A)(this,"audioFrameDecodeCount",void 0),(0,r.A)(this,"videoPacketBytes",void 0),(0,r.A)(this,"audioPacketBytes",void 0),(0,r.A)(this,"bufferReceiveBytes",void 0),(0,r.A)(this,"observer",void 0),(0,r.A)(this,"isWorkerMain",void 0),this.stats=t,this.observer=i,this.isWorkerMain=e,this.timer=new n.A(this.onTimer.bind(this),1e3,1e3)}reset(){this.videoFrameRenderCount=s.f[17](this.stats+160),this.videoFrameDecodeCount=s.f[17](this.stats+144),this.audioFrameRenderCount=s.f[17](this.stats+72),this.audioFrameDecodeCount=s.f[17](this.stats+56),this.videoPacketBytes=s.f[17](this.stats+104),this.audioPacketBytes=s.f[17](this.stats+16),this.bufferReceiveBytes=s.f[17](this.stats+192)}start(){this.reset(),this.timer.start()}stop(){this.timer.stop()}onTimer(){this.isWorkerMain||(a.M[15](this.stats+240,0),a.M[15](this.stats+244,0),a.M[15](this.stats+248,0),a.M[15](this.stats+252,0)),a.M[15](this.stats+220,Number(BigInt.asIntN(32,s.f[17](this.stats+160)-this.videoFrameRenderCount))),a.M[15](this.stats+216,Number(BigInt.asIntN(32,s.f[17](this.stats+144)-this.videoFrameDecodeCount))),a.M[15](this.stats+232,Number(BigInt.asIntN(32,s.f[17](this.stats+72)-this.audioFrameRenderCount))),a.M[15](this.stats+228,Number(BigInt.asIntN(32,s.f[17](this.stats+56)-this.audioFrameDecodeCount))),a.M[15](this.stats+212,Number(BigInt.asIntN(32,s.f[17](this.stats+104)-this.videoPacketBytes))),a.M[15](this.stats+208,Number(BigInt.asIntN(32,s.f[17](this.stats+16)-this.audioPacketBytes))),a.M[15](this.stats+256,Number(BigInt.asIntN(32,s.f[17](this.stats+192)-this.bufferReceiveBytes))),"visible"===document.visibilityState&&(s.f[15](this.stats+220)<.5*s.f[15](this.stats+224)||s.f[15](this.stats+252)>6e3/s.f[15](this.stats+224))&&this.observer.onVideoStutter(),this.reset()}}},28090:(t,e,i)=>{"use strict";i.d(e,{CN:()=>n,E9:()=>p,F5:()=>r,Gd:()=>A,IY:()=>m,NN:()=>o,NX:()=>v,Nz:()=>h,Rj:()=>f,S2:()=>s,Sw:()=>g,W1:()=>x,Wt:()=>u,Wu:()=>b,d6:()=>a,hV:()=>c,mQ:()=>d,xv:()=>y,yd:()=>l});const r="loading",s="loaded",a="playing",n="played",o="paused",l="stopped",c="ended",h="seeking",d="seeked",u="changing",f="changed",p="time",m="resume",g="firstAudioRendered",v="firstVideoRendered",y="streamUpdate",A="progress",b="volumeChange",x="subtitle_delay_change"},67593:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(26429),s=i(42577),a=i(95797);function n(t){return r.USE_THREADS||a.A.worker&&t?new MessageChannel:new s.A}},76750:(t,e,i)=>{"use strict";function r(){if("function"==typeof MediaSource)return MediaSource;if("function"==typeof ManagedMediaSource)return ManagedMediaSource;throw new Error("not support mse")}i.d(e,{A:()=>r})},47595:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(95797),s=i(44690),a=i(86834);function n(){let t=r.A.offscreenCanvas;return s.A.mac&&a.A.safari&&(s.A.version<"12"||a.A.version<"17")&&(t=!1),t}},25115:(t,e,i)=>{"use strict";i.d(e,{A:()=>j});var r=i(54001),s=i.n(r),a=i(14686),n=i(61499),o=i(63939),l=i(9599),c=i(29170),h=i(50932),d=i(12264),u=i(44315),f=i(44527),p=i(9705),m=i(84149),g=i(4624),v=i(35336),y=i(92174),A=i(69765),b=i(71766),x=i(39148),w=i(60120),k=i(84290),T=i(77231),S=i(44328),I=i(86932),P=i(85224),_=i(10333),E=i(22343),C=i(71517),M=i(37837),R=i(86834),B=i(85103),D=i(13724),U=i(43607),L=i(65977),N=i(76750),O=i(39381),F=i(20620),$=i(53e3),z=i(71762),V=i(72703),G=i(67672),W="src/avplayer/mse/MSEPipeline.ts";function H(t,e,i,r){if(e!==r)return!0;let s=!1;for(let r=0;r<e;r++)if(o.f[2](t+r)!==o.f[2](i+r)){s=!0;break}return s}class j extends f.A{constructor(){super()}async syncToKeyframe(t){let e=!0;if(t.video)for(;;){if(t.video.backPacket=await this.pullAVPacket(t.video,t),t.video.backPacket<0){t.video.packetEnded=!0,t.video.backPacket=0;break}if(t.audio&&!t.audio.packetEnded&&(!t.audio.backPacket||(0,S.k)(o.f[17](t.audio.backPacket+8),(0,c.A)(t.audio.backPacket+72,l.P),T.i0)<(0,S.k)(o.f[17](t.video.backPacket+8),(0,c.A)(t.video.backPacket+72,l.P),T.i0)))for(;;){if(t.audio.backPacket>0&&t.avpacketPool.release(t.audio.backPacket),t.audio.backPacket=await this.pullAVPacket(t.audio,t),t.audio.backPacket<0){t.audio.packetEnded=!0,t.audio.backPacket=0;break}if((0,S.k)(o.f[17](t.audio.backPacket+8),(0,c.A)(t.audio.backPacket+72,l.P),T.i0)>(0,S.k)(o.f[17](t.video.backPacket+8),(0,c.A)(t.video.backPacket+72,l.P),T.i0))break}if(1&o.f[15](t.video.backPacket+36))break;e=!1,t.avpacketPool.release(t.video.backPacket)}return e}getSourceOpenHandler(t){return async()=>{await this.syncToKeyframe(t);const e=[];t.audio&&(t.audio.track.setSourceBuffer(this.createSourceBuffer(t.mediaSource,t.audio.oformatContext.streams[0].codecpar[n.o9])),t.audio.enableRawMpeg||(y.ho(t.audio.oformatContext,{paddingZero:!1}),y.bx(t.audio.oformatContext)),e.push(this.startMux(t.audio,t))),t.video&&(t.video.track.setSourceBuffer(this.createSourceBuffer(t.mediaSource,t.video.oformatContext.streams[0].codecpar[n.o9])),t.video.enableRawMpeg||(y.ho(t.video.oformatContext,{paddingZero:!1}),y.bx(t.video.oformatContext)),e.push(this.startMux(t.video,t))),await s().all(e);let i=!1,r=!1;t.audio&&(t.audio.backPacket=await this.pullAVPacket(t.audio,t),t.audio.backPacket>0?(i=!0,t.audio.frontPacket=await this.pullAVPacket(t.audio,t),t.audio.frontPacket>0?t.audio.frontBuffered=!0:(t.audio.frontPacket=0,t.audio.packetEnded=!0)):t.audio.packetEnded=!0,t.audio.enableRawMpeg||t.audio.oformatContext.ioWriter.flush(),t.audio.track.addBuffer(t.audio.bufferQueue.flush())),t.video&&(t.video.backPacket=await this.pullAVPacket(t.video,t),t.video.backPacket>0?(r=!0,t.video.frontPacket=await this.pullAVPacket(t.video,t),t.video.frontPacket>0?t.video.frontBuffered=!0:(t.video.frontPacket=0,t.video.packetEnded=!0)):t.video.packetEnded=!0,t.video.enableRawMpeg||t.video.oformatContext.ioWriter.flush(),t.video.track.addBuffer(t.video.bufferQueue.flush())),t.audio&&(i?(this.createLoop(t.audio,t),t.audio.loop.start()):t.audio.track.end()),t.video&&(r?(this.createLoop(t.video,t),t.video.loop.start()):t.video.track.end()),await new D.A(.1);let a=0;t.audio?a=t.video?Math.max(t.audio.track.getBufferedStart(),t.video.track.getBufferedStart()):t.audio.track.getBufferedStart():t.video&&(a=t.video.track.getBufferedStart()),(R.A.safari||a>.1)&&t.controlIPCPort.notify("seek",{time:a})}}getMimeType(t){let e="";return 1===o.f[15](t)?e=(0,P.A)(t):0===o.f[15](t)&&(e=(0,_.A)(t)),e||g.h2("invalid stream",W,344),e}createSourceBuffer(t,e){return t.addSourceBuffer(this.getMimeType(e))}mixExtradata(t,e,i,r){e.oformatContext.streams[0].codecpar.codecId;const s=e.oformatContext.streams[0].codecpar;s.extradata&&(0,M.Eb)(s.extradata),s.extradata=(0,M.sY)(r),(0,a.Mr)(s.extradata,i,r),s.extradataSize=r}async pullAVPacketInternal(t,e){const i=await e.request("pull");if(G.ai(i))return i;{const e=t.avpacketPool.alloc();return(0,z.r0)(i,e),e}}async pullAVPacket(t,e){const i=t.pullQueue;if(i.ended&&!i.queue.length)return-1048576;const r=i.queue.length?i.queue.shift():await this.pullAVPacketInternal(e,t.pullIPC);if(r<0)return i.ended=!0,-1048576;if(o.f[17](r+16)<i.lastDTS&&g.R8(`got packet with dts ${o.f[17](r+16)}, which is earlier then the last packet(${i.lastDTS})`,W,403),"audio"===t.type&&o.f[17](r+16)>0)h.M[17](r+8,o.f[17](r+16));else if("video"===t.type&&!e.isLive)if(1&o.f[15](r+36)&&(27===o.f[15](e.video.codecpar+4)&&F.KD(r,o.f[20](e.video.codecpar+12)?4&O.r8(o.f[20](e.video.codecpar+12)+4):4)||173===o.f[15](e.video.codecpar+4)&&$.KD(r,o.f[20](e.video.codecpar+12)?4&O.r8(o.f[20](e.video.codecpar+12)+21):4)))if(o.f[17](r+8)<i.lastPTS){g.R8(`got packet with pts ${o.f[17](r+8)}, which is earlier then the last packet(${i.lastPTS}), try to fix it!`,W,436),h.M[17](r+8,i.lastPTS+(o.f[17](r+16)-i.lastDTS));const s=await this.pullAVPacketInternal(e,t.pullIPC);if(s<0)i.ended=!0;else{i.queue.push(s);let a=o.f[17](s+8);const n=o.f[17](s+8);for(;;){const r=await this.pullAVPacketInternal(e,t.pullIPC);if(r<0){i.ended=!0;break}if(i.queue.push(r),o.f[17](r+8)>n)break;a=U.jk(a,o.f[17](r+8))}a<o.f[17](r+8)&&(i.diff=o.f[17](r+16)-i.lastDTS)}}else i.diff=BigInt(0);else h.M[17](r+8,o.f[17](r+8)+i.diff);return o.f[17](r+8)>i.lastPTS&&(i.lastPTS=o.f[17](r+8)),i.lastDTS=o.f[17](r+16),"audio"===t.type&&i.useSampleRateTimeBase&&(i.frameCount===T.Dh?(i.frameCount=(0,S.k)(o.f[17](r+16),(0,c.A)(r+72,l.P),t.oformatContext.streams[0].timeBase),h.M[17](r+16,i.frameCount),h.M[17](r+8,i.frameCount)):(i.frameCount=i.frameCount+BigInt(0|o.f[15](t.codecpar+144)),h.M[17](r+16,i.frameCount),h.M[17](r+8,i.frameCount)),(0,a.Mr)(r+72,t.oformatContext.streams[0].timeBase[n.o9],8)),r}writeAVPacket(t,e,i=!1){if(e.enableRawMpeg){if(!e.timestampOffsetUpdated){const i=(0,S.k)(o.f[17](t+8),(0,c.A)(t+72,l.P),T.i0);e.track.updateTimestampOffset(Number(BigInt.asIntN(32,i))/1e3),e.timestampOffsetUpdated=!0}e.bufferQueue.write((0,a.s3)(o.f[20](t+24),o.f[15](t+28)).slice())}else y.XA(e.oformatContext,t),i&&e.oformatContext.ioWriter.flush()}swap(t,e){if(t.backPacket&&e.avpacketPool.release(t.backPacket),t.backPacket=0,!t.frontBuffered)return!1;t.backPacket=t.frontPacket,t.frontPacket=0,t.frontBuffered=!1;const i=(0,I.A)();return this.pullAVPacket(t,e).then((r=>{if(r<0)return t.packetEnded=!0,void(t.frontPacket=0);const s=(0,I.A)()-i;s>5&&(t.startTimestamp+=BigInt(Math.floor(s))),t.frontPacket=r,t.frontBuffered=!0,t.seekSync&&(t.seekSync(),t.seekSync=null),t.backPacket||this.swap(t,e)})),!0}createLoop(t,e){t.loop=new x.A((()=>{const i=t.track.getBufferedEnd()-(e.currentTime+((0,I.A)()-e.currentTimeNTP)/1e3);if(i>1*(e.playRate>BigInt(100)?Number(e.playRate)/100:1))return void t.loop.emptyTask();if(!t.backPacket)return void(t.packetEnded&&!t.frontPacket?(t.ended=!0,t.loop.stop(),t.enableRawMpeg||(y.dJ(t.oformatContext),y.bX(t.oformatContext)),t.bufferQueue.size&&t.track.addBuffer(t.bufferQueue.flush()),t.track.end()):t.loop.emptyTask());let r=t.backPacket;const s=(0,S.k)(o.f[17](r+16),(0,c.A)(r+72,l.P),T.i0);if(e.enableJitterBuffer&&(o.f[15](e.stats+236)?o.f[15](e.stats+32)/o.f[15](e.stats+236)*1e3:o.f[15](e.stats+224)?o.f[15](e.stats+120)/o.f[15](e.stats+224)*1e3:0)<=o.f[15](e.stats+272)&&this.setPlayRate(e.taskId,1),s*BigInt(100)/e.playRate+t.startTimestamp-BigInt(Math.floor((0,I.A)()))<=0||i<.5*(e.playRate>BigInt(100)?Number(e.playRate)/100:1)){t.track.isPaused()&&t.track.enqueue(),h.M[15](r+32,t.oformatContext.streams[0].index);const i=(0,C.rU)(r,1);i&&H(t.oformatContext.streams[0].codecpar.extradata,t.oformatContext.streams[0].codecpar.extradataSize,o.f[20](i),o.f[15](i+4))&&this.mixExtradata(r,t,o.f[20](i),o.f[15](i+4)),this.writeAVPacket(r,t,!0),t.track.addBuffer(t.bufferQueue.flush());const a=t.oformatContext.streams[0].codecpar.codecType;if(0===a?(h.M[17](e.stats+144,o.f[17](e.stats+144)+BigInt(1)),h.M[17](e.stats+160,o.f[17](e.stats+160)+BigInt(1))):1===a&&(h.M[17](e.stats+56,o.f[17](e.stats+56)+BigInt(1)),h.M[17](e.stats+72,o.f[17](e.stats+72)+BigInt(1))),e.playRate!==e.targetRate&&(t.startTimestamp=BigInt(Math.floor((0,I.A)()))-s*BigInt(100)/e.targetRate,e.playRate=e.targetRate),t.packetEnded&&!t.frontPacket)return t.ended=!0,t.loop.stop(),t.enableRawMpeg||(y.dJ(t.oformatContext),y.bX(t.oformatContext)),t.bufferQueue.size&&t.track.addBuffer(t.bufferQueue.flush()),void t.track.end();this.swap(t,e)}else t.loop.emptyTask()}),0,0)}async startMux(t,e){let i,r=T.Dh,s=T.Dh,a=BigInt(0);const n=t.oformatContext.streams[0].timeBase;for(t.backPacket>0&&(r=o.f[17](t.backPacket+16),s=o.f[17](t.backPacket+8),h.M[15](t.backPacket+32,t.oformatContext.streams[0].index),this.writeAVPacket(t.backPacket,t),e.avpacketPool.release(t.backPacket),t.backPacket=0);r<BigInt(0)||(0,S.k)(a-r,n,T.i0)<e.cacheDuration;){if(i=await this.pullAVPacket(t,e),i<0){t.packetEnded=!0;break}if(a=o.f[17](i+16),r<BigInt(0)&&(r=a,s=o.f[17](i+8)),o.f[17](i+8)<s&&(s=o.f[17](i+8)),e.video&&e.video.streamIndex===o.f[15](i+32)){const e=(0,C.rU)(i,1);e&&H(t.oformatContext.streams[0].codecpar.extradata,t.oformatContext.streams[0].codecpar.extradataSize,o.f[20](e),o.f[15](e+4))&&this.mixExtradata(i,t,o.f[20](e),o.f[15](e+4))}h.M[15](i+32,t.oformatContext.streams[0].index),this.writeAVPacket(i,t),e.avpacketPool.release(i)}s!==T.Dh&&t.startPTS<=BigInt(0)&&(t.startPTS=s),t.pullQueue.diff=BigInt(0),e.currentTimeNTP=(0,I.A)(),e.currentTime=0,t.startTimestamp=BigInt(Math.floor((0,I.A)()))-(0,S.k)(a,n,T.i0)*BigInt(100)/e.playRate}resetResource(t,e){t.bufferQueue.flush();const i=new A.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0});t.oformatContext.oformat=i;const r=new w.A;r.onQuotaExceededError=()=>{t.startTimestamp-=BigInt(100)},r.onEnded=()=>{e.audio&&!e.audio.ended||e.video&&!e.video.ended||(e.mediaSource.endOfStream(),g.pq(`muxer ended, taskId: ${e.taskId}`,W,754))},t.track=r,t.packetEnded=!1,t.ended=!1,t.startTimestamp=BigInt(0),t.frontBuffered=!1,t.seekSync=null,t.loop&&(t.loop.destroy(),t.loop=null),t.frontPacket&&(e.avpacketPool.release(t.frontPacket),t.frontPacket=0),t.backPacket&&(e.avpacketPool.release(t.backPacket),t.backPacket=0),t.pullQueue.ended=!1,t.pullQueue.index=0,t.pullQueue.frameCount=T.Dh,t.pullQueue.lastPTS=BigInt(0),t.pullQueue.lastDTS=BigInt(0),t.pullQueue.diff=BigInt(0)}async addStream(t,e,i,r,s,a){const l=this.tasks.get(t);if(l){const t=(0,M.Gy)(168);(0,V.A)(i)?(0,b.Yi)(t,i):(0,z.T8)(i,t);const c=new v.A(1048576),d=(0,u.fG)(),f=new A.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0}),y=new E.A;c.onFlush=t=>(y.write(t.slice()),0),c.onSeek=t=>y.seek(t)?0:p.lh;const x=d.createStream();(0,b.Yi)(x.codecpar[n.o9],t),86017===o.f[15](t+4)&&(x.codecpar.codecTag=(0,L.A)(".mp3"));const k=1===o.f[15](t)&&o.f[15](t+144)&&!l.isLive&&(0,S.lb)(r)>(0,S.lb)({num:1,den:o.f[15](t+136)});k?(x.timeBase.den=o.f[15](t+136),x.timeBase.num=1):(x.timeBase.den=r.den,x.timeBase.num=r.num),d.oformat=f,d.ioWriter=c;const I=new w.A,P={type:"audio",codecpar:t,ioWriter:c,oformatContext:d,oformat:f,track:I,bufferQueue:y,streamIndex:e,pullIPC:new m.Ay(a),loop:null,frontPacket:0,backPacket:0,frontBuffered:!1,startTimestamp:BigInt(0),packetEnded:!1,ended:!1,seekSync:null,startPTS:s,pullQueue:{queue:[],index:0,frameCount:T.Dh,diff:BigInt(0),lastPTS:BigInt(0),lastDTS:BigInt(0),ended:!1,useSampleRateTimeBase:k},enableRawMpeg:86017===o.f[15](t+4)&&!R.A.firefox,timestampOffsetUpdated:!1};I.onQuotaExceededError=()=>{P.startTimestamp-=BigInt(100)},I.onEnded=()=>{l.audio&&!l.audio.ended||l.video&&!l.video.ended||(l.mediaSource.endOfStream(),g.pq(`muxer ended, taskId: ${l.taskId}`,W,895))},1===o.f[15](t)?(l.audio=P,h.M[15](l.stats+4,o.f[15](t+136)),h.M[15](l.stats,o.f[15](t+116))):0===o.f[15](t)&&(P.type="video",l.video=P,h.M[15](l.stats+84,o.f[15](t+56)),h.M[15](l.stats+88,o.f[15](t+60)),o.f[15](l.stats+84)*o.f[15](l.stats+88)>8294400&&R.A.safari&&(l.cacheDuration=U.T9(BigInt(3e3),l.cacheDuration)))}else g.h2("task not found",W,916)}async reAddStream(t,e,i,r,a){const l=this.tasks.get(t);if(l){const t=(0,M.Gy)(168);(0,V.A)(i)?(0,b.Yi)(t,i):(0,z.T8)(i,t);const c=1===o.f[15](t)?l.audio:l.video;if(c){c.bufferQueue.flush(),await new(s())((t=>{c.track.removeAllBuffer((()=>{t()}))})),c.track.reset();const i=new A.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0});c.oformatContext.oformat=i,c.codecpar&&(0,b.dn)(c.codecpar),c.codecpar=t,c.streamIndex=e,c.startPTS=a;const h=c.oformatContext.streams[0];(0,b.Yi)(h.codecpar[n.o9],t),86017===o.f[15](t+4)&&(h.codecpar.codecTag=(0,L.A)(".mp3")),1===o.f[15](t)&&o.f[15](t+144)&&!l.isLive&&(0,S.lb)(r)>(0,S.lb)({num:1,den:o.f[15](t+136)})?(h.timeBase.den=o.f[15](t+136),h.timeBase.num=1):(h.timeBase.den=r.den,h.timeBase.num=r.num),c.track.changeMimeType(this.getMimeType(h.codecpar[n.o9])),c.enableRawMpeg||(y.ho(c.oformatContext,{paddingZero:!1}),y.bx(c.oformatContext))}else(0,b.dn)(t)}else g.h2("task not found",W,1004)}async pause(t){const e=this.tasks.get(t);var i,r,s,a;e?(null!==(i=e.audio)&&void 0!==i&&i.loop||null!==(r=e.video)&&void 0!==r&&r.loop||g.h2("task has not played",W,1012),e.pausing=!0,e.pauseTimestamp=(0,I.A)(),null===(s=e.audio)||void 0===s||s.loop.stop(),null===(a=e.video)||void 0===a||a.loop.stop()):g.h2("task not found",W,1020)}async unpause(t){const e=this.tasks.get(t);var i,r;e?(null!==(i=e.audio)&&void 0!==i&&i.loop||null!==(r=e.video)&&void 0!==r&&r.loop||g.h2("task has not played",W,1028),e.pausing=!1,e.seeking||(e.audio&&(e.audio.startTimestamp+=BigInt(Math.floor((0,I.A)()-e.pauseTimestamp)),e.audio.loop.start()),e.video&&(e.video.startTimestamp+=BigInt(Math.floor((0,I.A)()-e.pauseTimestamp)),e.video.loop.start()))):g.h2("task not found",W,1045)}async beforeSeek(t){const e=this.tasks.get(t);if(e){var i,r;const t=[];e.audio&&(e.audio.ended||e.audio.frontBuffered||t.push(new(s())((t=>{e.audio.seekSync=t})))),e.video&&(e.video.ended||e.video.frontBuffered||t.push(new(s())((t=>{e.video.seekSync=t})))),await s().all(t),e.seeking=!0,null===(i=e.audio)||void 0===i||i.loop.stop(),null===(r=e.video)||void 0===r||r.loop.stop(),e.audio&&(e.audio.enableRawMpeg||y.bX(e.audio.oformatContext),e.audio.bufferQueue.flush(),R.A.safari&&await new(s())((t=>{e.audio.track.removeAllBuffer((()=>{t()}))})),e.audio.track.reset(),e.audio.packetEnded=!1,e.audio.timestampOffsetUpdated=!1,e.audio.backPacket&&(e.avpacketPool.release(e.audio.backPacket),e.audio.backPacket=0),e.audio.frontPacket&&(e.avpacketPool.release(e.audio.frontPacket),e.audio.frontPacket=0),e.audio.pullQueue.queue.length&&e.audio.pullQueue.queue.forEach((t=>{e.avpacketPool.release(t)})),e.audio.pullQueue.queue.length=0,e.audio.pullQueue.ended=!1,e.audio.pullQueue.index=0,e.audio.pullQueue.lastPTS=BigInt(0),e.audio.pullQueue.lastDTS=BigInt(0),e.audio.pullQueue.diff=BigInt(0),e.audio.pullQueue.frameCount=T.Dh),e.video&&(e.video.enableRawMpeg||y.bX(e.video.oformatContext),e.video.bufferQueue.flush(),R.A.safari&&await new(s())((t=>{e.video.track.removeAllBuffer((()=>{t()}))})),e.video.track.reset(),e.video.packetEnded=!1,e.video.timestampOffsetUpdated=!1,e.video.backPacket&&(e.avpacketPool.release(e.video.backPacket),e.video.backPacket=0),e.video.frontPacket&&(e.avpacketPool.release(e.video.frontPacket),e.video.frontPacket=0),e.video.pullQueue.queue.length&&e.video.pullQueue.queue.forEach((t=>{e.avpacketPool.release(t)})),e.video.pullQueue.queue.length=0,e.video.pullQueue.ended=!1,e.video.pullQueue.index=0,e.video.pullQueue.diff=BigInt(0),e.video.pullQueue.lastPTS=BigInt(0),e.video.pullQueue.lastDTS=BigInt(0))}}async afterSeek(t,e){const i=this.tasks.get(t);if(i){let t=e,r=e,a=await this.syncToKeyframe(i);i.audio&&i.audio.backPacket>0&&((!a||e<BigInt(0))&&(t=(0,S.k)(o.f[17](i.audio.backPacket+8)-i.audio.startPTS,(0,c.A)(i.audio.backPacket+72,l.P),T.i0)),h.M[15](i.audio.backPacket+32,i.audio.oformatContext.streams[0].index),this.writeAVPacket(i.audio.backPacket,i.audio),i.avpacketPool.release(i.audio.backPacket),i.audio.backPacket=0),i.video&&i.video.backPacket>0&&((!a||e<BigInt(0))&&(r=(0,S.k)(o.f[17](i.video.backPacket+8)-i.video.startPTS,(0,c.A)(i.video.backPacket+72,l.P),T.i0)),h.M[15](i.video.backPacket+32,i.video.oformatContext.streams[0].index),this.writeAVPacket(i.video.backPacket,i.video),i.avpacketPool.release(i.video.backPacket),i.video.backPacket=0);const n=U.T9(t,r);for(;;){if(i.audio&&!i.audio.packetEnded){if(i.audio.backPacket=await this.pullAVPacket(i.audio,i),i.audio.backPacket<0&&(i.audio.packetEnded=!0,i.audio.backPacket=0,!i.video||i.video.packetEnded))break;if(t<BigInt(0)&&(t=(0,S.k)(o.f[17](i.audio.backPacket+8)-i.audio.startPTS,(0,c.A)(i.audio.backPacket+72,l.P),T.i0)),!((0,S.k)(o.f[17](i.audio.backPacket+8)-i.audio.startPTS,(0,c.A)(i.audio.backPacket+72,l.P),T.i0)<n+i.cacheDuration))break;h.M[15](i.audio.backPacket+32,i.audio.oformatContext.streams[0].index),this.writeAVPacket(i.audio.backPacket,i.audio),i.audio.enableRawMpeg||y.bX(i.audio.oformatContext),i.audio.track.addBuffer(i.audio.bufferQueue.flush()),i.avpacketPool.release(i.audio.backPacket),i.audio.backPacket=0}if(i.video&&!i.video.packetEnded){if(i.video.backPacket=await this.pullAVPacket(i.video,i),i.video.backPacket<0&&(i.video.packetEnded=!0,i.video.backPacket=0,!i.audio||i.audio.packetEnded))break;if(!((0,S.k)(o.f[17](i.video.backPacket+8)-i.video.startPTS,(0,c.A)(i.video.backPacket+72,l.P),T.i0)<n+i.cacheDuration))break;h.M[15](i.video.backPacket+32,i.video.oformatContext.streams[0].index),this.writeAVPacket(i.video.backPacket,i.video),i.video.enableRawMpeg||y.bX(i.video.oformatContext),i.video.track.addBuffer(i.video.bufferQueue.flush()),i.avpacketPool.release(i.video.backPacket),i.video.backPacket=0}}const d=[];i.audio&&(i.audio.enableRawMpeg||y.bX(i.audio.oformatContext),d.push(new(s())((t=>{i.audio.track.addBuffer(i.audio.bufferQueue.flush(),(()=>{t()}))})))),i.video&&(i.video.enableRawMpeg||y.bX(i.video.oformatContext),d.push(new(s())((t=>{i.video.track.addBuffer(i.video.bufferQueue.flush(),(()=>{t()}))})))),await s().all(d),i.audio&&!i.audio.packetEnded&&(i.audio.backPacket<=0&&(i.audio.backPacket=await this.pullAVPacket(i.audio,i),i.audio.backPacket<0&&(i.audio.packetEnded=!0,i.audio.backPacket=0)),i.audio.packetEnded||(i.audio.frontPacket=await this.pullAVPacket(i.audio,i),i.audio.frontPacket<0?(i.audio.frontPacket=0,i.audio.packetEnded=!0,i.audio.frontBuffered=!1):(i.audio.packetEnded=!1,i.audio.frontBuffered=!0),i.audio.startTimestamp=BigInt(Math.floor((0,I.A)()))-(t+i.cacheDuration+(0,S.k)(i.audio.startPTS,i.audio.oformatContext.streams[0].timeBase,T.i0))*BigInt(100)/i.playRate,i.pausing?i.pauseTimestamp=(0,I.A)():i.audio.loop.start())),i.video&&!i.video.packetEnded&&(i.video.backPacket<=0&&(i.video.backPacket=await this.pullAVPacket(i.video,i),i.video.backPacket<0&&(i.video.packetEnded=!0,i.video.backPacket=0)),i.video.packetEnded||(i.video.frontPacket=await this.pullAVPacket(i.video,i),i.video.frontPacket<0?(i.video.packetEnded=!0,i.video.frontBuffered=!1,i.video.frontPacket=0):(i.video.packetEnded=!1,i.video.frontBuffered=!0),i.video.startTimestamp=BigInt(Math.floor((0,I.A)()))-(r+i.cacheDuration+(0,S.k)(i.video.startPTS,i.video.oformatContext.streams[0].timeBase,T.i0))*BigInt(100)/i.playRate,i.pausing?i.pauseTimestamp=(0,I.A)():i.video.loop.start())),a||await new D.A(.5);let u=0,f=0;i.audio?i.video?(u=Math.max(i.audio.track.getBufferedStart(),i.video.track.getBufferedStart()),f=Math.min(i.audio.track.getBufferedEnd(),i.video.track.getBufferedEnd())):(u=i.audio.track.getBufferedStart(),f=i.audio.track.getBufferedEnd()):i.video&&(u=i.video.track.getBufferedStart(),f=i.video.track.getBufferedEnd());let p=(0,B.yw)(n);return p>=u&&p<=f||(p=Math.abs(p-u)>Math.abs(p-f)?f:u),i.currentTimeNTP=(0,I.A)(),i.currentTime=p,i.seeking=!1,p}return 0}async setPlayRate(t,e){const i=this.tasks.get(t);if(i){if(i.enableJitterBuffer){let t=o.f[15](i.stats+236)?o.f[15](i.stats+32)/o.f[15](i.stats+236)*1e3:o.f[15](i.stats+224)?o.f[15](i.stats+120)/o.f[15](i.stats+224)*1e3:0;t&&t<=o.f[15](i.stats+272)&&(e=1)}i.targetRate=BigInt(Math.floor(Math.floor(100*e))),i.enableJitterBuffer||(i.audio&&i.audio.loop&&i.audio.loop.resetInterval(),i.video&&i.video.loop&&i.video.loop.resetInterval())}}async restart(t){const e=this.tasks.get(t);if(e){e.audio&&this.resetResource(e.audio,e),e.video&&this.resetResource(e.video,e);const t=new((0,N.A)());t.onsourceopen=this.getSourceOpenHandler(e),e.mediaSource=t}}async setCurrentTime(t,e){const i=this.tasks.get(t);i?(i.audio&&i.audio.track.removeBuffer(e),i.video&&o.f[15](i.stats+92)>0&&(i.video.track.setMediaBufferMax(Math.max(i.video.track.getMediaBufferMax(),Math.ceil(o.f[15](i.stats+92)/1e3*1.5),10)),i.video.track.removeBuffer(e)),i.currentTime=e,i.currentTimeNTP=(0,I.A)()):g.h2("task not found",W,1445)}async getMediaSource(t){const e=this.tasks.get(t);if(e)return e.mediaSource.handle?(this.getMediaSource.transfer.push(e.mediaSource.handle),e.mediaSource.handle):e.mediaSource;g.h2("task not found",W,1462)}createTask(t){const e=new m.Ay(t.controlPort),i=new MediaSource||new ManagedMediaSource,r={...t,mediaSource:i,audio:null,video:null,playRate:BigInt(100),targetRate:BigInt(100),pauseTimestamp:0,seeking:!1,pausing:!1,controlIPCPort:e,currentTime:0,currentTimeNTP:0,cacheDuration:BigInt(Math.floor(500)),avpacketPool:new k.A((0,c.A)(t.avpacketList,d.A),t.avpacketListMutex)};return this.tasks.set(t.taskId,r),i.onsourceopen=this.getSourceOpenHandler(r),0}async registerTask(t){return this.tasks.has(t.taskId)?p.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.audio&&(e.audio.loop&&(e.audio.oformatContext.destroy(),e.audio.loop.destroy()),e.audio.pullIPC&&e.audio.pullIPC.destroy(),e.audio.pullQueue.queue.length&&(e.audio.pullQueue.queue.forEach((t=>{e.avpacketPool.release(t)})),e.audio.pullQueue.queue.length=0),e.audio.codecpar&&(0,b.dn)(e.audio.codecpar)),e.video&&(e.video.loop&&(e.video.oformatContext.destroy(),e.video.loop.destroy()),e.video.pullIPC&&e.video.pullIPC.destroy(),e.video.pullQueue.queue.length&&(e.video.pullQueue.queue.forEach((t=>{e.avpacketPool.release(t)})),e.video.pullQueue.queue.length=0),e.video.codecpar&&(0,b.dn)(e.video.codecpar)),e.controlIPCPort&&e.controlIPCPort.destroy(),this.tasks.delete(t))}}},52277:(t,e,i)=>{"use strict";i.d(e,{M:()=>f});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085),h=i(12264),d=i(73783),u=i(30128);class f{constructor(){(0,a.A)(this,"avpacketList",void 0),(0,a.A)(this,"avframeList",void 0),(0,a.A)(this,"avpacketListMutex",void 0),(0,a.A)(this,"avframeListMutex",void 0),(0,a.A)(this,"stats",void 0)}}r=f.prototype,(s=new(o())).set("avpacketList",{0:h.A,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("avframeList",{0:h.A,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("avpacketListMutex",{0:d.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("avframeListMutex",{0:d.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),s.set("stats",{0:u.A,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,8),(0,c.A)(r,l.g7,368),(0,c.A)(r,l.JY,s)},57038:(t,e,i)=>{"use strict";i.d(e,{A:()=>g});var r=i(134),s=i(23873),a=i(77658),n=i(21194),o=i(77334),l=i(8284),c=i(65749),h=i(49963),d=i(78040),u=i(47924),f=i(95335);const p='.ASS-box{font-family:Arial;overflow:hidden;pointer-events:none;position:absolute}.ASS-dialogue{font-size:0;position:absolute;z-index:0}.ASS-dialogue span{display:inline-block}.ASS-dialogue [data-text]{display:inline-block;color:var(--ass-fill-color);font-size:calc(var(--ass-scale)*var(--ass-real-fs)*1px);line-height:calc(var(--ass-scale)*var(--ass-tag-fs)*1px);letter-spacing:calc(var(--ass-scale)*var(--ass-tag-fsp)*1px)}.ASS-dialogue [data-wrap-style="0"],.ASS-dialogue [data-wrap-style="3"]{text-wrap:balance}.ASS-dialogue [data-wrap-style="1"]{word-break:break-word;white-space:normal}.ASS-dialogue [data-wrap-style="2"]{word-break:normal;white-space:nowrap}.ASS-dialogue [data-border-style="1"]{position:relative}.ASS-dialogue [data-border-style="1"]::after,.ASS-dialogue [data-border-style="1"]::before{content:attr(data-text);position:absolute;top:0;left:0;z-index:-1;filter:blur(calc(var(--ass-tag-blur)*1px))}.ASS-dialogue [data-border-style="1"]::before{color:var(--ass-shadow-color);transform:translate(calc(var(--ass-scale-stroke)*var(--ass-tag-xshad)*1px),calc(var(--ass-scale-stroke)*var(--ass-tag-yshad)*1px));-webkit-text-stroke:var(--ass-border-width) var(--ass-shadow-color);text-shadow:var(--ass-shadow-delta);opacity:var(--ass-shadow-opacity)}.ASS-dialogue [data-border-style="1"]::after{color:transparent;-webkit-text-stroke:var(--ass-border-width) var(--ass-border-color);text-shadow:var(--ass-border-delta);opacity:var(--ass-border-opacity)}.ASS-dialogue [data-border-style="3"]{padding:calc(var(--ass-scale-stroke)*var(--ass-tag-xbord)*1px) calc(var(--ass-scale-stroke)*var(--ass-tag-ybord)*1px);position:relative;filter:blur(calc(var(--ass-tag-blur)*1px))}.ASS-dialogue [data-border-style="3"]::after,.ASS-dialogue [data-border-style="3"]::before{content:"";width:100%;height:100%;position:absolute;z-index:-1}.ASS-dialogue [data-border-style="3"]::before{background-color:var(--ass-shadow-color);left:calc(var(--ass-scale-stroke)*var(--ass-tag-xshad)*1px);top:calc(var(--ass-scale-stroke)*var(--ass-tag-yshad)*1px)}.ASS-dialogue [data-border-style="3"]::after{background-color:var(--ass-border-color);left:0;top:0}@container style(--ass-tag-xbord: 0) and style(--ass-tag-ybord: 0){.ASS-dialogue [data-border-style="3"]::after{background-color:transparent}}@container style(--ass-tag-xshad: 0) and style(--ass-tag-yshad: 0){.ASS-dialogue [data-border-style="3"]::before{background-color:transparent}}.ASS-dialogue [data-rotate]{transform:perspective(312.5px) rotateY(calc(var(--ass-tag-fry)*1deg)) rotateX(calc(var(--ass-tag-frx)*1deg)) rotateZ(calc(var(--ass-tag-frz)*-1deg))}.ASS-dialogue [data-text][data-rotate]{transform-style:preserve-3d;word-break:normal;white-space:nowrap}.ASS-dialogue [data-scale],.ASS-dialogue [data-skew]{display:inline-block;transform:scale(var(--ass-tag-fscx),var(--ass-tag-fscy)) skew(calc(var(--ass-tag-fax)*1rad),calc(var(--ass-tag-fay)*1rad));transform-origin:var(--ass-align-h) var(--ass-align-v)}.ASS-fix-font-size{font-size:2048px;font-family:Arial;line-height:normal;width:0;height:0;position:absolute;visibility:hidden;overflow:hidden}.ASS-clip-area,.ASS-fix-font-size span{position:absolute}.ASS-clip-area{width:100%;height:100%;top:0;left:0}.ASS-scroll-area{position:absolute;width:100%;overflow:hidden}',m={Name:"Default",Fontname:"Arial",Fontsize:"16",PrimaryColour:"&Hffffff",SecondaryColour:"&Hffffff",OutlineColour:"&H0",BackColour:"&H0",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"1",Shadow:"0",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"0"};class g{constructor(t,e={container:t.parentNode}){if((0,r.A)(this,"store",void 0),(0,r.A)(this,"resampling_","video_height"),(0,r.A)(this,"resize_",void 0),(0,r.A)(this,"options",void 0),this.options=f.X$({},e),this.store={video:t,box:document.createElement("div"),svg:(0,o.An)("svg"),defs:(0,o.An)("defs"),observer:null,scale:1,width:0,height:0,scriptRes:{width:e.videoWidth||t.clientWidth,height:e.videoHeight||t.clientHeight},layoutRes:{width:e.videoWidth||t.clientWidth,height:e.videoHeight||t.clientHeight},resampledRes:{width:0,height:0},sbas:!0,styles:null,space:[],actives:[],delay:0,index:0,dialogues:[]},null==e.videoWidth&&(t.videoWidth=e.videoWidth),null==e.videoHeight&&(t.videoHeight=e.videoHeight),!e.container)throw new Error("Missing container.");this.resize_=(0,n.By)(this,this.store),this.updateHeader(e.header),e.container.append(a.Y);const{svg:i,defs:s,scriptRes:l,box:c}=this.store;i.setAttributeNS(null,"viewBox",`0 0 ${l.width} ${l.height}`),i.append(s),e.container.append(i),c.className="ASS-box",e.container.append(c),function(t){const e=t.getRootNode()||document;let i=e instanceof Document;!i&&"object"==typeof documentPictureInPicture&&documentPictureInPicture.window&&(i=e===documentPictureInPicture.window.document);const r=i?e.head:e;let s=r.querySelector("#ASS-global-style");s||(s=document.createElement("style"),s.type="text/css",s.id="ASS-global-style",s.append(document.createTextNode(p)),r.append(s)),document.head.querySelector("#ASS-global-style")||(s=document.createElement("style"),s.type="text/css",s.id="ASS-global-style",s.append(document.createTextNode(p)),document.head.append(s))}(e.container),this.resampling_=e.resampling||"video_height";const h=new ResizeObserver(this.resize.bind(this));return h.observe(t),this.store.observer=h,this}framing(t){const e=(0,u.U)(t,this.store);(0,o.MA)(e,"play"),e.__dialogue=t,this.store.actives.push(e)}updateHeader(t){if(t){const{info:e,width:i,height:r,styles:s}=(0,c.wE)(t,{defaultStyle:m});this.store.sbas=/yes/i.test(e.ScaledBorderAndShadow),this.store.layoutRes={width:+e.LayoutResX||this.options.videoWidth||this.store.video.clientWidth,height:+e.LayoutResY||this.options.videoHeight||this.store.video.clientHeight},this.store.scriptRes={width:i||this.store.layoutRes.width,height:r||this.store.layoutRes.height},this.store.styles=s}else this.store.styles=(0,d.W)({info:{WrapStyle:""},style:[],defaultStyle:m}),this.store.scriptRes={width:384,height:288};this.resize_(),this.options.header=t}updateVideoResolution(t,e){if(this.options.header){const{info:i,width:r,height:s}=(0,c.wE)(this.options.header,{defaultStyle:m});this.store.layoutRes={width:+i.LayoutResX||t||this.store.video.clientWidth,height:+i.LayoutResY||e||this.store.video.clientHeight},this.store.scriptRes={width:r||this.store.layoutRes.width,height:s||this.store.layoutRes.height}}else this.store.layoutRes={width:t,height:e}}render(t){if(1===t.type){t.Start=Number(t.Start)/1e3,t.End=Number(t.End)/1e3;const e=(0,h.b)({styles:this.store.styles,dialogues:[t]})[0];f.X$(e,{d:`ASS-${(0,l.A)()}`,align:{h:(e.alignment+2)%3,v:Math.trunc((e.alignment-1)/3)}}),(0,s.w7)(e,this.store),this.framing(e)}}clear(t){const e=Number(BigInt.asIntN(32,t))/1e3;for(let t=this.store.actives.length-1;t>=0;t-=1){const i=this.store.actives[t],{end:r}=i;r<e&&(i.$div.remove(),this.store.actives.splice(t,1))}}clearAll(){for(let t=this.store.actives.length-1;t>=0;t-=1)this.store.actives[t].$div.remove();this.store.actives.length=0,this.store.space.length=0}resize(){const t=this.store.actives.slice();this.resize_();for(let e=0;e<t.length;e++)this.framing(t[e].__dialogue)}destroy(){const{video:t,box:e,svg:i,observer:r}=this.store;return(0,n.IU)(this.store),a.Y.remove(),i.remove(),e.remove(),r.unobserve(t),this.store.styles={},this}show(){return this.store.box.style.visibility="visible",this}hide(){return this.store.box.style.visibility="hidden",this}get resampling(){return this.resampling_}set resampling(t){t!==this.resampling_&&/^(video|script)_(width|height)$/.test(t)&&(this.resampling_=t,this.resize())}}},40031:(t,e,i)=>{"use strict";i.d(e,{A:()=>I});var r=i(134),s=i(80662),a=i.n(s),n=i(12264),o=i(29170),l=i(63939),c=i(9599),h=i(50932),d=i(53616),u=i(84149),f=i(39148),p=i(4624),m=i(57038),g=i(50011),v=i(14686),y=i(51785),A=i(84290),b=i(44328),x=i(77231),w=i(95335),k=i(71517),T="src/avplayer/subtitle/SubtitleRender.ts";const S=[{reg:/<i>/g,value:"{\\i1}"},{reg:/<\/i>/g,value:"{\\i0}"},{reg:/<b>/g,value:"{\\b1}"},{reg:/<\/b>/g,value:"{\\b0}"},{reg:/<u>/g,value:"{\\u1}"},{reg:/<\/u>/g,value:"{\\u0}"},{reg:/{/g,value:"\\{"},{reg:/}/g,value:"\\}"},{reg:/&gt;/g,value:">"},{reg:/&lt;/g,value:"<"},{reg:/&lrm;/g,value:""},{reg:/&rlm;/g,value:""},{reg:/&amp;/g,value:"&"},{reg:/&nbsp;/g,value:"\\h"},{reg:/(<br\s*\/?>)|\n>/g,value:"\\N"}];class I{constructor(t){(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"loop",void 0),(0,r.A)(this,"demuxer2SubtitleRenderChannels",void 0),(0,r.A)(this,"leftPorts",void 0),(0,r.A)(this,"currentPort",void 0),(0,r.A)(this,"render",void 0),(0,r.A)(this,"queue",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"pulling",void 0),(0,r.A)(this,"formats",void 0),(0,r.A)(this,"avpacketPool",void 0),(0,r.A)(this,"delay",void 0),(0,r.A)(this,"enable",void 0),this.options=w.X$({},t),this.ended=!1,this.pulling=!1,this.queue=[],this.delay=BigInt(0),this.demuxer2SubtitleRenderChannels=new(a()),this.leftPorts=new(a()),t.avpacketList&&(this.avpacketPool=new A.A((0,o.A)(t.avpacketList,n.A),t.avpacketListMutex)),this.createDecoder(),this.render=new m.A(this.options.dom,{header:this.getAssHeader(this.options.codecpar),container:this.options.container,videoWidth:this.options.videoWidth,videoHeight:this.options.videoHeight}),this.loop=new f.A((()=>{!this.queue.length&&this.ended&&this.loop.stop(),this.queue.length<6&&!this.ended&&this.pull();const t=this.options.getCurrentTime()-this.delay;for(this.render.clear(t);this.queue.length;){const e=this.queue[0];if(e.Start>t)break;e.End>t&&this.render.render(e),this.queue.shift()}}),0,50,!1)}getAssHeader(t){let e="";if(94230===l.f[15](t+4)&&l.f[15](t+16)){e=g.decode((0,v.s3)(l.f[20](t+12),l.f[15](t+16)).slice());const i=e.split(/\r?\n/);let r=!1;for(let t=0;t<i.length;t++){const e=i[t].trim();"[Events]"===e&&(r=!0),/^Format:/.test(e)&&r&&(this.formats=y.Bp(e.trim()))}}return e}createDecoder(){this.decoder&&this.decoder.close(),this.decoder=new d.A({onReceiveSubtitle:t=>{for(let e=0;e<t.rects.length;e++){const i=t.rects[e];if(3===i.type){const e=y.wj(this.formats,i.text);null==e.Start&&(e.Start=t.pts),null==e.End&&(e.End=t.pts+t.duration),this.queue.push(e)}else 2===i.type?this.queue.push(this.webvtt2AssEvent(i.text,t.pts,t.pts+t.duration)):this.queue.push(this.text2AssEvent(i.text,t.pts,t.pts+t.duration))}}}),this.decoder.open(this.options.codecpar)}text2AssEvent(t,e,i){return{type:1,ReadOrder:0,Layer:0,Start:e,End:i,Style:"Default",Name:"",MarginL:0,MarginR:0,MarginV:0,Text:{raw:t,combined:t,parsed:[{tags:[],text:t,drawing:[]}]}}}webvtt2AssEvent(t,e,i){for(let e=0;e<S.length;e++)t=t.replace(S[e].reg,S[e].value);return this.text2AssEvent(t,e,i)}async pull(){if(this.pulling&&!this.ended)return;this.pulling=!0;const t=this.currentPort,e=await this.leftPorts.get(this.currentPort).request("pull");if(-1048576===e)p.Yz("SubtitleRender end",T,292),this.decoder.flush(),this.ended=!0;else if(e<0)p.Yz(`SubtitleRender pull avpacket error, ret: ${e}`,T,297),this.ended=!0;else if(this.loop&&t===this.currentPort){h.M[17](e+8,(0,b.k)(l.f[17](e+8),(0,o.A)(e+72,c.P),x.i0)),h.M[17](e+48,(0,b.k)(l.f[17](e+48),(0,o.A)(e+72,c.P),x.i0));const t=this.decoder.decode(e);this.avpacketPool?this.avpacketPool.release(e):(0,k.Qe)(e),t<0&&(p.Yz(`SubtitleRender decode avpacket error, ret: ${e}`,T,311),this.ended=!0)}else this.avpacketPool?this.avpacketPool.release(e):(0,k.Qe)(e);this.pulling=!1}getDemuxerPort(t){if(this.demuxer2SubtitleRenderChannels.has(t))return this.demuxer2SubtitleRenderChannels.get(t).port1;const e=new MessageChannel,i=new u.Ay(e.port2);return this.demuxer2SubtitleRenderChannels.set(t,e),this.leftPorts.set(t,i),e.port1}start(){this.loop.isStarted()||this.loop.start(),this.ended=!1}stop(){this.loop.stop(),this.render.clearAll()}pause(){this.loop.stop()}reset(){this.queue.length=0,this.render.clearAll()}reopenDecoder(t){this.options.codecpar=t,this.createDecoder(),this.render.updateHeader(this.getAssHeader(t))}updateVideoResolution(t,e){t===this.options.videoWidth&&e===this.options.videoHeight||(this.render.updateVideoResolution(t,e),this.options.videoWidth=t,this.options.videoHeight=e)}setDemuxTask(t){this.currentPort!==t&&(this.pulling=!1),this.currentPort=t}destroy(){this.loop.destroy(),this.loop=null,this.leftPorts.clear(),this.demuxer2SubtitleRenderChannels.clear(),this.queue.length=0,this.render.destroy(),this.render=null,this.decoder.close(),this.decoder=null}setDelay(t){this.delay=t}getDelay(){return this.delay}}},27089:(t,e,i)=>{"use strict";i.d(e,{A:()=>x});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(74503),l=i(94300),c=i(67672),h=i(52277),d=i(4624),u=i(18667),f=i(59377),p=i(56024),m=i(71517),g=i(73783),v=i(84149),y=i(54058),A=i(95335),b="src/avplayer/worker/AudioPipeline.ts";class x{constructor(){(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"render",void 0),(0,r.A)(this,"globalDataMap",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"timer",void 0),this.decoder=new u.A,this.render=new f.A,this.globalDataMap=new(a())}createGlobalData(t){const e=(0,o.A)(h.M);return g.Ts(e[n.o9]+24),g.Ts(e[n.o9]+28),this.globalDataMap.set(t,e),e}releaseGlobalData(t){t.avframeList.clear((t=>{(0,p.to)(t)}),20),t.avpacketList.clear((t=>{(0,m.Up)(t)}),20),g.zr(t[n.o9]+24),g.zr(t[n.o9]+28),(0,l.A)(t)}async init(t){this.controlPort=new v.Ay(t);let e=0;this.timer=new y.A((()=>{e++;const t=[];this.globalDataMap.forEach(((i,r)=>{const s=i.stats;t.push({taskId:r,stats:{audioFrameDecodeCount:s.audioFrameDecodeCount,audioFrameDecodeIntervalMax:s.audioFrameDecodeIntervalMax,audioDecodeErrorPacketCount:s.audioDecodeErrorPacketCount,audioFrameRenderCount:s.audioFrameRenderCount,audioFrameRenderIntervalMax:s.audioFrameRenderIntervalMax,sampleRate:s.sampleRate,channels:s.channels,audioFrameSize:s.audioFrameSize,audioCurrentTime:s.audioCurrentTime}}),2===e&&(s.audioFrameDecodeIntervalMax=0,s.audioFrameRenderIntervalMax=0)})),this.controlPort.notify("stats",{data:t}),2===e&&(e=0)}),0,500),this.controlPort.on(v.Wo,(t=>{if("stats"===t.method){const e=t.params.data;for(let t=0;t<e.length;t++){const i=this.globalDataMap.get(e[t].taskId).stats;i&&(A.__(e[t].stats,((t,e)=>{i[e]=t})),i.jitterBuffer.min=e[t].jitterBuffer.min,i.jitterBuffer.max=e[t].jitterBuffer.max)}}})),this.timer.start()}async invoke(t,e,i){const r=this;function s(t,e,i){if("unregisterTask"===t){const t=r.globalDataMap.get(e[0]);t&&(r.releaseGlobalData(t),r.globalDataMap.delete(e[0]))}else if("clear"===t)r.globalDataMap.forEach((t=>{r.releaseGlobalData(t)})),r.globalDataMap.clear();else if("syncSeekTime"===t){const t=r.globalDataMap.get(e[0]);if(t)return t.stats.audioCurrentTime}return i}if("decoder"===t){if("registerTask"===e){const t=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=t[n.o9]+32,i[0].avpacketList=t[n.o9],i[0].avpacketListMutex=t[n.o9]+24,i[0].avframeList=t[n.o9]+12,i[0].avframeListMutex=t[n.o9]+28}if(c.Pc(this.decoder[e]))return this.decoder[e](...i).then((t=>s(e,i,t)));d.h2(`method ${e} not found`,b,179)}else{if("registerTask"===e){const t=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=t[n.o9]+32,i[0].avframeList=t[n.o9]+12,i[0].avframeListMutex=t[n.o9]+28}if(c.Pc(this.render[e]))return this.render[e](...i).then((t=>s(e,i,t)));d.h2(`method ${e} not found`,b,197)}}async setLogLevel(t){d.V$(t)}}},40097:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var r=i(134),s=i(80662),a=i.n(s),n=i(30128),o=i(29170),l=i(88506),c=i(27089),h=i(84149),d=i(95335);class u{constructor(){(0,r.A)(this,"thread",void 0),(0,r.A)(this,"controlMessageChannel",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"statsMap",void 0),this.statsMap=new(a())}async run(){this.thread=await(0,l.pt)(c.A,{name:"AudioPipeline",dispatchToWorker:!0},27089).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new h.Ay(this.controlMessageChannel.port1),this.controlPort.on(h.Wo,(t=>{if("stats"===t.method){const e=t.params.data,i=[];for(let t=0;t<e.length;t++){const r=this.statsMap.get(e[t].taskId);r&&(d.__(e[t].stats,((t,e)=>{r[e]=t})),i.push({taskId:e[t].taskId,stats:{audioPacketQueueLength:r.audioPacketQueueLength,audioEncodeFramerate:r.audioEncodeFramerate,videoPacketQueueLength:r.videoPacketQueueLength},jitterBuffer:{min:r.jitterBuffer.min,max:r.jitterBuffer.max}}))}this.controlPort.notify("stats",{data:{stats:i}})}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}async destroy(){await(0,l.nx)(this.thread),this.thread=null}setLogLevel(t){this.thread.setLogLevel(t)}transformResult(t,e,i){if("unregisterTask"===t)this.statsMap.delete(e[0]);else if("clear"===t)this.statsMap.clear();else if("registerTask"===t)this.statsMap.set(e[0].taskId,(0,o.A)(e[0].stats,n.A));else if("syncSeekTime"===t){const t=this.statsMap.get(e[0]);if(t)return void(t.audioCurrentTime=i)}return i}get AudioDecodePipeline(){const t=this;return new Proxy({},{get(e,i,r){if(e[i])return e[i];const s=async function(...e){return t.thread.invoke("decoder",i,e).then((r=>t.transformResult(i,e,r)))};return s.transfer=function(...e){return{invoke:async function(...r){return t.thread.invoke.transfer(...e).invoke("decoder",i,r).then((e=>t.transformResult(i,r,e)))}}},e[i]=s,e[i]}})}get AudioRenderPipeline(){const t=this;return new Proxy({},{get(e,i,r){if(e[i])return e[i];const s=async function(...e){return t.thread.invoke("render",i,e).then((r=>t.transformResult(i,e,r)))};return s.transfer=function(...e){return{invoke:async function(...r){return t.thread.invoke.transfer(...e).invoke("render",i,r).then((e=>t.transformResult(i,r,e)))}}},e[i]=s,e[i]}})}}},59016:(t,e,i)=>{"use strict";i.d(e,{A:()=>x});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(74503),l=i(94300),c=i(87243),h=i(72480),d=i(67672),u=i(52277),f=i(4624),p=i(71762),m=i(56024),g=i(71517),v=i(73783),y=i(84149),A=i(54058),b="src/avplayer/worker/IODemuxPipeline.ts";class x{constructor(){(0,r.A)(this,"ioThread",void 0),(0,r.A)(this,"demuxPipeline",void 0),(0,r.A)(this,"globalDataMap",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"timer",void 0),this.ioThread=new c.A,this.demuxPipeline=new h.A,this.globalDataMap=new(a())}createGlobalData(t){const e=(0,o.A)(u.M);return v.Ts(e[n.o9]+24),v.Ts(e[n.o9]+28),this.globalDataMap.set(t,e),e}releaseGlobalData(t){t.avframeList.clear((t=>{(0,m.to)(t)}),20),t.avpacketList.clear((t=>{(0,g.Up)(t)}),20),v.zr(t[n.o9]+24),v.zr(t[n.o9]+28),(0,l.A)(t)}async init(t){this.controlPort=new y.Ay(t),this.timer=new A.A((()=>{const t=[];this.globalDataMap.forEach(((e,i)=>{const r=e.stats;t.push({taskId:i,stats:{bufferReceiveBytes:r.bufferReceiveBytes,audioPacketQueueLength:r.audioPacketQueueLength,videoPacketQueueLength:r.videoPacketQueueLength,audioPacketCount:r.audioPacketCount,audioPacketBytes:r.audioPacketBytes,audioEncodeFramerate:r.audioEncodeFramerate,videoPacketCount:r.videoPacketCount,videoPacketBytes:r.videoPacketBytes,keyFrameCount:r.keyFrameCount,gop:r.gop,keyFrameInterval:r.keyFrameInterval,videoEncodeFramerate:r.videoEncodeFramerate}})})),this.controlPort.notify("stats",{data:t})}),0,500),this.timer.start()}async invoke(t,e,i){const r=this;function s(t,e,i){if("unregisterTask"===t){const t=r.globalDataMap.get(e[0]);t&&(r.releaseGlobalData(t),r.globalDataMap.delete(e[0]))}else"clear"===t?(r.globalDataMap.forEach((t=>{r.releaseGlobalData(t)})),r.globalDataMap.clear()):"analyzeStreams"!==t||d.ai(i)||i.streams.forEach((t=>{t.codecpar=(0,p.Wu)(t.codecpar)}))}if("io"===t){if("registerTask"===e){const t=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=t[n.o9]+32}if(d.Pc(this.ioThread[e]))return this.ioThread[e](...i).then((t=>(s(e,i,t),t)));f.h2(`method ${e} not found`,b,150)}else{if("registerTask"===e){const t=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=t[n.o9]+32,i[0].avpacketList=t[n.o9],i[0].avpacketListMutex=t[n.o9]+24}if(d.Pc(this.demuxPipeline[e]))return this.demuxPipeline[e](...i).then((t=>(s(e,i,t),t)));f.h2(`method ${e} not found`,b,168)}}async setLogLevel(t){f.V$(t)}}},29998:(t,e,i)=>{"use strict";i.d(e,{A:()=>g});var r=i(134),s=i(80662),a=i.n(s),n=i(30128),o=i(29170),l=i(88506),c=i(59016),h=i(71762),d=i(67672),u=i(72703),f=i(71766),p=i(84149),m=i(95335);class g{constructor(){(0,r.A)(this,"thread",void 0),(0,r.A)(this,"codecparMap",void 0),(0,r.A)(this,"controlMessageChannel",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"statsMap",void 0),this.codecparMap=new(a()),this.statsMap=new(a())}async run(){this.thread=await(0,l.pt)(c.A,{name:"IODemuxPipeline",dispatchToWorker:!0},59016).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new p.Ay(this.controlMessageChannel.port1),this.controlPort.on(p.Wo,(t=>{if("stats"===t.method){const e=t.params.data;for(let t=0;t<e.length;t++){const i=this.statsMap.get(e[t].taskId);i&&m.__(e[t].stats,((t,e)=>{i[e]=t}))}}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}setLogLevel(t){this.thread.setLogLevel(t)}async destroy(){await(0,l.nx)(this.thread),this.thread=null}get IOPipeline(){const t=this;return new Proxy({},{get(e,i,r){if(e[i])return e[i];const s=async function(...e){return t.thread.invoke("io",i,e)};return s.transfer=function(...e){return{invoke:async function(...r){return t.thread.invoke.transfer(...e).invoke("io",i,r)}}},e[i]=s,e[i]}})}get DemuxPipeline(){const t=this;function e(e,i,r){if("analyzeStreams"!==e||d.ai(r))if("unregisterTask"===e){const e=t.codecparMap.get(i[0]);e&&(e.forEach((t=>{(0,f.dn)(t)})),t.codecparMap.delete(i[0])),t.statsMap.delete(i[0])}else"clear"===e?(t.codecparMap.forEach((t=>{t.forEach((t=>{(0,f.dn)(t)}))})),t.codecparMap.clear(),t.statsMap.clear()):"registerTask"===e&&t.statsMap.set(i[0].taskId,(0,o.A)(i[0].stats,n.A));else{const e=[];r.streams.forEach((r=>{(0,u.A)(r.codecpar)||(r.codecpar=(0,h.T8)(r.codecpar),e.push(r.codecpar)),t.codecparMap.set(i[0],e)}))}}return new Proxy({},{get(i,r,s){if(i[r])return i[r];const a=async function(...i){return t.thread.invoke("demux",r,i).then((t=>(e(r,i,t),t)))};return a.transfer=function(...i){return{invoke:async function(...s){return t.thread.invoke.transfer(...i).invoke("demux",r,s).then((t=>(e(r,s,t),t)))}}},i[r]=a,i[r]}})}}},75392:(t,e,i)=>{"use strict";i.d(e,{A:()=>A});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(74503),l=i(94300),c=i(67672),h=i(52277),d=i(4624),u=i(56024),f=i(71517),p=i(73783),m=i(84149),g=i(54058),v=i(95335),y=i(25115);class A{constructor(){(0,r.A)(this,"mse",void 0),(0,r.A)(this,"globalDataMap",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"timer",void 0),this.mse=new y.A,this.globalDataMap=new(a())}createGlobalData(t){const e=(0,o.A)(h.M);return p.Ts(e[n.o9]+24),p.Ts(e[n.o9]+28),this.globalDataMap.set(t,e),e}releaseGlobalData(t){t.avframeList.clear((t=>{(0,u.to)(t)}),20),t.avpacketList.clear((t=>{(0,f.Up)(t)}),20),p.zr(t[n.o9]+24),p.zr(t[n.o9]+28),(0,l.A)(t)}async init(t){this.controlPort=new m.Ay(t),this.timer=new g.A((()=>{const t=[];this.globalDataMap.forEach(((e,i)=>{const r=e.stats;t.push({taskId:i,stats:{audioFrameDecodeCount:r.audioFrameDecodeCount,audioFrameRenderCount:r.audioFrameRenderCount,sampleRate:r.sampleRate,channels:r.channels,videoFrameDecodeCount:r.videoFrameDecodeCount,videoFrameRenderCount:r.videoFrameRenderCount,width:r.width,height:r.height}})})),this.controlPort.notify("stats",{data:t})}),0,500),this.controlPort.on(m.Wo,(t=>{if("stats"===t.method){const e=t.params.data;for(let t=0;t<e.length;t++){const i=this.globalDataMap.get(e[t].taskId).stats;i&&(v.__(e[t].stats,((t,e)=>{i[e]=t})),i.jitterBuffer.min=e[t].jitterBuffer.min,i.jitterBuffer.max=e[t].jitterBuffer.max)}}})),this.timer.start()}async invoke(t,e){const i=this;if("registerTask"===t){const t=this.globalDataMap.get(e[0].taskId)||this.createGlobalData(e[0].taskId);e[0].stats=t[n.o9]+32,e[0].avpacketList=t[n.o9],e[0].avpacketListMutex=t[n.o9]+24}if(c.Pc(this.mse[t]))return this.mse[t].transfer||(this.mse[t].transfer=[]),this.mse[t](...e).then((r=>(this.mse[t].transfer.length&&(this.invoke.transfer=this.mse[t].transfer),r=function(t,e,r){if("unregisterTask"===t){const t=i.globalDataMap.get(e[0]);t&&(i.releaseGlobalData(t),i.globalDataMap.delete(e[0]))}else"clear"===t&&(i.globalDataMap.forEach((t=>{i.releaseGlobalData(t)})),i.globalDataMap.clear());return r}(t,e,r),r)));d.h2(`method ${t} not found`,"src/avplayer/worker/MSEPipeline.ts",162)}async setLogLevel(t){d.V$(t)}}},21862:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var r=i(134),s=i(80662),a=i.n(s),n=i(30128),o=i(29170),l=i(88506),c=i(84149),h=i(95335),d=i(75392);class u{constructor(){(0,r.A)(this,"thread",void 0),(0,r.A)(this,"controlMessageChannel",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"statsMap",void 0),this.statsMap=new(a())}async run(){this.thread=await(0,l.pt)(d.A,{name:"MSEPipeline",dispatchToWorker:!0},75392).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new c.Ay(this.controlMessageChannel.port1),this.controlPort.on(c.Wo,(t=>{if("stats"===t.method){const e=t.params.data,i=[];for(let t=0;t<e.length;t++){const r=this.statsMap.get(e[t].taskId);r&&(h.__(e[t].stats,((t,e)=>{r[e]=t})),i.push({taskId:e[t].taskId,stats:{videoEncodeFramerate:r.videoEncodeFramerate,videoPacketQueueLength:r.videoPacketQueueLength,audioPacketQueueLength:r.audioPacketQueueLength,audioEncodeFramerate:r.audioEncodeFramerate},jitterBuffer:{min:r.jitterBuffer.min,max:r.jitterBuffer.max}}))}this.controlPort.notify("stats",{data:{stats:i}})}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}setLogLevel(t){this.thread.setLogLevel(t)}async destroy(){await(0,l.nx)(this.thread),this.thread=null}transformResult(t,e,i){return"unregisterTask"===t?this.statsMap.delete(e[0]):"clear"===t?this.statsMap.clear():"registerTask"===t&&this.statsMap.set(e[0].taskId,(0,o.A)(e[0].stats,n.A)),i}get MSEPipeline(){const t=this;return new Proxy({},{get(e,i,r){if(e[i])return e[i];const s=async function(...e){return t.thread.invoke(i,e).then((r=>t.transformResult(i,e,r)))};return s.transfer=function(...e){return{invoke:async function(...r){return t.thread.invoke.transfer(...e).invoke(i,r).then((e=>t.transformResult(i,r,e)))}}},e[i]=s,e[i]}})}}},71272:(t,e,i)=>{"use strict";i.d(e,{A:()=>x});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(74503),l=i(94300),c=i(67672),h=i(52277),d=i(4624),u=i(31138),f=i(33968),p=i(56024),m=i(71517),g=i(73783),v=i(84149),y=i(54058),A=i(95335),b="src/avplayer/worker/VideoPipeline.ts";class x{constructor(){(0,r.A)(this,"decoder",void 0),(0,r.A)(this,"render",void 0),(0,r.A)(this,"globalDataMap",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"timer",void 0),this.decoder=new u.A,this.render=new f.A,this.globalDataMap=new(a())}createGlobalData(t){const e=(0,o.A)(h.M);return g.Ts(e[n.o9]+24),g.Ts(e[n.o9]+28),this.globalDataMap.set(t,e),e}releaseGlobalData(t){t.avframeList.clear((t=>{(0,p.to)(t)}),20),t.avpacketList.clear((t=>{(0,m.Up)(t)}),20),g.zr(t[n.o9]+24),g.zr(t[n.o9]+28),(0,l.A)(t)}async init(t){this.controlPort=new v.Ay(t);let e=0;this.timer=new y.A((()=>{e++;const t=[];this.globalDataMap.forEach(((i,r)=>{const s=i.stats;t.push({taskId:r,stats:{videoFrameDecodeCount:s.videoFrameDecodeCount,videoFrameDecodeIntervalMax:s.videoFrameDecodeIntervalMax,videoDecodeErrorPacketCount:s.videoDecodeErrorPacketCount,videoCurrentTime:s.videoCurrentTime,videoFrameRenderCount:s.videoFrameRenderCount,videoFrameRenderIntervalMax:s.videoFrameRenderIntervalMax,videoFrameDropCount:s.videoFrameDropCount,width:s.width,height:s.height}}),2===e&&(s.videoFrameDecodeIntervalMax=0,s.videoFrameRenderIntervalMax=0)})),this.controlPort.notify("stats",{data:t}),2===e&&(e=0)}),0,500),this.controlPort.on(v.Wo,(t=>{if("stats"===t.method){const e=t.params.data;for(let t=0;t<e.length;t++){const i=this.globalDataMap.get(e[t].taskId).stats;i&&(A.__(e[t].stats,((t,e)=>{i[e]=t})),i.jitterBuffer.min=e[t].jitterBuffer.min,i.jitterBuffer.max=e[t].jitterBuffer.max)}}})),this.timer.start()}async invoke(t,e,i){const r=this;function s(t,e,i){if("unregisterTask"===t){const t=r.globalDataMap.get(e[0]);t&&(r.releaseGlobalData(t),r.globalDataMap.delete(e[0]))}else if("clear"===t)r.globalDataMap.forEach((t=>{r.releaseGlobalData(t)})),r.globalDataMap.clear();else if("syncSeekTime"===t){const t=r.globalDataMap.get(e[0]);if(t)return t.stats.videoCurrentTime}return i}if("decoder"===t){if("registerTask"===e){const t=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=t[n.o9]+32,i[0].avpacketList=t[n.o9],i[0].avpacketListMutex=t[n.o9]+24,i[0].avframeList=t[n.o9]+12,i[0].avframeListMutex=t[n.o9]+28}if(c.Pc(this.decoder[e]))return this.decoder[e](...i).then((t=>s(e,i,t)));d.h2(`method ${e} not found`,b,179)}else{if("registerTask"===e){const t=this.globalDataMap.get(i[0].taskId)||this.createGlobalData(i[0].taskId);i[0].stats=t[n.o9]+32,i[0].avframeList=t[n.o9]+12,i[0].avframeListMutex=t[n.o9]+28}if(c.Pc(this.render[e]))return this.render[e](...i).then((t=>s(e,i,t)));d.h2(`method ${e} not found`,b,197)}}async setLogLevel(t){d.V$(t)}}},21678:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var r=i(134),s=i(80662),a=i.n(s),n=i(30128),o=i(29170),l=i(88506),c=i(71272),h=i(84149),d=i(95335);class u{constructor(){(0,r.A)(this,"thread",void 0),(0,r.A)(this,"controlMessageChannel",void 0),(0,r.A)(this,"controlPort",void 0),(0,r.A)(this,"statsMap",void 0),this.statsMap=new(a())}async run(){this.thread=await(0,l.pt)(c.A,{name:"VideoPipeline",dispatchToWorker:!0},71272).run(),this.controlMessageChannel=new MessageChannel,this.controlPort=new h.Ay(this.controlMessageChannel.port1),this.controlPort.on(h.Wo,(t=>{if("stats"===t.method){const e=t.params.data,i=[];for(let t=0;t<e.length;t++){const r=this.statsMap.get(e[t].taskId);r&&(d.__(e[t].stats,((t,e)=>{r[e]=t})),i.push({taskId:e[t].taskId,stats:{videoEncodeFramerate:r.videoEncodeFramerate,videoPacketQueueLength:r.videoPacketQueueLength},jitterBuffer:{min:r.jitterBuffer.min,max:r.jitterBuffer.max}}))}this.controlPort.notify("stats",{data:{stats:i}})}})),await this.thread.init.transfer(this.controlMessageChannel.port2).invoke(this.controlMessageChannel.port2)}setLogLevel(t){this.thread.setLogLevel(t)}async destroy(){await(0,l.nx)(this.thread),this.thread=null}transformResult(t,e,i){if("unregisterTask"===t)this.statsMap.delete(e[0]);else if("clear"===t)this.statsMap.clear();else if("registerTask"===t)this.statsMap.set(e[0].taskId,(0,o.A)(e[0].stats,n.A));else if("syncSeekTime"===t){const t=this.statsMap.get(e[0]);if(t)return void(t.videoCurrentTime=i)}return i}get VideoDecodePipeline(){const t=this;return new Proxy({},{get(e,i,r){if(e[i])return e[i];const s=async function(...e){return t.thread.invoke("decoder",i,e).then((r=>t.transformResult(i,e,r)))};return s.transfer=function(...e){return{invoke:async function(...r){return t.thread.invoke.transfer(...e).invoke("decoder",i,r).then((e=>t.transformResult(i,r,e)))}}},e[i]=s,e[i]}})}get VideoRenderPipeline(){const t=this;return new Proxy({},{get(e,i,r){if(e[i])return e[i];const s=async function(...e){return t.thread.invoke("render",i,e).then((r=>t.transformResult(i,e,r)))};return s.transfer=function(...e){return{invoke:async function(...r){return t.thread.invoke.transfer(...e).invoke("render",i,r).then((e=>t.transformResult(i,r,e)))}}},e[i]=s,e[i]}})}}},78417:(t,e,i)=>{"use strict";i.d(e,{A:()=>p});var r=i(88032),s=i.n(r),a=i(29967),n=i.n(a),o=i(79331),l=i(67672),c=i(62100),h=i(86932);function d(t){let e=0,i=0,r=0;return(t=t.slice(t.indexOf("PT")+2)).indexOf("H")>-1&&t.indexOf("M")>-1&&t.indexOf("S")>-1?(e=s()(t.slice(0,t.indexOf("H"))),i=s()(t.slice(t.indexOf("H")+1,t.indexOf("M"))),r=s()(t.slice(t.indexOf("M")+1,t.indexOf("S")))):t.indexOf("H")<0&&t.indexOf("M")>0&&t.indexOf("S")>-1?(i=s()(t.slice(0,t.indexOf("M"))),r=s()(t.slice(t.indexOf("M")+1,t.indexOf("S")))):t.indexOf("H")<0&&t.indexOf("M")<0&&t.indexOf("S")>-1&&(r=s()(t.slice(0,t.indexOf("S")))),3600*e+60*i+r}function u(t,e){return(Array(e).join("0")+t).slice(-e)}function f(t){if(!t)return 0;if(t.indexOf("/")>-1){const e=t.split("/");return s()(e[0])/s()(e[1])}return s()(t)}function p(t,e){const i={source:t,mediaList:{audio:[],video:[],subtitle:[]},type:"live",isEnd:!1,duration:0,minBufferTime:0,maxSegmentDuration:0,minimumUpdatePeriod:0,timestamp:(0,h.A)()},r=[],a=(p=t,p?(0,o.A)(p):null).MPD;var p;"static"===a.type&&(i.type="vod",i.isEnd=!0),a.minBufferTime&&(i.minBufferTime=d(a.minBufferTime)),a.maxSegmentDuration&&(i.maxSegmentDuration=d(a.maxSegmentDuration)),a.minimumUpdatePeriod&&(i.minimumUpdatePeriod=d(a.minimumUpdatePeriod)),a.mediaPresentationDuration&&(i.duration=d(a.mediaPresentationDuration));let m="";a.BaseURL&&(m=a.BaseURL);const g=l.YO(a.Period)?a.Period[0]:a.Period;return!i.duration&&g&&g.duration&&(i.duration=d(g.duration)),(l.YO(g.AdaptationSet)?g.AdaptationSet:[g.AdaptationSet]).forEach(((t,a)=>{let o="video/mp4",h="avc1.64001E",d=640,p=360,g=640,v=360,y=25,A="1:1",b="1",x=588633,w=m,k="und";t.BaseURL&&(w+=t.BaseURL),t.lang&&(k=t.lang),t.mimeType?(o=t.mimeType,"video/mp4"===o?(h=t.codecs,d=s()(t.width),p=s()(t.height),t.maxWidth&&(g=s()(t.maxWidth)),t.maxHeight&&(v=s()(t.maxHeight)),t.frameRate&&(y=f(t.frameRate)),A=t.sar,b=t.startWithSAP,x=s()(t.bandwidth)):"audio/mp4"===o&&(h=t.codecs,b=t.startWithSAP,x=s()(t.bandwidth))):(t.maxWidth&&(g=s()(t.maxWidth)),t.maxHeight&&(v=s()(t.maxHeight)),t.frameRate&&(y=f(t.frameRate))),(l.YO(t.Representation)?t.Representation:[t.Representation]).forEach(((a,f)=>{r.indexOf(a.id)>-1&&(a.id=(n()(r[r.length-1])+1).toString()),r.push(a.id);let m="";const T=[];let S=0,I=0,P=e.slice(0,e.lastIndexOf("/")+1)+w;a.mimeType&&(o=a.mimeType),"video/mp4"===o?(a.codecs&&(h=a.codecs),a.width&&(d=s()(a.width)),a.height&&(p=s()(a.height)),a.maxWidth&&(g=s()(a.maxWidth)),a.maxHeight&&(v=s()(a.maxHeight)),a.frameRate&&(y=s()(a.frameRate)),a.sar&&(A=a.sar),a.startWithSAP&&(b=a.startWithSAP),a.bandwidth&&(x=s()(a.bandwidth))):(a.codecs&&(h=a.codecs),a.startWithSAP&&(b=a.startWithSAP),a.bandwidth&&(x=s()(a.bandwidth))),a.BaseURL&&(P+=a.BaseURL);let _=!1;if((t.ContentProtection||a.ContentProtection)&&(_=!0),a.SegmentBase)"video/mp4"===o?i.mediaList.video.push({id:a.id,file:P,mimeType:o,codecs:h,width:d,height:p,maxWidth:g,maxHeight:v,frameRate:y,sar:A,startWithSAP:"1"===b,bandwidth:x,timescale:S,duration:I,encrypted:_}):"audio/mp4"===o?i.mediaList.audio.push({id:a.id,file:P,mimeType:o,codecs:h,startWithSAP:"1"===b,bandwidth:x,timescale:S,duration:I,encrypted:_,lang:k}):"application/mp4"===o&&i.mediaList.subtitle.push({id:a.id,file:P,mimeType:o,codecs:h,startWithSAP:"1"===b,bandwidth:x,timescale:S,duration:I,encrypted:_,lang:k});else{let e;if(t.SegmentTemplate&&(e=l.YO(t.SegmentTemplate)?t.SegmentTemplate[0]:t.SegmentTemplate),a.SegmentTemplate&&(e=l.YO(a.SegmentTemplate)?a.SegmentTemplate[0]:a.SegmentTemplate),e){const t=n()(e.startNumber);if(m=e.initialization,S=s()(e.timescale||"1"),e.duration&&!e.SegmentTimeline){I=s()(e.duration);let r=I/S;const n=t+Math.ceil((i.duration||r)/r)-1;for(let s=t;s<=n;s++){const o=r*(s-t);let l=r*(s-t+1);s===n&&(r=i.duration-r*(n-t),l=i.duration),T.push({idx:s,start:o,end:l,url:P+e.media.replace(/\$RepresentationID\$/g,a.id).replace(/\$Number(%(\d+)d)?\$/g,((t,e,i)=>i?u(s,+i):(0,c.A)(s))),segmentDuration:r})}}else if(e.SegmentTimeline&&e.SegmentTimeline.S){const i=l.YO(e.SegmentTimeline.S)?e.SegmentTimeline.S:[e.SegmentTimeline.S];let r=0,o=t;for(let t=0;t<i.length;t++){let l=s()(i[t].d);i[t].t&&(r=s()(i[0].t));let h=1;i[t].r&&(h=n()(i[t].r)+1);for(let t=0;t<h;t++)T.push({idx:o,start:r/S,end:(r+l)/S,url:P+e.media.replace(/\$RepresentationID\$/g,a.id).replace(/\$Number(%(\d+)d)?\$/g,((t,e,i)=>i?u(o,+i):(0,c.A)(o))).replace(/\$Time\$/g,(0,c.A)(r)),segmentDuration:l/S}),o++,r+=l}}}else if(a.SegmentList){const t=l.YO(a.SegmentList.SegmentURL)?a.SegmentList.SegmentURL:[a.SegmentList.SegmentURL];let e=0,i=s()(a.SegmentList.duration);for(let r=0;r<t.length;r++)T.push({idx:r,start:e/S,end:(e+i)/S,url:P+t[r].media,segmentDuration:i/S}),e+=i}"video/mp4"===o?i.mediaList.video.push({id:a.id,baseURL:P,initSegment:P+m.replace(/\$RepresentationID\$/g,a.id).replace(/\$Bandwidth\$/g,(0,c.A)(x)),mediaSegments:T,mimeType:o,codecs:h,width:d,height:p,maxWidth:g,maxHeight:v,frameRate:y,sar:A,startWithSAP:"1"===b,bandwidth:x,timescale:S,duration:I,encrypted:_}):"audio/mp4"===o?i.mediaList.audio.push({id:a.id,baseURL:P,initSegment:P+m.replace(/\$RepresentationID\$/g,a.id).replace(/\$Bandwidth\$/g,(0,c.A)(x)),mediaSegments:T,mimeType:o,codecs:h,startWithSAP:"1"===b,bandwidth:x,timescale:S,duration:I,encrypted:_,lang:k}):"application/mp4"===o&&i.mediaList.subtitle.push({id:a.id,baseURL:P,initSegment:P+m.replace(/\$RepresentationID\$/g,a.id).replace(/\$Bandwidth\$/g,(0,c.A)(x)),mediaSegments:T,mimeType:o,codecs:h,startWithSAP:"1"===b,bandwidth:x,timescale:S,duration:I,encrypted:_,lang:k})}}))})),["video","audio"].forEach((t=>{i.mediaList[t].sort(((t,e)=>t.bandwidth-e.bandwidth))})),i}},48182:(t,e,i)=>{"use strict";i.d(e,{A:()=>M});var r=i(7210),s=i.n(r),a=i(43929),n=i.n(a),o=i(69736),l=i.n(o),c=i(80662),h=i.n(c),d=i(67756),u=i(64608),f=i(4624),p="src/avprotocol/m3u8/parser.ts";function m(t){return d.Bq(t,'"')}function g(t){const e=d.gI(t,",");return{duration:d.Ro(e[0]),title:decodeURIComponent(escape(e[1]))}}function v(t){const e=d.gI(t,"@");return{length:d.Ro(e[0]),offset:e[1]?d.Ro(e[1]):-1}}function y(t){const e=d.gI(t,"x");return{width:d.Ro(e[0]),height:d.Ro(e[1])}}function A(t){const e="ALLOWED-CPC: Each entry must consit of KEYFORMAT and Content Protection Configuration",i=t.split(",");0===i.length&&f.z3(e,p,102);const r=[];for(const t of i){const[i,s]=d.gI(t,":");i&&s?r.push({format:i,cpcList:s.split("/")}):f.z3(e,p,108)}return r}function b(t){const e=d.m2(t);return 16!==e.length&&f.z3("IV must be a 128-bit unsigned integer",p,119),e}function x(t,e){e.IV&&t.compatibleVersion<2&&(t.compatibleVersion=2),(e.KEYFORMAT||e.KEYFORMATVERSIONS)&&t.compatibleVersion<5&&(t.compatibleVersion=5)}function w(t){const e={};for(const r of d.HG(t)){const[t,s]=d.gI(r,"="),a=m(s);switch(t){case"URI":e[t]=a;break;case"START-DATE":case"END-DATE":e[t]=new Date(a);break;case"IV":e[t]=b(a);break;case"BYTERANGE":e[t]=v(a);break;case"RESOLUTION":e[t]=y(a);break;case"ALLOWED-CPC":e[t]=A(a);break;case"END-ON-NEXT":case"DEFAULT":case"AUTOSELECT":case"FORCED":case"PRECISE":case"CAN-BLOCK-RELOAD":case"INDEPENDENT":case"GAP":e[t]="YES"===a;break;case"DURATION":case"PLANNED-DURATION":case"BANDWIDTH":case"AVERAGE-BANDWIDTH":case"FRAME-RATE":case"TIME-OFFSET":case"CAN-SKIP-UNTIL":case"HOLD-BACK":case"PART-HOLD-BACK":case"PART-TARGET":case"BYTERANGE-START":case"BYTERANGE-LENGTH":case"LAST-MSN":case"LAST-PART":case"SKIPPED-SEGMENTS":case"SCORE":case"PROGRAM-ID":e[t]=d.Ro(a);break;default:t.startsWith("SCTE35-")?e[t]=d.m2(a):t.startsWith("X-")?e[t]=(i=s).startsWith('"')?m(i):i.startsWith("0x")||i.startsWith("0X")?d.m2(i):d.Ro(i):("VIDEO-RANGE"===t&&"SDR"!==a&&"HLG"!==a&&"PQ"!==a&&f.h2(`VIDEO-RANGE: unknown value "${a}"`,p,206),e[t]=a)}}var i;return e}function k(t,e,i){const r=function({attributes:t}){return new u.ru({type:t.TYPE,uri:t.URI,groupId:t["GROUP-ID"],language:t.LANGUAGE,assocLanguage:t["ASSOC-LANGUAGE"],name:t.NAME,isDefault:t.DEFAULT,autoselect:t.AUTOSELECT,forced:t.FORCED,instreamId:t["INSTREAM-ID"],characteristics:t.CHARACTERISTICS,channels:t.CHANNELS})}(e),s=t[d.Th(i)],a=function(t,e){let i=!1;for(const r of t){if(r.name===e.name)return"All EXT-X-MEDIA tags in the same Group MUST have different NAME attributes.";r.isDefault&&(i=!0)}return i&&e.isDefault?"EXT-X-MEDIA A Group MUST NOT have more than one member with a DEFAULT attribute of YES.":""}(s,r);a&&f.h2(a,p,315),s.push(r),r.isDefault&&(t.currentRenditions[d.Th(i)]=s.length-1)}function T(t,e,i,r,s){const a=new u.KT({uri:i,bandwidth:e.BANDWIDTH,averageBandwidth:e["AVERAGE-BANDWIDTH"],score:e.SCORE,codecs:e.CODECS,resolution:e.RESOLUTION,frameRate:e["FRAME-RATE"],hdcpLevel:e["HDCP-LEVEL"],allowedCpc:e["ALLOWED-CPC"],videoRange:e["VIDEO-RANGE"],stableVariantId:e["STABLE-VARIANT-ID"],programId:e["PROGRAM-ID"]});for(const i of t)if("EXT-X-MEDIA"===i.name){const t=i.attributes,r=t.TYPE;if(r&&t["GROUP-ID"]||f.h2("EXT-X-MEDIA TYPE attribute is REQUIRED.",p,355),e[r]===t["GROUP-ID"]&&(k(a,i,r),"CLOSED-CAPTIONS"===r))for(const{instreamId:t}of a.closedCaptions)if(t&&t.startsWith("SERVICE")&&s.compatibleVersion<7){s.compatibleVersion=7;break}}return function(t,e,i){for(const r of["AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS"])"CLOSED-CAPTIONS"===r&&"NONE"===t[r]?(i.isClosedCaptionsNone=!0,e.closedCaptions=[]):t[r]&&!e[d.Th(r)].some((e=>e.groupId===t[r]))&&f.h2(`${r} attribute MUST match the value of the GROUP-ID attribute of an EXT-X-MEDIA tag whose TYPE attribute is ${r}.`,p,330)}(e,a,s),a.isIFrameOnly=r,a}function S(t,e){if(t.method!==e.method)return!1;if(t.uri!==e.uri)return!1;if(t.iv){if(!e.iv)return!1;if(t.iv.length!==e.iv.length)return!1;for(let i=0;i<t.iv.length;i++)if(t.iv[i]!==e.iv[i])return!1}else if(e.iv)return!1;return t.format===e.format&&t.formatVersion===e.formatVersion}function I(t,e,i,r,s,a,o){const c=new u.Y4({uri:e,mediaSequenceNumber:s,discontinuitySequence:a});let h=!1,d=!1;for(let e=i;e<=r;e++){const{name:i,value:r,attributes:s}=t[e];if("EXTINF"===i)!n()(r.duration)&&o.compatibleVersion<3&&(o.compatibleVersion=3),Math.round(r.duration)>o.targetDuration&&f.h2("EXTINF duration, when rounded to the nearest integer, MUST be less than or equal to the target duration",p,517),c.duration=r.duration,c.title=r.title;else if("EXT-X-BYTERANGE"===i)o.compatibleVersion<4&&(o.compatibleVersion=4),c.byterange=r;else if("EXT-X-DISCONTINUITY"===i)c.parts.length>0&&f.h2("EXT-X-DISCONTINUITY must appear before the first EXT-X-PART tag of the Parent Segment.",p,530),c.discontinuity=!0;else if("EXT-X-KEY"===i)c.parts.length>0&&f.h2("EXT-X-KEY must appear before the first EXT-X-PART tag of the Parent Segment.",p,536),"NONE"!==s.METHOD&&(x(o,s),c.key=new u.Uz({method:s.METHOD,uri:s.URI,iv:s.IV,format:s.KEYFORMAT,formatVersion:s.KEYFORMATVERSIONS}));else if("EXT-X-MAP"===i)c.parts.length>0&&f.h2("EXT-X-MAP must appear before the first EXT-X-PART tag of the Parent Segment.",p,552),o.compatibleVersion<5&&(o.compatibleVersion=5),o.hasMap=!0,c.map=new u.qP({uri:s.URI,byterange:s.BYTERANGE});else if("EXT-X-PROGRAM-DATE-TIME"===i)c.programDateTime=r;else if("EXT-X-DATERANGE"===i){const t={};for(const e of l()(s))(e.startsWith("SCTE35-")||e.startsWith("X-"))&&(t[e]=s[e]);c.dateRange=new u.ad({id:s.ID,classId:s.CLASS,start:s["START-DATE"],end:s["END-DATE"],duration:s.DURATION,plannedDuration:s["PLANNED-DURATION"],endOnNext:s["END-ON-NEXT"],attributes:t})}else if("EXT-X-CUE-OUT"===i)c.markers.push(new u.xC({type:"OUT",duration:s&&s.DURATION||r}));else if("EXT-X-CUE-IN"===i)c.markers.push(new u.xC({type:"IN"}));else if("EXT-X-CUE-OUT-CONT"===i||"EXT-X-CUE"===i||"EXT-OATCLS-SCTE35"===i||"EXT-X-ASSET"===i||"EXT-X-SCTE35"===i)c.markers.push(new u.xC({type:"RAW",tagName:i,value:r}));else if("EXT-X-PRELOAD-HINT"!==i||s.TYPE)if("EXT-X-PRELOAD-HINT"===i&&"PART"===s.TYPE&&d)f.h2("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist.",p,612);else if("EXT-X-PART"!==i&&"EXT-X-PRELOAD-HINT"!==i||s.URI){if("EXT-X-PRELOAD-HINT"===i&&"MAP"===s.TYPE)h&&f.h2("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist.",p,619),h=!0,o.hasMap=!0,c.map=new u.qP({hint:!0,uri:s.URI,byterange:{length:s["BYTERANGE-LENGTH"],offset:s["BYTERANGE-START"]||0}});else if("EXT-X-PART"===i||"EXT-X-PRELOAD-HINT"===i&&"PART"===s.TYPE){"EXT-X-PART"!==i||s.DURATION||f.h2("EXT-X-PART: DURATION attribute is mandatory",p,631),"EXT-X-PRELOAD-HINT"===i&&(d=!0);const t=new u.nw({hint:"EXT-X-PRELOAD-HINT"===i,uri:s.URI,byterange:"EXT-X-PART"===i?s.BYTERANGE:{length:s["BYTERANGE-LENGTH"],offset:s["BYTERANGE-START"]||0},duration:s.DURATION,independent:s.INDEPENDENT,gap:s.GAP});c.parts.push(t)}}else f.h2("EXT-X-PART / EXT-X-PRELOAD-HINT: URI attribute is mandatory",p,615);else f.h2("EXT-X-PRELOAD-HINT: TYPE attribute is mandatory",p,609)}return c}function P(t,e,i,r,s,a,n){const o=new u.Vd({uri:e,mediaSequenceNumber:s,discontinuitySequence:a});for(let e=i;e<=r;e++){const{name:i,attributes:r}=t[e];"EXTINF"===i?f.h2("A prefetch segment must not be advertised with an EXTINF tag.",p,663):"EXT-X-DISCONTINUITY"===i?f.h2("A prefetch segment must not be advertised with an EXT-X-DISCONTINUITY tag.",p,666):"EXT-X-PREFETCH-DISCONTINUITY"===i?o.discontinuity=!0:"EXT-X-KEY"===i?"NONE"!==r.METHOD&&(x(n,r),o.key=new u.Uz({method:r.METHOD,uri:r.URI,iv:r.IV,format:r.KEYFORMAT,formatVersion:r.KEYFORMATVERSIONS})):"EXT-X-MAP"===i&&f.h2("Prefetch segments must not be advertised with an EXT-X-MAP tag.",p,684)}return o}function _(t,e,i,r,s){const{discontinuity:a,key:n,map:o,byterange:l,uri:c}=e;if(a&&(e.discontinuitySequence=i+1),n||(e.key=r),o||(e.map=s),l&&-1===l.offset){const{segments:e}=t;if(e.length>0){const t=e[e.length-1];t.byterange&&t.uri===c?l.offset=t.byterange.offset+t.byterange.length:f.h2("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST be a sub-range of the same media resource",p,900)}else f.h2("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST appear in the Playlist file",p,904)}return t.segments.push(e),[e.discontinuitySequence,e.key,e.map]}function E(t,e){const[i,r]=function(t){const e=t.indexOf(":");return-1===e?[t.slice(1).trim(),null]:[t.slice(1,e).trim(),t.slice(e+1).trim()]}(t),a=function(t){switch(t){case"EXTM3U":case"EXT-X-VERSION":return"Basic";case"EXTINF":case"EXT-X-BYTERANGE":case"EXT-X-DISCONTINUITY":case"EXT-X-PREFETCH-DISCONTINUITY":case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-PROGRAM-DATE-TIME":case"EXT-X-DATERANGE":case"EXT-X-CUE-OUT":case"EXT-X-CUE-IN":case"EXT-X-CUE-OUT-CONT":case"EXT-X-CUE":case"EXT-OATCLS-SCTE35":case"EXT-X-ASSET":case"EXT-X-SCTE35":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":return"Segment";case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-ENDLIST":case"EXT-X-PLAYLIST-TYPE":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PREFETCH":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return"MediaPlaylist";case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":return"MasterPlaylist";case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-START":return"MediaorMasterPlaylist";default:return"Unknown"}}(i);if(function(t,e){if("Segment"===t||"MediaPlaylist"===t)return void 0===e.isMasterPlaylist?void(e.isMasterPlaylist=!1):void(e.isMasterPlaylist&&f.h2("The file contains both media and master playlist tags.",p,1011));if("MasterPlaylist"===t){if(void 0===e.isMasterPlaylist)return void(e.isMasterPlaylist=!0);!1===e.isMasterPlaylist&&f.h2("The file contains both media and master playlist tags.",p,1021)}}(a,e),"Unknown"===a)return null;"MediaPlaylist"===a&&"EXT-X-RENDITION-REPORT"!==i&&"EXT-X-PREFETCH"!==i&&(e.hash[i]&&f.h2("There MUST NOT be more than one Media Playlist tag of each type in any Media Playlist",p,1042),e.hash[i]=!0);const[n,o]=function(t,e){switch(t){case"EXTM3U":case"EXT-X-DISCONTINUITY":case"EXT-X-ENDLIST":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-CUE-IN":return[null,null];case"EXT-X-VERSION":case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":return[d.Ro(e),null];case"EXT-X-CUE-OUT":return s()(Number(e))?[null,w(e)]:[d.Ro(e),null];case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-DATERANGE":case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":case"EXT-X-START":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return[null,w(e)];case"EXTINF":return[g(e),null];case"EXT-X-BYTERANGE":return[v(e),null];case"EXT-X-PROGRAM-DATE-TIME":return[new Date(e),null];default:return[e,null]}}(i,r);return{name:i,category:a,value:n,attributes:o}}function C(t,e){let i;return e.isMasterPlaylist?i=function(t,e){const i=new u.ts;let r=!1;for(const[s,{name:a,value:n,attributes:o}]of t.entries())if("EXT-X-VERSION"===a)i.version=n;else if("EXT-X-STREAM-INF"===a){const a=t[s+1];("string"!=typeof a||a.startsWith("#EXT"))&&f.h2("EXT-X-STREAM-INF must be followed by a URI line",p,417);const n=T(t,o,a,!1,e);n&&("number"==typeof n.score&&(r=!0,n.score<0&&f.h2("SCORE attribute on EXT-X-STREAM-INF must be positive decimal-floating-point number.",p,424)),i.variants.push(n))}else if("EXT-X-I-FRAME-STREAM-INF"===a){const r=T(t,o,o.URI,!0,e);r&&i.variants.push(r)}else if("EXT-X-SESSION-DATA"===a){const t=new u.pf({id:o["DATA-ID"],value:o.VALUE,uri:o.URI,language:o.LANGUAGE});i.sessionDataList.some((e=>e.id===t.id&&e.language===t.language))&&f.h2("A Playlist MUST NOT contain more than one EXT-X-SESSION-DATA tag with the same DATA-ID attribute and the same LANGUAGE attribute.",p,444),i.sessionDataList.push(t)}else if("EXT-X-SESSION-KEY"===a){"NONE"===o.METHOD&&f.h2("EXT-X-SESSION-KEY: The value of the METHOD attribute MUST NOT be NONE",p,450);const t=new u.Uz({method:o.METHOD,uri:o.URI,iv:o.IV,format:o.KEYFORMAT,formatVersion:o.KEYFORMATVERSIONS});i.sessionKeyList.some((e=>S(e,t)))&&f.h2("A Master Playlist MUST NOT contain more than one EXT-X-SESSION-KEY tag with the same METHOD, URI, IV, KEYFORMAT, and KEYFORMATVERSIONS attribute values.",p,460),x(e,o),i.sessionKeyList.push(t)}else"EXT-X-INDEPENDENT-SEGMENTS"===a?(i.independentSegments&&f.h2("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist",p,467),i.independentSegments=!0):"EXT-X-START"===a&&(i.start&&f.h2("EXT-X-START tag MUST NOT appear more than once in a Playlist",p,473),"number"!=typeof o["TIME-OFFSET"]&&f.h2("EXT-X-START: TIME-OFFSET attribute is REQUIRED",p,476),i.start={offset:o["TIME-OFFSET"],precise:o.PRECISE||!1});if(r)for(const t of i.variants)"number"!=typeof t.score&&f.h2("If any Variant Stream contains the SCORE attribute, then all Variant Streams in the Master Playlist SHOULD have a SCORE attribute",p,484);if(e.isClosedCaptionsNone)for(const t of i.variants)t.closedCaptions.length>0&&f.h2("If there is a variant with CLOSED-CAPTIONS attribute of NONE, all EXT-X-STREAM-INF tags MUST have this attribute with a value of NONE",p,491);return i}(t,e):(i=function(t,e){const i=new u.tk;let r=-1,s=0,a=!1,n=!1,o=0,l=null,c=null,d=!1;for(const[h,m]of t.entries()){const{name:g,value:v,attributes:y,category:A}=m;if("Segment"!==A){if("EXT-X-VERSION"===g)void 0===i.version?i.version=v:f.h2("A Playlist file MUST NOT contain more than one EXT-X-VERSION tag.",p,716);else if("EXT-X-TARGETDURATION"===g)i.targetDuration=e.targetDuration=v;else if("EXT-X-MEDIA-SEQUENCE"===g)i.segments.length>0&&f.h2("The EXT-X-MEDIA-SEQUENCE tag MUST appear before the first Media Segment in the Playlist.",p,724),i.mediaSequenceBase=s=v;else if("EXT-X-DISCONTINUITY-SEQUENCE"===g)i.segments.length>0&&f.h2("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before the first Media Segment in the Playlist.",p,730),a&&f.h2("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before any EXT-X-DISCONTINUITY tag.",p,733),i.discontinuitySequenceBase=o=v;else if("EXT-X-ENDLIST"===g)i.endlist=!0;else if("EXT-X-PLAYLIST-TYPE"===g)i.playlistType=v;else if("EXT-X-I-FRAMES-ONLY"===g)e.compatibleVersion<4&&(e.compatibleVersion=4),i.isIFrame=!0;else if("EXT-X-INDEPENDENT-SEGMENTS"===g)i.independentSegments&&f.h2("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist",p,751),i.independentSegments=!0;else if("EXT-X-START"===g)i.start&&f.h2("EXT-X-START tag MUST NOT appear more than once in a Playlist",p,757),"number"!=typeof y["TIME-OFFSET"]&&f.h2("EXT-X-START: TIME-OFFSET attribute is REQUIRED",p,760),i.start={offset:y["TIME-OFFSET"],precise:y.PRECISE||!1};else if("EXT-X-SERVER-CONTROL"===g)y["CAN-BLOCK-RELOAD"]||f.h2("EXT-X-SERVER-CONTROL: CAN-BLOCK-RELOAD=YES is mandatory for Low-Latency HLS",p,766),i.lowLatencyCompatibility={canBlockReload:y["CAN-BLOCK-RELOAD"],canSkipUntil:y["CAN-SKIP-UNTIL"],holdBack:y["HOLD-BACK"],partHoldBack:y["PART-HOLD-BACK"]};else if("EXT-X-PART-INF"===g)y["PART-TARGET"]||f.h2("EXT-X-PART-INF: PART-TARGET attribute is mandatory",p,777),i.partTargetDuration=y["PART-TARGET"];else if("EXT-X-RENDITION-REPORT"===g)y.URI||f.h2("EXT-X-RENDITION-REPORT: URI attribute is mandatory",p,783),0===y.URI.search(/^[a-z]+:/)&&f.h2("EXT-X-RENDITION-REPORT: URI must be relative to the playlist uri",p,786),i.renditionReports.push(new u.h4({uri:y.URI,lastMSN:y["LAST-MSN"],lastPart:y["LAST-PART"]}));else if("EXT-X-SKIP"===g)y["SKIPPED-SEGMENTS"]||f.h2("EXT-X-SKIP: SKIPPED-SEGMENTS attribute is mandatory",p,796),e.compatibleVersion<9&&(e.compatibleVersion=9),i.skip=y["SKIPPED-SEGMENTS"],s+=i.skip;else if("EXT-X-PREFETCH"===g){const a=P(t,v,-1===r?h:r,h-1,s++,o,e);a&&(a.discontinuity&&(a.discontinuitySequence++,o=a.discontinuitySequence),a.key?l=a.key:a.key=l,i.prefetchSegments.push(a)),n=!0,r=-1}else if("string"==typeof m){-1===r&&f.h2("A URI line is not preceded by any segment tags",p,833),i.targetDuration||f.h2("The EXT-X-TARGETDURATION tag is REQUIRED",p,836),n&&f.h2("These segments must appear after all complete segments.",p,839);const a=I(t,m,r,h-1,s++,o,e);a&&([o,l,c]=_(i,a,o,l,c),!d&&a.parts.length>0&&(d=!0)),r=-1}}else-1===r&&(r=h),"EXT-X-DISCONTINUITY"===g&&(a=!0)}if(-1!==r){const a=I(t,"",r,t.length-1,s++,o,e);if(a){var m;const{parts:t}=a;!(t.length>0)||i.endlist||null!==(m=t[t.length-1])&&void 0!==m&&m.hint||f.h2("If the Playlist contains EXT-X-PART tags and does not contain an EXT-X-ENDLIST tag, the Playlist must contain an EXT-X-PRELOAD-HINT tag with a TYPE=PART attribute",p,856),_(i,a,l,c),!d&&a.parts.length>0&&(d=!0)}}return function(t){const e=new(h()),i=new(h());let r=!1,s=!1;for(let a=t.length-1;a>=0;a--){const{programDateTime:n,dateRange:o}=t[a];if(n&&(s=!0),o&&o.start){r=!0,o.endOnNext&&(o.end||o.duration)&&f.h2("An EXT-X-DATERANGE tag with an END-ON-NEXT=YES attribute MUST NOT contain DURATION or END-DATE attributes.",p,924);const t=o.start.getTime(),s=o.duration||0;o.end&&o.duration&&t+1e3*s!==o.end.getTime()&&f.h2("END-DATE MUST be equal to the value of the START-DATE attribute plus the value of the DURATION",p,930),o.endOnNext&&(o.end=e.get(o.classId)),e.set(o.classId,o.start);const a=o.end?o.end.getTime():o.start.getTime()+1e3*(o.duration||0),n=i.get(o.classId);if(n){for(const e of n)(e.start<=t&&e.end>t||e.start>=t&&e.start<a)&&f.h2("DATERANGE tags with the same CLASS should not overlap",p,942);n.push({start:t,end:a})}else o.classId&&i.set(o.classId,[{start:t,end:a}])}}r&&!s&&f.h2("If a Playlist contains an EXT-X-DATERANGE tag, it MUST also contain at least one EXT-X-PROGRAM-DATE-TIME tag.",p,953)}(i.segments),i.lowLatencyCompatibility&&function({lowLatencyCompatibility:t,targetDuration:e,partTargetDuration:i,segments:r,renditionReports:s},a){const{canSkipUntil:n,holdBack:o,partHoldBack:l}=t;if(n<6*e&&f.h2("The Skip Boundary must be at least six times the EXT-X-TARGETDURATION.",p,960),o<3*e&&f.h2("HOLD-BACK must be at least three times the EXT-X-TARGETDURATION.",p,964),a){void 0===i&&f.h2("EXT-X-PART-INF is required if a Playlist contains one or more EXT-X-PART tags",p,968),void 0===l&&f.h2("EXT-X-PART: PART-HOLD-BACK attribute is mandatory",p,971),l<i&&f.h2("PART-HOLD-BACK must be at least PART-TARGET",p,974);for(const[t,{parts:e}]of r.entries()){e.length>0&&t<r.length-3&&f.h2("Remove EXT-X-PART tags from the Playlist after they are greater than three target durations from the end of the Playlist.",p,978);for(const[t,{duration:r}]of e.entries())void 0!==r&&(r>i&&f.h2("PART-TARGET is the maximum duration of any Partial Segment",p,985),t<e.length-1&&r<.85*i&&f.h2("All Partial Segments except the last part of a segment must have a duration of at least 85% of PART-TARGET",p,988))}}for(const t of s){const e=r[r.length-1];null!==t.lastMSN&&void 0!==t.lastMSN||(t.lastMSN=e.mediaSequenceNumber),(null===t.lastPart||void 0===t.lastPart)&&e.parts.length>0&&(t.lastPart=e.parts.length-1)}}(i,d),i.duration=i.segments.reduce(((t,e)=>"number"==typeof e.duration?t+e.duration:t),0),i}(t,e),!i.isIFrame&&e.hasMap&&e.compatibleVersion<6&&(e.compatibleVersion=6)),e.compatibleVersion>1&&(!i.version||i.version<e.compatibleVersion)&&f.h2(`EXT-X-VERSION needs to be ${e.compatibleVersion} or higher.`,p,1092),i}function M(t){const e={version:void 0,isMasterPlaylist:void 0,hasMap:!1,targetDuration:0,compatibleVersion:1,isClosedCaptionsNone:!1,hash:{}},i=function(t,e){const i=[];for(const r of t.split("\n")){const t=r.trim();if(t)if(t.startsWith("#")){if(t.startsWith("#EXT")){const r=E(t,e);r&&i.push(r)}}else i.push(t)}return 0!==i.length&&"EXTM3U"===i[0].name||f.h2("The EXTM3U tag MUST be the first line.",p,1074),i}(t,e),r=C(i,e);return r.source=t,r}},64608:(t,e,i)=>{"use strict";i.d(e,{KT:()=>n,Uz:()=>l,Vd:()=>y,Y4:()=>g,ad:()=>h,h4:()=>A,nw:()=>v,pf:()=>o,qP:()=>c,ru:()=>a,tk:()=>m,ts:()=>p,xC:()=>d});var r=i(134),s=i(86932);class a{constructor({type:t,uri:e,groupId:i,language:s,assocLanguage:a,name:n,isDefault:o,autoselect:l,forced:c,instreamId:h,characteristics:d,channels:u}){(0,r.A)(this,"type",void 0),(0,r.A)(this,"uri",void 0),(0,r.A)(this,"groupId",void 0),(0,r.A)(this,"language",void 0),(0,r.A)(this,"assocLanguage",void 0),(0,r.A)(this,"name",void 0),(0,r.A)(this,"isDefault",void 0),(0,r.A)(this,"autoselect",void 0),(0,r.A)(this,"forced",void 0),(0,r.A)(this,"instreamId",void 0),(0,r.A)(this,"characteristics",void 0),(0,r.A)(this,"channels",void 0),this.type=t,this.uri=e,this.groupId=i,this.language=s,this.assocLanguage=a,this.name=n,this.isDefault=o,this.autoselect=l,this.forced=c,this.instreamId=h,this.characteristics=d,this.channels=u}}class n{constructor({uri:t,isIFrameOnly:e=!1,bandwidth:i,averageBandwidth:s,score:a,codecs:n,resolution:o,frameRate:l,hdcpLevel:c,allowedCpc:h,videoRange:d,stableVariantId:u,programId:f,audio:p=[],video:m=[],subtitles:g=[],closedCaptions:v=[],currentRenditions:y={audio:0,video:0,subtitles:0,closedCaptions:0}}){(0,r.A)(this,"uri",void 0),(0,r.A)(this,"isIFrameOnly",void 0),(0,r.A)(this,"bandwidth",void 0),(0,r.A)(this,"averageBandwidth",void 0),(0,r.A)(this,"score",void 0),(0,r.A)(this,"codecs",void 0),(0,r.A)(this,"resolution",void 0),(0,r.A)(this,"frameRate",void 0),(0,r.A)(this,"hdcpLevel",void 0),(0,r.A)(this,"allowedCpc",void 0),(0,r.A)(this,"videoRange",void 0),(0,r.A)(this,"stableVariantId",void 0),(0,r.A)(this,"programId",void 0),(0,r.A)(this,"audio",void 0),(0,r.A)(this,"video",void 0),(0,r.A)(this,"subtitles",void 0),(0,r.A)(this,"closedCaptions",void 0),(0,r.A)(this,"currentRenditions",void 0),this.uri=t,this.isIFrameOnly=e,this.bandwidth=i,this.averageBandwidth=s,this.score=a,this.codecs=n,this.resolution=o,this.frameRate=l,this.hdcpLevel=c,this.allowedCpc=h,this.videoRange=d,this.stableVariantId=u,this.programId=f,this.audio=p,this.video=m,this.subtitles=g,this.closedCaptions=v,this.currentRenditions=y}}class o{constructor({id:t,value:e,uri:i,language:s}){(0,r.A)(this,"id",void 0),(0,r.A)(this,"value",void 0),(0,r.A)(this,"uri",void 0),(0,r.A)(this,"language",void 0),this.id=t,this.value=e,this.uri=i,this.language=s}}class l{constructor({method:t,uri:e,iv:i,format:s,formatVersion:a}){(0,r.A)(this,"method",void 0),(0,r.A)(this,"uri",void 0),(0,r.A)(this,"iv",void 0),(0,r.A)(this,"format",void 0),(0,r.A)(this,"formatVersion",void 0),this.method=t,this.uri=e,this.iv=i,this.format=s,this.formatVersion=a}}class c{constructor({hint:t=!1,uri:e,mimeType:i,byterange:s}){(0,r.A)(this,"hint",void 0),(0,r.A)(this,"uri",void 0),(0,r.A)(this,"mimeType",void 0),(0,r.A)(this,"byterange",void 0),this.hint=t,this.uri=e,this.mimeType=i,this.byterange=s}}class h{constructor({id:t,classId:e,start:i,end:s,duration:a,plannedDuration:n,endOnNext:o,attributes:l={}}){(0,r.A)(this,"id",void 0),(0,r.A)(this,"classId",void 0),(0,r.A)(this,"start",void 0),(0,r.A)(this,"end",void 0),(0,r.A)(this,"duration",void 0),(0,r.A)(this,"plannedDuration",void 0),(0,r.A)(this,"endOnNext",void 0),(0,r.A)(this,"attributes",void 0),this.id=t,this.classId=e,this.start=i,this.end=s,this.duration=a,this.plannedDuration=n,this.endOnNext=o,this.attributes=l}}class d{constructor({type:t,duration:e,tagName:i,value:s}){(0,r.A)(this,"type",void 0),(0,r.A)(this,"duration",void 0),(0,r.A)(this,"tagName",void 0),(0,r.A)(this,"value",void 0),this.type=t,this.duration=e,this.tagName=i,this.value=s}}class u{constructor(t){(0,r.A)(this,"type",void 0),this.type=t}}class f extends u{constructor({isMasterPlaylist:t,uri:e,version:i,independentSegments:s=!1,start:a,source:n}){super("playlist"),(0,r.A)(this,"isMasterPlaylist",void 0),(0,r.A)(this,"uri",void 0),(0,r.A)(this,"version",void 0),(0,r.A)(this,"independentSegments",void 0),(0,r.A)(this,"start",void 0),(0,r.A)(this,"source",void 0),this.isMasterPlaylist=t,this.uri=e,this.version=i,this.independentSegments=s,this.start=a,this.source=n}}class p extends f{constructor(t={}){super({...t,isMasterPlaylist:!0}),(0,r.A)(this,"variants",void 0),(0,r.A)(this,"currentVariant",void 0),(0,r.A)(this,"sessionDataList",void 0),(0,r.A)(this,"sessionKeyList",void 0);const{variants:e=[],currentVariant:i,sessionDataList:s=[],sessionKeyList:a=[]}=t;this.variants=e,this.currentVariant=i,this.sessionDataList=s,this.sessionKeyList=a}}class m extends f{constructor(t={}){super({...t,isMasterPlaylist:!1}),(0,r.A)(this,"targetDuration",void 0),(0,r.A)(this,"mediaSequenceBase",void 0),(0,r.A)(this,"discontinuitySequenceBase",void 0),(0,r.A)(this,"endlist",void 0),(0,r.A)(this,"playlistType",void 0),(0,r.A)(this,"isIFrame",void 0),(0,r.A)(this,"segments",void 0),(0,r.A)(this,"prefetchSegments",void 0),(0,r.A)(this,"lowLatencyCompatibility",void 0),(0,r.A)(this,"partTargetDuration",void 0),(0,r.A)(this,"renditionReports",void 0),(0,r.A)(this,"skip",void 0),(0,r.A)(this,"hash",void 0),(0,r.A)(this,"duration",void 0),(0,r.A)(this,"timestamp",void 0);const{targetDuration:e,mediaSequenceBase:i=0,discontinuitySequenceBase:a=0,endlist:n=!1,playlistType:o,isIFrame:l,segments:c=[],prefetchSegments:h=[],lowLatencyCompatibility:d,partTargetDuration:u,renditionReports:f=[],skip:p=0,hash:m,duration:g=0}=t;this.targetDuration=e,this.mediaSequenceBase=i,this.discontinuitySequenceBase=a,this.endlist=n,this.playlistType=o,this.isIFrame=l,this.segments=c,this.prefetchSegments=h,this.lowLatencyCompatibility=d,this.partTargetDuration=u,this.renditionReports=f,this.skip=p,this.hash=m,this.duration=g,this.timestamp=(0,s.A)()}}class g extends u{constructor({uri:t,mimeType:e,data:i,duration:s,title:a,byterange:n,discontinuity:o,mediaSequenceNumber:l=0,discontinuitySequence:c=0,key:h,map:d,programDateTime:u,dateRange:f,markers:p=[],parts:m=[]}){super("segment"),(0,r.A)(this,"uri",void 0),(0,r.A)(this,"mimeType",void 0),(0,r.A)(this,"data",void 0),(0,r.A)(this,"duration",void 0),(0,r.A)(this,"title",void 0),(0,r.A)(this,"byterange",void 0),(0,r.A)(this,"discontinuity",void 0),(0,r.A)(this,"mediaSequenceNumber",void 0),(0,r.A)(this,"discontinuitySequence",void 0),(0,r.A)(this,"key",void 0),(0,r.A)(this,"map",void 0),(0,r.A)(this,"programDateTime",void 0),(0,r.A)(this,"dateRange",void 0),(0,r.A)(this,"markers",void 0),(0,r.A)(this,"parts",void 0),this.uri=t,this.mimeType=e,this.data=i,this.duration=s,this.title=a,this.byterange=n,this.discontinuity=o,this.mediaSequenceNumber=l,this.discontinuitySequence=c,this.key=h,this.map=d,this.programDateTime=u,this.dateRange=f,this.markers=p,this.parts=m}}class v extends u{constructor({hint:t=!1,uri:e,duration:i,independent:s,byterange:a,gap:n}){super("part"),(0,r.A)(this,"hint",void 0),(0,r.A)(this,"uri",void 0),(0,r.A)(this,"duration",void 0),(0,r.A)(this,"independent",void 0),(0,r.A)(this,"byterange",void 0),(0,r.A)(this,"gap",void 0),this.hint=t,this.uri=e,this.duration=i,this.independent=s,this.duration=i,this.byterange=a,this.gap=n}}class y extends u{constructor({uri:t,discontinuity:e,mediaSequenceNumber:i=0,discontinuitySequence:s=0,key:a}){super("prefetch"),(0,r.A)(this,"uri",void 0),(0,r.A)(this,"discontinuity",void 0),(0,r.A)(this,"mediaSequenceNumber",void 0),(0,r.A)(this,"discontinuitySequence",void 0),(0,r.A)(this,"key",void 0),this.uri=t,this.discontinuity=e,this.mediaSequenceNumber=i,this.discontinuitySequence=s,this.key=a}}class A{constructor({uri:t,lastMSN:e,lastPart:i}){(0,r.A)(this,"uri",void 0),(0,r.A)(this,"lastMSN",void 0),(0,r.A)(this,"lastPart",void 0),this.uri=t,this.lastMSN=e,this.lastPart=i}}},67756:(t,e,i)=>{"use strict";i.d(e,{Bq:()=>u,HG:()=>f,Ro:()=>c,Th:()=>p,gI:()=>d,m2:()=>h});var r=i(99704),s=i.n(r),a=i(17735),n=i.n(a),o=i(7210),l=i.n(o);function c(t,e=10){if("number"==typeof t)return t;const i=10===e?s()(t):n()(t,e);return l()(i)?0:i}function h(t){(t.startsWith("0x")||t.startsWith("0X"))&&(t=t.slice(2));const e=[];for(let i=0;i<t.length;i+=2)e.push(c(t.slice(i,i+2),16));return new Uint8Array(e)}function d(t,e,i=0){let r=-1;for(let s=0,a=0;s<t.length;s++)if(t[s]===e){if(a++===i)return[t.slice(0,s),t.slice(s+1)];r=s}return-1!==r?[t.slice(0,r),t.slice(r+1)]:[t]}function u(t,e=" "){return t?(t=t.trim()," "===e||(t.startsWith(e)&&(t=t.slice(1)),t.endsWith(e)&&(t=t.slice(0,-1))),t):t}function f(t){const e=[];let i=!0,r=0;const s=[];for(let a=0;a<t.length;a++){const n=t[a];i&&","===n?(e.push(t.slice(r,a).trim()),r=a+1):'"'!==n&&"'"!==n||(i?(s.push(n),i=!1):n===s[s.length-1]?(s.pop(),i=!0):s.push(n))}return e.push(t.slice(r).trim()),e}function p(t){const e=[];let i=!1;for(const r of t)"-"!==r&&"_"!==r?i?(e.push(r.toUpperCase()),i=!1):e.push(r.toLowerCase()):i=!0;return e.join("")}},88103:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(43356);class a extends s.A{constructor(t,e){super(t,e),(0,r.A)(this,"context",void 0),(0,r.A)(this,"paddingLeft",void 0),(0,r.A)(this,"paddingTop",void 0),(0,r.A)(this,"flipX",void 0),(0,r.A)(this,"flipY",void 0),this.paddingLeft=0,this.paddingTop=0,this.flipX=1,this.flipY=1}async init(){this.context=this.canvas.getContext("2d")}clear(){const t=this.canvas.width>>1,e=this.canvas.height>>1;this.rotate&&(this.context.translate(t,e),this.context.rotate(-this.rotate*Math.PI/180),this.context.translate(-t,-e)),this.context.clearRect(0,0,this.canvasWidth*this.options.devicePixelRatio,this.canvasHeight*this.options.devicePixelRatio),this.rotate&&(this.context.translate(t,e),this.context.rotate(this.rotate*Math.PI/180),this.context.translate(-t,-e))}checkFrame(t){t.codedWidth===this.textureWidth&&t.codedHeight===this.videoHeight&&t.codedWidth===this.videoWidth||(this.videoWidth=t.codedWidth,this.videoHeight=t.codedHeight,this.textureWidth=t.codedWidth,this.layout())}render(t){this.lost||(this.checkFrame(t),this.context.drawImage(t,this.paddingLeft,this.paddingTop,this.canvasWidth*this.options.devicePixelRatio-2*this.paddingLeft,this.canvasHeight*this.options.devicePixelRatio-2*this.paddingTop))}layout(){let t=this.videoWidth,e=this.videoHeight,i=this.canvasWidth,r=this.canvasHeight,s=0,a=0;90!==this.rotate&&270!==this.rotate||(a=Math.floor((r-i)/2),s=Math.floor((i-r)/2),i=this.canvasHeight,r=this.canvasWidth);const n=t/i,o=e/r;let l;if(l=n>1?!(n<o):n>o,1===this.renderMode&&(l=!l),l){const n=(r-e*i/t)/r;this.paddingTop=(Math.floor(n/2*r)+a)*this.options.devicePixelRatio,this.paddingLeft=s*this.options.devicePixelRatio}else{const n=(i-t*r/e)/i;this.paddingLeft=(Math.floor(n/2*i)+s)*this.options.devicePixelRatio,this.paddingTop=a*this.options.devicePixelRatio}if(this.context){let t=1,e=1;this.flipHorizontal&&(t=-1),this.flipVertical&&(e=-1);const i=this.canvas.width>>1,r=this.canvas.height>>1;this.context.translate(i,r),t!==this.flipX&&this.context.scale(-1,1),e!==this.flipY&&this.context.scale(1,-1),this.context.translate(-i,-r),this.flipX=t,this.flipY=e}}setRotate(t){if((t%=360)===this.rotate)return;const e=this.canvas.width>>1,i=this.canvas.height>>1;this.rotate&&(this.context.translate(e,i),this.context.rotate(-this.rotate*Math.PI/180),this.context.translate(-e,-i)),this.clear(),this.rotate=t,this.context&&(this.context.translate(e,i),this.context.rotate(this.rotate*Math.PI/180),this.context.translate(-e,-i)),this.layout()}destroy(){this.context=null,super.destroy()}static isSupport(t){return t instanceof VideoFrame||t instanceof ImageBitmap}}},43356:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(6110);class a{constructor(t,e){(0,r.A)(this,"canvas",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"textureWidth",void 0),(0,r.A)(this,"videoWidth",void 0),(0,r.A)(this,"videoHeight",void 0),(0,r.A)(this,"canvasWidth",void 0),(0,r.A)(this,"canvasHeight",void 0),(0,r.A)(this,"rotate",void 0),(0,r.A)(this,"renderMode",void 0),(0,r.A)(this,"format",void 0),(0,r.A)(this,"lost",void 0),(0,r.A)(this,"destroyed",void 0),(0,r.A)(this,"srcColorSpace",void 0),(0,r.A)(this,"dstColorSpace",void 0),(0,r.A)(this,"flipHorizontal",void 0),(0,r.A)(this,"flipVertical",void 0),this.canvas=t,this.options=e,this.canvasWidth=t.width,this.canvasHeight=t.height,this.videoWidth=0,this.videoHeight=0,this.textureWidth=0,this.rotate=0,this.renderMode=e.renderMode,this.flipHorizontal=!1,this.flipVertical=!1,this.lost=!1,this.destroyed=!1,e.dstColorSpace?this.dstColorSpace=e.dstColorSpace:this.dstColorSpace=new s.A(1,1,1,1)}getRotateMatrix(t){t=Math.PI*t/180;const e=Math.sin(t),i=Math.cos(t);return[i,-e,0,0,e,i,0,0,0,0,1,0,0,0,0,1]}setRenderMode(t){this.renderMode!==t&&(this.renderMode=t,this.layout(),this.clear())}enableHorizontalFlip(t){this.flipHorizontal!==t&&(this.flipHorizontal=t,this.layout(),this.clear())}enableVerticalFlip(t){this.flipVertical!==t&&(this.flipVertical=t,this.layout(),this.clear())}viewport(t,e){const i=this.options.devicePixelRatio;this.canvasWidth=t,this.canvasHeight=e,this.canvas.width=t*i,this.canvas.height=e*i,this.videoWidth&&this.videoHeight&&this.layout()}getVideoWidth(){return this.videoWidth}getVideoHeight(){return this.videoHeight}destroy(){this.canvas=null,this.destroyed=!0}setDstColorSpace(t){this.dstColorSpace=t}static isSupport(t){return!1}}},43813:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var r=i(63939),s=i(14686),a=i(97317),n=i(25669),o=i(6110),l=i(37653),c=i(32903),h=i(72703);class d extends l.A{constructor(t,e){super(t,e)}generateFragmentSource(t,e){const i=(0,n.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:0,outputRGB:!0}),r=["r","g","b","a"];let s=`texture2D(rgb_Sampler, v_color.xy).${r[e.comp[0].offset]}`,a=`texture2D(rgb_Sampler, v_color.xy).${r[e.comp[1].offset]}`,o=`texture2D(rgb_Sampler, v_color.xy).${r[e.comp[2].offset]}`,l="1.0";128&e.flags&&4===e.nbComponents&&(l=`texture2D(rgb_Sampler, v_color.xy).${r[e.comp[3].offset]}`),this.fragmentSource=`\n      precision highp float;\n      varying vec4 v_color;\n      uniform sampler2D rgb_Sampler;\n      void main () {\n        float r = ${s};\n        float g = ${a};\n        float b = ${o};\n        float alpha = ${l};\n        vec4 color = vec4(r, g, b, alpha);\n        ${i.reduce(((t,e)=>t+e),"")}\n        gl_FragColor = color;\n      }\n    `}checkFrame(t){const e=a.g[r.f[15](t+80)];e&&(r.f[15](t+32)===this.textureWidth&&r.f[15](t+72)===this.videoHeight&&r.f[15](t+68)===this.videoWidth||(this.srcColorSpace=new o.A(r.f[15](t+220),r.f[15](t+212),r.f[15](t+216),r.f[15](t+208)),this.generateFragmentSource(r.f[15](t+80),e),this.program=new c.A(this.fragmentSource),this.useProgram(),4===e.nbComponents&&(this.rgbTexture.setFormat(this.gl.RGBA),this.rgbTexture.setInternalformat(this.gl.RGBA)),this.rgbTexture.setSize(r.f[15](t+32),r.f[15](t+72)),this.videoWidth=r.f[15](t+68),this.videoHeight=r.f[15](t+72),this.textureWidth=r.f[15](t+32),this.format=r.f[15](t+80),this.layout()))}render(t){this.lost||(this.checkFrame(t),this.rgbTexture.fill((0,s.s3)(r.f[20](t),this.rgbTexture.width*this.rgbTexture.height)),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4))}static isSupport(t){if((0,h.A)(t)){const e=a.g[r.f[15](t+80)];if(e)return 32&e.flags&&e.comp[0].depth+7>>>3==1}return!1}}},37653:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(94012),a=i(17397);class n extends s.A{constructor(t,e){super(t,e),(0,r.A)(this,"rgbTexture",void 0)}useProgram(){super.useProgram(),this.rgbTexture=new a.A(this.gl),this.rgbTexture.bind(0),this.rgbTexture.init(),this.program.bindRGBTexture(0)}destroy(){this.rgbTexture&&(this.rgbTexture.destroy(),this.rgbTexture=null),super.destroy()}}},94012:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(134),s=i(4624),a=i(43356),n=i(38469),o="src/avrender/image/WebGLRender.ts";class l extends a.A{constructor(t,e){super(t,e),(0,r.A)(this,"gl",void 0),(0,r.A)(this,"VAO",void 0),(0,r.A)(this,"program",void 0),(0,r.A)(this,"vertex",void 0),(0,r.A)(this,"webglContextLostTimer",void 0),(0,r.A)(this,"onWebglContextLost",void 0),(0,r.A)(this,"onWebglContextRestored",void 0),(0,r.A)(this,"fragmentSource",void 0),(0,r.A)(this,"vertexSource",void 0)}async init(){this.gl=this.canvas.getContext("webgl2",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer}),this.gl||(this.gl=this.canvas.getContext("webgl",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer})),this.gl||(this.gl=this.canvas.getContext("experimental-webgl",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer})),this.gl||s.h2("can not support webgl, got WebGLRenderingContext failed",o,96),this.VAO=this.gl.createBuffer(),this.VAO||s.h2("create vao buffer failed",o,101),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.VAO),this.gl.enable(this.gl.BLEND),this.gl.clearColor(0,0,0,0),this.gl.clearDepth(1),this.viewport(this.canvasWidth||this.canvas.width,this.canvasHeight||this.canvas.height),this.onWebglContextLost=t=>{this.destroyed||(this.webglContextLostTimer=setTimeout((()=>{this.lost=!0,this.webglContextLostTimer=null,s.z3("webgl context lost",o,118),this.options.onRenderContextLost&&this.options.onRenderContextLost()}),3e3))},this.onWebglContextRestored=t=>{this.webglContextLostTimer&&(clearTimeout(this.webglContextLostTimer),this.webglContextLostTimer=null)},this.canvas.addEventListener("webglcontextlost",this.onWebglContextLost),this.canvas.addEventListener("webglcontextrestored",this.onWebglContextRestored)}viewport(t,e){this.gl.viewport(0,0,t*this.options.devicePixelRatio,e*this.options.devicePixelRatio),super.viewport(t,e)}useProgram(){this.program.link(this.gl),this.program.bind(),this.program.setRotateMatrix(this.getRotateMatrix(this.rotate))}clear(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}layout(){let t=this.videoWidth,e=this.videoHeight,i=this.canvasWidth,r=this.canvasHeight;90!==this.rotate&&270!==this.rotate||(i=this.canvasHeight,r=this.canvasWidth);const s=t/i,a=e/r;let o;o=s>1?!(s<a):s>a,1===this.renderMode&&(o=!o);let l=0;if(this.textureWidth!==this.videoWidth&&(l=(this.textureWidth-this.videoWidth)/this.textureWidth),o){const s=(r-e*i/t)/r;this.vertex=[-1,1-s,0,0,0,0,0,-1,-1+s,0,0,1,0,0,1,1-s,0,1-l,0,0,0,1,-1+s,0,1-l,1,0,0]}else{const s=(i-t*r/e)/i;this.vertex=[-1+s,1,0,0,0,0,0,-1+s,-1,0,0,1,0,0,1-s,1,0,1-l,0,0,0,1-s,-1,0,1-l,1,0,0]}(0,n.A)(this.vertex,this.flipHorizontal,this.flipVertical),this.gl&&this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.vertex),this.gl.STATIC_DRAW)}setRotate(t){(t%=360)!==this.rotate&&(this.rotate=t,this.gl&&this.program.setRotateMatrix(this.getRotateMatrix(this.rotate)),this.layout(),this.clear())}destroy(){this.program&&this.program.stop(),this.gl=null,this.VAO=null,this.vertex=null,this.onWebglContextLost&&(this.canvas.removeEventListener("webglcontextlost",this.onWebglContextLost),this.onWebglContextLost=null),this.onWebglContextRestored&&(this.canvas.removeEventListener("webglcontextrestored",this.onWebglContextRestored),this.onWebglContextRestored=null),super.destroy()}}},99293:(t,e,i)=>{"use strict";i.d(e,{A:()=>v});var r=i(134),s=i(74503),a=i(63939),n=i(94300),o=i(14686),l=i(97317),c=i(22594),h=i(25669),d=i(57517),u=i(6110),f=i(20088),p=i(56024),m=i(73039),g=i(72703);class v extends c.A{constructor(t,e){super(t,e),(0,r.A)(this,"hdrMetadata",void 0),(0,r.A)(this,"ext",void 0),this.hdrMetadata=(0,s.A)(f.A),this.hdrMetadata.multiplier=1}async init(){if(await super.init(),this.ext=this.gl.getExtension("EXT_texture_norm16"),!this.ext)throw Error("not support")}generateFragmentSource(t,e,i){i.outputRGB=!0;const r=(0,h.A)(this.srcColorSpace,this.dstColorSpace,i);let s="texture2D(u_Sampler, v_color.xy).x",a="texture2D(v_Sampler, v_color.xy).x",n="1.0";23===t||189===t?(s="texture2D(u_Sampler, v_color.xy).x",a="texture2D(u_Sampler, v_color.xy).y"):24!==t&&190!==t||(s="texture2D(u_Sampler, v_color.xy).y",a="texture2D(u_Sampler, v_color.xy).x"),128&e.flags&&4===e.nbComponents&&(n="texture2D(a_Sampler, v_color.xy).x"),this.fragmentSource=`\n      precision highp float;\n\n      varying vec4 v_color;\n      uniform sampler2D y_Sampler;\n      uniform sampler2D u_Sampler;\n      uniform sampler2D v_Sampler;\n      \n      uniform float v_max;\n\n      uniform float offset;\n      uniform float multiplier;\n      uniform float pq_tonemap_a;\n      uniform float pq_tonemap_b;\n      uniform float hlg_ootf_gamma_minus_one;\n      uniform float hlg_dst_max_luminance_relative;\n      uniform float nits_to_sdr_relative_factor;\n      uniform float sdr_relative_to_nits_factor;\n\n      ${1&e.flags?"\n        float swap(float x) {\n          int value = int(x * 65535.0);\n          int low = value & 0xff;\n          int high = (value >> 8) & 0xff;\n          value = (low << 8) | high;\n          return float(value) / v_max;\n        }\n      ":""}\n      \n      void main () {\n      \n        float y = texture2D(y_Sampler, v_color.xy).x;\n        float u = ${s};\n        float v = ${a};\n        float alpha = ${n};\n        \n        ${1&e.flags?"\n          y = swap(y);\n          u = swap(u);\n          v = swap(v);\n        ":"\n          y = y * 65535.0 / v_max;\n          u = u * 65535.0 / v_max;\n          v = v * 65535.0 / v_max;\n        "}\n        \n        vec4 color = vec4(y, u, v, alpha);\n\n        if (color.a > 0.0) {\n          color.r /= color.a;\n          color.g /= color.a;\n          color.b /= color.a;\n        }\n        color.r -= offset;\n        color.g -= offset;\n        color.b -= offset;\n\n        color.r *= multiplier;\n        color.g *= multiplier;\n        color.b *= multiplier;\n        \n        ${r.reduce(((t,e)=>t+e),"")}\n\n        color.r *= color.a;\n        color.g *= color.a;\n        color.b *= color.a;\n\n        gl_FragColor = color;\n      }\n    `}checkFrame(t){const e=l.g[a.f[15](t+80)];if(!e)return;const i=e.comp[0].depth+7>>>3;if(a.f[15](t+32)/i!==this.textureWidth||a.f[15](t+72)!==this.videoHeight||a.f[15](t+68)!==this.videoWidth||a.f[15](t+80)!==this.format){this.srcColorSpace=new u.A(a.f[15](t+220),a.f[15](t+212),a.f[15](t+216),a.f[15](t+208));const i={type:0,bitDepth:e.comp[0].depth,toneMapPQAndHlgToDst:!0,metadata:this.hdrMetadata,dstSdrMaxLuminanceNits:d.kH,dstMaxLuminanceRelative:1},r=(0,p.aH)(t,14);if(r){const t=a.f[20](r+4);a.f[8](t)>0&&(i.maxContentLightLevel=a.f[8](t))}this.generateFragmentSource(a.f[15](t+80),e,i),this.program=new m.A(this.fragmentSource),this.useProgram(),this.program.setMetaData(this.hdrMetadata),this.yTexture.setFormat(this.gl.RED),this.yTexture.setInternalformat(this.ext.R16_EXT),this.yTexture.setDataType(this.gl.UNSIGNED_SHORT),this.uTexture.setFormat(this.gl.RED),this.uTexture.setInternalformat(this.ext.R16_EXT),this.uTexture.setDataType(this.gl.UNSIGNED_SHORT),this.vTexture.setFormat(this.gl.RED),this.vTexture.setInternalformat(this.ext.R16_EXT),this.vTexture.setDataType(this.gl.UNSIGNED_SHORT),this.aTexture.setFormat(this.gl.RED),this.aTexture.setInternalformat(this.ext.R16_EXT),this.aTexture.setDataType(this.gl.UNSIGNED_SHORT),this.yTexture.setSize(a.f[15](t+32)>>>1,a.f[15](t+72)),this.uTexture.setSize(a.f[15](t+32+4)>>>1,a.f[15](t+72)>>>l.g[a.f[15](t+80)].log2ChromaH),e.comp[1].plane!==e.comp[2].plane&&this.vTexture.setSize(a.f[15](t+32+8)>>>1,a.f[15](t+72)>>>l.g[a.f[15](t+80)].log2ChromaH),4===e.nbComponents&&this.aTexture.setSize(a.f[15](t+32+12)>>>1,a.f[15](t+72)),this.program.setMax((1<<e.comp[0].depth)-1),this.videoWidth=a.f[15](t+68),this.videoHeight=a.f[15](t+72),this.textureWidth=a.f[15](t+32)>>>1,this.format=a.f[15](t+80),this.layout()}}render(t){if(this.lost)return;this.checkFrame(t);const e=l.g[a.f[15](t+80)];e&&(this.yTexture.fill((0,o.bg)(a.f[20](t),this.yTexture.width*this.yTexture.height)),this.uTexture.fill((0,o.bg)(a.f[20](t+4),this.uTexture.width*this.uTexture.height)),e.comp[1].plane!==e.comp[2].plane&&this.vTexture.fill((0,o.bg)(a.f[20](t+8),this.vTexture.width*this.vTexture.height)),4===e.nbComponents&&this.aTexture.fill((0,o.bg)(a.f[20](t+12),this.aTexture.width*this.aTexture.height)),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4))}destroy(){this.hdrMetadata&&((0,n.A)(this.hdrMetadata),this.hdrMetadata=null),super.destroy()}static isSupport(t){if((0,g.A)(t)){const e=l.g[a.f[15](t+80)];if(e)return!(32&e.flags)&&16&e.flags&&e.comp[0].depth+7>>>3==2}return!1}}},55196:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var r=i(63939),s=i(14686),a=i(97317),n=i(22594),o=i(91848),l=i(25669),c=i(6110),h=i(72703);class d extends n.A{constructor(t,e){super(t,e)}generateFragmentSource(t,e){const i=(0,l.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:0,outputRGB:!0});let r="texture2D(u_Sampler, v_color.xy).x",s="texture2D(v_Sampler, v_color.xy).x",a="1.0";23===t||189===t?(r="texture2D(u_Sampler, v_color.xy).x",s="texture2D(u_Sampler, v_color.xy).y"):24!==t&&190!==t||(r="texture2D(u_Sampler, v_color.xy).y",s="texture2D(u_Sampler, v_color.xy).x"),128&e.flags&&4===e.nbComponents&&(a="texture2D(a_Sampler, v_color.xy).x"),this.fragmentSource=`\n      precision highp float;\n      varying vec4 v_color;\n      uniform sampler2D y_Sampler;\n      uniform sampler2D u_Sampler;\n      uniform sampler2D v_Sampler;\n      uniform sampler2D a_Sampler;\n      void main () {\n        float y = texture2D(y_Sampler, v_color.xy).x;\n        float u = ${r};\n        float v = ${s};\n        float alpha = ${a};\n        vec4 color = vec4(y, u, v, alpha);\n        ${i.reduce(((t,e)=>t+e),"")}\n        gl_FragColor = color;\n      }\n    `}checkFrame(t){const e=a.g[r.f[15](t+80)];e&&(r.f[15](t+32)===this.textureWidth&&r.f[15](t+72)===this.videoHeight&&r.f[15](t+68)===this.videoWidth||(this.srcColorSpace=new c.A(r.f[15](t+220),r.f[15](t+212),r.f[15](t+216),r.f[15](t+208)),this.generateFragmentSource(r.f[15](t+80),e),this.program=new o.A(this.fragmentSource),this.useProgram(),this.yTexture.setSize(r.f[15](t+32),r.f[15](t+72)),this.uTexture.setSize(r.f[15](t+32+4),r.f[15](t+72)>>>a.g[r.f[15](t+80)].log2ChromaH),e.comp[1].plane!==e.comp[2].plane&&this.vTexture.setSize(r.f[15](t+32+8),r.f[15](t+72)>>>a.g[r.f[15](t+80)].log2ChromaH),4===e.nbComponents&&this.aTexture.setSize(r.f[15](t+32+12),r.f[15](t+72)),this.videoWidth=r.f[15](t+68),this.videoHeight=r.f[15](t+72),this.textureWidth=r.f[15](t+32),this.format=r.f[15](t+80),this.layout()))}render(t){if(this.lost)return;this.checkFrame(t);const e=a.g[r.f[15](t+80)];e&&(this.yTexture.fill((0,s.s3)(r.f[20](t),this.yTexture.width*this.yTexture.height)),this.uTexture.fill((0,s.s3)(r.f[20](t+4),this.uTexture.width*this.uTexture.height)),e.comp[1].plane!==e.comp[2].plane&&this.vTexture.fill((0,s.s3)(r.f[20](t+8),this.vTexture.width*this.vTexture.height)),4===e.nbComponents&&this.aTexture.fill((0,s.s3)(r.f[20](t+12),this.aTexture.width*this.aTexture.height)),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4))}static isSupport(t){if((0,h.A)(t)){const e=a.g[r.f[15](t+80)];if(e)return!(32&e.flags)&&16&e.flags&&e.comp[0].depth+7>>>3==1}return!1}}},22594:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(48280),a=i(94012);class n extends a.A{constructor(t,e){super(t,e),(0,r.A)(this,"yTexture",void 0),(0,r.A)(this,"uTexture",void 0),(0,r.A)(this,"vTexture",void 0),(0,r.A)(this,"aTexture",void 0)}useProgram(){super.useProgram(),this.yTexture=new s.A(this.gl),this.yTexture.bind(0),this.yTexture.init(),this.program.bindYTexture(0),this.uTexture=new s.A(this.gl),this.uTexture.bind(1),this.uTexture.init(),this.program.bindUTexture(1),this.vTexture=new s.A(this.gl),this.vTexture.bind(2),this.vTexture.init(),this.program.bindVTexture(2),this.aTexture=new s.A(this.gl),this.aTexture.bind(3),this.aTexture.init(),this.program.bindATexture(3)}destroy(){this.yTexture&&(this.yTexture.destroy(),this.yTexture=null),this.uTexture&&(this.uTexture.destroy(),this.uTexture=null),this.vTexture&&(this.vTexture.destroy(),this.vTexture=null),this.aTexture&&(this.aTexture.destroy(),this.aTexture=null),super.destroy()}}},54750:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(54895),s=i(23195),a=i(15045);class n extends a.A{constructor(t,e){super(t,e),this.vertexSource=r.A,this.fragmentSource=s.A}checkFrame(t){t.codedWidth===this.textureWidth&&t.codedHeight===this.videoHeight&&t.codedWidth===this.videoWidth||(this.videoWidth=t.codedWidth,this.videoHeight=t.codedHeight,this.textureWidth=t.codedWidth,this.layout(),this.generatePipeline())}generateBindGroup(){this.bindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,externalTexture:{}},{binding:2,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}}]})}render(t){if(this.lost)return;this.checkFrame(t);const e=this.device.createBindGroup({layout:this.renderPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.device.importExternalTexture({source:t})},{binding:2,resource:this.sampler}]}),i=this.device.createCommandEncoder(),r={colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]},s=i.beginRenderPass(r);s.setPipeline(this.renderPipeline),s.setBindGroup(0,e),s.setVertexBuffer(0,this.vbo),s.draw(4,4,0,0),s.end(),this.device.queue.submit([i.finish()])}destroy(){super.destroy()}static isSupport(t){return t instanceof VideoFrame}}},1052:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var r=i(63939),s=i(97317),a=i(14686),n=i(6110),o=i(25669),l=i(56066),c=i(72703);class h extends l.A{constructor(t,e){super(t,e)}generateFragmentSource(t,e){const i=(0,o.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:1,outputRGB:!0}),r=["r","g","b","a"];let s=`textureSample(rgbTexture, in_texcoord.xy).${r[e.comp[0].offset]}`,a=`textureSample(rgbTexture, in_texcoord.xy).${r[e.comp[1].offset]}`,n=`textureSample(rgbTexture, in_texcoord.xy).${r[e.comp[2].offset]}`,l="1.0";128&e.flags&&4===e.nbComponents&&(l=`textureSample(rgbTexture, in_texcoord.xy).${r[e.comp[3].offset]}`),this.fragmentSource=`\n      @group(0) @binding(1) var s: sampler;\n      @group(0) @binding(2) var rgbTexture: texture_2d<f32>;\n      \n      @fragment\n      fn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n        let r = ${s};\n        let g = ${a};\n        let b = ${n};\n        let alpha = ${l};\n        var color = vec4(r, g, b, alpha);\n        ${i.reduce(((t,e)=>t+e),"")}\n        return color;\n      }\n    `}checkFrame(t){const e=s.g[r.f[15](t+80)];e&&(r.f[15](t+32)===this.textureWidth&&r.f[15](t+72)===this.videoHeight&&r.f[15](t+68)===this.videoWidth||(this.rgbTexture&&this.rgbTexture.destroy(),this.rgbTexture=this.device.createTexture({size:[r.f[15](t+32),r.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"}),this.srcColorSpace=new n.A(r.f[15](t+220),r.f[15](t+212),r.f[15](t+216),r.f[15](t+208)),this.generateFragmentSource(r.f[15](t+80),e),this.videoWidth=r.f[15](t+68),this.videoHeight=r.f[15](t+72),this.textureWidth=r.f[15](t+32),this.format=r.f[15](t+80),this.layout(),this.generatePipeline(),this.generateRenderBundleEncoder()))}render(t){if(this.lost)return;this.checkFrame(t),this.device.queue.writeTexture({texture:this.rgbTexture},(0,a.s3)(r.f[20](t),this.rgbTexture.width*this.rgbTexture.height),{offset:0,bytesPerRow:this.rgbTexture.width,rowsPerImage:this.rgbTexture.height},{width:this.rgbTexture.width,height:this.rgbTexture.height,depthOrArrayLayers:1});const e=this.device.createCommandEncoder(),i=e.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});i.executeBundles([this.renderBundle]),i.end(),this.device.queue.submit([e.finish()])}static isSupport(t){if((0,c.A)(t)){const e=s.g[r.f[15](t+80)];if(e)return 32&e.flags&&e.comp[0].depth+7>>>3==1}return!1}}},56066:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(54895),a=i(15045);class n extends a.A{constructor(t,e){super(t,e),(0,r.A)(this,"rgbTexture",void 0),this.vertexSource=s.A}generateBindGroup(){if(!this.rgbTexture)return;const t=[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}];this.bindGroupLayout=this.device.createBindGroupLayout({entries:t});const e=[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.sampler},{binding:2,resource:this.rgbTexture.createView()}];this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:e})}destroy(){this.rgbTexture&&this.rgbTexture.destroy(),super.destroy()}}},15045:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(134),s=i(4624),a=i(43356),n=i(72739),o=i(38469),l="src/avrender/image/WebGPURender.ts";class c extends a.A{constructor(t,e){super(t,e),(0,r.A)(this,"adapter",void 0),(0,r.A)(this,"device",void 0),(0,r.A)(this,"context",void 0),(0,r.A)(this,"vsModule",void 0),(0,r.A)(this,"fsModule",void 0),(0,r.A)(this,"rotateMatrixBuffer",void 0),(0,r.A)(this,"renderPipeline",void 0),(0,r.A)(this,"rotateMatrix",void 0),(0,r.A)(this,"vbo",void 0),(0,r.A)(this,"sampler",void 0),(0,r.A)(this,"vertex",void 0),(0,r.A)(this,"fragmentSource",void 0),(0,r.A)(this,"vertexSource",void 0),(0,r.A)(this,"renderBundleEncoder",void 0),(0,r.A)(this,"renderBundle",void 0),(0,r.A)(this,"bindGroupLayout",void 0),(0,r.A)(this,"bindGroup",void 0),(0,r.A)(this,"pipelineLayout",void 0)}async init(t){var e;this.adapter=await navigator.gpu.requestAdapter({powerPreference:null!==(e=this.options.powerPreference)&&void 0!==e?e:"high-performance"}),this.adapter||s.h2("not support webgpu render",l,86);const i=[];n.__(t,(t=>{this.adapter.features.has(t)&&i.push(t)})),this.device=await this.adapter.requestDevice({requiredFeatures:i.length?i:void 0}),this.device.lost.then((()=>{var t;this.destroyed||(this.lost=!0,s.z3("gpu device lost",l,105),null!==(t=this.options)&&void 0!==t&&t.onRenderContextLost&&this.options.onRenderContextLost())})),this.context=this.canvas.getContext("webgpu"),this.context||s.h2("can not support webgpu, got GPUCanvasContext failed",l,114),this.context.configure({device:this.device,format:navigator.gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),this.sampler=this.device.createSampler({magFilter:"linear",minFilter:"linear"}),this.vbo=this.device.createBuffer({size:28*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),this.rotateMatrixBuffer=this.device.createBuffer({size:16*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.setRotateMatrix(this.getRotateMatrix(0))}generatePipeline(){this.generateBindGroup(),this.pipelineLayout=this.device.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]}),this.vsModule=this.device.createShaderModule({code:this.vertexSource}),this.fsModule=this.device.createShaderModule({code:this.fragmentSource}),this.renderPipeline=this.device.createRenderPipeline({layout:this.pipelineLayout,vertex:{module:this.vsModule,entryPoint:"main",buffers:[{arrayStride:28,attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32x4"}]}]},fragment:{module:this.fsModule,entryPoint:"main",targets:[{format:navigator.gpu.getPreferredCanvasFormat()}]},primitive:{topology:"triangle-strip"}})}generateRenderBundleEncoder(){this.renderPipeline&&(this.renderBundleEncoder=this.device.createRenderBundleEncoder({colorFormats:[navigator.gpu.getPreferredCanvasFormat()]}),this.renderBundleEncoder.setPipeline(this.renderPipeline),this.renderBundleEncoder.setBindGroup(0,this.bindGroup),this.renderBundleEncoder.setVertexBuffer(0,this.vbo),this.renderBundleEncoder.draw(4,4,0,0),this.renderBundle=this.renderBundleEncoder.finish())}setRotateMatrix(t){this.rotateMatrix=t;const e=new Float32Array(this.rotateMatrix);this.device.queue.writeBuffer(this.rotateMatrixBuffer,0,e.buffer,e.byteOffset,e.byteLength)}setVertices(){const t=new Float32Array(this.vertex);this.device.queue.writeBuffer(this.vbo,0,t.buffer,t.byteOffset,t.byteLength)}clear(){this.context.getCurrentTexture().destroy()}layout(){let t=this.videoWidth,e=this.videoHeight,i=this.canvasWidth,r=this.canvasHeight;90!==this.rotate&&270!==this.rotate||(i=this.canvasHeight,r=this.canvasWidth);const s=t/i,a=e/r;let n;n=s>1?!(s<a):s>a,1===this.renderMode&&(n=!n);let l=0;if(this.textureWidth!==this.videoWidth&&(l=(this.textureWidth-this.videoWidth)/this.textureWidth),n){const s=(r-e*i/t)/r;this.vertex=[-1,1-s,0,0,0,0,0,-1,-1+s,0,0,1,0,0,1,1-s,0,1-l,0,0,0,1,-1+s,0,1-l,1,0,0]}else{const s=(i-t*r/e)/i;this.vertex=[-1+s,1,0,0,0,0,0,-1+s,-1,0,0,1,0,0,1-s,1,0,1-l,0,0,0,1-s,-1,0,1-l,1,0,0]}(0,o.A)(this.vertex,this.flipHorizontal,this.flipVertical),this.setVertices()}viewport(t,e){super.viewport(t,e)}setRotate(t){(t%=360)!==this.rotate&&(this.rotate=t,this.setRotateMatrix(this.getRotateMatrix(t)),this.layout(),this.clear())}destroy(){this.sampler=null,this.vbo&&this.vbo.destroy(),this.rotateMatrixBuffer&&this.rotateMatrixBuffer.destroy(),this.bindGroupLayout=null,this.bindGroup=null,this.pipelineLayout=null,this.renderBundle=null,this.renderBundleEncoder=null,this.fsModule=null,this.vsModule=null,this.renderPipeline=null,this.rotateMatrix=null,this.vertex=null,this.context=null,this.options=null,this.destroyed=!0,this.device&&(this.device.destroy(),this.device=null),this.adapter&&(this.adapter=null),super.destroy()}}},90058:(t,e,i)=>{"use strict";i.d(e,{A:()=>A});var r=i(134),s=i(61499),a=i(74503),n=i(63939),o=i(94300),l=i(49393),c=i(97317),h=i(14686),d=i(6110),u=i(62496),f=i(57914),p=i(57517),m=i(25669),g=i(20088),v=i(56024),y=i(72703);class A extends l.A{constructor(t,e){super(t,e),(0,r.A)(this,"metaYBuffer",void 0),(0,r.A)(this,"metaUBuffer",void 0),(0,r.A)(this,"metaVBuffer",void 0),(0,r.A)(this,"metaABuffer",void 0),(0,r.A)(this,"computeBindGroupLayout",void 0),(0,r.A)(this,"computeBindGroupY",void 0),(0,r.A)(this,"computeBindGroupU",void 0),(0,r.A)(this,"computeBindGroupV",void 0),(0,r.A)(this,"computeBindGroupA",void 0),(0,r.A)(this,"computePipelineLayout",void 0),(0,r.A)(this,"computePipeline",void 0),(0,r.A)(this,"inputYTexture",void 0),(0,r.A)(this,"inputUTexture",void 0),(0,r.A)(this,"inputVTexture",void 0),(0,r.A)(this,"inputATexture",void 0),(0,r.A)(this,"computeModule",void 0),(0,r.A)(this,"uint2Float",void 0),(0,r.A)(this,"hdrMetadata",void 0),(0,r.A)(this,"hdrMetadataBuffer",void 0),this.hdrMetadata=(0,a.A)(g.A),this.hdrMetadata.multiplier=1}generateFragmentSource(t,e,i){i.outputRGB=!0;const r=(0,m.A)(this.srcColorSpace,this.dstColorSpace,i);let s="textureSample(uTexture, s, in_texcoord.xy).x",a="textureSample(vTexture, s, in_texcoord.xy).x",n="1.0";23===t||189===t?(s="textureSample(uTexture, s, in_texcoord.xy).x",a="textureSample(uTexture, s, in_texcoord.xy).y"):24!==t&&190!==t||(s="textureSample(uTexture, s, in_texcoord.xy).y",a="textureSample(uTexture, s, in_texcoord.xy).x"),128&e.flags&&4===e.nbComponents&&(n="textureSample(aTexture, s, in_texcoord.xy).x"),this.fragmentSource=`\n      struct HdrMetadata {\n        offset: f32,\n        multiplier: f32,\n        pqTonemapA: f32,\n        pqTonemapB: f32,\n        hlgOOTFGammaMinusOne: f32,\n        hlgDstMaxLuminanceRelative: f32,\n        nitsToSdrRelativeFactor: f32,\n        sdrRelativeToNitsFactor: f32\n      };\n\n      @group(0) @binding(1) var s: sampler;\n      @group(0) @binding(2) var<uniform> hdrMetadata: HdrMetadata;\n      @group(0) @binding(3) var yTexture: texture_2d<f32>;\n      @group(0) @binding(4) var uTexture: texture_2d<f32>;\n\n      ${this.vTexture?"@group(0) @binding(5) var vTexture: texture_2d<f32>;":""}\n      ${this.aTexture?"@group(0) @binding(6) var aTexture: texture_2d<f32>;":""}\n\n      @fragment\n      fn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n\n        let offset = hdrMetadata.offset;\n        let multiplier = hdrMetadata.multiplier;\n        let pq_tonemap_a = hdrMetadata.pqTonemapA;\n        let pq_tonemap_b = hdrMetadata.pqTonemapB;\n        let hlg_ootf_gamma_minus_one = hdrMetadata.hlgOOTFGammaMinusOne;\n        let hlg_dst_max_luminance_relative = hdrMetadata.hlgDstMaxLuminanceRelative;\n        let nits_to_sdr_relative_factor = hdrMetadata.nitsToSdrRelativeFactor;\n        let sdr_relative_to_nits_factor = hdrMetadata.sdrRelativeToNitsFactor;\n\n        let y = textureSample(yTexture, s, in_texcoord.xy).x;\n        let u = ${s};\n        let v = ${a};\n        let alpha = ${n};\n        var color = vec4(y, u, v, alpha);\n\n        if (color.a > 0) {\n          color.r /= color.a;\n          color.g /= color.a;\n          color.b /= color.a;\n        }\n        color.r -= offset;\n        color.g -= offset;\n        color.b -= offset;\n\n        color.r *= multiplier;\n        color.g *= multiplier;\n        color.b *= multiplier;\n        \n        ${r.reduce(((t,e)=>t+e),"")}\n\n        color.r *= color.a;\n        color.g *= color.a;\n        color.b *= color.a;\n\n        return color;\n      }\n    `}async init(){await super.init(["float32-filterable"]),this.metaYBuffer=this.device.createBuffer({size:4*Uint32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.metaUBuffer=this.device.createBuffer({size:4*Uint32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.metaVBuffer=this.device.createBuffer({size:4*Uint32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.metaABuffer=this.device.createBuffer({size:4*Uint32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.hdrMetadataBuffer=this.device.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})}generateComputeBindGroup(){this.computeBindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,texture:{sampleType:"uint"}},{binding:2,visibility:GPUShaderStage.COMPUTE,storageTexture:{format:"r32float"}}]}),this.computeBindGroupY=this.device.createBindGroup({layout:this.computeBindGroupLayout,entries:[{binding:0,resource:{buffer:this.metaYBuffer,size:4*Uint32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.inputYTexture.createView()},{binding:2,resource:this.yTexture.createView()}]}),this.computeBindGroupU=this.device.createBindGroup({layout:this.computeBindGroupLayout,entries:[{binding:0,resource:{buffer:this.metaUBuffer,size:4*Uint32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.inputUTexture.createView()},{binding:2,resource:this.uTexture.createView()}]}),this.vTexture&&(this.computeBindGroupV=this.device.createBindGroup({layout:this.computeBindGroupLayout,entries:[{binding:0,resource:{buffer:this.metaVBuffer,size:4*Uint32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.inputVTexture.createView()},{binding:2,resource:this.vTexture.createView()}]})),this.aTexture&&(this.computeBindGroupA=this.device.createBindGroup({layout:this.computeBindGroupLayout,entries:[{binding:0,resource:{buffer:this.metaABuffer,size:4*Uint32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.inputATexture.createView()},{binding:2,resource:this.aTexture.createView()}]}))}generateComputePipeline(){this.generateComputeBindGroup(),this.computePipelineLayout=this.device.createPipelineLayout({bindGroupLayouts:[this.computeBindGroupLayout]}),this.computeModule=this.device.createShaderModule({code:this.uint2Float}),this.computePipeline=this.device.createComputePipeline({layout:this.computePipelineLayout,compute:{module:this.computeModule,entryPoint:"main"}})}generateBindGroup(){if(!this.yTexture)return;const t=[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}},{binding:4,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}];this.vTexture&&t.push({binding:5,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.aTexture&&t.push({binding:6,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.bindGroupLayout=this.device.createBindGroupLayout({entries:t});const e=[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.sampler},{binding:2,resource:{buffer:this.hdrMetadataBuffer,size:this.hdrMetadataBuffer.size}},{binding:3,resource:this.yTexture.createView()},{binding:4,resource:this.uTexture.createView()}];this.vTexture&&e.push({binding:5,resource:this.vTexture.createView()}),this.aTexture&&e.push({binding:6,resource:this.aTexture.createView()}),this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:e})}checkFrame(t){const e=c.g[n.f[15](t+80)];if(e&&(n.f[15](t+32)>>>1!==this.textureWidth||n.f[15](t+72)!==this.videoHeight||n.f[15](t+68)!==this.videoWidth||n.f[15](t+80)!==this.format)){this.yTexture&&this.yTexture.destroy(),this.uTexture&&this.uTexture.destroy(),this.vTexture&&this.vTexture.destroy(),this.aTexture&&this.aTexture.destroy(),this.inputYTexture&&this.inputYTexture.destroy(),this.inputUTexture&&this.inputUTexture.destroy(),this.inputVTexture&&this.inputVTexture.destroy(),this.inputATexture&&this.inputATexture.destroy(),this.yTexture=this.device.createTexture({size:[n.f[15](t+32)>>>1,n.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING,format:"r32float"}),this.uTexture=this.device.createTexture({size:[n.f[15](t+32+4)>>>1,n.f[15](t+72)>>>e.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING,format:"r32float"}),e.comp[1].plane!==e.comp[2].plane&&(this.vTexture=this.device.createTexture({size:[n.f[15](t+32+8)>>>1,n.f[15](t+72)>>>e.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING,format:"r32float"})),4===e.nbComponents&&(this.aTexture=this.device.createTexture({size:[n.f[15](t+32+12)>>>1,n.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING,format:"r32float"})),this.inputYTexture=this.device.createTexture({size:[this.yTexture.width,this.yTexture.height],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,format:"r16uint"}),this.inputUTexture=this.device.createTexture({size:[this.uTexture.width,this.uTexture.height],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,format:"r16uint"}),e.comp[1].plane!==e.comp[2].plane&&(this.inputVTexture=this.device.createTexture({size:[this.vTexture.width,this.vTexture.height],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,format:"r16uint"})),4===e.nbComponents&&(this.inputATexture=this.device.createTexture({size:[this.aTexture.width,this.aTexture.height],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,format:"r16uint"}));const i=new Uint32Array([(1<<e.comp[0].depth)-1,this.inputYTexture.width,this.inputYTexture.height]);this.device.queue.writeBuffer(this.metaYBuffer,0,i.buffer,i.byteOffset,i.byteLength);const r=new Uint32Array([(1<<e.comp[1].depth)-1,this.inputUTexture.width,this.inputUTexture.height]);if(this.device.queue.writeBuffer(this.metaUBuffer,0,r.buffer,r.byteOffset,r.byteLength),e.comp[1].plane!==e.comp[2].plane){const t=new Uint32Array([(1<<e.comp[2].depth)-1,this.inputVTexture.width,this.inputVTexture.height]);this.device.queue.writeBuffer(this.metaVBuffer,0,t.buffer,t.byteOffset,t.byteLength)}if(4===e.nbComponents){const t=new Uint32Array([(1<<e.comp[3].depth)-1,this.inputATexture.width,this.inputATexture.height]);this.device.queue.writeBuffer(this.metaABuffer,0,t.buffer,t.byteOffset,t.byteLength)}this.srcColorSpace=new d.A(n.f[15](t+220),n.f[15](t+212),n.f[15](t+216),n.f[15](t+208)),this.videoWidth=n.f[15](t+68),this.videoHeight=n.f[15](t+72),this.textureWidth=n.f[15](t+32)>>>1,this.format=n.f[15](t+80);const a={type:1,bitDepth:e.comp[0].depth,toneMapPQAndHlgToDst:!0,metadata:this.hdrMetadata,dstSdrMaxLuminanceNits:p.kH,dstMaxLuminanceRelative:1},o=(0,v.aH)(t,14);if(o){const t=n.f[20](o+4);n.f[8](t)>0&&(a.maxContentLightLevel=n.f[8](t))}this.generateFragmentSource(n.f[15](t+80),e,a),this.uint2Float=1&e.flags?f.A:u.A,this.layout(),this.generatePipeline(),this.generateRenderBundleEncoder(),this.generateComputePipeline();const l=(0,h.s3)(this.hdrMetadata[s.o9],32).slice();this.device.queue.writeBuffer(this.hdrMetadataBuffer,0,l.buffer,l.byteOffset,l.byteLength)}}render(t){if(this.lost)return;this.checkFrame(t);const e=this.device.createCommandEncoder(),i=e.beginComputePass({});i.setPipeline(this.computePipeline),i.setBindGroup(0,this.computeBindGroupY),this.device.queue.writeTexture({texture:this.inputYTexture},(0,h.s3)(n.f[20](t),this.inputYTexture.width*this.inputYTexture.height<<1),{offset:0,bytesPerRow:this.inputYTexture.width<<1,rowsPerImage:this.inputYTexture.height},{width:this.inputYTexture.width,height:this.inputYTexture.height,depthOrArrayLayers:1}),i.dispatchWorkgroups(this.inputYTexture.width+7>>>3,this.inputYTexture.height+7>>>3),i.setBindGroup(0,this.computeBindGroupU),this.device.queue.writeTexture({texture:this.inputUTexture},(0,h.s3)(n.f[20](t+4),this.inputUTexture.width*this.inputUTexture.height<<1),{offset:0,bytesPerRow:this.inputUTexture.width<<1,rowsPerImage:this.inputUTexture.height},{width:this.inputUTexture.width,height:this.inputUTexture.height,depthOrArrayLayers:1}),i.dispatchWorkgroups(this.inputUTexture.width+7>>>3,this.inputUTexture.height+7>>>3),this.inputVTexture&&(i.setBindGroup(0,this.computeBindGroupV),this.device.queue.writeTexture({texture:this.inputVTexture},(0,h.s3)(n.f[20](t+8),this.inputVTexture.width*this.inputVTexture.height<<1),{offset:0,bytesPerRow:this.inputVTexture.width<<1,rowsPerImage:this.inputVTexture.height},{width:this.inputVTexture.width,height:this.inputVTexture.height,depthOrArrayLayers:1}),i.dispatchWorkgroups(this.inputVTexture.width+7>>>3,this.inputVTexture.height+7>>>3)),this.inputATexture&&(i.setBindGroup(0,this.computeBindGroupA),this.device.queue.writeTexture({texture:this.inputATexture},(0,h.s3)(n.f[20](t+12),this.inputATexture.width*this.inputATexture.height<<1),{offset:0,bytesPerRow:this.inputATexture.width<<1,rowsPerImage:this.inputATexture.height},{width:this.inputATexture.width,height:this.inputATexture.height,depthOrArrayLayers:1}),i.dispatchWorkgroups(this.inputATexture.width+7>>>3,this.inputATexture.height+7>>>3)),i.end();const r=e.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});r.executeBundles([this.renderBundle]),r.end(),this.device.queue.submit([e.finish()])}destroy(){this.inputYTexture&&(this.inputYTexture.destroy(),this.inputYTexture=null),this.inputUTexture&&(this.inputUTexture.destroy(),this.inputUTexture=null),this.inputVTexture&&(this.inputVTexture.destroy(),this.inputVTexture=null),this.metaYBuffer&&(this.metaYBuffer.destroy(),this.metaYBuffer=null),this.metaUBuffer&&(this.metaUBuffer.destroy(),this.metaUBuffer=null),this.metaVBuffer&&(this.metaVBuffer.destroy(),this.metaVBuffer=null),this.hdrMetadata&&((0,o.A)(this.hdrMetadata),this.hdrMetadata=null),this.computeModule=null,this.computeBindGroupY=null,this.computeBindGroupU=null,this.computeBindGroupV=null,this.computeBindGroupLayout=null,this.computePipelineLayout=null,this.computePipeline=null,super.destroy()}static isSupport(t){if((0,y.A)(t)){const e=c.g[n.f[15](t+80)];if(e)return!(32&e.flags)&&16&e.flags&&e.comp[0].depth+7>>>3==2}return!1}}},37977:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var r=i(63939),s=i(49393),a=i(97317),n=i(14686),o=i(6110),l=i(25669),c=i(72703);class h extends s.A{constructor(t,e){super(t,e)}generateFragmentSource(t,e){const i=(0,l.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:1,outputRGB:!0});let r="textureSample(uTexture, s, in_texcoord.xy).x",s="textureSample(vTexture, s, in_texcoord.xy).x",a="1.0";23===t||189===t?(r="textureSample(uTexture, s, in_texcoord.xy).x",s="textureSample(uTexture, s, in_texcoord.xy).y"):24!==t&&190!==t||(r="textureSample(uTexture, s, in_texcoord.xy).y",s="textureSample(uTexture, s, in_texcoord.xy).x"),128&e.flags&&4===e.nbComponents&&(a="textureSample(aTexture, s, in_texcoord.xy).x"),this.fragmentSource=`\n      @group(0) @binding(1) var s: sampler;\n      @group(0) @binding(2) var yTexture: texture_2d<f32>;\n      @group(0) @binding(3) var uTexture: texture_2d<f32>;\n      ${this.vTexture?"@group(0) @binding(4) var vTexture: texture_2d<f32>;":""}\n      ${this.aTexture?"@group(0) @binding(5) var aTexture: texture_2d<f32>;":""}\n      \n      @fragment\n      fn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n        let y = textureSample(yTexture, s, in_texcoord.xy).x;\n        let u = ${r};\n        let v = ${s};\n        let alpha = ${a};\n        var color = vec4(y, u, v, alpha);\n        ${i.reduce(((t,e)=>t+e),"")}\n        return color;\n      }\n    `}checkFrame(t){const e=a.g[r.f[15](t+80)];e&&(r.f[15](t+32)===this.textureWidth&&r.f[15](t+72)===this.videoHeight&&r.f[15](t+68)===this.videoWidth||(this.yTexture&&this.yTexture.destroy(),this.uTexture&&this.uTexture.destroy(),this.vTexture&&this.vTexture.destroy(),this.aTexture&&this.aTexture.destroy(),this.yTexture=this.device.createTexture({size:[r.f[15](t+32),r.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"}),this.uTexture=this.device.createTexture({size:[r.f[15](t+32+4),r.f[15](t+72)>>>a.g[r.f[15](t+80)].log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"}),e.comp[1].plane!==e.comp[2].plane&&(this.vTexture=this.device.createTexture({size:[r.f[15](t+32+8),r.f[15](t+72)>>>a.g[r.f[15](t+80)].log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"})),4===e.nbComponents&&(this.aTexture=this.device.createTexture({size:[r.f[15](t+32+12),r.f[15](t+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"})),this.srcColorSpace=new o.A(r.f[15](t+220),r.f[15](t+212),r.f[15](t+216),r.f[15](t+208)),this.generateFragmentSource(r.f[15](t+80),e),this.videoWidth=r.f[15](t+68),this.videoHeight=r.f[15](t+72),this.textureWidth=r.f[15](t+32),this.format=r.f[15](t+80),this.layout(),this.generatePipeline(),this.generateRenderBundleEncoder()))}render(t){if(this.lost)return;this.checkFrame(t),this.device.queue.writeTexture({texture:this.yTexture},(0,n.s3)(r.f[20](t),this.yTexture.width*this.yTexture.height),{offset:0,bytesPerRow:this.yTexture.width,rowsPerImage:this.yTexture.height},{width:this.yTexture.width,height:this.yTexture.height,depthOrArrayLayers:1}),this.device.queue.writeTexture({texture:this.uTexture},(0,n.s3)(r.f[20](t+4),this.uTexture.width*this.uTexture.height),{offset:0,bytesPerRow:this.uTexture.width,rowsPerImage:this.uTexture.height},{width:this.uTexture.width,height:this.uTexture.height,depthOrArrayLayers:1}),this.vTexture&&this.device.queue.writeTexture({texture:this.vTexture},(0,n.s3)(r.f[20](t+8),this.vTexture.width*this.vTexture.height),{offset:0,bytesPerRow:this.vTexture.width,rowsPerImage:this.vTexture.height},{width:this.vTexture.width,height:this.vTexture.height,depthOrArrayLayers:1}),this.aTexture&&this.device.queue.writeTexture({texture:this.aTexture},(0,n.s3)(r.f[20](t+12),this.aTexture.width*this.aTexture.height),{offset:0,bytesPerRow:this.aTexture.width,rowsPerImage:this.aTexture.height},{width:this.aTexture.width,height:this.aTexture.height,depthOrArrayLayers:1});const e=this.device.createCommandEncoder(),i=e.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});i.executeBundles([this.renderBundle]),i.end(),this.device.queue.submit([e.finish()])}static isSupport(t){if((0,c.A)(t)){const e=a.g[r.f[15](t+80)];if(e)return!(32&e.flags)&&16&e.flags&&e.comp[0].depth+7>>>3==1}return!1}}},49393:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(54895),a=i(15045);class n extends a.A{constructor(t,e){super(t,e),(0,r.A)(this,"yTexture",void 0),(0,r.A)(this,"uTexture",void 0),(0,r.A)(this,"vTexture",void 0),(0,r.A)(this,"aTexture",void 0),this.vertexSource=s.A}generateBindGroup(){if(!this.yTexture)return;const t=[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}},{binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}];this.vTexture&&t.push({binding:4,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.aTexture&&t.push({binding:5,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.bindGroupLayout=this.device.createBindGroupLayout({entries:t});const e=[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.sampler},{binding:2,resource:this.yTexture.createView()},{binding:3,resource:this.uTexture.createView()}];this.vTexture&&e.push({binding:4,resource:this.vTexture.createView()}),this.aTexture&&e.push({binding:5,resource:this.aTexture.createView()}),this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:e})}destroy(){this.yTexture&&this.yTexture.destroy(),this.uTexture&&this.uTexture.destroy(),this.vTexture&&this.vTexture.destroy(),this.aTexture&&this.aTexture.destroy(),super.destroy()}}},6110:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(134),s=i(12535),a=i(1064),n=i(86141),o=i(91131);class l{constructor(t,e,i,s){(0,r.A)(this,"matrixId",void 0),(0,r.A)(this,"primaryId",void 0),(0,r.A)(this,"transferId",void 0),(0,r.A)(this,"rangeId",void 0),this.matrixId=t,this.primaryId=e,this.transferId=i,this.rangeId=s}getMatrixId(){return this.matrixId}getPrimaryId(){return this.primaryId}getTransferId(){return this.transferId}getRangeId(){return this.rangeId}isWide(){return 9===this.primaryId||11===this.primaryId||12===this.primaryId}isHDR(){return 18===this.transferId||16===this.transferId}isToneMappedByDefault(){return 18===this.transferId||16===this.transferId}isAffectedBySDRWhiteLevel(){return 18===this.transferId||16===this.transferId}fullRangeEncodedValues(){return 12===this.transferId||11===this.transferId}getTransferMatrix(t){const e=(1<<t-1)/((1<<t)-1);let i=0,r=0;switch(this.matrixId){case 0:return new s.A;case 1:case 2:i=.2126,r=.0722;break;case 4:i=.3,r=.11;break;case 5:case 6:i=.299,r=.114;break;case 7:i=.212,r=.087;break;case 8:return s.A.RowMajor([.25,.5,.25,0,-.25,.5,-.25,e,.5,0,-.5,e,0,0,0,1]);case 10:return i=.2627,r=.0593,s.A.RowMajor([1,0,0,0,i,1-i-r,r,0,0,0,1,0,0,0,0,1]);case 9:i=.2627,r=.0593;break;case 11:return s.A.RowMajor([0,1,0,0,0,-.5,.493283,.5,.5,-.495951,0,.5,0,0,0,1])}let a=1-i-r,n=.5/(1-r),o=.5/(1-i);return s.A.RowMajor([i,a,r,0,n*-i,n*-a,n*(1-r),.5,o*(1-i),o*-a,o*-r,.5,0,0,0,1])}getRangeAdjustMatrix(t){if(2===this.rangeId)return new s.A;const e=t-8,i=(1<<t)-1,r=i/(219<<e);switch(this.matrixId){case 0:case 8:return(new s.A).setScale(new a.P([r,r,r])).postTranslate(new a.P([-16/219,-16/219,-16/219]));case 1:case 4:case 5:case 6:case 7:case 9:case 10:case 11:case 2:{const t=224<<e,n=i/t,o=(t-i)/(2*t);return(new s.A).setScale(new a.P([r,n,n])).postTranslate(new a.P([-16/219,o,o]))}}return new s.A}getTransferFunction_(){switch(this.transferId){case 8:return n.Hi;case 4:return n.$_;case 5:return n.J7;case 7:return n.q;case 1:case 6:case 14:case 15:return n.aP;case 17:return n.Cr;case 18:case 12:case 9:case 10:case 16:case 2:return null}}getTransferFunction(t){return this.transferId,this.getTransferFunction_()}getInverseTransferFunction(t){const e=this.getTransferFunction(t);if(e){const t={a:0,b:0,c:0,d:0,e:0,f:0,g:0};if(e.a>0&&e.g>0){const i=Math.pow(e.a,e.g);t.a=1/i,t.b=-e.e/i,t.g=1/e.g}return t.d=e.c*e.d+e.f,t.e=-e.b/e.a,0!=e.c&&(t.c=1/e.c,t.f=-e.f/e.c),t}}hasExtendedSkTransferFn(){return 0===this.matrixId}isValid(){return 2!==this.matrixId&&2!==this.primaryId&&2!==this.transferId&&0!==this.rangeId}getColorSpacePrimaries(){const t=o.WO;switch(this.primaryId){case 1:return o.P5;case 4:return o.Wc;case 5:return o.cA;case 7:return o.vi;case 8:return o.cp;case 9:return o.Je;case 10:return o.lf;case 11:return o.Rk;case 12:return o.tR}return t}getPrimaryMatrix(){const t=this.getColorSpacePrimaries(),e=o._O(t);return s.A.RowMajor([e.rc(0,0),e.rc(0,1),e.rc(0,2),0,e.rc(1,0),e.rc(1,1),e.rc(1,2),0,e.rc(2,0),e.rc(2,1),e.rc(2,2),0,0,0,0,1])}}},91131:(t,e,i)=>{"use strict";i.d(e,{Je:()=>u,P5:()=>o,Rk:()=>p,WO:()=>g,Wc:()=>l,_O:()=>v,cA:()=>c,cp:()=>d,lf:()=>f,tR:()=>m,vi:()=>h});var r=i(45726),s=i(1064),a=i(66551),n=i(60153);const o=[.64,.33,.3,.6,.15,.06,.3127,.329],l=[.67,.33,.21,.71,.14,.08,.31,.316],c=[.64,.33,.29,.6,.15,.06,.3127,.329],h=[.63,.34,.31,.595,.155,.07,.3127,.329],d=[.681,.319,.243,.692,.145,.049,.31,.316],u=[.708,.292,.17,.797,.131,.046,.3127,.329],f=[1,0,0,1,0,0,.3333333333333333,.3333333333333333],p=[.68,.32,.265,.69,.15,.06,.314,.351],m=[.68,.32,.265,.69,.15,.06,.3127,.329],g=[0,0,0,0,0,0,0,0];function v(t){const e=r.A.RowMajor([t[0],t[2],t[4],t[1],t[3],t[5],1-t[0]-t[1],1-t[2]-t[3],1-t[4]-t[5]]),i=e.copy().invert(),o=new s.P([t[6]/t[7],1,(1-t[6]-t[7])/t[7]]),l=(0,n.Y3)(i,o);let c=new r.A([l.x,0,0,0,l.y,0,0,0,l.z]);c=(0,a.B)(e,c);const h=function(t,e){const i=new s.P([t/e,1,(1-t-e)/e]),o=new s.P([.96422,1,.82521]),l=r.A.RowMajor([.8951,.2664,-.1614,-.7502,1.7135,.0367,.0389,-.0685,1.0296]),c=r.A.RowMajor([.9869929,-.1470543,.1599627,.4323053,.5183603,.0492912,-.0085287,.0400428,.9684867]),h=(0,n.Y3)(l,i),d=(0,n.Y3)(l,o);let u=new r.A([d.x/h.x,0,0,0,d.y/h.y,0,0,0,d.z/h.z]);return u=(0,a.B)(u,l),u=(0,a.B)(c,u),u}(t[6],t[7]);return(0,a.B)(h,c)}},86141:(t,e,i)=>{"use strict";i.d(e,{$_:()=>r,Cr:()=>l,Hi:()=>n,J7:()=>s,aP:()=>o,q:()=>a});const r={g:2.2,a:1,b:0,c:0,d:0,e:0,f:0},s={g:2.8,a:1,b:0,c:0,d:0,e:0,f:0},a={g:2.222222222222,a:.899626676224,b:.100373323776,c:.25,d:.091286342118,e:0,f:0},n={g:1,a:1,b:0,c:0,d:0,e:0,f:0},o={g:2.4,a:.9478672985781991,b:.05213270142180095,c:.07739938080495357,d:.04045,e:0,f:0},l={g:2.6,a:1.034080527699,b:0,c:0,d:0,e:0,f:0}},89401:(t,e,i)=>{"use strict";i.d(e,{A:()=>l,U:()=>o});var r=i(57517);const s=.2627,a=.678,n=.0593;function o(t){t.metadata.hlgDstMaxLuminanceRelative=t.dstMaxLuminanceRelative;const e=t.dstSdrMaxLuminanceNits*t.dstMaxLuminanceRelative;t.metadata.hlgOOTFGammaMinusOne=1.2+.42*Math.log10(e/r.hD)/Math.log10(10)-1}function l(t){return 0===t.type?`\n      {\n        vec4 luma_vec = vec4(${s}, ${a}, ${n}, 0.0);\n        float L = dot(color, luma_vec);\n        if (L > 0.0) {\n          color.r *= pow(L, hlg_ootf_gamma_minus_one);\n          color.g *= pow(L, hlg_ootf_gamma_minus_one);\n          color.b *= pow(L, hlg_ootf_gamma_minus_one);\n          color.r *= hlg_dst_max_luminance_relative;\n          color.g *= hlg_dst_max_luminance_relative;\n          color.b *= hlg_dst_max_luminance_relative;\n        }\n      }\n    `:1===t.type?`\n      {\n        let luma_vec: vec4<f32> = vec4(${s}, ${a}, ${n}, 0.0);\n        let L: f32 = dot(color, luma_vec);\n        if (L > 0.0) {\n          color.r *= pow(L, hlg_ootf_gamma_minus_one);\n          color.g *= pow(L, hlg_ootf_gamma_minus_one);\n          color.b *= pow(L, hlg_ootf_gamma_minus_one);\n          color.r *= hlg_dst_max_luminance_relative;\n          color.g *= hlg_dst_max_luminance_relative;\n          color.b *= hlg_dst_max_luminance_relative;\n        }\n      }\n    `:""}},7511:(t,e,i)=>{"use strict";function r(t,e){let i="",r="";if(0===e.type?(i="mat4",r="vec4"):1===e.type&&(i="mat4x4",r="vec4"),!i||!r)return"";let s=`\n      color = ${i}(\n        ${t.rc(0,0)}, ${t.rc(1,0)}, ${t.rc(2,0)}, 0,\n        ${t.rc(0,1)}, ${t.rc(1,1)}, ${t.rc(2,1)}, 0,\n        ${t.rc(0,2)}, ${t.rc(1,2)}, ${t.rc(2,2)}, 0,\n        0, 0, 0, 1\n      ) * color;\n    `;return 0===t.rc(0,3)&&0===t.rc(1,3)&&0===t.rc(2,3)||(s+=`\n        color += ${r}(${t.rc(0,3)}, ${t.rc(1,3)}, ${t.rc(2,3)}, 0);\n      `),s}i.d(e,{A:()=>r})},79955:(t,e,i)=>{"use strict";function r(t,e){e.metadata.sdrRelativeToNitsFactor=e.dstSdrMaxLuminanceNits/t}function s(t){return"\n    color.r *= sdr_relative_to_nits_factor;\n    color.g *= sdr_relative_to_nits_factor;\n    color.b *= sdr_relative_to_nits_factor;\n "}i.d(e,{A:()=>s,j:()=>r})},64748:(t,e,i)=>{"use strict";i.d(e,{A:()=>a,n:()=>s});var r=i(57517);function s(t,e,i){let s=i.dstSdrMaxLuminanceNits;e&&(s=r.kH,i.ndwl&&(s=i.ndwl)),i.metadata.nitsToSdrRelativeFactor=t/s}function a(t){return"\n    color.r *= nits_to_sdr_relative_factor;\n    color.g *= nits_to_sdr_relative_factor;\n    color.b *= nits_to_sdr_relative_factor;\n  "}},70194:(t,e,i)=>{"use strict";i.d(e,{A:()=>a,J:()=>s});var r=i(57517);function s(t,e){const i=function(t,e){let i=r.hD;return 18!==t.getTransferId()&&e.maxContentLightLevel>0&&(i=e.maxContentLightLevel),i/e.dstSdrMaxLuminanceNits}(t,e);i>e.dstMaxLuminanceRelative?(e.metadata.pqTonemapA=e.dstMaxLuminanceRelative/(i*i),e.metadata.pqTonemapB=1/e.dstMaxLuminanceRelative):(e.metadata.pqTonemapA=0,e.metadata.pqTonemapB=0)}function a(t){return`\n    {\n      ${1===t.type?"let maximum: f32":"float maximum"} = max(color.r, max(color.g, color.b));\n      if (maximum > 0.0) {\n        color.r *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n        color.g *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n        color.b *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n      }\n    }\n `}},15380:(t,e,i)=>{"use strict";function r(t){return t===t>>>0?`${t}.0`:t.toString()}i.d(e,{A:()=>r})},25669:(t,e,i)=>{"use strict";i.d(e,{A:()=>v});var r=i(6110),s=i(57517),a=i(7511),n=i(5361),o=i(63921),l=i(55168),c=i(16307),h=i(89401),d=i(64748),u=i(70194),f=i(79955),p=i(84272),m=i(51025),g=i(40326);function v(t,e,i){const v=[],y=8===t.getMatrixId(),A=(0,a.A)(t.getRangeAdjustMatrix(i.bitDepth),i);if(y||v.push(A),10===t.getMatrixId()||v.push((0,a.A)(t.getTransferMatrix(i.bitDepth).invert(),i)),y&&v.push(A),e.isValid()){if(t.isHDR()){switch(t.getTransferId()){case 18:v.push((0,n.A)(i));break;case 16:v.push((0,o.A)(i));break;default:const e=t.getTransferFunction();e?v.push((0,l.A)(e,t.hasExtendedSkTransferFn(),i)):v.push((0,c.A)(t.getTransferId(),i))}10===t.getMatrixId()&&v.push((0,a.A)(t.getTransferMatrix(i.bitDepth).invert(),i)),v.push((0,a.A)(t.getPrimaryMatrix(),i));const y=new r.A(0,9,8,2);switch(t.getTransferId()){case 18:i.toneMapPQAndHlgToDst?((0,h.U)(i),v.push((0,h.A)(i))):((0,d.n)(12/s.kH,!1,i),v.push((0,d.A)(i)));break;case 16:(0,d.n)(s.th,!0,i),v.push((0,d.A)(i)),i.toneMapPQAndHlgToDst&&(v.push((0,a.A)(y.getPrimaryMatrix().invert(),i)),(0,u.J)(t,i),v.push((0,u.A)(i)),v.push((0,a.A)(y.getPrimaryMatrix(),i)))}switch(v.push((0,a.A)(e.getPrimaryMatrix().invert(),i)),10===e.getMatrixId()&&v.push((0,a.A)(e.getTransferMatrix(i.bitDepth),i)),e.getTransferId()){case 18:(0,f.j)(s.kH,i),v.push((0,f.A)(i)),v.push((0,p.A)(i));break;case 16:(0,f.j)(s.th,i),v.push((0,f.A)(i)),v.push((0,m.A)(i));default:const r=e.getInverseTransferFunction();r?v.push((0,l.A)(r,t.hasExtendedSkTransferFn(),i)):v.push((0,g.A)(t.getTransferId(),i))}}if(!i.outputRGB){const t=8===e.getMatrixId(),r=(0,a.A)(e.getRangeAdjustMatrix(i.bitDepth).invert(),i);t&&v.push(r),10===e.getMatrixId()||v.push((0,a.A)(e.getTransferMatrix(i.bitDepth),i)),t||v.push(r)}}return v}},57517:(t,e,i)=>{"use strict";i.d(e,{hD:()=>s,kH:()=>r,th:()=>a});const r=203,s=1e3,a=1e4},71323:(t,e,i)=>{"use strict";function r(t,e,i){return e?`\n      {\n        ${1===i.type?"var v: f32":"float v"} = abs(color.r);\n        ${t()}\n        color.r = sign(color.r) * v;\n      }\n      {\n        ${1===i.type?"var v: f32":"float v"} = abs(color.g);\n        ${t()}\n        color.g = sign(color.g) * v;\n      }\n      {\n        ${1===i.type?"var v: f32":"float v"} = abs(color.b);\n        ${t()}\n        color.b = sign(color.b) * v;\n      }\n    `:`\n      {\n        ${1===i.type?"var v: f32":"float v"} = color.r;\n        ${t()}\n        color.r = v;\n      }\n      {\n        ${1===i.type?"var v: f32":"float v"} = color.g;\n        ${t()}\n        color.g = v;\n      }\n      {\n        ${1===i.type?"var v: f32":"float v"} = color.b;\n        ${t()}\n        color.b = v;\n      }\n    `}i.d(e,{A:()=>r})},40326:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(71323);function s(t,e){return(0,r.A)((function(){switch(t){case 9:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v =  1.0 + log(v) / log(10.0) / 2.0;\n          }\n        ";case 10:return"\n          if (v < sqrt(10.0) / 1000.0)\n            v = 0.0;\n          }\n          else {\n            v = 1.0 + log(v) / log(10.0) / 2.5;\n          }\n        ";case 11:return`\n          ${1===e.type?"let a: f32":"float a"} = 1.099296826809442;\n          ${1===e.type?"let b: f32":"float b"}= 0.018053968510807;\n          if (v < -b) {\n            v = -a * pow(-v, 0.45) + (a - 1.0);\n          }\n          else if (v <= b) {\n            v = 4.5 * v;\n          }\n          else {\n            v = a * pow(v, 0.45) - (a - 1.0);\n          }\n        `;case 12:return`\n          ${1===e.type?"let a: f32":"float a"} = 1.099;\n          ${1===e.type?"let b: f32":"float b"} = 0.018;\n          ${1===e.type?"let l: f32":"float l"} = 0.0045;\n\n          if (v < -l) {\n            v = -(a * pow(-4.0 * v, 0.45) + (a - 1.0)) / 4.0;\n          }\n          else if (v <= b) {\n            v = 4.5 * v;\n          }\n          else {\n            v = a * pow(v, 0.45) - (a - 1.0);\n          }\n        `;default:return""}}),!1,e)}},5361:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(71323);function s(t){return(0,r.A)((function(){return`\n      v = max(0.0, v);\n      ${1===t.type?"let a: f32":"float a"} = 0.17883277f;\n      ${1===t.type?"let b: f32":"float b"} = 0.28466892f;\n      ${1===t.type?"let c: f32":"float c"} = 0.55991073f;\n      if (v <= 0.5) {\n        v = v * v + 4.0;\n      }\n      else {\n        v = exp((v - c) / a) + b;\n      }\n      v = v / 12.0;\n    `}),!1,t)}},84272:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(71323);function s(t){return(0,r.A)((function(){return`\n      v = max(0.0, v);\n      ${1===t.type?"let a: f32":"float a"} = 0.17883277f;\n      ${1===t.type?"let b: f32":"float b"} = 0.28466892f;\n      ${1===t.type?"let c: f32":"float c"} = 0.55991073f;\n      if (v <= 1.0) {\n        v = 0.5 * sqrt(v);\n      }\n      else {\n        v = a * log(v - b) + c;\n      }\n    `}),!1,t)}},63921:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(71323);function s(t){return(0,r.A)((function(){return`\n      v = max(0.0, v);\n      ${1===t.type?"let m1: f32":"float m1"} = (2610.0 / 4096.0) / 4.0;\n      ${1===t.type?"let m2: f32":"float m2"} = (2523.0 / 4096.0) * 128.0;\n      ${1===t.type?"let c1: f32":"float c1"} = 3424.0 / 4096.0;\n      ${1===t.type?"let c2: f32":"float c2"} = (2413.0 / 4096.0) * 32.0;\n      ${1===t.type?"let c3: f32":"float c3"} = (2392.0 / 4096.0) * 32.0;\n      \n      ${0===t.type?"\n        #ifdef GL_FRAGMENT_PRECISION_HIGH\n        highp float v2 = v;\n        #else\n        float v2 = v;\n        #endif\n      ":"var v2: f32 = v;"}\n  \n      v2 = pow(max(pow(v2, 1.0 / m2) - c1, 0.0) / (c2 - c3 * pow(v2, 1.0 / m2)), 1.0 / m1);\n      v = v2;\n    `}),!1,t)}},51025:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(71323);function s(t){return(0,r.A)((function(){return`\n      v = max(0.0, v);\n      ${1===t.type?"let m1: f32":"float m1"} = (2610.0 / 4096.0) / 4.0;\n      ${1===t.type?"let m2: f32":"float m2"} = (2523.0 / 4096.0) * 128.0;\n      ${1===t.type?"let c1: f32":"float c1"} = 3424.0 / 4096.0;\n      ${1===t.type?"let c2: f32":"float c2"} = (2413.0 / 4096.0) * 32.0;\n      ${1===t.type?"let c3: f32":"float c3"} = (2392.0 / 4096.0) * 32.0;\n      v =  pow((c1 + c2 * pow(v, m1)) / (1.0 + c3 * pow(v, m1)), m2);\n    `}),!1,t)}},16307:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(71323);function s(t,e){return(0,r.A)((function(){switch(t){case 9:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v = pow(10.0, (v - 1.0) * 2.0);\n          }\n        ";case 10:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v = pow(10.0, (v - 1.0) * 2.5);\n          }\n        ";case 11:return`\n          ${1===e.type?"let a: f32":"float a"} = 1.099296826809442;\n          ${1===e.type?"let from_linear_neg_a: f32":"float from_linear_neg_a"} = -1.047844;\n          ${1===e.type?"let from_linear_b: f32":"float from_linear_b"} = 0.081243;\n          if (v < from_linear_neg_a) {\n            v = -pow((a - 1.0 - v) / a, 1.0 / 0.45);\n          }\n          else if (v <= from_linear_b) {\n            v = v / 4.5;\n          }\n          else {\n            v = pow((v + a - 1.0) / a, 1.0 / 0.45);\n          }\n        `;case 12:return`\n          ${1===e.type?"let a: f32":"float a"} = 1.099;\n          ${1===e.type?"let from_linear_neg_l: f32":"float from_linear_neg_l"} = -0.020250;\n          ${1===e.type?"let from_linear_b: f32":"float from_linear_b"} = 0.081000;\n          if (v < from_linear_neg_l) {\n            v = -pow((1.0 - a - v * 4.0) / a, 1.0 / 0.45) / 4.0;\n          }\n          else if (v <= from_linear_b) {\n            v = v / 4.5;\n          }\n          else {\n            v = pow((v + a - 1.0) / a, 1.0 / 0.45);\n          }\n        `;default:return""}}),!1,e)}},55168:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(71323),s=i(15380);function a(t,e,i){return(0,r.A)((function(){let e=.0009765625,i="v";Math.abs(t.c-1)>e&&(i=`${(0,s.A)(t.c)} * ${i}`),Math.abs(t.f)>e&&(i=`${i} + ${(0,s.A)(t.f)}`);let r="v";return Math.abs(t.a=1)>e&&(r=`${(0,s.A)(t.a)} * ${r}`),Math.abs(t.b)>e&&(r=`${r} + ${(0,s.A)(t.b)}`),Math.abs(t.g-1)>e&&(r=`pow(${r}, ${(0,s.A)(t.g)})`),Math.abs(t.e)>e&&(r=`${r} + ${(0,s.A)(t.e)}`),`\n      if (v < ${(0,s.A)(t.d)}) {\n        v = ${i};\n      }\n      else {\n        v = ${r};\n      }\n    `}),!1,i)}},38469:(t,e,i)=>{"use strict";function r(t,e,i){if(e){let e=t[3],i=t[4];t[3]=t[17],t[4]=t[18],t[17]=e,t[18]=i,e=t[10],i=t[11],t[10]=t[24],t[11]=t[25],t[24]=e,t[25]=i}if(i){let e=t[3],i=t[4];t[3]=t[10],t[4]=t[11],t[10]=e,t[11]=i,e=t[17],i=t[18],t[17]=t[24],t[18]=t[25],t[24]=e,t[25]=i}}i.d(e,{A:()=>r})},20088:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085);class h{constructor(){(0,a.A)(this,"offset",void 0),(0,a.A)(this,"multiplier",void 0),(0,a.A)(this,"pqTonemapA",void 0),(0,a.A)(this,"pqTonemapB",void 0),(0,a.A)(this,"hlgOOTFGammaMinusOne",void 0),(0,a.A)(this,"hlgDstMaxLuminanceRelative",void 0),(0,a.A)(this,"nitsToSdrRelativeFactor",void 0),(0,a.A)(this,"sdrRelativeToNitsFactor",void 0)}}r=h.prototype,(s=new(o())).set("offset",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("multiplier",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("pqTonemapA",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("pqTonemapB",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("hlgOOTFGammaMinusOne",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("hlgDstMaxLuminanceRelative",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("nitsToSdrRelativeFactor",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("sdrRelativeToNitsFactor",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,4),(0,c.A)(r,l.g7,32),(0,c.A)(r,l.JY,s)},36719:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(9188);class a extends s.A{constructor(t,e,i=!0){super(t,e),(0,r.A)(this,"enableColor",void 0),(0,r.A)(this,"aPoint",void 0),(0,r.A)(this,"aColor",void 0),this.enableColor=i}link(t){super.link(t),this.aPoint=this.gl.getAttribLocation(this.program,"point"),this.aColor=this.gl.getAttribLocation(this.program,"color"),this.enableColor?(this.gl.enableVertexAttribArray(this.aPoint),this.gl.enableVertexAttribArray(this.aColor)):this.gl.enableVertexAttribArray(this.aPoint)}bind(){super.bind(),this.enableColor?(this.gl.vertexAttribPointer(this.aPoint,3,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0),this.gl.vertexAttribPointer(this.aColor,4,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,3*Float32Array.BYTES_PER_ELEMENT)):this.gl.vertexAttribPointer(this.aPoint,3,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0)}}},9188:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(134);class s{constructor(t,e){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"_program",void 0),(0,r.A)(this,"vertexShader",void 0),(0,r.A)(this,"fragmentShader",void 0),this.vertexShader=t,this.fragmentShader=e}link(t){this.gl=t,this.vertexShader&&this.vertexShader.compile(this.gl),this.fragmentShader&&this.fragmentShader.compile(this.gl),this._program=this.gl.createProgram(),this.gl.attachShader(this._program,this.vertexShader.shader),this.gl.attachShader(this._program,this.fragmentShader.shader),this.gl.linkProgram(this._program)}stop(){this.vertexShader.stop(this.gl),this.fragmentShader.stop(this.gl),this.gl.deleteProgram(this._program),this.vertexShader=null,this.fragmentShader=null,this._program=null}bind(){this.gl.useProgram(this._program)}get program(){return this._program}}},32903:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(48091);class s extends r.A{constructor(t){super(t)}}},48091:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(24399);class a extends s.A{constructor(t){super(t),(0,r.A)(this,"rgbSamplerLocation",void 0)}link(t){super.link(t),this.rgbSamplerLocation=this.gl.getUniformLocation(this.program,"rgb_Sampler")}bindRGBTexture(t=0){this.gl.uniform1i(this.rgbSamplerLocation,t)}}},24399:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(134),s=i(36719),a=i(37022),n=i(36200),o=i(14397);class l extends s.A{constructor(t){super(new a.A(o.A),new n.A(t)),(0,r.A)(this,"rotateMatrixLocation",void 0)}link(t){super.link(t),this.rotateMatrixLocation=this.gl.getUniformLocation(this.program,"rotateMatrix")}setRotateMatrix(t){this.gl.uniformMatrix4fv(this.rotateMatrixLocation,!1,new Float32Array(t))}}},73039:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(1706);class a extends s.A{constructor(t){super(t),(0,r.A)(this,"maxUniformLocation",void 0),(0,r.A)(this,"offsetLocation",void 0),(0,r.A)(this,"multiplierLocation",void 0),(0,r.A)(this,"pqTonemapALocation",void 0),(0,r.A)(this,"pqTonemapBLocation",void 0),(0,r.A)(this,"hlgOOTFGammaMinusOneLocation",void 0),(0,r.A)(this,"hlgDstMaxLuminanceRelativeLocation",void 0),(0,r.A)(this,"nitsToSdrRelativeFactorLocation",void 0),(0,r.A)(this,"sdrRelativeToNitsFactorLocation",void 0)}link(t){super.link(t),this.maxUniformLocation=this.gl.getUniformLocation(this.program,"v_max"),this.offsetLocation=this.gl.getUniformLocation(this.program,"offset"),this.multiplierLocation=this.gl.getUniformLocation(this.program,"multiplier"),this.pqTonemapALocation=this.gl.getUniformLocation(this.program,"pq_tonemap_a"),this.pqTonemapBLocation=this.gl.getUniformLocation(this.program,"pq_tonemap_b"),this.hlgOOTFGammaMinusOneLocation=this.gl.getUniformLocation(this.program,"hlg_ootf_gamma_minus_one"),this.hlgDstMaxLuminanceRelativeLocation=this.gl.getUniformLocation(this.program,"hlg_dst_max_luminance_relative"),this.nitsToSdrRelativeFactorLocation=this.gl.getUniformLocation(this.program,"nits_to_sdr_relative_factor"),this.sdrRelativeToNitsFactorLocation=this.gl.getUniformLocation(this.program,"sdr_relative_to_nits_factor")}setMax(t){this.gl.uniform1f(this.maxUniformLocation,t)}setMetaData(t){this.gl.uniform1f(this.offsetLocation,t.offset),this.gl.uniform1f(this.multiplierLocation,t.multiplier),this.gl.uniform1f(this.pqTonemapALocation,t.pqTonemapA),this.gl.uniform1f(this.pqTonemapBLocation,t.pqTonemapB),this.gl.uniform1f(this.hlgOOTFGammaMinusOneLocation,t.hlgOOTFGammaMinusOne),this.gl.uniform1f(this.hlgDstMaxLuminanceRelativeLocation,t.hlgDstMaxLuminanceRelative),this.gl.uniform1f(this.nitsToSdrRelativeFactorLocation,t.nitsToSdrRelativeFactor),this.gl.uniform1f(this.sdrRelativeToNitsFactorLocation,t.sdrRelativeToNitsFactor)}}},91848:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(1706);class s extends r.A{constructor(t){super(t)}}},1706:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(24399);class a extends s.A{constructor(t){super(t),(0,r.A)(this,"ySamplerLocation",void 0),(0,r.A)(this,"uSamplerLocation",void 0),(0,r.A)(this,"vSamplerLocation",void 0),(0,r.A)(this,"aSamplerLocation",void 0)}link(t){super.link(t),this.ySamplerLocation=this.gl.getUniformLocation(this.program,"y_Sampler"),this.uSamplerLocation=this.gl.getUniformLocation(this.program,"u_Sampler"),this.vSamplerLocation=this.gl.getUniformLocation(this.program,"v_Sampler"),this.aSamplerLocation=this.gl.getUniformLocation(this.program,"a_Sampler")}bindYTexture(t=0){this.gl.uniform1i(this.ySamplerLocation,t)}bindUTexture(t=0){this.gl.uniform1i(this.uSamplerLocation,t)}bindVTexture(t=0){this.gl.uniform1i(this.vSamplerLocation,t)}bindATexture(t=0){this.gl.uniform1i(this.aSamplerLocation,t)}}},36200:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(27976);class s extends r.A{constructor(t){super(1,t)}}},27976:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(134);class s{constructor(t,e){(0,r.A)(this,"type",void 0),(0,r.A)(this,"_shader",void 0),(0,r.A)(this,"_source",void 0),(0,r.A)(this,"compiled",void 0),this.type=t,this._shader=null,this._source=e,this.compiled=!1}compile(t){this.compiled||(this._shader=t.createShader(0===this.type?t.VERTEX_SHADER:t.FRAGMENT_SHADER),t.shaderSource(this._shader,this._source),t.compileShader(this._shader),this.compiled=!0)}stop(t){t.deleteShader(this._shader),this._shader=null}get shader(){return this._shader}}},37022:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(27976);class s extends r.A{constructor(t){super(0,t)}}},17397:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(22684);class a extends s.A{constructor(t,e,i){super(t,e,i),(0,r.A)(this,"filter",void 0),(0,r.A)(this,"format",void 0),(0,r.A)(this,"internalformat",void 0),(0,r.A)(this,"dataType",void 0),this.format=this.gl.RGB,this.filter=this.gl.LINEAR,this.internalformat=this.gl.RGB,this.dataType=this.gl.UNSIGNED_BYTE}init(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}setFormat(t){this.format=t}setInternalformat(t){this.internalformat=t}setDataType(t){this.dataType=t}setFilter(t){this.filter=t}fill(t){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.setUnpackAlignment(),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.internalformat,this.width,this.height,0,this.format,this.dataType,t)}}},22684:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(67672);class a{constructor(t,e,i){(0,r.A)(this,"gl",void 0),(0,r.A)(this,"width",void 0),(0,r.A)(this,"height",void 0),(0,r.A)(this,"texture",void 0),this.gl=t,this.width=e,this.height=i,this.texture=this.gl.createTexture()}getTexture(){return this.texture}bind(t){s.ai(t)&&this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}setSize(t,e){this.width=t,this.height=e}setUnpackAlignment(){this.width%8==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,8):this.width%4==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,4):this.width%2==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,2):this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1)}destroy(){this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null)}}},48280:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(22684);class a extends s.A{constructor(t,e,i){super(t,e,i),(0,r.A)(this,"filter",void 0),(0,r.A)(this,"format",void 0),(0,r.A)(this,"internalformat",void 0),(0,r.A)(this,"dataType",void 0),this.format=this.gl.LUMINANCE,this.filter=this.gl.LINEAR,this.internalformat=this.gl.LUMINANCE,this.dataType=this.gl.UNSIGNED_BYTE}init(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}setFormat(t){this.format=t}setInternalformat(t){this.internalformat=t}setDataType(t){this.dataType=t}setFilter(t){this.filter=t}fill(t){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.setUnpackAlignment(),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.internalformat,this.width,this.height,0,this.format,this.dataType,t)}}},48641:(t,e,i)=>{"use strict";i.d(e,{A:()=>m});var r=i(134),s=i(63939),a=i(50932),n=i(37837),o=i(11473),l=i(84149),c=i(4624),h=i(26429),d=i(44690),u=i(67672),f=i(14686);const p=d.A.windows||d.A.mac||d.A.linux?20:30;class m{constructor(t,e,i={}){(0,r.A)(this,"context",void 0),(0,r.A)(this,"observer",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"pullIPC",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"channels",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"float32",void 0),(0,r.A)(this,"buffered",void 0),(0,r.A)(this,"pause",void 0),(0,r.A)(this,"startTime",void 0),(0,r.A)(this,"dest",void 0),(0,r.A)(this,"queue",void 0),(0,r.A)(this,"firstRendered",void 0),this.context=t,this.observer=e,this.options=i}async request(t,e,i){switch(t){case"init":break;case"start":{const{port:t,channels:i}=e;this.channels=i,this.pullIPC=new l.Ay(t),this.buffer=this.allocBuffer(),this.float32=new Float32Array((0,o.eq)().buffer),this.queue=[],this.startTime=0,this.ended=!1,this.pause=!1,this.firstRendered=!1,await this.pullInterval(),this.buffering(),await this.pullInterval(),this.buffered=!0,this.process();break}case"restart":if(!this.ended)return;this.buffer=this.allocBuffer(),this.queue=[],this.startTime=0,this.ended=!1,this.pause=!1,this.firstRendered=!1,await this.pullIPC.request("pull",{buffer:this.buffer}),this.buffering(),await this.pullIPC.request("pull",{buffer:this.buffer}),this.buffered=!0,this.process();break;case"stop":this.freeBuffer(this.buffer),this.buffer=null,this.ended=!0,this.pullIPC.destroy();break;case"clear":this.queue.forEach((t=>{t.disconnect()})),this.queue.length=0;break;case"pause":this.pause=!0;break;case"unpause":this.pause=!1,this.queue.length||this.process()}}allocBuffer(){const t=(0,n.Gy)(40);a.M[20](t,(0,n.Gy)(4*this.channels));const e=(0,n.Gy)(512*p*this.channels);for(let i=0;i<this.channels;i++)a.M[20](s.f[20](t)+4*i,e+128*p*4*i);return a.M[15](t+12,128*p),t}freeBuffer(t){t&&((0,n.aI)(s.f[20](t)),(0,n.aI)(t),(0,n.Eb)(t))}async pullInterval(){let t=0;if(this.options.isMainWorker){const e=await this.pullIPC.request("pullBuffer",{nbSamples:128*p});u.sv(e)?(t=0,(0,f.lW)(s.f[20](s.f[20](this.buffer)),e.byteLength,new Uint8Array(e))):t=e}else t=await this.pullIPC.request("pull",{buffer:this.buffer});return t}async pull(){this.buffered=!1,await this.pullInterval()<0?this.ended=!0:(this.buffered=!0,this.queue.length||this.process())}buffering(){this.float32.length||(this.float32=new Float32Array((0,o.eq)().buffer));const t=this.context.createBuffer(this.channels,128*p,this.context.sampleRate);for(let e=0;e<this.channels;e++)if(s.f[20](s.f[20](this.buffer)+4*e)){let i=s.f[20](s.f[20](this.buffer)+4*e)>>>2;t.copyToChannel&&!h.USE_THREADS?t.copyToChannel(this.float32.subarray(i,i+128*p),e,0):t.getChannelData(e).set(this.float32.subarray(i,i+128*p),0)}const e=this.context.createBufferSource();e.buffer=t,e.onended=()=>{if(this.queue.shift(),this.ended&&!this.queue.length)return this.freeBuffer(this.buffer),c.pq("audio source ended","src/avrender/pcm/AudioSourceBufferNode.ts",252),void this.observer.onEnded();this.process(),this.queue.length||this.observer.onStutter(),this.firstRendered||(this.firstRendered=!0,this.observer.onFirstRendered())},0===this.startTime&&(this.startTime=this.context.currentTime),e.start(this.startTime),this.dest&&e.connect(this.dest),this.startTime+=e.buffer.duration,this.queue.push(e)}connect(t){this.dest=t}disconnect(){for(let t=0;t<this.queue.length;t++)this.queue[t].disconnect();this.dest=null,this.queue.length=0}process(){this.buffer&&!this.pause&&this.buffered&&(this.buffering(),this.pull())}}},88397:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(6534);class s extends r.A{constructor(t,e,i={}){super(t,e,"audio-source-processor",i)}}},6534:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(84149),a=i(67672);class n{constructor(t,e,i,a={}){(0,r.A)(this,"audioWorkletNode",void 0),(0,r.A)(this,"ipcPort",void 0),(0,r.A)(this,"observer",void 0),this.observer=e,this.audioWorkletNode=new AudioWorkletNode(t,i,a),this.ipcPort=new s.Ay(this.audioWorkletNode.port),this.ipcPort.on(s.Wo,(t=>{switch(t.method){case"ended":this.observer.onEnded();break;case"firstRendered":this.observer.onFirstRendered();break;case"stutter":this.observer.onStutter()}}))}async request(t,e,i){return this.ipcPort.request(t,e,i)}connect(t){this.audioWorkletNode.connect(t)}getNode(){return this.audioWorkletNode}disconnect(){this.audioWorkletNode.disconnect()}getParameters(t){const e=this.audioWorkletNode.parameters;if(a.Pc(e.get))return e.get(t);e.forEach(((e,i)=>{if(i===t)return e}))}}},41324:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(61837);async function s(t,e){const i=(0,r.A)(e,{varName:"processor"}),s=new Blob([i],{type:"text/javascript"}),a=URL.createObjectURL(s);await t.audioWorklet.addModule(a)}},60120:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r,s=i(134),a=i(95335),n=i(4624);!function(t){t[t.ADD=0]="ADD",t[t.REMOVE=1]="REMOVE",t[t.UPDATE_TIMESTAMP_OFFSET=2]="UPDATE_TIMESTAMP_OFFSET"}(r||(r={}));const o={mediaBufferMax:10};class l{constructor(t={}){(0,s.A)(this,"sourceBuffer",void 0),(0,s.A)(this,"operatorQueue",void 0),(0,s.A)(this,"updating",void 0),(0,s.A)(this,"lastRemoveTime",void 0),(0,s.A)(this,"paddingCallback",void 0),(0,s.A)(this,"options",void 0),(0,s.A)(this,"ending",void 0),(0,s.A)(this,"onQuotaExceededError",void 0),(0,s.A)(this,"onEnded",void 0),this.options=a.X$({},o,t),this.operatorQueue=[],this.updating=!1,this.lastRemoveTime=0,this.ending=!1}setSourceBuffer(t){this.sourceBuffer=t,this.sourceBuffer.onupdateend=()=>{this.paddingCallback&&(this.paddingCallback(),this.paddingCallback=null),this.operatorQueue&&this.operatorQueue.length?this.enqueue():(this.updating=!1,this.ending&&this.onEnded&&this.onEnded())},this.sourceBuffer.onerror=t=>{n.z3(`track update buffer error: ${t}`,"src/avrender/track/Track.ts",102)}}changeMimeType(t){this.sourceBuffer&&this.sourceBuffer.changeType(t)}enqueue(){if(this.operatorQueue.length){const t=this.operatorQueue.shift();if(t.operator===r.ADD)try{this.sourceBuffer.appendBuffer(t.buffer),this.updating=!0,t.callback&&(this.paddingCallback=t.callback)}catch(e){if(!(e instanceof DOMException&&"QuotaExceededError"===e.name))throw e;this.operatorQueue.unshift(t),this.onQuotaExceededError&&this.onQuotaExceededError(),this.updating=!1}else t.operator===r.REMOVE?(this.sourceBuffer.remove(t.start,t.end),this.updating=!0,t.callback&&(this.paddingCallback=t.callback)):t.operator===r.UPDATE_TIMESTAMP_OFFSET&&(this.sourceBuffer.timestampOffset=t.timestampOffset,t.callback&&t.callback(),this.enqueue())}}addBuffer(t,e){t?(this.operatorQueue.push({operator:r.ADD,buffer:t,callback:e}),this.updating||this.enqueue()):e&&e()}updateTimestampOffset(t,e){this.operatorQueue.push({operator:r.UPDATE_TIMESTAMP_OFFSET,timestampOffset:t,callback:e}),this.updating||this.enqueue()}removeBuffer(t,e){this.ending||(t=Math.floor(t))-this.lastRemoveTime<this.options.mediaBufferMax<<1||(this.operatorQueue.push({operator:r.REMOVE,start:this.lastRemoveTime,end:t-this.options.mediaBufferMax,callback:e}),this.updating||this.enqueue(),this.lastRemoveTime=t-this.options.mediaBufferMax)}removeAllBuffer(t){this.sourceBuffer.buffered.length?(this.operatorQueue.push({operator:r.REMOVE,start:this.sourceBuffer.buffered.start(0),end:this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1),callback:t}),this.updating||this.enqueue()):t&&t()}end(){this.ending=!0,this.updating||this.operatorQueue.length||this.onEnded&&this.onEnded()}stop(){if(this.sourceBuffer){try{this.sourceBuffer.abort(),this.updating=!1}catch(t){}try{this.sourceBuffer.buffered.length&&(this.updating?this.operatorQueue.push({operator:r.REMOVE,start:this.sourceBuffer.buffered.start(0),end:this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)}):(this.sourceBuffer.remove(this.sourceBuffer.buffered.start(0),this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)),this.updating=!0)),this.paddingCallback&&(this.paddingCallback(),this.paddingCallback=null)}catch(t){}}}reset(){this.stop(),this.operatorQueue.length=0,this.ending=!1}isPaused(){return!this.updating&&this.operatorQueue.length}getQueueLength(){return this.operatorQueue.length}getBufferedTime(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)-this.sourceBuffer.buffered.start(0):0}getBufferedStart(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.start(0):0}getBufferedEnd(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1):0}getSourceBuffer(){return this.sourceBuffer}setMediaBufferMax(t){this.options.mediaBufferMax=t}getMediaBufferMax(){return this.options.mediaBufferMax}destroy(){this.stop(),this.operatorQueue=null,this.sourceBuffer&&(this.sourceBuffer.onupdateend=this.sourceBuffer.onerror=null,this.sourceBuffer=null)}}},85224:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(63939),s=i(1984),a=i(86834);function n(t){let e="";return e=86017!==r.f[15](t+4)||a.A.firefox?`audio/mp4; codecs="${(0,s.A)(t)}"`:"audio/mpeg",e}},10333:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(94663);function s(t){return`video/mp4; codecs="${(0,r.A)(t)}"`}},77231:(t,e,i)=>{"use strict";i.d(e,{Dh:()=>s,KR:()=>l,N_:()=>a,SF:()=>n,f7:()=>u,go:()=>h,i0:()=>c,qs:()=>o,zg:()=>d});var r=i(9599);const s=-BigInt(1),a=-1,n=1e6,o=1e3,l=new r.P({den:n,num:1}),c=new r.P({den:o,num:1}),h=(new r.P({den:1,num:1}),2147483647),d=65535,u=4294967295},9705:(t,e,i)=>{"use strict";i.d(e,{E$:()=>r,LR:()=>s,LT:()=>c,NU:()=>d,OY:()=>l,UY:()=>a,gR:()=>n,lh:()=>o,r8:()=>h});const r=-1,s=-2,a=-3,n=-4,o=-5,l=-6,c=-7,h=-8,d=-9},49032:(t,e,i)=>{"use strict";async function r(t,e=-1){let i=await t.peekString(8);if(/^FLV/.test(i))return 0;if(/^DKIF/.test(i))return 5;if(/^ftyp/.test(i.slice(4,8)))return 1;if(/^OggS/.test(i))return 4;if(/^ID3/.test(i))return 12;if(/^fLaC/.test(i))return 15;if(/^RIFF/.test(i)){const e=(await t.peekString(12)).slice(8);if(/^WAVE/.test(e))return 14}else{if(/^ADIF/.test(i))return 13;if(440786851===await t.peekUint32())return 6;{const e=await t.peekBuffer(2);switch(e[0]){case 86:if(!(224&~e[1]))return 13;break;case 255:if(240==(246&e[1]))return 13;if([242,244,246,250,252].includes(254&e[1]))return 12}}}return e}i.d(e,{A:()=>r})},36204:(t,e,i)=>{"use strict";i.d(e,{t:()=>l});var r=i(63939),s=i(50932),a=i(56024),n=i(66788),o=i(14686);function l(t,e=0){0===e&&(e=(0,a.FP)()),s.M[15](e+152,t.sampleRate),s.M[15](e+76,t.numberOfFrames),s.M[15](e+292,t.numberOfChannels),s.M[15](e+80,function(t){switch(t){case"u8":return 0;case"s16":return 1;case"s32":return 2;case"f32":return 3;case"u8-planar":return 5;case"s16-planar":return 6;case"s32-planar":return 7;case"f32-planar":return 8;default:throw new Error("not support")}}(t.format)),s.M[17](e+104,BigInt(Math.floor(t.timestamp))),(0,a.rh)(e);const i=(0,n.K0)(r.f[15](e+80))?r.f[15](e+292):1;for(let s=0;s<i;s++)t.copyTo((0,o.s3)(r.f[20](r.f[20](e+64)+4*s),r.f[15](e+32)),{planeIndex:s});return e}},22898:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(63939),s=i(14686);function a(t,e){const i=Number(null!=e?e:r.f[17](t+8)),a=1&r.f[15](t+36);return new EncodedAudioChunk({type:a?"key":"delta",timestamp:i,data:(0,s.s3)(r.f[20](t+24),r.f[15](t+28))})}},28917:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(63939),s=i(14686);function a(t,e){const i=Number(null!=e?e:r.f[17](t+8)),a=1&r.f[15](t+36);return new EncodedVideoChunk({type:a?"key":"delta",timestamp:i,data:(0,s.s3)(r.f[20](t+24),r.f[15](t+28))})}},94561:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(26429),s=i(76045),a=i(67672),n=i(86834);async function o(t,e=!1){let i;return a.Yj(t)||a.sv(t)?(i=await(0,s.A)({source:t}),r.USE_THREADS&&e&&(i.threadModule=await(0,s.A)({source:n.A.firefox?t:i.buffer},{child:!0})),delete i.buffer):i=t,i}},93147:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(63939),s=i(97317);function a(t){if(0!==r.f[15](t))return!1;const e=s.g[r.f[15](t+28)];return e&&128&e.flags}},24310:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(63939),s=i(97317);function a(t){if(0!==r.f[15](t))return!1;const e=s.g[r.f[15](t+28)];return!(!e||e.comp[0].depth<=8||18!==r.f[15](t+92)&&16!==r.f[15](t+92))}},16041:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(134),s=i(50932),a=i(40046),n=i(73783),o=i(37837),l=i(56024);class c{constructor(t,e){(0,r.A)(this,"list",void 0),(0,r.A)(this,"mutex",void 0),this.list=t,this.mutex=e}alloc(){let t=this.list.find((t=>-1===a.p_(t+320,-1,1,16,2)),20);return t||(t=(0,o.Gy)(328),(0,l._h)(t),s.M[16](t+320,1),n.s2(this.mutex),this.list.push(t,20),n.Tl(this.mutex)),t}release(t){a.Hh(t+320,16,2)<=0||1===a.jb(t+320,1,16,2)&&((0,l.to)(t),a.M_(t+320,-1,16,2))}}},47442:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(134),s=i(50932),a=i(40046),n=i(73783),o=i(37837);class l{constructor(t,e){(0,r.A)(this,"list",void 0),(0,r.A)(this,"mutex",void 0),this.list=t,this.mutex=e}alloc(){let t=this.list.find((t=>-1===a.p_(t+40,-1,1,16,2)),20);return t||(t=(0,o.Gy)(48),s.M[16](t+40,1),n.s2(this.mutex),this.list.push(t,20),n.Tl(this.mutex)),t}release(t){a.Hh(t+40,16,2)<=0||1===a.jb(t+40,1,16,2)&&a.M_(t+40,-1,16,2)}}},84290:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(134),s=i(50932),a=i(40046),n=i(73783),o=i(37837),l=i(71517);class c{constructor(t,e){(0,r.A)(this,"list",void 0),(0,r.A)(this,"mutex",void 0),this.list=t,this.mutex=e}alloc(){let t=this.list.find((t=>-1===a.p_(t+88,-1,1,16,2)),20);return t||(t=(0,o.Gy)(96),(0,l.Pd)(t),s.M[16](t+88,1),n.s2(this.mutex),this.list.push(t,20),n.Tl(this.mutex)),t}release(t){a.Hh(t+88,16,2)<=0||1===a.jb(t+88,1,16,2)&&((0,l.Up)(t),a.M_(t+88,-1,16,2))}}},97317:(t,e,i)=>{"use strict";i.d(e,{g:()=>r});const r={0:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},12:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},4:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},13:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},5:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},14:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},23:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:2,offset:0,shift:0,depth:8},{plane:1,step:2,offset:1,shift:0,depth:8}]},59:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},60:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},61:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},62:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},122:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},123:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},124:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},125:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},46:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},45:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},69:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},70:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},63:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},64:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},126:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},127:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},128:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},129:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},48:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},47:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},65:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},66:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},67:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},68:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},130:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},131:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},132:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},133:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},50:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},49:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},26:{nbComponents:4,log2ChromaW:0,log2ChromaH:0,flags:160,comp:[{plane:0,step:4,offset:0,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:2,shift:0,depth:8},{plane:0,step:4,offset:3,shift:0,depth:8}]},119:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:32,comp:[{plane:0,step:4,offset:0,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:2,shift:0,depth:8}]},28:{nbComponents:4,log2ChromaW:0,log2ChromaH:0,flags:160,comp:[{plane:0,step:4,offset:2,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:0,shift:0,depth:8},{plane:0,step:4,offset:3,shift:0,depth:8}]},121:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:32,comp:[{plane:0,step:4,offset:2,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:0,shift:0,depth:8}]},33:{nbComponents:4,log2ChromaW:1,log2ChromaH:1,flags:144,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8},{plane:3,step:1,offset:0,shift:0,depth:8}]}}},58055:(t,e,i)=>{"use strict";i.d(e,{J:()=>r});const r={0:{bits:8,planar:!1},1:{bits:16,planar:!1},2:{bits:32,planar:!1},10:{bits:64,planar:!1},3:{bits:32,planar:!1},4:{bits:64,planar:!1},5:{bits:8,planar:!0},6:{bits:16,planar:!0},7:{bits:32,planar:!0},11:{bits:64,planar:!0},8:{bits:32,planar:!0},9:{bits:64,planar:!0}}},62751:(t,e,i)=>{"use strict";i.d(e,{$$:()=>s,HR:()=>r,Ki:()=>p,Mb:()=>f,Sz:()=>c,Xp:()=>o,_R:()=>a,_m:()=>u,iW:()=>h,mX:()=>d,n1:()=>n,qO:()=>l});const r={flv:0,mp4:1,mov:1,ts:2,ivf:5,opus:4,oggs:4,ogg:4,m3u8:2,m3u:2,mpd:1,mp3:12,mkv:6,mka:6,webm:7,aac:13,flac:15,wav:14,srt:17,vtt:16,ssa:18,ass:18,xml:19,ttml:19,h264:9,264:9,avc:9,h265:10,265:10,hevc:10,h266:11,266:11,vvc:11,mpeg:3,mpg:3},s={m3u8:2,m3u:2,mpd:3},a={copy:0,h264:27,avc:27,hevc:173,h265:173,vvc:196,h266:196,av1:225,vp9:167,vp8:139,mpeg4:12,theora:30},n={copy:0,aac:86018,ac3:86019,eac3:86056,dca:86020,mp3:86017,opus:86076,flac:86028,speex:86051,vorbis:86021,pcm_alaw:65543,pcm_mulaw:65542},o={webvtt:94226,subrip:94225,ass:94230,ttml:94232,mov_text:94213,hdmv_pgs:94214,hdmv_text:94231,dvd:94208,dvb:94209,eia_608:94218},l={yuv420p:0,yuv422p:4,yuv444p:5,yuva420p:33,yuva422p:78,yuva444p:79,yuv420p10le:62,yuv422p10le:64,yuv444p10le:68,yuva420p10le:87,yuva422p10le:89,yuva444p10le:91,yuv420p10be:61,yuv422p10be:63,yuv444p10be:67,yuva420p10be:86,yuva422p10be:88,yuva444p10be:90},c={u8:0,"u8-planar":5,s16:1,"s16-planar":6,s32:2,"s32-planar":7,s64:10,"s64-planar":11,float:3,"float-planar":8,double:4,"double-planar":9},h={flv:0,mp4:1,mov:1,ts:2,mpegts:2,ivf:5,opus:4,ogg:4,m3u8:2,m3u:2,mpd:1,mp3:12,mkv:6,matroska:6,mka:6,webm:7,aac:13,flac:15,wav:14,raw_h264:9,raw_h265:10,raw_vvc:11},d={tv:1,pc:2},u={bt709:1,fcc:4,bt470bg:5,smpte170m:6,smpte240m:7,ycgco:8,gbr:0,bt2020ncl:9},f={Audio:1,Video:0,Subtitle:3,Attachment:4,Data:2},p={default:1,dub:2,original:4,comment:8,lyrics:16,karaoke:32,forced:64,"hearing impaired":128,"visual impaired":256,"clean effects":512,"attached pic":1024,"timed thumbnails":2048,captions:65536,descriptions:131072,metadata:262144,dependent:524288,"still image":1048576}},36981:(t,e,i)=>{"use strict";i.d(e,{r:()=>d});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085);class h{constructor(){(0,a.A)(this,"id",void 0),(0,a.A)(this,"name",void 0),(0,a.A)(this,"opaque",void 0)}}r=h.prototype,(s=new(o())).set("id",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("name",{0:4,1:0,2:0,3:1,4:16,5:0,6:0,7:4,8:0}),s.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,4),(0,c.A)(r,l.g7,24),(0,c.A)(r,l.JY,s);class d{constructor(){(0,a.A)(this,"order",void 0),(0,a.A)(this,"nbChannels",void 0),(0,a.A)(this,"u",void 0),(0,a.A)(this,"opaque",void 0)}}!function(t){var e=new(o());e.set("order",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("nbChannels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("u",{0:function(t){var e=new(o());return e.set("mask",{0:10,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("map",{0:h,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),(0,c.A)(t,l.Og,!0),(0,c.A)(t,l.dc,8),(0,c.A)(t,l.g7,8),(0,c.A)(t,l.JY,e),t}({}),1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),(0,c.A)(t,l.Og,!0),(0,c.A)(t,l.dc,8),(0,c.A)(t,l.g7,24),(0,c.A)(t,l.JY,e)}(d.prototype)},50288:(t,e,i)=>{"use strict";i.d(e,{BU:()=>f});var r,s,a,n=i(134),o=i(80662),l=i.n(o),c=i(61499),h=i(12085),d=i(73783);class u{constructor(){(0,n.A)(this,"data",0),(0,n.A)(this,"size",0),(0,n.A)(this,"refcount",0),(0,n.A)(this,"free",0),(0,n.A)(this,"opaque",0),(0,n.A)(this,"flags",0),(0,n.A)(this,"flagsInternal",0)}}s=u.prototype,(a=new(l())).set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),a.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),a.set("refcount",{0:9,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),a.set("free",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),a.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),a.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),a.set("flagsInternal",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),(0,h.A)(s,c.Og,!0),(0,h.A)(s,c.dc,4),(0,h.A)(s,c.g7,28),(0,h.A)(s,c.JY,a);class f{constructor(){(0,n.A)(this,"buffer",0),(0,n.A)(this,"data",0),(0,n.A)(this,"size",0)}}!function(t){var e=new(l());e.set("buffer",{0:u,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,h.A)(t,c.Og,!0),(0,h.A)(t,c.dc,4),(0,h.A)(t,c.g7,12),(0,h.A)(t,c.JY,e)}(f.prototype);class p{constructor(){(0,n.A)(this,"mutex",void 0),(0,n.A)(this,"pool",0),(0,n.A)(this,"refcount",0),(0,n.A)(this,"size",0),(0,n.A)(this,"opaque",0),(0,n.A)(this,"alloc",0),(0,n.A)(this,"alloc2",0),(0,n.A)(this,"poolFree",0)}}!function(t){var e=new(l());e.set("mutex",{0:d.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("pool",{0:r,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("refcount",{0:9,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("alloc",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),e.set("alloc2",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:24,8:0}),e.set("poolFree",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:28,8:0}),(0,h.A)(t,c.Og,!0),(0,h.A)(t,c.dc,4),(0,h.A)(t,c.g7,32),(0,h.A)(t,c.JY,e)}(p.prototype);class m{constructor(){(0,n.A)(this,"data",0),(0,n.A)(this,"opaque",0),(0,n.A)(this,"free",0),(0,n.A)(this,"pool",0),(0,n.A)(this,"next",0),(0,n.A)(this,"buffer",void 0)}}!function(t){var e=new(l());e.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("free",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("pool",{0:p,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),e.set("next",{0:m,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("buffer",{0:u,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),(0,h.A)(t,c.Og,!0),(0,h.A)(t,c.dc,4),(0,h.A)(t,c.g7,48),(0,h.A)(t,c.JY,e)}(m.prototype),r=m},77162:(t,e,i)=>{"use strict";i.d(e,{A:()=>m});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085),h=i(47958),d=i(9599),u=i(36981),f=i(77231),p=i(71766);class m{constructor(){(0,a.A)(this,"codecType",-1),(0,a.A)(this,"codecId",0),(0,a.A)(this,"codecTag",0),(0,a.A)(this,"extradata",0),(0,a.A)(this,"extradataSize",0),(0,a.A)(this,"codedSideData",0),(0,a.A)(this,"nbCodedSideData",0),(0,a.A)(this,"format",f.N_),(0,a.A)(this,"bitrate",BigInt(0)),(0,a.A)(this,"bitsPerCodedSample",0),(0,a.A)(this,"bitsPerRawSample",0),(0,a.A)(this,"profile",f.N_),(0,a.A)(this,"level",f.N_),(0,a.A)(this,"width",0),(0,a.A)(this,"height",0),(0,a.A)(this,"sampleAspectRatio",new d.P({den:1,num:1})),(0,a.A)(this,"framerate",new d.P({den:1,num:0})),(0,a.A)(this,"fieldOrder",0),(0,a.A)(this,"colorRange",0),(0,a.A)(this,"colorPrimaries",2),(0,a.A)(this,"colorTrc",2),(0,a.A)(this,"colorSpace",2),(0,a.A)(this,"chromaLocation",0),(0,a.A)(this,"videoDelay",0),(0,a.A)(this,"chLayout",void 0),(0,a.A)(this,"sampleRate",f.N_),(0,a.A)(this,"blockAlign",0),(0,a.A)(this,"frameSize",0),(0,a.A)(this,"initialPadding",0),(0,a.A)(this,"trailingPadding",0),(0,a.A)(this,"seekPreroll",0),(0,a.A)(this,"bitFormat",0)}destroy(){(0,p.dn)(this[l.o9]),this[l.o9]=0}}r=m.prototype,(s=new(o())).set("codecType",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("codecId",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("codecTag",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("extradata",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("extradataSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("codedSideData",{0:h.lg,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("nbCodedSideData",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),s.set("bitrate",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),s.set("bitsPerCodedSample",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),s.set("bitsPerRawSample",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:44,8:0}),s.set("profile",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),s.set("level",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:52,8:0}),s.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),s.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:60,8:0}),s.set("sampleAspectRatio",{0:d.P,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),s.set("framerate",{0:d.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),s.set("fieldOrder",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),s.set("colorRange",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),s.set("colorPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),s.set("colorTrc",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),s.set("colorSpace",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:96,8:0}),s.set("chromaLocation",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:100,8:0}),s.set("videoDelay",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),s.set("chLayout",{0:u.r,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),s.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),s.set("blockAlign",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),s.set("frameSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),s.set("initialPadding",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:148,8:0}),s.set("trailingPadding",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),s.set("seekPreroll",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:156,8:0}),s.set("bitFormat",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:160,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,8),(0,c.A)(r,l.g7,168),(0,c.A)(r,l.JY,s)},56490:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085);class h{constructor(){(0,a.A)(this,"key",0),(0,a.A)(this,"value",0)}}r=h.prototype,(s=new(o())).set("key",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("value",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,4),(0,c.A)(r,l.g7,8),(0,c.A)(r,l.JY,s);class d{constructor(){(0,a.A)(this,"count",0),(0,a.A)(this,"elems",0)}}!function(t){var e=new(o());e.set("count",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("elems",{0:h,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),(0,c.A)(t,l.Og,!0),(0,c.A)(t,l.dc,4),(0,c.A)(t,l.g7,8),(0,c.A)(t,l.JY,e)}(d.prototype)},55833:(t,e,i)=>{"use strict";i.d(e,{pu:()=>m});var r=i(134),s=i(80662),a=i.n(s),n=i(61499),o=i(12085),l=i(56490),c=i(50288),h=i(9599),d=i(94300),u=i(36981),f=i(77231),p=i(56024);const m=8;class g{constructor(){(0,r.A)(this,"type",0),(0,r.A)(this,"data",0),(0,r.A)(this,"size",0),(0,r.A)(this,"metadata",0),(0,r.A)(this,"buf",0)}}var v,y;v=g.prototype,(y=new(a())).set("type",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),y.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),y.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),y.set("metadata",{0:l.A,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),y.set("buf",{0:c.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),(0,o.A)(v,n.Og,!0),(0,o.A)(v,n.dc,4),(0,o.A)(v,n.g7,20),(0,o.A)(v,n.JY,y),function(t){var e=new(a());e.set("displayPrimaries",{0:h.P,1:0,2:0,3:1,4:6,5:0,6:0,7:0,8:0}),e.set("whitePoint",{0:h.P,1:0,2:0,3:1,4:2,5:0,6:0,7:48,8:0}),e.set("minLuminance",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("maxLuminance",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),e.set("hasPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),e.set("hasLuminance",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),(0,o.A)(t,n.Og,!0),(0,o.A)(t,n.dc,4),(0,o.A)(t,n.g7,88),(0,o.A)(t,n.JY,e)}(class{constructor(){(0,r.A)(this,"displayPrimaries",void 0),(0,r.A)(this,"whitePoint",void 0),(0,r.A)(this,"minLuminance",void 0),(0,r.A)(this,"maxLuminance",void 0),(0,r.A)(this,"hasPrimaries",void 0),(0,r.A)(this,"hasLuminance",void 0)}}.prototype),function(t){var e=new(a());e.set("maxCLL",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("maxFALL",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,o.A)(t,n.Og,!0),(0,o.A)(t,n.dc,4),(0,o.A)(t,n.g7,8),(0,o.A)(t,n.JY,e)}(class{constructor(){(0,r.A)(this,"maxCLL",void 0),(0,r.A)(this,"maxFALL",void 0)}}.prototype);class A{constructor(){(0,r.A)(this,"data",new Array(m).fill(0,0,m)),(0,r.A)(this,"linesize",new Array(m).fill(0,0,m)),(0,r.A)(this,"extendedData",0),(0,r.A)(this,"width",f.N_),(0,r.A)(this,"height",f.N_),(0,r.A)(this,"nbSamples",f.N_),(0,r.A)(this,"format",f.N_),(0,r.A)(this,"keyFrame",0),(0,r.A)(this,"pictType",0),(0,r.A)(this,"sampleAspectRatio",new h.P({den:1,num:0})),(0,r.A)(this,"pts",f.Dh),(0,r.A)(this,"pktDts",f.Dh),(0,r.A)(this,"timeBase",void 0),(0,r.A)(this,"quality",f.N_),(0,r.A)(this,"opaque",0),(0,r.A)(this,"repeatPict",f.N_),(0,r.A)(this,"interlacedFrame",f.N_),(0,r.A)(this,"topFieldFirst",f.N_),(0,r.A)(this,"paletteHasChanged",f.N_),(0,r.A)(this,"sampleRate",f.N_),(0,r.A)(this,"buf",new Array(m).fill(0,0,m)),(0,r.A)(this,"extendedBuf",0),(0,r.A)(this,"nbExtendedBuf",0),(0,r.A)(this,"sideData",0),(0,r.A)(this,"nbSideData",0),(0,r.A)(this,"flags",0),(0,r.A)(this,"colorRange",0),(0,r.A)(this,"colorPrimaries",2),(0,r.A)(this,"colorTrc",2),(0,r.A)(this,"colorSpace",2),(0,r.A)(this,"chromaLocation",0),(0,r.A)(this,"bestEffortTimestamp",f.Dh),(0,r.A)(this,"pktPos",f.Dh),(0,r.A)(this,"metadata",0),(0,r.A)(this,"decodeErrorFlags",0),(0,r.A)(this,"pktSize",f.N_),(0,r.A)(this,"hwFramesCtx",0),(0,r.A)(this,"opaqueRef",0),(0,r.A)(this,"cropTop",0),(0,r.A)(this,"cropBottom",0),(0,r.A)(this,"cropLeft",0),(0,r.A)(this,"cropRight",0),(0,r.A)(this,"privateRef",0),(0,r.A)(this,"chLayout",void 0),(0,r.A)(this,"duration",BigInt(0))}close(){(0,p.to)(this[n.o9]),(0,d.A)(this)}}!function(t){var e=new(a());e.set("data",{0:2,1:1,2:1,3:1,4:8,5:0,6:0,7:0,8:0}),e.set("linesize",{0:15,1:0,2:0,3:1,4:8,5:0,6:0,7:32,8:0}),e.set("extendedData",{0:2,1:1,2:2,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:68,8:0}),e.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),e.set("nbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:76,8:0}),e.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),e.set("keyFrame",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),e.set("pictType",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),e.set("sampleAspectRatio",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),e.set("pts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),e.set("pktDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),e.set("timeBase",{0:h.P,1:0,2:0,3:0,4:0,5:0,6:0,7:120,8:0}),e.set("quality",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:128,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:132,8:0}),e.set("repeatPict",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),e.set("interlacedFrame",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),e.set("topFieldFirst",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),e.set("paletteHasChanged",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:148,8:0}),e.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),e.set("buf",{0:c.BU,1:1,2:1,3:1,4:8,5:0,6:0,7:156,8:0}),e.set("extendedBuf",{0:c.BU,1:1,2:2,3:0,4:0,5:0,6:0,7:188,8:0}),e.set("nbExtendedBuf",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:192,8:0}),e.set("sideData",{0:g,1:1,2:2,3:0,4:0,5:0,6:0,7:196,8:0}),e.set("nbSideData",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:200,8:0}),e.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:204,8:0}),e.set("colorRange",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:208,8:0}),e.set("colorPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:212,8:0}),e.set("colorTrc",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:216,8:0}),e.set("colorSpace",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:220,8:0}),e.set("chromaLocation",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:224,8:0}),e.set("bestEffortTimestamp",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:232,8:0}),e.set("pktPos",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:240,8:0}),e.set("metadata",{0:l.A,1:1,2:1,3:0,4:0,5:0,6:0,7:248,8:0}),e.set("decodeErrorFlags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:252,8:0}),e.set("pktSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:256,8:0}),e.set("hwFramesCtx",{0:c.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:260,8:0}),e.set("opaqueRef",{0:c.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:264,8:0}),e.set("cropTop",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:268,8:0}),e.set("cropBottom",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:272,8:0}),e.set("cropLeft",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:276,8:0}),e.set("cropRight",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:280,8:0}),e.set("privateRef",{0:c.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:284,8:0}),e.set("chLayout",{0:u.r,1:0,2:0,3:0,4:0,5:0,6:0,7:288,8:0}),e.set("duration",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:312,8:0}),(0,o.A)(t,n.Og,!0),(0,o.A)(t,n.dc,8),(0,o.A)(t,n.g7,320),(0,o.A)(t,n.JY,e)}(A.prototype),function(t){var e=new(a());e.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:320,8:0}),(0,o.A)(t,n.Og,!0),(0,o.A)(t,n.dc,8),(0,o.A)(t,n.g7,328),(0,o.A)(t,n.JY,e)}(class extends A{constructor(...t){super(...t),(0,r.A)(this,"refCount",void 0)}}.prototype)},47958:(t,e,i)=>{"use strict";i.d(e,{lg:()=>f});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085),h=i(50288),d=i(9599),u=i(77231);class f{constructor(){(0,a.A)(this,"data",0),(0,a.A)(this,"size",u.N_),(0,a.A)(this,"type",-1)}}r=f.prototype,(s=new(o())).set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("type",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,4),(0,c.A)(r,l.g7,12),(0,c.A)(r,l.JY,s);class p{constructor(){(0,a.A)(this,"buf",0),(0,a.A)(this,"pts",u.Dh),(0,a.A)(this,"dts",u.Dh),(0,a.A)(this,"data",0),(0,a.A)(this,"size",0),(0,a.A)(this,"streamIndex",u.N_),(0,a.A)(this,"flags",0),(0,a.A)(this,"sideData",0),(0,a.A)(this,"sideDataElems",0),(0,a.A)(this,"duration",u.Dh),(0,a.A)(this,"pos",u.Dh),(0,a.A)(this,"opaque",0),(0,a.A)(this,"opaqueRef",0),(0,a.A)(this,"timeBase",new d.P({den:u.SF,num:1})),(0,a.A)(this,"bitFormat",0)}}!function(t){var e=new(o());e.set("buf",{0:h.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("pts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("dts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:24,8:0}),e.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),e.set("streamIndex",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),e.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:36,8:0}),e.set("sideData",{0:f,1:1,2:1,3:0,4:0,5:0,6:0,7:40,8:0}),e.set("sideDataElems",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:44,8:0}),e.set("duration",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),e.set("pos",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("opaqueRef",{0:h.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:68,8:0}),e.set("timeBase",{0:d.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),e.set("bitFormat",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),(0,c.A)(t,l.Og,!0),(0,c.A)(t,l.dc,8),(0,c.A)(t,l.g7,88),(0,c.A)(t,l.JY,e)}(p.prototype),function(t){var e=new(o());e.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),(0,c.A)(t,l.Og,!0),(0,c.A)(t,l.dc,8),(0,c.A)(t,l.g7,96),(0,c.A)(t,l.JY,e)}(class extends p{constructor(...t){super(...t),(0,a.A)(this,"refCount",void 0)}}.prototype)},10278:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085);class h{constructor(){(0,a.A)(this,"data",void 0),(0,a.A)(this,"linesize",void 0),(0,a.A)(this,"nbSamples",void 0),(0,a.A)(this,"maxnbSamples",void 0),(0,a.A)(this,"channels",void 0),(0,a.A)(this,"sampleRate",void 0),(0,a.A)(this,"timestamp",void 0),(0,a.A)(this,"duration",void 0)}}r=h.prototype,(s=new(o())).set("data",{0:2,1:1,2:2,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("linesize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("nbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("maxnbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("channels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("timestamp",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("duration",{0:19,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,8),(0,c.A)(r,l.g7,40),(0,c.A)(r,l.JY,s),function(t){var e=new(o());e.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),(0,c.A)(t,l.Og,!0),(0,c.A)(t,l.dc,8),(0,c.A)(t,l.g7,48),(0,c.A)(t,l.JY,e)}(class extends h{constructor(...t){super(...t),(0,a.A)(this,"refCount",void 0)}}.prototype)},9599:(t,e,i)=>{"use strict";i.d(e,{P:()=>h});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085);class h{constructor(t){(0,a.A)(this,"num",1),(0,a.A)(this,"den",1),t&&(this.den=t.den,this.num=t.num)}}r=h.prototype,(s=new(o())).set("num",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("den",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,4),(0,c.A)(r,l.g7,8),(0,c.A)(r,l.JY,s)},37815:(t,e,i)=>{"use strict";i.d(e,{A6:()=>v,D$:()=>u,Q7:()=>m,VG:()=>f,aw:()=>d,us:()=>g});var r=i(14686),s=i(63939),a=i(50932),n=i(37837),o=i(40046),l=i(73783),c=i(52699);const h=1;function d(t,e,i=0,r=0,s=0){const l=(0,n.Gy)(28);if(!l)return 0;const c=function(t,e,i,r=0,s=0,l=0){a.M[20](t,e),a.M[15](t+4,i),a.M[20](t+12,r),a.M[20](t+16,s),o.M_(t+8,1,9,2),a.M[15](t+20,l);const c=(0,n.Gy)(12);return c?(a.M[20](c,t),a.M[20](c+4,e),a.M[15](c+8,i),c):0}(l,t,e,i,r,s);return c||((0,n.Eb)(l),0)}function u(t){return d((0,n.sY)(t),t)}function f(t){const e=(0,n.Gy)(12);return(0,r.Mr)(e,t,12),o.WQ(s.f[20](t)+8,1,9,2),e}function p(t,e){const i=s.f[20](s.f[20](t));if(e?((0,r.Mr)(s.f[20](t),s.f[20](e),12),(0,n.aI)(e)):(0,n.aI)(t),1===o.jb(i+8,1,9,2)){const t=!(2&s.f[15](i+24));s.f[20](i+16)?y(s.f[20](i+16),s.f[20](i)):(0,n.Eb)(s.f[20](i)),t&&(0,n.Eb)(i)}}function m(t){t&&s.f[20](t)&&p(t,0)}function g(t,e){const i=s.f[20](t);if(!e)return m(t),0;if(i&&s.f[20](i+4)===s.f[20](e+4))return a.M[20](i+4,s.f[20](e+4)),a.M[15](i+8,s.f[15](e+8)),0;const r=f(e);return m(t),a.M[20](t,r),0}function v(t,e){if(!s.f[20](t)){const i=d((0,n.cz)(0,e),e);return a.M[20](t,i),a.M[15](s.f[20](i)+24,s.f[15](s.f[20](i)+24)|h),0}const i=s.f[20](t),l=s.f[20](i);if(s.f[15](i+8)===e)return 0;if(!(s.f[15](l+24)&h&&function(t){return 1&s.f[15](s.f[20](t)+20)?0:1===o.Hh(s.f[20](t)+8,9,2)?1:0}(i)&&s.f[20](i+4)===s.f[20](l))){let i=c.z(4);a.M[20](i,0);const n=v(i,e);return n<0?(c.t(4),n):((0,r.Mr)(s.f[20](s.f[20](i)+4),s.f[20](l),Math.min(e,s.f[15](l+4))),p(t,i),c.t(4),0)}const u=(0,n.cz)(s.f[20](l),e);return a.M[20](i+4,u),a.M[20](l,u),a.M[15](i+8,e),a.M[15](l+4,e),0}function y(t,e){const i=t,r=s.f[20](i+12);l.s2(r),a.M[20](i+16,s.f[20](r+4)),a.M[20](r+4,i),l.Tl(r),1===o.jb(r+8,1,9,2)&&function(t){!function(t){for(;s.f[20](t+4);){const e=s.f[20](t+4);a.M[20](t+4,s.f[20](e+16)),s.f[20](e+4)?y(s.f[20](e+4),s.f[20](e)):(0,n.Eb)(s.f[20](e)),(0,n.Eb)(e)}}(t),l.zr(t),(0,n.Eb)(t)}(r)}},73749:(t,e,i)=>{"use strict";i.d(e,{AO:()=>c,IH:()=>l,a5:()=>d});var r=i(63939),s=i(50932),a=i(11473),n=i(14686),o=i(37837);function l(t){c(r.f[20](t)),(0,o.aI)(t)}function c(t){if(t){for(;s.M[15](t,r.f[15](t)-1),r.f[15](t)+1;)(0,o.aI)(r.f[20](t+4)+8*r.f[15](t)),(0,o.aI)(r.f[20](t+4)+8*r.f[15](t)+4);(0,o.aI)(t+4)}}function h(t,e){let i=0;return t?(e&&(i=1+(e-r.f[20](t+4)>>>3)),i>=r.f[15](t)?0:r.f[20](t+4)+8*i):0}function d(t,e,i,o=0){if(!t)throw new Error("m is nullptr");let l=0;if(64&o&&(l=function(t,e,i=0,s=0){if(!t)return 0;let a=i;if(!e)return 0;for(;a=h(t,a);){let t=(0,n.lH)(r.f[20](a));if(1&s&&(t.toLocaleLowerCase(),e.toLocaleLowerCase()),t===e||2&s&&0===t.indexOf(e))return a}}(t,e,0,o)),l){if(16&o)return 0;32&o&&(i=`${(0,n.lH)(r.f[20](l+4))},${i}`),a.s_.free(r.f[20](l+4)),s.M[20](l+4,a.s_.malloc(i.length+1)),(0,n.qW)(r.f[20](l+4),i,i.length)}else{let o=a.s_.realloc(r.f[20](t+4),8*(r.f[15](t)+1));s.M[20](t+4,o),s.M[20](r.f[20](t+4)+8*r.f[15](t),a.s_.malloc(e.length+1)),s.M[20](r.f[20](t+4)+8*r.f[15](t)+4,a.s_.malloc(i.length+1)),(0,n.qW)(r.f[20](r.f[20](t+4)+8*r.f[15](t)),e,e.length),(0,n.qW)(r.f[20](r.f[20](t+4)+8*r.f[15](t)+4),i,i.length),s.M[15](t,r.f[15](t)+1)}return 0}},56024:(t,e,i)=>{"use strict";i.d(e,{FP:()=>f,_h:()=>v,aH:()=>g,rh:()=>y,to:()=>A,xj:()=>p});var r=i(63939),s=i(50932),a=i(55833),n=i(37837),o=i(14686),l=i(77231),c=i(37815),h=i(73749),d=i(66788),u=i(9705);function f(){const t=(0,n.Gy)(320);return v(t),t}function p(t){A(t),(0,n.Eb)(t)}function m(t){const e=r.f[20](t);(0,c.Q7)(e+16),(0,h.IH)(e+12),(0,n.aI)(t)}function g(t,e){for(let i=0;i<r.f[15](t+200);i++)if(r.f[15](r.f[20](r.f[20](t+196)+4*i))===e)return r.f[20](r.f[20](t+196)+4*i);return 0}function v(t){r.f[20](t+64)!==t&&(0,n.aI)(t+64),(0,o.sO)(t,0,320),s.M[17](t+104,l.Dh),s.M[17](t+112,l.Dh),s.M[17](t+232,l.Dh),s.M[17](t+240,l.Dh),s.M[15](t+256,-1),s.M[15](t+84,1),s.M[15](t+92,0),s.M[15](t+96,1),s.M[15](t+80,-1),s.M[20](t+64,t),s.M[15](t+212,2),s.M[15](t+216,2),s.M[15](t+220,2),s.M[15](t+208,0),s.M[15](t+224,0),s.M[15](t+204,0)}function y(t,e){const i=(0,d.K0)(r.f[15](t+80)),o=r.f[15](t+292),l=i?o:1;let h=0;if(!r.f[15](t+32)){if(h=(0,d.f8)(r.f[15](t+80),o,r.f[15](t+76),e),h<0)return h;s.M[15](t+32,h)}if(l>a.pu){if(s.M[20](t+64,(0,n.sY)(4*l)),s.M[20](t+188,(0,n.sY)(4*l)),!r.f[20](t+188)||!r.f[20](t+64))return(0,n.aI)(t+64),(0,n.aI)(t+188),u.gR;s.M[15](t+192,l-a.pu)}else s.M[20](t+64,t);for(let e=0;e<Math.min(l,a.pu);e++){if(s.M[20](t+156+4*e,(0,c.D$)(r.f[15](t+32))),!r.f[20](t+156+4*e))return A(t),u.gR;s.M[20](r.f[20](t+64)+4*e,r.f[20](r.f[20](t+156+4*e)+4)),s.M[20](t+4*e,r.f[20](r.f[20](t+156+4*e)+4))}for(let e=0;e<l-a.pu;e++){if(s.M[20](r.f[20](t+188)+4*e,(0,c.D$)(r.f[15](t+32))),!r.f[20](r.f[20](t+188)+4*e))return A(t),u.gR;s.M[20](r.f[20](t+64)+(e+a.pu),r.f[20](r.f[20](r.f[20](t+188)+4*e)+4))}}function A(t){!function(t){for(let e=0;e<r.f[15](t+200);e++)m(r.f[20](t+196)+4*e);s.M[15](t+200,0),(0,n.aI)(t+196)}(t);for(let e=0;e<8;e++)(0,c.Q7)(t+156+4*e);for(let e=0;e<r.f[15](t+192);e++)(0,c.Q7)(r.f[20](t+188)+4*e);(0,n.aI)(t+188),(0,h.IH)(t+248),(0,c.Q7)(t+260),(0,c.Q7)(t+264),(0,c.Q7)(t+284),v(t)}},71517:(t,e,i)=>{"use strict";i.d(e,{$W:()=>f,E4:()=>p,Is:()=>g,NX:()=>I,NZ:()=>A,Ow:()=>m,Pd:()=>b,Qe:()=>y,Up:()=>T,Zx:()=>S,_5:()=>v,fQ:()=>u,iI:()=>h,rN:()=>k,rU:()=>d,zu:()=>x});var r=i(14686),s=i(63939),a=i(50932),n=i(37837),o=i(77231),l=i(37815);const c=64;function h(t,e){return e?(0,r.JW)(s.f[20](t+24),s.f[15](t+28)):(0,r.s3)(s.f[20](t+24),s.f[15](t+28))}function d(t,e){for(let i=0;i<s.f[15](t+44);i++)if(s.f[15](s.f[20](t+40)+12*i+8)===e)return s.f[20](t+40)+12*i;return 0}function u(t,e){for(let i=0;i<s.f[15](t+44);i++)if(s.f[15](s.f[20](t+40)+12*i+8)===e)return!0;return!1}function f(t,e,i,o,l){const c=s.f[15](e),h=s.f[20](t);for(let t=0;t<c;t++)if(s.f[15](h+12*t+8)===i)return(0,n.Eb)(s.f[20](h+12*t)),a.M[20](h+12*t,o),void a.M[15](h+12*t+4,l);const d=12*(c+1),u=(0,n.Gy)(d);if(c)for(let t=0;t<c;t++)(0,r.Mr)(u+12*t,h+12*t,12);const f=u+12*c;return a.M[20](f,o),a.M[15](f+8,i),a.M[15](f+4,l),h&&(0,n.Eb)(h),a.M[20](t,u),a.M[15](e,c+1),f}function p(t,e,i,s){const a=(0,n.sY)(s+c);return(0,r.sO)(a+s,0,c),f(t,e,i,a,s)}function m(t,e,i,r){f(t+40,t+44,e,i,r)}function g(t,e){let i=-1;for(let r=0;r<s.f[15](t+44);r++)if(s.f[15](s.f[20](t+40)+12*r+8)===e){i=r;break}if(i>-1)if(1===s.f[15](t+44))(0,n.Eb)(s.f[20](s.f[20](t+40))),(0,n.Eb)(s.f[20](t+40)),a.M[20](t+40,0),a.M[15](t+44,0);else{const e=12*(s.f[15](t+44)-1),o=(0,n.Gy)(e);for(let e=0;e<s.f[15](t+44);e++)e!==i?(0,r.Mr)(o+12*e,s.f[20](t+40)+12*e,12):(0,n.Eb)(s.f[20](s.f[20](t+40)+12*e));(0,n.Eb)(s.f[20](t+40)),a.M[20](t+40,o),a.M[15](t+44,s.f[15](t+44)-1)}}function v(){const t=(0,n.Gy)(88);return b(t),t}function y(t){T(t),(0,n.Eb)(t)}function A(t,e){const i=s.f[20](t),r=s.f[15](e);if(i){for(let t=0;t<r;t++)(0,n.Eb)(s.f[20](i+12*t));(0,n.aI)(t),a.M[15](e,0)}}function b(t){a.M[20](t+24,0),a.M[15](t+28,0),a.M[20](t+40,0),a.M[15](t+44,0),a.M[15](t+32,o.N_),a.M[17](t+56,o.Dh),a.M[17](t+48,o.Dh),a.M[15](t+36,0),a.M[17](t+16,o.Dh),a.M[17](t+8,o.Dh),a.M[15](t+76,o.SF),a.M[15](t+72,1),a.M[15](t+80,0),a.M[20](t,0)}function x(t,e){return a.M[15](t+32,s.f[15](e+32)),a.M[17](t+56,s.f[17](e+56)),a.M[17](t+48,s.f[17](e+48)),a.M[15](t+36,s.f[15](e+36)),a.M[17](t+16,s.f[17](e+16)),a.M[17](t+8,s.f[17](e+8)),a.M[20](t+64,s.f[20](e+64)),a.M[15](t+76,s.f[15](e+76)),a.M[15](t+72,s.f[15](e+72)),a.M[15](t+80,s.f[15](e+80)),a.M[20](t+68,0),(0,l.us)(t+68,s.f[20](e+68)),function(t,e){if(A(t+40,t+44),s.f[15](e+44)){let i=12;a.M[20](t+40,(0,n.Gy)(i*s.f[15](e+44)));for(let i=0;i<s.f[15](e+44);i++)a.M[15](s.f[20](t+40)+12*i+4,s.f[15](s.f[20](e+40)+12*i+4)),a.M[15](s.f[20](t+40)+12*i+8,s.f[15](s.f[20](e+40)+12*i+8)),a.M[20](s.f[20](t+40)+12*i,(0,n.sY)(s.f[15](s.f[20](e+40)+12*i+4))),(0,r.Mr)(s.f[20](s.f[20](t+40)+12*i),s.f[20](s.f[20](e+40)+12*i),s.f[15](s.f[20](e+40)+12*i+4));a.M[15](t+44,s.f[15](e+44))}}(t,e),0}function w(t,e){return(0,l.A6)(t,e+c),(0,r.sO)(s.f[20](s.f[20](t)+4)+e,0,c),0}function k(t,e){return s.f[20](t)&&(0,l.Q7)(t),a.M[20](t,0),x(t,e),!s.f[20](e)&&s.f[15](e+28)?(w(t,s.f[15](e+28)),s.f[15](e+28)&&(0,r.Mr)(s.f[20](s.f[20](t)+4),s.f[20](e+24),s.f[15](e+28)),a.M[20](t+24,s.f[20](s.f[20](t)+4))):s.f[20](e)&&(a.M[20](t,(0,l.VG)(s.f[20](e))),a.M[20](t+24,s.f[20](e+24))),a.M[15](t+28,s.f[15](e+28)),0}function T(t){A(t+40,t+44),(0,l.Q7)(t+68),s.f[20](t)?(0,l.Q7)(t):s.f[20](t+24)&&(0,n.Eb)(s.f[20](t+24)),b(t)}function S(t,e){s.f[20](t)&&(0,l.Q7)(t),a.M[20](t,0),!s.f[20](e)&&s.f[15](e+28)?(w(t,s.f[15](e+28)),s.f[15](e+28)&&(0,r.Mr)(s.f[20](s.f[20](t)+4),s.f[20](e+24),s.f[15](e+28)),a.M[20](t+24,s.f[20](s.f[20](t)+4))):s.f[20](e)&&(a.M[20](t,(0,l.VG)(s.f[20](e))),a.M[20](t+24,s.f[20](e+24))),a.M[15](t+28,s.f[15](e+28))}function I(t,e,i){s.f[20](t)?(0,l.Q7)(t):s.f[20](t+24)&&(0,n.Eb)(s.f[20](t+24)),a.M[20](t,(0,l.aw)(e,i+c)),a.M[20](t+24,e),a.M[15](t+28,i)}},99991:(t,e,i)=>{"use strict";i.d(e,{ML:()=>h,bl:()=>c});var r=i(63939),s=i(50932),a=i(85103),n=i(37837),o=i(14686),l=i(9705);function c(t){2==r.f[15](t)&&(0,n.aI)(t+8),(0,o.sO)(t,0,24)}function h(t,e){return e?(s.M[15](t,1),s.M[15](t+4,(0,a.Xb)(BigInt(e>>>0))),s.M[10](t+8,BigInt(e>>>0)),0):l.UY}},71766:(t,e,i)=>{"use strict";i.d(e,{Yi:()=>h,dn:()=>d});var r=i(14686),s=i(63939),a=i(50932),n=i(37837),o=i(99991),l=i(71517),c=i(77231);function h(t,e){a.M[15](t,s.f[15](e)),a.M[15](t+4,s.f[15](e+4)),a.M[8](t+8,s.f[8](e+8)),a.M[15](t+28,s.f[15](e+28)),a.M[17](t+32,s.f[17](e+32)),a.M[15](t+40,s.f[15](e+40)),a.M[15](t+44,s.f[15](e+44)),a.M[15](t+48,s.f[15](e+48)),a.M[15](t+52,s.f[15](e+52)),a.M[15](t+56,s.f[15](e+56)),a.M[15](t+60,s.f[15](e+60)),a.M[15](t+68,s.f[15](e+68)),a.M[15](t+64,s.f[15](e+64)),a.M[15](t+80,s.f[15](e+80)),a.M[15](t+84,s.f[15](e+84)),a.M[15](t+88,s.f[15](e+88)),a.M[15](t+92,s.f[15](e+92)),a.M[15](t+96,s.f[15](e+96)),a.M[15](t+100,s.f[15](e+100)),a.M[15](t+104,s.f[15](e+104)),(0,r.Mr)(t+112,e+112,24),a.M[15](t+136,s.f[15](e+136)),a.M[15](t+140,s.f[15](e+140)),a.M[15](t+144,s.f[15](e+144)),a.M[15](t+148,s.f[15](e+148)),a.M[15](t+152,s.f[15](e+152)),a.M[15](t+156,s.f[15](e+156)),(0,r.Mr)(t+72,e+72,8),s.f[20](e+12)&&(s.f[20](t+12)&&(0,n.Eb)(s.f[20](t+12)),a.M[20](t+12,(0,n.sY)(s.f[15](e+16))),a.M[15](t+16,s.f[15](e+16)),(0,r.Mr)(s.f[20](t+12),s.f[20](e+12),s.f[15](e+16))),s.f[20](e+20)&&function(t,e,i,o){if(!i)return;const l=(0,n.Gy)(12*o);for(let t=0;t<o;t++)a.M[15](l+12*t+8,s.f[15](i+12*t+8)),a.M[15](l+12*t+4,s.f[15](i+12*t+4)),a.M[20](l+12*t,(0,n.sY)(s.f[15](i+12*t+4))),(0,r.Mr)(l+12*t,i+12*t,s.f[15](i+12*t+4));a.M[15](e,o),a.M[20](t,l)}(t+20,t+24,s.f[20](e+20),s.f[15](e+24))}function d(t){t&&(function(t){s.f[20](t+12)&&(0,n.aI)(t+12),(0,o.bl)(t+112),(0,l.NZ)(t+20,t+24),(0,r.sO)(t,0,168),a.M[15](t,-1),a.M[15](t+4,0),a.M[15](t+28,-1),a.M[15](t+112,0),a.M[15](t+80,0),a.M[15](t+84,0),a.M[15](t+88,2),a.M[15](t+92,2),a.M[15](t+96,2),a.M[15](t+100,0),a.M[15](t+64,0),a.M[15](t+68,1),a.M[15](t+72,0),a.M[15](t+72,1),a.M[15](t+48,c.N_),a.M[15](t+52,c.N_)}(t),(0,n.Eb)(t))}},85103:(t,e,i)=>{"use strict";function r(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,(t+=t>>8)+(t>>16)&63}function s(t){return r(Number(BigInt.asUintN(32,t)))+r(Number(BigInt.asUintN(32,t>>BigInt(32))))}function a(t){const e=t/BigInt(1e3),i=t-e*BigInt(1e3);return Number(e)+Number(i)/1e3}function n(t,e){return t+e-1&~(e-1)}i.d(e,{An:()=>n,Xb:()=>s,yw:()=>a})},23991:(t,e,i)=>{"use strict";function r(t){let e=0,i=0;for(;i<32&&0===t.readU1();)i++;return e=t.readU(i),e+=(1<<i)-1,e}function s(t){let e=r(t);return e=1&e?(e+1)/2:-e/2,e}i.d(e,{$x:()=>s,xb:()=>r})},39381:(t,e,i)=>{"use strict";i.d(e,{E3:()=>a,Sg:()=>c,Y0:()=>l,ht:()=>o,r8:()=>s,yd:()=>n});var r=i(63939);function s(t){return r.f[2](t)}function a(t){return s(t+1)<<8|s(t)}function n(t){return s(t)<<8|s(t+1)}function o(t){return s(t)<<16|s(t+1)<<8|s(t+2)}function l(t){return a(t+2)<<16|a(t)}function c(t){return n(t)<<16|n(t+2)}},37837:(t,e,i)=>{"use strict";i.d(e,{Eb:()=>d,Gy:()=>h,aI:()=>u,cz:()=>f,sY:()=>c});var r=i(11473),s=i(63939),a=i(50932),n=i(14686),o=i(4624),l="src/avutil/util/mem.ts";function c(t){const e=r.s_.malloc(t);return e||o.h2("can not alloc buffer",l,32),e}function h(t){const e=r.s_.malloc(t);return e||o.h2("can not alloc buffer",l,40),(0,n.sO)(e,0,t),e}function d(t){r.s_.free(t)}function u(t){r.s_.free(s.f[20](t)),a.M[20](t,0)}function f(t,e){return r.s_.realloc(t,e)}},60264:(t,e,i)=>{"use strict";function r(t){return t.length>4&&0===t[0]&&0===t[1]&&(1===t[2]||0===t[2]&&1===t[3])}function s(t,e){let i=0;for(let r=e;r<t.length;r++)switch(t[r]){case 0:i++;break;case 1:if(i>=2)return{offset:r-Math.min(i,3),startCode:Math.min(i+1,4)};i=0;break;default:i=0}return{offset:-1,startCode:0}}function a(t){const e=[];let i=s(t,0),r={offset:-1,startCode:0};for(;r=s(t,i.offset+i.startCode),r.offset>-1;)e.push(t.subarray(i.offset+i.startCode,r.offset,!0)),i=r;return e.push(t.subarray(i.offset+i.startCode,void 0,!0)),e}function n(t,e=0,i){i||(i=t.length);const r=new Uint8Array(t.length);let s=0,a=0;for(let n=0;n<t.length;n++){if(n>=e&&n<i)if(0===t[n])s++;else if(3===t[n]&&2===s&&n+1<t.length&&t[n+1]<=3){if(n++,n===t.length)break;s=0===t[n]?1:0}else s=0;r[a++]=t[n]}return r.slice(0,a)}i.d(e,{BN:()=>n,Bs:()=>r,Ky:()=>s,py:()=>a})},44328:(t,e,i)=>{"use strict";i.d(e,{iU:()=>n,k:()=>s,lb:()=>a});var r=i(31658);function s(t,e,i){return t*BigInt(0|e.num)*BigInt(0|i.den)/(BigInt(0|e.den)*BigInt(0|i.num))}function a(t){return t.num/t.den}function n(t){const e=(0,r.A)(t.num,t.den);e<=1||(t.den/=e,t.num/=e)}},66788:(t,e,i)=>{"use strict";i.d(e,{K0:()=>n,f8:()=>o});var r=i(77231),s=i(85103),a=i(58055);function n(t){return!(t<0||t>=12)&&a.J[t].planar}function o(t,e,i,o){const l=function(t){return t<0||t>=12?0:a.J[t].bits>>3}(t),c=n(t);return!l||i<=0||e<=0?-1:(o||(o=1,i=(0,s.An)(i,32)),e>r.go/o||e*i>(r.go-o*e)/l?-1:c?(0,s.An)(i*l,o):(0,s.An)(i*l*e,o))}},71762:(t,e,i)=>{"use strict";i.d(e,{T8:()=>d,Wu:()=>h,r0:()=>c,wm:()=>l});var r=i(63939),s=i(50932),a=i(14686),n=i(71517),o=i(37837);function l(t){const e={pts:r.f[17](t+8),dts:r.f[17](t+16),data:(0,n.iI)(t).slice(),streamIndex:r.f[15](t+32),flags:r.f[15](t+36),sideData:[],duration:r.f[17](t+48),pos:r.f[17](t+56),timeBase:{den:r.f[15](t+76),num:r.f[15](t+72)},bitFormat:r.f[15](t+80)};for(let i=0;i<r.f[15](t+44);i++){const s={type:r.f[15](r.f[20](t+40)+12*i+8),data:(0,a.s3)(r.f[20](r.f[20](t+40)+12*i),r.f[15](r.f[20](t+40)+12*i+4)).slice()};e.sideData.push(s)}return e}function c(t,e=0){e||(e=(0,n._5)()),s.M[17](e+8,t.pts),s.M[17](e+16,t.dts);const i=(0,o.sY)(t.data.length);if((0,a.lW)(i,t.data.length,t.data),(0,n.NX)(e,i,t.data.length),s.M[15](e+32,t.streamIndex),s.M[15](e+36,t.flags),s.M[17](e+48,t.duration),s.M[17](e+56,t.pos),s.M[15](e+76,t.timeBase.den),s.M[15](e+72,t.timeBase.num),s.M[15](e+80,t.bitFormat),t.sideData.length)for(let i=0;i<t.sideData.length;i++){const r=(0,o.sY)(t.sideData[i].data.length);(0,a.lW)(r,t.sideData[i].data.length,t.sideData[i].data),(0,n.Ow)(e,r,t.sideData[i].type,t.sideData[i].data.length)}else(0,n.NZ)(e+40,e+44);return e}function h(t){const e={codecType:r.f[15](t),codecId:r.f[15](t+4),codecTag:r.f[8](t+8),extradata:null,codedSideData:[],format:r.f[15](t+28),bitrate:r.f[17](t+32),bitsPerCodedSample:r.f[15](t+40),bitsPerRawSample:r.f[15](t+44),profile:r.f[15](t+48),level:r.f[15](t+52),width:r.f[15](t+56),height:r.f[15](t+60),sampleAspectRatio:{den:r.f[15](t+68),num:r.f[15](t+64)},framerate:{den:r.f[15](t+76),num:r.f[15](t+72)},fieldOrder:r.f[15](t+80),colorRange:r.f[15](t+84),colorPrimaries:r.f[15](t+88),colorTrc:r.f[15](t+92),colorSpace:r.f[15](t+96),chromaLocation:r.f[15](t+100),videoDelay:r.f[15](t+104),chLayout:{order:r.f[15](t+112),nbChannels:r.f[15](t+116),u:r.f[10](t+120)},sampleRate:r.f[15](t+136),blockAlign:r.f[15](t+140),frameSize:r.f[15](t+144),initialPadding:r.f[15](t+148),trailingPadding:r.f[15](t+152),seekPreroll:r.f[15](t+156),bitFormat:r.f[15](t+160)};r.f[15](t+16)&&(e.extradata=(0,a.s3)(r.f[20](t+12),r.f[15](t+16)).slice());for(let i=0;i<r.f[15](t+24);i++){const s={type:r.f[15](r.f[20](t+20)+12*i+8),data:(0,a.s3)(r.f[20](r.f[20](t+20)+12*i),r.f[15](r.f[20](t+20)+12*i+4)).slice()};e.codedSideData.push(s)}return e}function d(t,e=0){if(e||(e=(0,o.sY)(168),(0,a.sO)(e,0,168)),s.M[15](e,t.codecType),s.M[15](e+4,t.codecId),s.M[8](e+8,t.codecTag),t.extradata&&(r.f[20](e+12)&&(0,o.Eb)(r.f[20](e+12)),s.M[20](e+12,(0,o.sY)(t.extradata.length)),(0,a.lW)(r.f[20](e+12),t.extradata.length,t.extradata),s.M[15](e+16,t.extradata.length)),t.codedSideData.length)for(let i=0;i<t.codedSideData.length;i++){const r=(0,o.sY)(t.codedSideData[i].data.length);(0,a.lW)(r,t.codedSideData[i].data.length,t.codedSideData[i].data),(0,n.$W)(e+20,e+24,t.codedSideData[i].type,t.codedSideData[i].data.length,r)}else(0,n.NZ)(e+20,e+24);return s.M[15](e+28,t.format),s.M[17](e+32,t.bitrate),s.M[15](e+40,t.bitsPerCodedSample),s.M[15](e+44,t.bitsPerRawSample),s.M[15](e+48,t.profile),s.M[15](e+52,t.level),s.M[15](e+56,t.width),s.M[15](e+60,t.height),s.M[15](e+68,t.sampleAspectRatio.den),s.M[15](e+64,t.sampleAspectRatio.num),s.M[15](e+76,t.framerate.den),s.M[15](e+72,t.framerate.num),s.M[15](e+80,t.fieldOrder),s.M[15](e+84,t.colorRange),s.M[15](e+88,t.colorPrimaries),s.M[15](e+92,t.colorTrc),s.M[15](e+96,t.colorSpace),s.M[15](e+100,t.chromaLocation),s.M[15](e+104,t.videoDelay),s.M[15](e+112,t.chLayout.order),s.M[15](e+116,t.chLayout.nbChannels),s.M[10](e+120,t.chLayout.u),s.M[15](e+136,t.sampleRate),s.M[15](e+140,t.blockAlign),s.M[15](e+144,t.frameSize),s.M[15](e+148,t.initialPadding),s.M[15](e+152,t.trailingPadding),s.M[15](e+156,t.seekPreroll),s.M[15](e+160,t.bitFormat),e}},95007:(t,e,i)=>{"use strict";i.d(e,{A:()=>A});var r=i(134),s=i(95335),a=i(72739),n=i(73783),o=i(7417),l=i(4624),c="src/cheap/allocator/AllocatorJS.ts";const h=2,d=k(16),u=32,f=1+2*u,p=1,m=0,g=2,v=1,y=p+f+2;class A{constructor(t,e=!0){var i,a,n,o;(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"byteOffset",void 0),(0,r.A)(this,"heapOffset",void 0),(0,r.A)(this,"heapLength",void 0),(0,r.A)(this,"int32Array",void 0),(0,r.A)(this,"updates",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"shared",void 0),(0,r.A)(this,"handles",void 0),this.options=s.X$({growSize:1048576,maxHeapSize:2097152e3},t),this.handles=[],this.buffer=t.buffer,this.shared=!1,this.options.memory||this.buffer instanceof ArrayBuffer||this.buffer instanceof SharedArrayBuffer?(this.byteOffset=null!==(i=t.byteOffset)&&void 0!==i?i:0,this.heapOffset=S(this.byteOffset+w(u),null!==(a=t.byteLength)&&void 0!==a?a:this.buffer.byteLength),this.heapLength=I((null!==(n=t.byteLength)&&void 0!==n?n:this.buffer.byteLength)-this.heapOffset),this.int32Array=new Int32Array(this.buffer,this.heapOffset,k(this.heapLength)),this.updates=new Int32Array(this.buffer,this.byteOffset,u),"function"==typeof SharedArrayBuffer&&this.buffer instanceof SharedArrayBuffer&&(this.shared=!0)):l.h2("Expected buffer to be an instance of Buffer or ArrayBuffer",c,109),e&&(this.updates.fill(p),function(t){return t[p-1]===f&&t[p+f]===f}(o=this.int32Array)||function(t){const e=p,i=f,r=y,s=t.length-(e+i+2+v);E(t,i,e),t[e+m]=1,t[e+g]=r;for(let i=1;i<u;i++)t[e+g+i]=p;E(t,s,r),t[r+m]=1,t[r+g]=e}(o),function(t){let e=y;for(;e<t.length-v;){const i=_(t,e);i<2||i>=t.length-y?l.h2(`Got invalid sized chunk at ${w(e)} (${w(i)} bytes).`,c,568):R(t,e)?b(t,e,i):x(t,e,i),e+=i+2}}(this.int32Array))}addUpdateHandle(t){a.zy(this.handles,t)||this.handles.push(t)}removeUpdateHandle(t){a.TF(this.handles,t)}malloc_(t){(t=T(t,7))<16&&(t=16);const e=k(t),i=this.findFreeBlock(this.int32Array,e);if(i<=p)return 0;const r=_(this.int32Array,i);return r-(e+2)>=d?function(t,e,i,r,s){const a=e+i+2,n=r-(a-e);M(t,e,r,s),t[e-1]=-i,t[e+i]=-i,t[a-1]=-n,t[a+n]=-n,U(t,a,n,s)}(this.int32Array,i,e,r,this.updates):M(this.int32Array,i,r,this.updates),w(i)+this.heapOffset}malloc(t){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const e=this.malloc_(t);return this.shared&&(0,n.Tl)(o.II),e}calloc_(t,e){let i=t*e;i=i<16?16:T(i,7);const r=this.malloc_(i);if(0===r)return 0;const s=k(r-this.heapOffset);return this.int32Array.subarray(s,s+k(i)).fill(0),r}calloc(t,e){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const i=this.calloc_(t,e);return this.shared&&(0,n.Tl)(o.II),i}realloc_(t,e){if(0===t)return this.malloc_(e);const i=t;if(0===e)return this.free_(i),0;let r=k(t-=this.heapOffset),s=r,a=0;B(this.int32Array,r)&&(s=this.int32Array[r-1],a=r-s);const n=_(this.int32Array,s)-a;if(n>=k(T(e,7)))return i;{const t=this.malloc_(e);return 0===t?(this.free_(i),0):(this.int32Array.set(this.int32Array.subarray(r,r+n),k(t-this.heapOffset)),this.free_(i),t)}}realloc(t,e){return this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer()),t=this.realloc_(t,e),this.shared&&(0,n.Tl)(o.II),t}alignedAlloc_(t,e){if(t<=8)return this.malloc_(e);const i=this.malloc_(e+t-1+4);if(0===i)return 0;const r=i+t-1+4&~(t-1);return this.int32Array[k(r-this.heapOffset)-v]=k(i-this.heapOffset),r}alignedAlloc(t,e){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const i=this.alignedAlloc_(t,e);return this.shared&&(0,n.Tl)(o.II),i}free_(t){if(0===t)return;let e=k(t-=this.heapOffset);if(B(this.int32Array,e)&&(e=this.int32Array[e-v]),R(this.int32Array,e))return;const i=_(this.int32Array,e),r=D(this.int32Array,e),s=function(t,e){const i=_(t,e);if(e+i+2>=t.length-2)return 0;const r=e+i+2;return t[r-v]<2?0:r}(this.int32Array,e);0!==r?0!==s?function(t,e,i,r,s,a){const n=_(t,e),o=_(t,s),l=s-e+o;M(t,e,n,a),M(t,s,o,a),t[e-v]=-l,t[s+o]=-l,U(t,e,l,a)}(this.int32Array,r,0,0,s,this.updates):L(this.int32Array,r,e,i,this.updates):0!==s?function(t,e,i,r,s){const a=_(t,e);M(t,e,a,s);const n=r+a+2;t[i-v]=-n,t[e+a]=-n,U(t,i,n,s)}(this.int32Array,s,e,i,this.updates):U(this.int32Array,e,i,this.updates)}free(t){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer()),this.free_(t),this.shared&&(0,n.Tl)(o.II)}sizeof(t){if(0===t)return 0;let e=k(t-=this.heapOffset);return B(this.int32Array,e)&&(e=this.int32Array[e-v]),w(_(this.int32Array,e))}inspect(){return this.checkBuffer(),function(t,e){const i=[],r=P(t,p,e);let s=y,a=0;for(;s<t.length-v;){const r=_(t,s);(r<2||r>=t.length)&&l.h2(`Got invalid sized chunk at ${w(s)} (${w(r)})`,c,624),R(t,s)?i.push(P(t,s,e)):(a+=w(r),i.push({type:"used",block:s,offset:w(s)+e,size:w(r)})),s+=r+2}return{header:r,blocks:i,total:w(t.length),used:a}}(this.int32Array,this.heapOffset)}findFreeBlock(t,e){let i=function(t,e){let i=p;for(let r=t[p+m];r>0;r--){let s=t[i+g+(r-1)];for(;s!==p&&t[s-v]<e;)i=s,s=t[i+g+(r-1)]}return i=t[i+g],i}(t,e);if(i===p){if(this.options.growAllowed&&this.heapLength<this.options.maxHeapSize){const t=this.int32Array.length+1;let i,o,l=0,c=0,h=0;if(this.options.onResize){var r,s,n;const t=this.options.onResize(this.int32Array,this.int32Array.byteLength+T(Math.max(this.options.growSize,w(e)),7));l=null!==(r=t.byteOffset)&&void 0!==r?r:0,h=S(l+w(u),null!==(s=t.byteLength)&&void 0!==s?s:t.buffer.byteLength),c=I((null!==(n=t.byteLength)&&void 0!==n?n:t.buffer.byteLength)-h),i=new Int32Array(t.buffer,h,k(c)),o=new Int32Array(t.buffer,l,u)}else{const t=new ArrayBuffer(this.int32Array.length+k(this.options.growSize));h=S(l+w(u),t.byteLength),c=I(t.byteLength-h),i=new Int32Array(t,h,k(c)),i.set(this.int32Array,0),o=new Int32Array(t,l,u)}this.byteOffset=l,this.heapOffset=h,this.buffer=i.buffer,this.heapLength=c,this.int32Array=i,this.updates=o;const d=i.length-(t-1)-2;E(i,d,t);const f=D(i,t);return 0!==f?L(i,f,t,d,this.updates):U(i,t,d,this.updates),this.handles.length&&a.__(this.handles,(t=>{t(this.buffer)})),this.findFreeBlock(this.int32Array,e)}return i}return i}getBuffer(){return this.buffer}isAlloc(t){this.shared&&((0,n.s2)(o.II,!0),this.checkBuffer());const e=k(t-this.heapOffset);let i=this.int32Array[p+g];for(;i&&i!==p;){if(e>=i&&e<i+this.int32Array[i-v])return this.shared&&(0,n.Tl)(o.II),!1;i=this.int32Array[i+g]}return this.shared&&(0,n.Tl)(o.II),!0}checkBuffer(){this.options.memory&&this.options.memory.buffer!==this.buffer&&(this.buffer=this.options.memory.buffer,this.heapLength=I(this.buffer.byteLength-this.heapOffset),this.int32Array=new Int32Array(this.buffer,this.heapOffset,k(this.heapLength)))}}function b(t,e,i){t[e-1]!==t[e+i]&&l.h2(`Block length header does not match footer (${w(t[e-1])} vs ${w(t[e+i])}).`,c,584);const r=t[e+m];(r<1||r>u)&&l.h2(`Block ${w(e)} height must be between 1 and ${u}, got ${r}.`,c,589);for(let i=0;i<r;i++){const r=t[e+g+i];r>=y&&!R(t,r)&&l.h2(`Block ${w(e)} has a pointer to a non-free block (${w(r)}).`,c,595)}return!0}function x(t,e,i){if(t[e-1]===t[e+i])return!0;l.h2(`Block length header does not match footer (${w(t[e-1])} vs ${w(t[e+i])}).`,c,604)}function w(t){return t<<h>>>0}function k(t){return t>>>h}function T(t,e){return(t+e&~e)>>>0}function S(t,e){const i=e-t;return t+(T(i,7)===i?0:i-T(i,7)+8)}function I(t){return(p+f)%2||(t-=4),t}function P(t,e,i){const r=t[e+m],s=[];for(let i=0;i<r;i++)s.push(t[e+g+i]);return{type:"free",block:e,offset:w(e)+i,height:r,pointers:s,size:w(t[e-1])}}function _(t,e){const i=t[e-1],r=i>>31;return i+r^r}function E(t,e,i){t[i-1]=e,t[i+e]=e}function C(t,e,i){const r=t[p+m];let s=p;for(let a=r;a>0;a--){let r=s+g+(a-1);for(;t[r]>=y&&t[t[r]-1]<e;)s=t[r],r=s+g+(a-1);i[a-1]=s}}function M(t,e,i,r){C(t,i,r);let s=t[r[0]+g];for(;s!==e&&s!==p&&t[s-1]<=i;){for(let i=t[s+m]-1;i>=0;i--)t[s+g+i]===e&&(r[i]=s);s=t[s+g]}let a=t[p+m];for(let i=0;i<a&&t[r[i]+g+i]===e;i++)t[r[i]+g+i]=t[e+g+i];for(;a>0&&t[p+g+(a-1)]===p;)a--,t[p+m]=a;t[e-1]=-i,t[e+i]=-i}function R(t,e){return!(e<f)&&!(t[e-v]<0)}function B(t,e){return!(e<f)&&!(t[e-v]<0)}function D(t,e){if(e<=y)return 0;const i=t[e-2];return i<2?0:e-(2+i)}function U(t,e,i,r){C(t,i,r);const s=function(t,e,i,r){const s=t[p+m];let a=function(){let t=1;for(;Math.random()<.5&&t<u;)t+=1;return t}();if(i-1<a+1&&(a=i-2),a>s){const i=s+1;return t[p+m]=i,t[p+g+(i-1)]=p,r[i]=p,t[e+m]=i,i}return t[e+m]=a,a}(t,e,i,r);for(let i=1;i<=s;i++){const s=r[i-1]+g+(i-1);t[e+g+(i-1)]=t[s],t[s]=e,r[i-1]=p}return t[e-1]=i,t[e+i]=i,i}function L(t,e,i,r,s){const a=i-e+r;return M(t,e,i-e-2,s),t[e-v]=-a,t[i+r]=-a,U(t,e,a,s),r}},94321:(t,e,i)=>{"use strict";i.d(e,{z:()=>s});var r=i(134);class s{constructor(){(0,r.A)(this,"table",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"nodes",void 0),this.table=new WebAssembly.Table({initial:16,element:"anyfunc"}),this.pointer=6,this.nodes=[{pointer:this.pointer,length:10,free:!0}]}getPointer(){return this.pointer}alloc(t){let e=this.findFree(t);if(e<0){const i=this.nodes[this.nodes.length-1],r=t-(i.free?i.length:0);this.table.grow(r),i.free?i.length=i.length+r:this.nodes.push({pointer:i.pointer+i.length,length:r,free:!0}),e=this.findFree(t)}const i=this.nodes[e];return i.length>t&&(this.nodes.splice(e+1,0,{pointer:i.pointer+t,length:i.length-t,free:!0}),i.length=t),i.free=!1,i.pointer}free(t){let e=this.findNode(t);const i=this.nodes[e];if(i&&!i.free){const t=this.nodes[e-1],r=this.nodes[e+1];t&&t.free?r&&r.free?(t.length+=i.length+r.length,this.nodes.splice(e,2)):(t.length+=i.length,this.nodes.splice(e,1)):r&&r.free?(i.length+=r.length,this.nodes.splice(e+1,1),i.free=!0):i.free=!0}if(1===this.nodes.length&&this.nodes[0].free){const t=new WebAssembly.Table({initial:16,element:"anyfunc"});this.pointer=6,this.nodes=[{pointer:this.pointer,length:10,free:!0}];for(let e=1;e<this.pointer;e++)t.set(e,this.table.get(e));this.table=t}}get(t){return this.table.get(t)}set(t,e){if(t<0||t>=this.pointer)throw new RangeError("index out of bound");this.table.set(t,e)}inspect(){return this.nodes}findFree(t){let e=-1;for(let i=0;i<this.nodes.length;i++)if(this.nodes[i].length>=t&&this.nodes[i].free){e=i;break}return e}findNode(t){let e=-1;for(let i=0;i<this.nodes.length;i++)if(this.nodes[i].pointer===t){e=i;break}return e}}},98564:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>u});var r=i(4919),s=i(4624),a=i(63939),n=i(50932),o=i(88096),l=i(5679),c=i.n(l),h="src/cheap/asm/memory.ts";let d;async function u(t){try{let e=(0,r.E_)(c());o.DD(e,"function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer),d=(await WebAssembly.instantiate(e,{env:{memory:t}})).instance,(0,a.$)({4:d.exports.readU8,5:d.exports.readU8,2:d.exports.readU8,3:d.exports.readU8,6:d.exports.readU16,7:d.exports.readU16,8:t=>d.exports.read32(t)>>>0,9:t=>d.exports.read32(t)>>>0,10:t=>BigInt.asUintN(64,d.exports.read64(t)),22:t=>BigInt.asUintN(64,d.exports.read64(t)),11:d.exports.read8,12:d.exports.read8,13:d.exports.read16,14:d.exports.read16,15:d.exports.read32,16:d.exports.read32,17:d.exports.read64,21:d.exports.read64,18:d.exports.readf32,19:d.exports.readf64,20:t=>d.exports.read32(t)>>>0}),(0,n.$)({4:d.exports.write8,5:d.exports.write8,2:d.exports.write8,3:d.exports.write8,6:d.exports.write16,7:d.exports.write16,8:d.exports.write32,9:d.exports.write32,10:d.exports.write64,22:d.exports.write64,11:d.exports.write8,12:d.exports.write8,13:d.exports.write16,14:d.exports.write16,15:d.exports.write32,16:d.exports.write32,17:d.exports.write64,21:d.exports.write64,18:d.exports.writef32,19:d.exports.writef64,20:d.exports.write32})}catch(t){s.R8("memory asm not support, cannot use asm memory function",h,96)}}},26429:(t,e,i)=>{"use strict";i.r(e),i.d(e,{HEAP_INITIAL:()=>f,HEAP_MAXIMUM:()=>p,HEAP_OFFSET:()=>u,STACK_ALIGNMENT:()=>h,STACK_SIZE:()=>d,USE_THREADS:()=>c});var r,s,a=i(95797),n=i(10576),o=i(86834),l=i(44690);const c=!!a.A.thread&&!0!==n.TK.CHEAP_DISABLE_THREAD;let h=16,d=1048576;const u=1024,f=null!==(r=n.TK.CHEAP_HEAP_INITIAL)&&void 0!==r?r:265,p=null!==(s=n.TK.CHEAP_HEAP_MAXIMUM)&&void 0!==s?s:c&&l.A.ios&&o.A.safari&&!o.A.checkVersion(o.A.majorVersion,"17",!0)?8192:65536},73281:(t,e,i)=>{"use strict";i.d(e,{A:()=>M});var r=i(59135),s=i(63939),a=i(50932);let n,o;const l=(0,r.A)();function c(t,e){o().setUint8(t,e)}function h(t){return o().getUint8(t)}function d(t,e){o().setUint16(t,e,l)}function u(t){return o().getUint16(t,l)}function f(t,e){o().setUint32(t,e,l)}function p(t){return o().getUint32(t,l)}function m(t,e){o().setBigUint64(t,e,l)}function g(t){return o().getBigUint64(t,l)}function v(t,e){o().setInt8(t,e)}function y(t){return o().getInt8(t)}function A(t,e){o().setInt16(t,e,l)}function b(t){return o().getInt16(t,l)}function x(t,e){o().setInt32(t,e,l)}function w(t){return o().getInt32(t,l)}function k(t,e){o().setBigInt64(t,e,l)}function T(t){return o().getBigInt64(t,l)}function S(t,e){o().setFloat32(t,e,l)}function I(t){return o().getFloat32(t,l)}function P(t,e){o().setFloat64(t,e,l)}function _(t){return o().getFloat64(t,l)}function E(t){return o().getUint32(t,l)}function C(t,e){return o().setUint32(t,e,l)}function M(t,e){n=t,o=e,(0,s.$)({4:h,5:h,2:h,3:h,6:u,7:u,8:p,9:p,10:g,11:y,12:y,13:b,14:b,15:w,16:w,17:T,18:I,19:_,20:E,23:t=>!!y(t),24:t=>!!y(t)}),(0,a.$)({4:c,5:c,2:c,3:c,6:d,7:d,8:f,9:f,10:m,11:v,12:v,13:A,14:A,15:x,16:x,17:k,18:S,19:P,20:C,23:(t,e)=>{v(t,e?1:0)},24:(t,e)=>{v(t,e?1:0)}})}},63939:(t,e,i)=>{"use strict";i.d(e,{$:()=>a,f:()=>s});var r=i(95335);const s={4:function(t){throw new Error("unimplemented")},5:function(t){throw new Error("unimplemented")},2:function(t){throw new Error("unimplemented")},3:function(t){throw new Error("unimplemented")},6:function(t){throw new Error("unimplemented")},7:function(t){throw new Error("unimplemented")},8:function(t){throw new Error("unimplemented")},9:function(t){throw new Error("unimplemented")},10:function(t){throw new Error("unimplemented")},11:function(t){throw new Error("unimplemented")},12:function(t){throw new Error("unimplemented")},13:function(t){throw new Error("unimplemented")},14:function(t){throw new Error("unimplemented")},15:function(t){throw new Error("unimplemented")},16:function(t){throw new Error("unimplemented")},17:function(t){throw new Error("unimplemented")},18:function(t){throw new Error("unimplemented")},19:function(t){throw new Error("unimplemented")},20:function(t){throw new Error("unimplemented")},0:function(t){throw new Error("invalid operate")},1:function(t){throw new Error("invalid operate")},22:function(t){throw new Error("invalid operate")},21:function(t){throw new Error("invalid operate")},23:function(t){throw new Error("invalid operate")},24:function(t){throw new Error("invalid operate")}};function a(t){r.X$(s,t)}},50932:(t,e,i)=>{"use strict";i.d(e,{$:()=>a,M:()=>s});var r=i(95335);const s={4:function(t,e){throw new Error("unimplemented")},5:function(t,e){throw new Error("unimplemented")},2:function(t,e){throw new Error("unimplemented")},3:function(t,e){throw new Error("unimplemented")},6:function(t,e){throw new Error("unimplemented")},7:function(t,e){throw new Error("unimplemented")},8:function(t,e){throw new Error("unimplemented")},9:function(t,e){throw new Error("unimplemented")},10:function(t,e){throw new Error("unimplemented")},11:function(t,e){throw new Error("unimplemented")},12:function(t,e){throw new Error("unimplemented")},13:function(t,e){throw new Error("unimplemented")},14:function(t,e){throw new Error("unimplemented")},15:function(t,e){throw new Error("unimplemented")},16:function(t,e){throw new Error("unimplemented")},17:function(t,e){throw new Error("unimplemented")},18:function(t,e){throw new Error("unimplemented")},19:function(t,e){throw new Error("unimplemented")},20:function(t,e){throw new Error("unimplemented")},0:function(t,e){throw new Error("invalid operate")},1:function(t,e){throw new Error("invalid operate")},22:function(t,e){throw new Error("invalid operate")},21:function(t,e){throw new Error("invalid operate")},23:function(t,e){throw new Error("invalid operate")},24:function(t,e){throw new Error("invalid operate")}};function a(t){r.X$(s,t)}},25323:(t,e,i)=>{"use strict";i.d(e,{X:()=>M,l:()=>C});var r=i(66681),s=i.n(r),a=i(11919),n=i.n(a),o=i(75019),l=i.n(o),c=i(99921),h=i(63939),d=i(50932),u=i(61499),f=i(6704),p=i(67672),m=i(95335),g=i(62100),v=i(72739);function y(t,e,i,r){s()(t,e,{get:i,set:r,configurable:!0,enumerable:!0})}function A(t){return function(){return h.f[20](t())}}function b(t,e,i,r){return function(){return t[`__$__${e}`]||(t[`__$__${e}`]=C(i(),r))}}function x(t,e){return function(){return h.f[e](t())}}function w(t,e,i,r){const s=8*f.i[e]-r-i,a=Math.pow(2,i)-1;return function(){return h.f[e](t())>>>s&a}}function k(t){return function(e){d.M[8](t(),e)}}function T(t,e,i,r){const s=`__$__${e}`;return function(e){const a=t[s]||(t[s]=C(i(),r));m.__(e,((t,e)=>{a[e]=t})),t[s]=a}}function S(t,e){return function(i){d.M[e](t(),i)}}function I(t,e,i,r){let s=0,a=8*f.i[e];for(let t=0;t<i;t++)s|=1<<a-1-(t+r);const n=Math.pow(2,i)-1,o=a-r-i;return function(i){const r=t(),a=h.f[e](r);d.M[e](r,a&~s|(i&n)<<o)}}function P(t,e,i){return function(){const r=e[`__$__${i}`];return r[u.o9]=t(),r}}function _(t,e,i,r,s){const a=`__$__${e}`;return function(e){let n=t[a]||function(t,e,i){const r={};let s=(0,c.A)(i);for(let a=0;a<e;a++){const e=(0,g.A)(a);y(r,e,b(r,e,(()=>t()+s*a),i),T(r,e,(()=>t()+s*a),i))}return r}(i,r,s);n[u.o9]=i(),v.__(e,((t,e)=>{n[e]=t})),t[a]=n}}function E(t,e,i,r,s){const a=`__$__${e}`;return function(e){let n=t[a]||function(t,e,i){const r={};let s=(0,c.A)(i);for(let a=0;a<e;a++)y(r,(0,g.A)(a),x((()=>t()+s*a),i),S((()=>t()+s*a),i));return r}(i,r,s);n[u.o9]=i(),v.__(e,((t,e)=>{n[e]=t})),t[a]=n}}function C(t,e){let i=p.Pc(e)?e.prototype:e;const r={};for(r[u.o9]=t,n()(r,i);;){let t=i[u.JY];if(t&&t.forEach(((t,e)=>{t[3]?t[1]?y(r,e,P((()=>r[u.o9]+t[7]),r,e),E(r,e,(()=>r[u.o9]+t[7]),t[4],20)):p.Pc(t[0])||p.Ik(t[0])?y(r,e,P((()=>r[u.o9]+t[7]),r,e),_(r,e,(()=>r[u.o9]+t[7]),t[4],t[0])):y(r,e,P((()=>r[u.o9]+t[7]),r,e),E(r,e,(()=>r[u.o9]+t[7]),t[4],t[0])):t[1]?y(r,e,A((()=>r[u.o9]+t[7])),k((()=>r[u.o9]+t[7]))):p.Pc(t[0])||p.Ik(t[0])?y(r,e,b(r,e,(()=>r[u.o9]+t[7]),t[0]),T(r,e,(()=>r[u.o9]+t[7]),t[0])):t[5]?y(r,e,w((()=>r[u.o9]+t[7]),t[0],t[6],t[8]),I((()=>r[u.o9]+t[7]),t[0],t[6],t[8])):y(r,e,x((()=>r[u.o9]+t[7]),t[0]),S((()=>r[u.o9]+t[7]),t[0]))})),i=l()(i),!i)break}return r}function M(t){let e=l()(t);for(;;){let i=e[u.JY];if(i&&i.forEach(((e,i)=>{delete t[i]})),e=l()(e),!e)break}}},12085:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(66681),s=i.n(r);function a(t,e,i){s()(t,e,{value:i,writable:!1,enumerable:!1,configurable:!1})}},11473:(t,e,i)=>{"use strict";i.d(e,{GE:()=>y,KZ:()=>F,Tg:()=>G,XI:()=>x,ce:()=>k,eq:()=>N,hZ:()=>O,pv:()=>V,s_:()=>w,wE:()=>A});var r=i(39638),s=i(95007),a=i(94321),n=i(10576),o=i(26429),l=i(7417),c=i(33856),h=i(98564),d=i(82854),u=i(73281),f=i(54568),p=i(86834);let m=-1,g=!0,v="",y=null,A=null,b=0,x=null,w=null,k=null,T=null,S=null,I=null,P=null,_=null,E=null,C=null,M=null,R=null,B=null,D=null,U={5:_,3:_,7:E,9:C,22:M,12:T,14:S,16:I,21:P};function L(){return!(!k||k.buffer===_.buffer)}function N(){return L()&&z(k.buffer),_}function O(){return L()&&z(k.buffer),E}function F(){return L()&&z(k.buffer),D}function $(t){return L()&&z(k.buffer),U[t]}function z(t){T=new Int8Array(t),S=new Int16Array(t),I=new Int32Array(t),P=new BigInt64Array(t),_=new Uint8Array(t),E=new Uint16Array(t),C=new Uint32Array(t),M=new BigUint64Array(t),R=new Float32Array(t),B=new Float64Array(t),D=new DataView(t),U={5:_,3:_,7:E,9:C,22:M,12:T,14:S,16:I,21:P}}function V(){return Atomics.add(C,l.hb>>>2,1)}async function G(t){var e;(0,u.A)((()=>w),F),(0,c.A)($),k=t.memory;var i;i=new s.A({buffer:k.buffer,memory:k,byteOffset:o.HEAP_OFFSET,maxHeapSize:64*o.HEAP_MAXIMUM*1024,growAllowed:!0,onResize:(t,e)=>(k.grow(e-t.byteLength>>>16),{buffer:k.buffer,byteOffset:o.HEAP_OFFSET})},!1),w&&w.removeUpdateHandle(z),w=i,n.TK.CHeap&&(n.TK.CHeap.Allocator=w),w.addUpdateHandle(z),z(w.getBuffer()),t.stackPointer&&(b=t.stackSize,A=t.stackPointer,y=new WebAssembly.Global({value:"i32",mutable:!0},A+b),x=new a.z),m="number"==typeof t.id?t.id:Atomics.add(C,l.hb>>>2,1),v=null!==(e=t.name)&&void 0!==e?e:"anonymous",n.TK.CHeap={initThread:G,Allocator:w,Table:x,ThreadId:m,ThreadName:v,Memory:k,Config:o,StackSize:b,StackTop:A,StackPointer:y,isMainThread:!1},g=!1,t.disableAsm||("function"==typeof BigInt&&BigInt!==Number&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||p.A.newEdge)&&await(0,h.Ay)(k),o.USE_THREADS&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||p.A.newEdge)&&await(0,d.Ay)(k))}!(0,r.A)()&&!(0,f.A)()||(0,r.A)()&&!o.USE_THREADS?function(){var t,e,i,r,f,T,S,P;if((0,u.A)((()=>w),F),(0,c.A)($),k=null!==(t=n.TK.CHeap)&&void 0!==t&&t.Memory?n.TK.CHeap.Memory:new WebAssembly.Memory({initial:o.HEAP_INITIAL,maximum:o.HEAP_MAXIMUM,shared:o.USE_THREADS}),w=null!==(e=n.TK.CHeap)&&void 0!==e&&e.Allocator?n.TK.CHeap.Allocator:new s.A({buffer:k.buffer,memory:k,byteOffset:o.HEAP_OFFSET,maxHeapSize:64*o.HEAP_MAXIMUM*1024,growAllowed:!0,onResize:(t,e)=>(k.grow(e-t.byteLength>>>16),{buffer:k.buffer,byteOffset:o.HEAP_OFFSET})}),w.addUpdateHandle(z),z(w.getBuffer()),b=null!==(i=n.TK.CHeap)&&void 0!==i&&i.StackSize?n.TK.CHeap.StackSize:o.STACK_SIZE,A=null!==(r=n.TK.CHeap)&&void 0!==r&&r.StackTop?n.TK.CHeap.StackTop:w.malloc(b),y=null!==(f=n.TK.CHeap)&&void 0!==f&&f.StackPointer?n.TK.CHeap.StackPointer:new WebAssembly.Global({value:"i32",mutable:!0},A+b),x=null!==(T=n.TK.CHeap)&&void 0!==T&&T.Table?n.TK.CHeap.Table:new a.z,m=null!==(S=n.TK.CHeap)&&void 0!==S&&S.ThreadId?n.TK.CHeap.ThreadId:0,v=null!==(P=n.TK.CHeap)&&void 0!==P&&P.ThreadName?n.TK.CHeap.ThreadName:"main",!n.TK.CHeap)if(o.USE_THREADS)Atomics.store(C,l.hb>>>2,m+1),Atomics.store(I,l.II>>>2,0);else{C[l.hb>>>2]=m+1;let t=l.II>>>2;I[t]=0}"function"==typeof BigInt&&BigInt!==Number&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||p.A.newEdge)&&(0,h.Ay)(k),o.USE_THREADS&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||p.A.newEdge)&&(0,d.Ay)(k),n.TK.CHeap||(n.TK.CHeap={Allocator:w,Table:x,ThreadId:m,ThreadName:v,Memory:k,Config:o,StackSize:b,StackTop:A,StackPointer:y,isMainThread:!0,threadCounter:l.hb,heapMutex:l.II}),g=!0}():(n.TK.CHeap={initThread:G,isMainThread:!1,Config:o},g=!1)},80098:(t,e,i)=>{"use strict";i.d(e,{I_:()=>y,SQ:()=>A});var r=i(75019),s=i.n(r),a=i(11919),n=i.n(a),o=i(99921),l=i(63939),c=i(50932),h=i(61499),d=i(6704),u=i(67672),f=i(95335),p=i(72739),m=i(2148);const g=s()({});function v(t,e){for(;;){let i=t[h.JY];if(i){const t=i.get(e);if(t)return t}if(!(t=s()(t))||t===g)return null}}function y(t,e){const i=u.Pc(e)?e.prototype:e,r={};r[h.o9]=t,n()(r,i);const{proxy:s,revoke:a}=Proxy.revocable(r,{get(t,e,r){if(u.Yj(e)){const r=v(i,e.replace(/^\$+/,""));if(r){const i=t[h.o9]+r[7];if(r[3]){const r=t[e];return r[h.o9]=i,r}if(r[1])return l.f[20](i);if(u.Pc(r[0])||u.Ik(r[0]))return t[e]||(t[e]=y(i,r[0]));{let t=l.f[r[0]](i);return r[5]&&(t=t>>>8*d.i[r[0]]-r[8]-r[6]&Math.pow(2,r[6])-1),t}}return t[e]}return t[e]},set(t,e,r,s){if(u.Yj(e)){const s=v(i,e.replace(/^\$+/,""));if(s){const i=t[h.o9]+s[7];if(s[3]){const a=t[e]||function(t,e,i,r){const s={};s[h.o9]=t;let a=(0,o.A)(r?20:i);return new Proxy(s,{get(t,e,s){if(e===h.o9)return t[h.o9];const n=(0,m.A)(e);return r?l.f[20](t[h.o9]+n*a):u.Pc(i)?t[e]:l.f[i](t[h.o9]+n*a)},set(t,e,s,n){if(e===h.o9)return t[h.o9]=s,!0;const o=(0,m.A)(e);if(r)c.M[20](t[h.o9]+o*a,s),t[e]=s;else if(u.Pc(i)){const r=t[e]||(t[e]=y(t[h.o9]+o*a,i));f.__(s,((t,e)=>{r[e]=t})),t[e]=r}else c.M[i](t[h.o9]+o*a,s),t[e]=s;return!0}})}(i,s[4],s[0],s[1]);p.__(r,((t,e)=>{a[e]=t})),t[e]=a}else if(s[1])c.M[20](i,r),t[e]=r;else if(u.Pc(s[0])||u.Ik(s[0])){const a=t[e]||(t[e]=y(i,s[0]));f.__(r,((t,e)=>{a[e]=t})),t[e]=a}else{if(s[5]){let t=0,e=8*d.i[s[0]];for(let i=0;i<s[6];i++)t|=1<<e-1-(i+s[8]);const a=l.f[s[0]](i);c.M[s[0]](i,a&~t|(r&Math.pow(2,s[6])-1)<<e-s[8]-s[6])}else c.M[s[0]](i,r);t[e]=r}}else t[e]=r}else t[e]=r;return!0}});return r[h.kE]=a,s}function A(t){const e=t[h.kE];e&&e()}},52699:(t,e,i)=>{"use strict";i.d(e,{t:()=>a,z:()=>s});var r=i(11473);function s(t){return r.GE.value-=t,r.GE.value}function a(t){r.GE.value+=t}},7417:(t,e,i)=>{"use strict";i.d(e,{II:()=>c,hb:()=>l,z1:()=>o});var r,s,a=i(10576);let n=1;function o(t,e=1){let i=n;for(;i%e;)i+=1;return n=i+t,i}const l=null!==(r=a.TK.CHeap)&&void 0!==r&&r.threadCounter?a.TK.CHeap.threadCounter:o(4,4),c=null!==(s=a.TK.CHeap)&&void 0!==s&&s.heapMutex?a.TK.CHeap.heapMutex:o(4,4)},79630:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(134),s=i(63939),a=i(50932),n=i(11473),o=i(61403);class l{constructor(t,e){(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"len",void 0),this.pointer=t,this.len=e}get byteLength(){return this.len}get buffer(){return(0,n.eq)().buffer}get byteOffset(){return this.pointer}getFloat32(t,e){return(0,n.KZ)().getFloat32(this.pointer+t,e)}getFloat64(t,e){return(0,n.KZ)().getFloat64(this.pointer+t,e)}getInt8(t){return(0,n.KZ)().getInt8(this.pointer+t)}getInt16(t,e){return(0,n.KZ)().getInt16(this.pointer+t,e)}getInt32(t,e){return(0,n.KZ)().getInt32(this.pointer+t,e)}getUint8(t){return(0,n.KZ)().getUint8(this.pointer+t)}getUint16(t,e){return(0,n.KZ)().getUint16(this.pointer+t,e)}getUint32(t,e){return(0,n.KZ)().getUint32(this.pointer+t,e)}setFloat32(t,e,i){(0,n.KZ)().setFloat32(this.pointer+t,e,i)}setFloat64(t,e,i){(0,n.KZ)().setFloat64(this.pointer+t,e,i)}setInt8(t,e){(0,n.KZ)().setInt8(this.pointer+t,e)}setInt16(t,e,i){(0,n.KZ)().setInt16(this.pointer+t,e,i)}setInt32(t,e,i){(0,n.KZ)().setInt32(this.pointer+t,e,i)}setUint8(t,e){(0,n.KZ)().setUint8(this.pointer+t,e)}setUint16(t,e,i){(0,n.KZ)().setUint16(this.pointer+t,e,i)}setUint32(t,e,i){(0,n.KZ)().setUint32(this.pointer+t,e,i)}getBigInt64(t,e){return(0,n.KZ)().getBigInt64(this.pointer+t,e)}getBigUint64(t,e){return(0,n.KZ)().getBigUint64(this.pointer+t,e)}setBigInt64(t,e,i){(0,n.KZ)().setBigInt64(this.pointer+t,e,i)}setBigUint64(t,e,i){(0,n.KZ)().setBigUint64(this.pointer+t,e,i)}}class c extends o.A{constructor(t,e){return super(),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"len",void 0),this.pointer=t,this.len=e,this.proxy}getIndexValue(t){return s.f[2](this.pointer+t)}setIndexValue(t,e){a.M[2](this.pointer+t,e)}set(t,e=0){(0,n.eq)().set(t,this.pointer+e)}subarray(t=0,e,i){return i?new c(this.pointer+t,(e||this.len)-t):(0,n.eq)().subarray(this.pointer+t,this.pointer+(null!=e?e:this.len))}slice(t=0,e){return(0,n.eq)().slice(this.pointer+t,this.pointer+(null!=e?e:this.len))}get length(){return this.len}get byteLength(){return this.len}get buffer(){return(0,n.eq)().buffer}get byteOffset(){return this.pointer}get view(){return new l(this.pointer,this.len)}}},12264:(t,e,i)=>{"use strict";i.d(e,{A:()=>y});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085),h=i(11473),d=i(63939),u=i(50932),f=i(99921),p=i(14686),m=i(67672),g=i(29170);class v{constructor(){(0,a.A)(this,"prev",void 0),(0,a.A)(this,"next",void 0),(0,a.A)(this,"data",void 0)}}r=v.prototype,(s=new(o())).set("prev",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("next",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("data",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,4),(0,c.A)(r,l.g7,12),(0,c.A)(r,l.JY,s);class y{constructor(){(0,a.A)(this,"length",0),(0,a.A)(this,"head",0),(0,a.A)(this,"tail",0)}createNode(t,e,i=!1){const r=h.s_.malloc(12);if(u.M[20](r+4,0),u.M[20](r,0),m.ai(e))if(20===e)u.M[20](r+8,t);else{const i=h.s_.malloc((0,f.A)(e));u.M[e](i,t),u.M[20](r+8,i)}else if(i)u.M[20](r+8,t);else{const i=h.s_.malloc((0,f.A)(e));(0,p.Mr)(i,t[l.o9],(0,f.A)(e)),u.M[20](r+8,i)}return r}getItem(t,e){let i;return i=m.ai(e)?20===e?t:d.f[e](t):(0,g.A)(t,e),i}push(t,e,i=!1){const r=this.createNode(t,e,i);this.tail?(u.M[20](this.tail+4,r),u.M[20](r,this.tail),this.tail=r):(this.head=r,this.tail=r),this.length++}pop(t){const e=this.tail;let i=this.getItem(d.f[20](e+8),t);return this.length>1?(u.M[20](d.f[20](e)+4,0),this.tail=d.f[20](e)):(this.head=0,this.tail=0),this.length--,h.s_.free(d.f[20](e+8)),h.s_.free(e),i}shift(t){const e=this.head;let i=this.getItem(d.f[20](e+8),t);return this.length>1?(u.M[20](d.f[20](e+4),0),this.head=d.f[20](e+4)):(this.head=0,this.tail=0),this.length--,h.s_.free(d.f[20](e+8)),h.s_.free(e),i}unshift(t,e,i=!1){const r=this.createNode(t,e,i);this.head?(u.M[20](this.head,r),u.M[20](r+4,this.head),this.head=r):(this.head=r,this.tail=r),this.length++}forEach(t,e){if(!this.length)return;let i=this.head,r=0;for(;0!==i&&!1!==t(this.getItem(d.f[20](i+8),e),r);)i=d.f[20](i+4),r++}find(t,e){if(!this.length)return 0;let i=this.head,r=0;for(;0!==i;){const s=this.getItem(d.f[20](i+8),e);if(!0===t(s,r))return s;i=d.f[20](i+4),r++}return 0}indexOf(t,e){if(!this.length)return 0;let i=this.head,r=0;for(;0!==i;){if(r===t)return this.getItem(d.f[20](i+8),e);i=d.f[20](i+4),r++}return 0}clear(t,e){if(this.length){let i=this.head;for(;0!==i;){t&&t(this.getItem(d.f[20](i+8),e)),h.s_.free(d.f[20](i+8));const r=d.f[20](i+4);h.s_.free(i),i=r}}this.head=0,this.tail=0,this.length=0}}!function(t){var e=new(o());e.set("length",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("head",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("tail",{0:v,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),(0,c.A)(t,l.Og,!0),(0,c.A)(t,l.dc,4),(0,c.A)(t,l.g7,12),(0,c.A)(t,l.JY,e)}(y.prototype)},72703:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(67672);function s(t){return r.ai(t)&&t>=0}},74503:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(99921),s=i(11473),a=i(14686),n=i(95335),o=i(34677),l=i(29170);function c(t,e){const i=(0,r.A)(t),c=s.s_.malloc(i);if(!c)throw new TypeError("cannot alloc memory for struct");(0,a.sO)(c,0,i);const h=(0,l.A)(c,t),d=new t;return e&&n.X$(d,e),n.__(d,((t,e)=>{(0,o.A)(t)&&(h[e]=t)})),h}},14686:(t,e,i)=>{"use strict";i.d(e,{JW:()=>u,Mr:()=>c,bg:()=>p,lH:()=>m,lW:()=>h,qW:()=>g,s3:()=>f,sO:()=>d});var r=i(11473),s=i(70812),a=i(50011),n=i(50932),o=i(79630),l=i(26429);function c(t,e,i){(0,r.eq)().set((0,r.eq)().subarray(e,e+i),t)}function h(t,e,i){(0,r.eq)().set(i.subarray(0,e),t)}function d(t,e,i){(0,r.eq)().subarray(t,t+i).fill(e)}function u(t,e){return l.USE_THREADS?f(t,e):new o.A(t,e)}function f(t,e){return(0,r.eq)().subarray(t,t+e)}function p(t,e){return(0,r.hZ)().subarray(t>>>1,(t>>>1)+e)}function m(t,e){const i=(0,s.b2)(t),r=Math.min(i,null!=e?e:i);return a.decode(f(t,r))}function g(t,e,i,r=!0){const s=a.encode(e);let o=s.length,l=r?1:0;i&&o-l>i&&(o=i-l),h(t,o,s),r&&n.M[11](t+o,0)}},99921:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(61499),s=i(67672),a=i(6704);function n(t){return s.ai(t)?a.i[t]||0:s.Pc(t)&&t.prototype[r.Og]?t.prototype[r.g7]:0}},70812:(t,e,i)=>{"use strict";i.d(e,{b2:()=>s});var r=i(63939);function s(t){let e=0;for(;r.f[4]((t+=1)-1);)e++;return e}},29170:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(61499),s=i(80098),a=i(25323),n=i(95797),o=i(67672),l=i(10534);function c(t,e){return arguments[2]&&o.Yj(arguments[2])&&(e=e.prototype,l.__(arguments[2],(t=>{const i=e[r.JY];e=i.get(t)[0]}))),n.A.proxy?(0,s.I_)(t,e):(0,a.l)(t,e)}},94300:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(11473),s=i(61499),a=i(80098),n=i(25323),o=i(95797);function l(t){const e=t[s.o9];e&&(r.s_.free(e),t[s.o9]=0,o.A.proxy?(0,a.SQ)(t):(0,n.X)(t))}},61499:(t,e,i)=>{"use strict";i.d(e,{JY:()=>c,Og:()=>a,dc:()=>o,g7:()=>n,kE:()=>h,o9:()=>l});var r=i(75062),s=i.n(r);const a=s()("Struct"),n=s()("StructLength"),o=s()("StructMaxBaseTypeByteLength"),l=s()("StructAddress"),c=(s()("StructKeysQueue"),s()("StructKeysMeta")),h=(s()("StructKeysInstance"),s()("StructProxyRevoke"))},82854:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>u,KJ:()=>h,Ko:()=>d});var r=i(4919),s=i(4624),a=i(88096),n=i(19985),o=i.n(n),l=i(40046),c="src/cheap/thread/asm/atomics.ts";let h;function d(){return!!h}async function u(t){try{if(!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))return;{const e=(0,r.E_)(o());a.DD(e,!0),h=(await WebAssembly.instantiate(e,{env:{memory:t}})).instance}(0,l.$Z)({add:function(t,e,i){switch(i){case 5:case 3:return 255&h.exports.add8(t,e);case 12:return h.exports.add8(t,e);case 14:return h.exports.add16(t,e);case 7:return 65535&h.exports.add16(t,e);case 16:return h.exports.add32(t,e);case 9:return 4294967295&h.exports.add32(t,e);case 21:return h.exports.add64(t,e);case 22:return BigInt.asUintN(64,h.exports.add64(t,e))}},sub:function(t,e,i){switch(i){case 5:case 3:return 255&h.exports.sub8(t,e);case 12:return h.exports.sub8(t,e);case 14:return h.exports.sub16(t,e);case 7:return 65535&h.exports.sub16(t,e);case 16:return h.exports.sub32(t,e);case 9:return 4294967295&h.exports.sub32(t,e);case 21:return h.exports.sub64(t,e);case 22:return BigInt.asUintN(64,h.exports.sub64(t,e))}},and:function(t,e,i){switch(i){case 5:case 3:return 255&h.exports.and8(t,e);case 12:return h.exports.and8(t,e);case 14:return h.exports.and16(t,e);case 7:return 65535&h.exports.and16(t,e);case 16:return h.exports.and32(t,e);case 9:return 4294967295&h.exports.and32(t,e);case 21:return h.exports.and64(t,e);case 22:return BigInt.asUintN(64,h.exports.and64(t,e))}},or:function(t,e,i){switch(i){case 5:case 3:return 255&h.exports.or8(t,e);case 12:return h.exports.or8(t,e);case 14:return h.exports.or16(t,e);case 7:return 65535&h.exports.or16(t,e);case 16:case 9:return h.exports.or32(t,e);case 21:return h.exports.or64(t,e);case 22:return BigInt.asUintN(64,h.exports.or64(t,e))}},xor:function(t,e,i){switch(i){case 5:case 3:return 255&h.exports.xor8(t,e);case 12:return h.exports.xor8(t,e);case 14:return h.exports.xor16(t,e);case 7:return 65535&h.exports.xor16(t,e);case 16:case 9:return h.exports.xor32(t,e);case 21:return h.exports.xor64(t,e);case 22:return BigInt.asUintN(64,h.exports.xor64(t,e))}},store:function(t,e,i){switch(i){case 5:case 12:case 3:return h.exports.store8(t,e);case 14:case 7:return h.exports.store16(t,e);case 16:case 9:return h.exports.store32(t,e);case 21:case 22:return h.exports.store64(t,e)}},load:function(t,e){switch(e){case 5:case 3:return 255&h.exports.load8(t);case 12:return h.exports.load8(t);case 14:case 7:return h.exports.load16(t);case 16:return h.exports.load32(t);case 9:return 4294967295&h.exports.load32(t);case 21:return h.exports.load64(t);case 22:return BigInt.asUintN(64,h.exports.load64(t))}},compareExchange:function(t,e,i,r){switch(r){case 5:case 3:return 255&h.exports.compare_exchange8(t,e,i);case 12:return h.exports.compare_exchange8(t,e,i);case 14:return h.exports.compare_exchange16(t,e,i);case 7:return 65535&h.exports.compare_exchange16(t,e,i);case 16:return h.exports.compare_exchange32(t,e,i);case 9:return 4294967295&h.exports.compare_exchange32(t,e,i);case 21:return h.exports.compare_exchange64(t,e,i);case 22:return BigInt.asUintN(64,h.exports.compare_exchange64(t,e,i))}},exchange:function(t,e,i){switch(i){case 5:case 3:return 255&h.exports.exchange8(t,e);case 12:return h.exports.exchange8(t,e);case 14:return h.exports.exchange16(t,e);case 7:return 65535&h.exports.exchange16(t,e);case 16:return h.exports.exchange32(t,e);case 9:return 4294967295&h.exports.exchange32(t,e);case 21:return h.exports.exchange64(t,e);case 22:return BigInt.asUintN(64,h.exports.exchange64(t,e))}},notify:function(t,e){return h.exports.notify(t,e)},wait:function(t,e){return h.exports.wait(t,e)},waitTimeout:function(t,e,i){return h.exports.waitTimeout(t,e,BigInt(0|i))}})}catch(t){s.R8("atomics asm not support, cannot use asm atomics function",c,284)}}},40046:(t,e,i)=>{"use strict";let r,s,a,n,o,l,c,h,d,u,f,p,m,g;function v(t){t.add&&(r=t.add),t.sub&&(s=t.sub),t.and&&(a=t.and),t.or&&(n=t.or),t.xor&&(o=t.xor),t.store&&(l=t.store),t.load&&(c=t.load),t.compareExchange&&(h=t.compareExchange),t.exchange&&(d=t.exchange),t.notify&&(u=t.notify),t.wait&&(f=t.wait),t.waitTimeout&&(p=t.waitTimeout),t.waitAsync&&(m=t.waitAsync),t.waitTimeoutAsync&&(g=t.waitTimeoutAsync)}i.d(e,{$Z:()=>v,Hh:()=>c,I8:()=>o,M_:()=>l,Uo:()=>a,WQ:()=>r,cv:()=>d,j4:()=>p,jb:()=>s,me:()=>u,or:()=>n,p_:()=>h,uk:()=>f})},33856:(t,e,i)=>{"use strict";i.d(e,{A:()=>_});var r=i(54001),s=i.n(r),a=i(86932),n=i(7972),o=i(40046),l=i(26429),c=i(86834),h=i(95797);let d;const u=l.USE_THREADS||!c.A.chrome&&h.A.atomics||c.A.checkVersion(c.A.majorVersion,"94",!0);function f(t,e,i,r){if(u)return Atomics.add(d(i),t>>>r,e);{const s=d(i),a=t>>>r,n=s[a];return s[a]+=e,n}}function p(t,e,i,r){if(u)return Atomics.sub(d(i),t>>>r,e);{const s=d(i),a=t>>>r,n=s[a];return s[a]-=e,n}}function m(t,e,i,r){if(u)return Atomics.and(d(i),t>>>r,e);{const s=d(i),a=t>>>r,n=s[a];return s[a]&=e,n}}function g(t,e,i,r){if(u)return Atomics.or(d(i),t>>>r,e);{const s=d(i),a=t>>>r,n=s[a];return s[a]|=e,n}}function v(t,e,i,r){if(u)return Atomics.xor(d(i),t>>>r,e);{const s=d(i),a=t>>>r,n=s[a];return s[a]^=e,n}}function y(t,e,i,r){if(u)return Atomics.store(d(i),t>>>r,e);{const s=d(i),a=t>>>r,n=s[a];return s[a]=e,n}}function A(t,e,i){return u?Atomics.load(d(e),t>>>i):d(e)[t>>>i]}function b(t,e,i,r,s){if(u)return Atomics.compareExchange(d(r),t>>>s,e,i);{const a=d(r),n=t>>>s,o=a[n];return o===e&&(a[n]=i),o}}function x(t,e,i,r){if(u)return Atomics.exchange(d(i),t>>>r,e);{const s=d(i),a=t>>>r,n=s[a];return s[a]=e,n}}function w(t,e){return u?Atomics.notify(d(16),t>>>2,e):void 0}const k={ok:0,"not-equal":1,"timed-out":2};function T(t,e){return k[Atomics.wait(d(16),t>>>2,e)]}function S(t,e,i){return k[Atomics.wait(d(16),t>>>2,e,i)]}async function I(t,e){if(Atomics.waitAsync){const i=Atomics.waitAsync(d(16),t>>>2,e);return i.async?k[await i.value]:k[i.value]}if(A(t)!==e)return 1;for(;A(t)===e;)await new(s())((t=>{(0,n.A)((()=>{t()}))}));return 0}async function P(t,e,i){if(Atomics.waitAsync){const r=Atomics.waitAsync(d(16),t>>>2,e,i);return r.async?k[await r.value]:k[r.value]}if(A(t)!==e)return 1;{const r=(0,a.A)();for(;A(t)===e&&(0,a.A)()-r<i;)await new(s())((t=>{(0,n.A)((()=>{t()}))}));return A(t)!==e?0:2}}function _(t){d=t,(0,o.$Z)({add:f,sub:p,and:m,or:g,xor:v,store:y,load:A,compareExchange:b,exchange:x,notify:w,wait:T,waitTimeout:S,waitAsync:I,waitTimeoutAsync:P})}},42518:(t,e,i)=>{"use strict";i.d(e,{Ts:()=>u,XR:()=>v,mq:()=>m,uk:()=>g,vP:()=>p,zr:()=>f});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085),h=i(73783),d=i(40046);function u(t,e){return d.M_(t,0,16,2),0}function f(t){return d.M_(t,0,16,2),0}function p(t){return d.WQ(t,1,16,2),d.me(t,1),0}function m(t){return d.WQ(t,1,16,2),d.me(t,1073741824),0}function g(t,e){let i=d.Hh(t,16,2);return h.Tl(e),d.uk(t,i),h.s2(e),0}function v(t,e,i){let r=d.Hh(t,16,2);h.Tl(e);let s=d.j4(t,r,i);return h.s2(e),2===s?110:0}r=class{constructor(){(0,a.A)(this,"atomic",void 0)}}.prototype,(s=new(o())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,4),(0,c.A)(r,l.g7,4),(0,c.A)(r,l.JY,s)},81574:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var r=i(84149),s=i(10576),a=i(67672);let n=s.TK;function o(t){let e,i;n.onmessage=o=>{const l=o.data,c=l.type,h=l.data;switch(c){case"init":if(s.TK.CHeap&&s.TK.CHeap.initThread&&s.TK.CHeap.Config.USE_THREADS)return void s.TK.CHeap.initThread(h).then((()=>{n.postMessage({type:"ready"})}));n.postMessage({type:"ready"});break;case"run":n.postMessage({type:"running"}),i=t(h.params),d=h.port,e=new r.Ay(d),e.on(r.S3,(async t=>{const r=t.method,s=t.params;if(a.Pc(i[r]))try{i[r].transfer||(i[r].transfer=[]);const a=await i[r](...s.params);e.reply(t,a,null,i[r].transfer),i[r].transfer.length=0}catch(i){e.reply(t,-2097152,{message:i.message})}}));break;case"stop":e&&e.destroy(),n.postMessage({type:"stopped"})}var d}}},26848:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var r=i(10576);let s=r.TK;function a(t){let e;s.onmessage=i=>{const a=i.data,n=a.type,o=a.data;switch(n){case"init":if(r.TK.CHeap&&r.TK.CHeap.initThread&&r.TK.CHeap.Config.USE_THREADS)return void r.TK.CHeap.initThread(o).then((()=>{s.postMessage({type:"ready"})}));s.postMessage({type:"ready"});break;case"run":e=t(o.params);break;case"stop":e&&e.then?e.then((t=>{s.postMessage({type:"stopped",data:t})})):s.postMessage({type:"stopped",data:e})}}}},67524:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var r=i(84149),s=i(10576),a=i(67672);let n=s.TK;function o(t){let e;n.onmessage=i=>{const o=i.data,l=o.type,c=o.data;switch(l){case"init":if(s.TK.CHeap&&s.TK.CHeap.initThread&&s.TK.CHeap.Config.USE_THREADS)return void s.TK.CHeap.initThread(c).then((()=>{n.postMessage({type:"ready"})}));n.postMessage({type:"ready"});break;case"run":n.postMessage({type:"running"}),h=c.port,e=new r.Ay(h),e.on(r.S3,(async i=>{const r=i.method,s=i.params;if(a.Pc(t[r]))try{t[r].transfer||(t[r].transfer=[]);const a=await t[r](...s.params);e.reply(i,a,null,t[r].transfer),t[r].transfer.length=0}catch(t){e.reply(i,-2097152,{message:t.message})}}));break;case"stop":e&&e.destroy(),n.postMessage({type:"stopped"})}var h}}},73783:(t,e,i)=>{"use strict";i.d(e,{Tl:()=>g,Ts:()=>f,bh:()=>m,eu:()=>u,s2:()=>p,zr:()=>v});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085),h=i(40046),d=i(39638);class u{constructor(){(0,a.A)(this,"atomic",void 0)}}function f(t){return h.M_(t,0,16,2),0}function p(t,e=!1){let i;if(0!==(i=h.p_(t,0,1,16,2)))do{2!=i&&0===h.p_(t,1,2,16,2)||!e&&(0,d.A)()&&h.uk(t,2)}while(0!==(i=h.p_(t,0,2,16,2)));return 0}function m(t){return 0===h.p_(t,0,1,16,2)?0:16}function g(t){return 1!==h.jb(t,1,16,2)&&(h.M_(t,0,16,2),h.me(t,1)),0}function v(t){return h.M_(t,0,16,2),0}r=u.prototype,(s=new(o())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,4),(0,c.A)(r,l.g7,4),(0,c.A)(r,l.JY,s)},79490:(t,e,i)=>{"use strict";i.d(e,{Ts:()=>p,XR:()=>A,Zr:()=>y,bE:()=>g,uk:()=>v,zr:()=>m});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085),h=i(73783),d=i(63939),u=i(50932),f=i(40046);function p(t,e){return f.M_(t,0|e,16,2),h.Ts(t+4),0}function m(t){return h.zr(t+4),0}function g(t){return f.WQ(t,1,16,2),f.me(t,1),0}function v(t){for(;f.uk(t,0),f.jb(t,1,16,2)<=0;)f.WQ(t,1,16,2);return 0}function y(t){return h.s2(t+4),d.f[16](t)>0?(u.M[16](t,d.f[16](t)-1),h.Tl(t+4),0):(h.Tl(t+4),11)}function A(t,e){return 2!==f.j4(t,0,e)&&f.jb(t,1,16,2)<=0?(f.WQ(t,1,16,2),110):0}r=class{constructor(){(0,a.A)(this,"atomic",void 0),(0,a.A)(this,"mutex",void 0)}}.prototype,(s=new(o())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("mutex",{0:h.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,4),(0,c.A)(r,l.g7,8),(0,c.A)(r,l.JY,s)},88506:(t,e,i)=>{"use strict";i.d(e,{nE:()=>k,nx:()=>T,pt:()=>w});var r=i(75062),s=i.n(r),a=i(80662),n=i.n(a),o=i(54001),l=i.n(o),c=i(11473),h=i(84149),d=i(61837),u=i(26429),f=i(67672),p=i(10576),m=i(62100);let g=p.TK.Worker,v=p.TK.MessageChannel;i(81574),i(26848),i(67524);const y=(0,d.A)(81574,{varName:"init"}),A=((0,d.A)(26848,{varName:"init"}),(0,d.A)(67524,{varName:"init"}),s()("revoke")),b=new(n());function x(t,e){return`${t}_${e}`}function w(t,e={},i){let r,s=[];function a(...e){const r=new t(...e);return new(l())((e=>{const s={$worker:null,$ipc:null,$channel:null,$moduleId:(0,m.A)(i),$stackPointer:0,$instance:r,$type:"class"},{proxy:a,revoke:n}=Proxy.revocable(s,{get(e,i,a){if(e[i])return s[i];if(i in t.prototype&&"function"==typeof t.prototype[i]){const t=function(...t){return r[i](...t)};t.transfer=function(...t){return{invoke:function(...t){return r[i](...t)}}},e[i]=t}return e[i]}});s[A]=n,e(a)}))}return r=(...r)=>{let a;if(i instanceof g)a=i;else{let e;const r=x(i,"class");if(b.has(r))e=b.get(r).url,b.get(r).refCount++;else{const s=(0,d.A)(i,{varName:`__module_${t.name}__`,exportName:`__${t.name}__`,pointName:t.name,exportIsClass:!0}),a=`\n            self.CHEAP_DISABLE_THREAD = ${p.TK.CHEAP_DISABLE_THREAD}\n            self.CHEAP_HEAP_INITIAL = ${p.TK.CHEAP_HEAP_INITIAL}\n            self.CHEAP_HEAP_MAXIMUM = ${p.TK.CHEAP_HEAP_MAXIMUM}\n            ${s}\n            function run(params) {\n              params.unshift(null)\n              return new (Function.prototype.bind.apply(__module_${t.name}__.__${t.name}__, params))()\n            }\n            ${y}\n            init.default(run);\n          `;{const t=new Blob([a],{type:"text/javascript"});e=URL.createObjectURL(t)}b.set(r,{url:e,refCount:1})}a=new g(e)}const n=new v;return new(l())(((o,l)=>{var d;const f=u.USE_THREADS?c.s_.alignedAlloc(u.STACK_ALIGNMENT,e.stackSize?e.stackSize+u.STACK_ALIGNMENT&~u.STACK_ALIGNMENT:u.STACK_SIZE):0,p=e=>{const l=e.data,c=l.type;switch(l.data,c){case"ready":a.postMessage({type:"run",data:{port:n.port2,params:r}},[n.port2,...s]);break;case"running":!function(){const e=new h.Ay(n.port1),r={$worker:a,$ipc:e,$channel:n,$moduleId:(0,m.A)(i),$stackPointer:f,$type:"class"},{proxy:s,revoke:l}=Proxy.revocable(r,{get(i,s,a){if(i[s])return r[s];if(s in t.prototype&&"function"==typeof t.prototype[s]){const t=async function(...t){return e.request(s,{params:t})};t.transfer=function(...t){return{invoke:async function(...i){return e.request(s,{params:i},t)}}},i[s]=t}return i[s]}});r[A]=l,o(s)}()}};a.onmessage=p,a.onmessage=p,a.postMessage({type:"init",data:{memory:u.USE_THREADS?c.ce:null,name:e.name||t.name,stackPointer:f,stackSize:null!==(d=e.stackSize)&&void 0!==d?d:u.STACK_SIZE}})}))},{run:!u.USE_THREADS&&!e.dispatchToWorker||e.disableWorker?a:r,transfer:function(...t){return s=t,{run:!u.USE_THREADS&&!e.dispatchToWorker||e.disableWorker?a:r}}}}function k(t){if(t.$worker&&(t.$worker.terminate(),t.$worker=null),t.$moduleId){if(f.Yj(t.$moduleId)){const e=x(t.$moduleId,t.$type);b.has(e)&&(b.get(e).refCount--,0===b.get(e).refCount&&(URL.revokeObjectURL(b.get(e).url),b.delete(e)))}t.$moduleId=null}if(t.$ipc&&(t.$ipc.destroy(),t.$ipc=null),t.$stackPointer&&(c.s_.free(t.$stackPointer),t.$stackPointer=0),t.$channel=null,t.$instance=null,t[A]){const e=t[A];t[A]=null,e()}}async function T(t){return t.$worker?new(l())((e=>{t.$worker.onmessage=function(i){const r=i.data,s=r.type,a=r.data;"stopped"===s&&(k(t),e(a))},t.$worker.postMessage({type:"stop"})})):t.$retval?t.$retval:void 0}},6704:(t,e,i)=>{"use strict";i.d(e,{_:()=>s,i:()=>r});const r={2:1,3:1,4:1,5:1,6:2,7:2,8:4,9:4,10:8,11:1,12:1,13:2,14:2,15:4,16:4,17:8,18:4,19:8,20:4,0:4,1:4,22:8,21:8,23:1,24:1},s={2:0,3:0,4:0,5:0,6:1,7:1,8:2,9:2,10:4,11:0,12:0,13:1,14:1,15:2,16:2,17:4,18:2,19:4,20:2,1:2,0:2,22:4,21:4,23:0,24:0}},19094:(t,e,i)=>{"use strict";i.d(e,{A:()=>p});var r=i(134),s=i(54001),a=i.n(s),n=i(11473),o=i(63939),l=i(50932),c=i(26429),h=i(14686),d=i(42518),u=i(73783),f=i(40046);class p{constructor(t,e){(0,r.A)(this,"count",void 0),(0,r.A)(this,"url",void 0),(0,r.A)(this,"childThreads",void 0),this.count=t,this.url=e,this.childThreads=[]}async createTheadPoolEntry(t){return new(a())(((e,i)=>{const r=new Worker(this.url),s=n.s_.alignedAlloc(c.STACK_ALIGNMENT,c.STACK_SIZE),a=n.s_.malloc(8);(0,h.sO)(a,0,8),l.M[15](a+4,0),l.M[15](a,2|o.f[15](a));const f=(0,n.pv)();r.onmessage=t=>{if("ready"===t.data.type){const t=s;(0,h.sO)(t,0,20),u.Ts(t+16),d.Ts(t+12),r.postMessage({type:"wait"}),e({id:f,thread:{thread:0,worker:r,stackPointer:s,threadDescriptor:a},threadWait:t})}},r.postMessage({type:"ready",data:{cheap:{memory:n.ce,stackPointer:s,stackSize:c.STACK_SIZE,id:f},runner:{resource:{tableSize:t.tableSize,module:t.module,initFuncs:t.initFuncs},options:{memoryBase:t.memoryBase,tableBase:t.tableBase,threadDescriptor:a,childImports:t.childImports},imports:t.childImports}}})}))}async ready(t){this.childThreads=await a().all(new Array(this.count).fill(0).map((()=>this.createTheadPoolEntry(t))))}hasFree(){for(let t=0;t<this.childThreads.length;t++)if(0===o.f[15](this.childThreads[t].thread.threadDescriptor+4))return!0;return!1}isPoolThread(t){for(let e=0;e<this.childThreads.length;e++)if(this.childThreads[e].thread.thread===t)return!0;return!1}createThread(t,e,i,r){for(let e=0;e<this.childThreads.length;e++)if(0===o.f[15](this.childThreads[e].thread.threadDescriptor+4))return l.M[15](this.childThreads[e].thread.threadDescriptor+4,1),this.childThreads[e].thread.thread=t,l.M[15](t+8,2|o.f[15](t+8)),u.s2(this.childThreads[e].threadWait+16),l.M[20](this.childThreads[e].threadWait,t),l.M[20](this.childThreads[e].threadWait+4,i),l.M[20](this.childThreads[e].threadWait+8,r),u.Tl(this.childThreads[e].threadWait+16),void d.vP(this.childThreads[e].threadWait+12)}joinThread(t,e){let i;for(let e=0;e<this.childThreads.length;e++)if(this.childThreads[e].thread.thread===t){i=this.childThreads[e];break}return i?(1&o.f[15](t+8)||(f.uk(t+12,1),0!==e&&l.M[20](e,o.f[20](t+4)),l.M[15](i.thread.threadDescriptor+4,0)),0):-1}detachThread(t){let e;for(let i=0;i<this.childThreads.length;i++)if(this.childThreads[i].thread.thread===t){e=this.childThreads[i];break}return e?(l.M[15](e.thread.threadDescriptor,1|o.f[15](e.thread.threadDescriptor)),l.M[15](t+8,1|o.f[15](t+8)),0):-1}destroy(){for(let t=0;t<this.childThreads.length;t++)n.s_.free(this.childThreads[t].thread.stackPointer),n.s_.free(this.childThreads[t].thread.threadDescriptor),this.childThreads[t].thread.worker.terminate();this.childThreads=[]}}},16030:(t,e,i)=>{"use strict";i.d(e,{A:()=>U});var r=i(134),s=i(80662),a=i.n(s),n=i(54001),o=i.n(n),l=i(63939),c=i(50932),h=i(11473),d=i(95335),u=i(72739),f=i(4624),p=i(67672),m=i(14686),g=i(14621),v=i(1708),y=i(20357),A=i(77775),b=i(61837),x=i(26429),w=i(40046),k=i(82854),T=i(80905),S=i(24565),I=i(39638),P=i(19094),_=i(42518),E=i(73783),C=i(95797),M="src/cheap/webassembly/WebAssemblyRunner.ts";i(81999);const R=(0,b.A)(81999,{varName:"init"});function B(){}let D=!1;class U{static getTable(){return h.XI}static mutexLock(t){E.s2(t)}static mutexUnlock(t){E.Tl(t)}static condWait(t,e){_.uk(t,e)}static readPointer(t){return l.f[20](t)}static writePointer(t,e){c.M[20](t,e)}constructor(t,e={}){var i;(0,r.A)(this,"resource",void 0),(0,r.A)(this,"instance",void 0),(0,r.A)(this,"options",void 0),(0,r.A)(this,"builtinMalloc",void 0),(0,r.A)(this,"memoryBase",void 0),(0,r.A)(this,"tableBase",void 0),(0,r.A)(this,"childImports",void 0),(0,r.A)(this,"childUrl",void 0),(0,r.A)(this,"childBlob",void 0),(0,r.A)(this,"childThreads",void 0),(0,r.A)(this,"imports",void 0),(0,r.A)(this,"childReadyPromises",void 0),(0,r.A)(this,"threadPool",void 0),(0,r.A)(this,"initCalling",void 0),(0,r.A)(this,"promisingMap",void 0),this.resource=t,this.builtinMalloc=[],this.initCalling=!1,this.childThreads=new(a()),this.childReadyPromises=[],this.promisingMap=new(a()),p.Yj(e.childImports)?this.childImports=e.childImports:p.Ik(e.childImports)&&e.childImports instanceof Blob&&(this.childImports=URL.createObjectURL(e.childImports)),this.memoryBase=t.dataSize?h.s_.malloc(t.dataSize):0,e.thread&&e.tableBase&&h.XI.getPointer()!==e.tableBase&&h.XI.alloc(e.tableBase-h.XI.getPointer()),this.tableBase=t.tableSize?h.XI.alloc(t.tableSize):0,this.options=e,this.imports={env:{memory:h.ce,__stack_pointer:h.GE,__indirect_function_table:h.XI.table,clock_time_get:g.WU,clock_res_get:g.Lq,random_get:g.Pp,abort:g.h2,proc_exit:function(t){f.z3(`wasm module exit, code: ${t}`,M,156)},__syscall_renameat:B,__syscall_unlinkat:B,environ_get:g.B,environ_sizes_get:g.CK,fd_close:B,fd_fdstat_get:g.LS,fd_read:B,fd_seek:B,fd_write:g.nK,emscripten_builtin_malloc:t=>{const e=h.s_.malloc(t);return this.builtinMalloc.push(e),e},emscripten_builtin_free:t=>{h.s_.free(t)},emscripten_builtin_memalign:(t,e,i)=>{const r=h.s_.alignedAlloc(e,i);return 0!==r?(c.M[20](t,r),this.builtinMalloc.push(r),0):-1},emscripten_memcpy_big:function(t,e,i){(0,m.Mr)(t,e,i)},__libc_malloc:function(t){return h.s_.malloc(t)},__libc_free:t=>{h.s_.free(t)},malloc:t=>{if(!0===this.initCalling){const e=h.s_.malloc(t);return this.builtinMalloc.push(e),e}return h.s_.malloc(t)},calloc:function(t,e){return h.s_.calloc(t,e)},realloc:function(t,e){return h.s_.realloc(t,e)},aligned_alloc:(t,e)=>h.s_.alignedAlloc(t,e),free:function(t){h.s_.free(t)},posix_memalign:function(t,e,i){const r=h.s_.alignedAlloc(e,i);return 0!==r?(c.M[20](t,r),0):-1},memalign:function(t,e){return h.s_.alignedAlloc(t,e)}},"GOT.func":{malloc:new WebAssembly.Global({mutable:!0,value:"i32"},2),calloc:new WebAssembly.Global({mutable:!0,value:"i32"},3),realloc:new WebAssembly.Global({mutable:!0,value:"i32"},4),aligned_alloc:new WebAssembly.Global({mutable:!0,value:"i32"},5),free:new WebAssembly.Global({mutable:!0,value:"i32"},1)}};{const t=(t,e,i,r)=>{if(this.threadPool&&this.threadPool.hasFree())return this.threadPool.createThread(t,e,i,r),0;this.childUrl||this.createChildUrl();const s=new Worker(this.childUrl);c.M[15](t,(0,h.pv)()),c.M[16](t+12,1),c.M[15](t+8,0),c.M[20](t+4,0);const a=h.s_.alignedAlloc(x.STACK_ALIGNMENT,x.STACK_SIZE),n=h.s_.malloc(8);let d;(0,m.sO)(n,0,8),this.childThreads.set(l.f[15](t),{thread:t,worker:s,stackPointer:a,threadDescriptor:n});const u=new(o())((t=>{d=t}));return C.A.jspi||this.childReadyPromises.push(u),s.onmessage=t=>{const e=t.data,i=e.type;e.data,"run"===i&&d(0)},s.postMessage({type:"run",data:{cheap:{memory:h.ce,stackPointer:a,stackSize:x.STACK_SIZE,id:l.f[15](t)},runner:{resource:{tableSize:this.resource.tableSize,module:this.resource.threadModule.module,initFuncs:this.resource.threadModule.initFuncs},options:{memoryBase:this.options.memoryBase||this.memoryBase,tableBase:this.tableBase,thread:t,threadDescriptor:n,childImports:this.childImports},func:i,args:r,imports:this.childImports,thread:t}}}),C.A.jspi?u:0};d.X$(this.imports.env,{wasm_pthread_create:C.A.jspi?new WebAssembly.Suspending(t):t,wasm_pthread_join2:(t,e)=>{if(this.threadPool&&this.threadPool.isPoolThread(t))return this.threadPool.joinThread(t,e),0;if(1&l.f[15](t+8))return this.childThreads.delete(l.f[15](t)),0;w.uk(t+12,1),0!==e&&c.M[20](e,l.f[20](t+4));const i=this.childThreads.get(l.f[15](t));return h.s_.free(i.stackPointer),h.s_.free(i.threadDescriptor),i.worker.terminate(),this.childThreads.delete(l.f[15](t)),(0,m.sO)(t,0,16),0},wasm_pthread_detach2:t=>{if(this.threadPool&&this.threadPool.isPoolThread(t))return this.threadPool.detachThread(t),0;const e=this.childThreads.get(l.f[15](t));c.M[15](e.threadDescriptor,1|l.f[15](e.threadDescriptor)),c.M[15](t+8,1|l.f[15](t+8))}}),d.X$(this.imports.env,v),d.X$(this.imports.env,y),d.X$(this.imports.env,A)}if(this.memoryBase?d.X$(this.imports.env,{__memory_base:this.memoryBase}):e.memoryBase&&d.X$(this.imports.env,{__memory_base:e.memoryBase}),this.tableBase&&d.X$(this.imports.env,{__table_base:this.tableBase}),null!==(i=e.imports)&&void 0!==i&&i.env&&(d.X$(this.imports.env,e.imports.env),e.envKey&&e.importMap)){const t={};d.__(this.imports.env,((i,r)=>{e.importMap[r]&&(t[e.importMap[r]]=i)})),this.imports[e.envKey]=t}this.imports.wasi_snapshot_preview1=this.imports.env}createChildUrl(){const t=`\n      ${(0,b.A)(16030,{varName:"__WebAssemblyRunner__",exportName:"__WebAssemblyRunner__",pointName:U.name,exportIsClass:!0})}\n      ${R}\n      var preRun;\n      ${this.childImports?`\n      preRun = import('${this.childImports}')\n      `:""}\n      init.default(preRun);\n    `;this.childBlob=new Blob([t],{type:"text/javascript"}),this.childUrl=URL.createObjectURL(this.childBlob)}overrideAtomic(){v.override({atomic_add_i8:k.KJ.exports.add8,atomic_sub_i8:k.KJ.exports.sub8,atomic_and_i8:k.KJ.exports.and8,atomic_or_i8:k.KJ.exports.or8,atomic_xor_i8:k.KJ.exports.xor8,atomic_store_i8:k.KJ.exports.store8,atomic_load_i8:k.KJ.exports.load8,atomic_compare_exchange_i8:k.KJ.exports.compare_exchange8,atomic_exchange_i8:k.KJ.exports.exchange8,atomic_add_i16:k.KJ.exports.add16,atomic_sub_i16:k.KJ.exports.sub16,atomic_and_i16:k.KJ.exports.and16,atomic_or_i16:k.KJ.exports.or16,atomic_xor_i16:k.KJ.exports.xor16,atomic_store_i16:k.KJ.exports.store16,atomic_load_i16:k.KJ.exports.load16,atomic_compare_exchange_i16:k.KJ.exports.compare_exchange16,atomic_exchange_i16:k.KJ.exports.exchange16,atomic_add_i32:k.KJ.exports.add32,atomic_sub_i32:k.KJ.exports.sub32,atomic_and_i32:k.KJ.exports.and32,atomic_or_i32:k.KJ.exports.or32,atomic_xor_i32:k.KJ.exports.xor32,atomic_store_i32:k.KJ.exports.store32,atomic_load_i32:k.KJ.exports.load32,atomic_compare_exchange_i32:k.KJ.exports.compare_exchange32,atomic_exchange_i32:k.KJ.exports.exchange32,atomic_add_i64:k.KJ.exports.add64,atomic_sub_i64:k.KJ.exports.sub64,atomic_and_i64:k.KJ.exports.and64,atomic_or_i64:k.KJ.exports.or64,atomic_xor_i64:k.KJ.exports.xor64,atomic_store_i64:k.KJ.exports.store64,atomic_load_i64:k.KJ.exports.load64,atomic_compare_exchange_i64:k.KJ.exports.compare_exchange64,atomic_exchange_i64:k.KJ.exports.exchange64,atomics_notify:k.KJ.exports.notify,atomics_wait:k.KJ.exports.wait}),d.X$(this.imports.env,v)}async run(t,e){if(p.Ik(t)&&d.X$(this.options.imports,t),(0,I.A)()&&!S.LK&&S.Ko()&&this.resource.threadModule&&(await S.Ts(h.ce,y.override),d.X$(this.imports.env,y)),!T.LK&&T.Ko()&&await T.Ts(h.ce),!D&&k.Ko()&&(D=!0,this.overrideAtomic()),this.instance=await WebAssembly.instantiate(this.resource.module,this.imports),this.initRunTime(),this.resource.threadModule&&this.resource.enableThreadPool&&e>0&&!C.A.jspi){this.childUrl||this.createChildUrl();let t=e;this.resource.enableThreadCountRate&&(t*=this.resource.enableThreadCountRate),this.threadPool=new P.A(t,this.childUrl),await this.threadPool.ready({tableSize:this.resource.tableSize,module:this.resource.threadModule.module,initFuncs:this.resource.threadModule.initFuncs,memoryBase:this.options.memoryBase||this.memoryBase,tableBase:this.tableBase,childImports:this.childImports})}}async runAsChild(t){p.Ik(t)&&d.X$(this.options.imports,t),!S.LK&&S.Ko()&&(await S.Ts(h.ce,y.override),d.X$(this.imports.env,y)),!D&&k.Ko()&&(D=!0,this.overrideAtomic()),this.instance=new WebAssembly.Instance(this.resource.module,this.imports),this.initRunTime()}async childrenThreadReady(){if(!this.childReadyPromises.length)return;const t=this.childReadyPromises;this.childReadyPromises=[],await o().all(t)}initRunTime(){this.builtinMalloc=[],this.initCalling=!0,p.YO(this.resource.initFuncs)&&u.__(this.resource.initFuncs,(t=>{let e;if(this.asm[t]&&(e=this.asm[t]),e)return e()})),this.initCalling=!1}call(t,...e){if(!this.asm)return-1;let i;if(this.asm[t]?i=this.asm[t]:this.options.exportMap&&this.options.exportMap[t]&&this.asm[this.options.exportMap[t]]&&(i=this.asm[this.options.exportMap[t]]),i)return i.apply(null,e);f.z3(`the wasm module has not function ${t} to call`,M,597)}async callAsync(t,...e){if(!this.asm)return-1;if(!C.A.jspi)return this.call(t,...e);let i;if(this.promisingMap.has(t)?i=this.promisingMap.get(t):(this.asm[t]?i=this.asm[t]:this.options.exportMap&&this.options.exportMap[t]&&this.asm[this.options.exportMap[t]]&&(i=this.asm[this.options.exportMap[t]]),i=WebAssembly.promising(i),this.promisingMap.set(t,i)),i)return i.apply(null,e);f.z3(`the wasm module has not function ${t} to call`,M,639)}get asm(){return this.instance&&this.instance.exports}getInstance(){return this.instance}destroy(){var t;null!==(t=this.builtinMalloc)&&void 0!==t&&t.length&&(u.__(this.builtinMalloc,(t=>{h.s_.free(t)})),this.builtinMalloc.length=0),this.memoryBase&&(h.s_.free(this.memoryBase),this.memoryBase=null),this.tableBase&&(h.XI.free(this.tableBase),this.tableBase=null),this.childImports&&(URL.revokeObjectURL(this.childImports),this.childImports=null),this.childUrl&&(URL.revokeObjectURL(this.childUrl),this.childUrl=null),this.childBlob=null,this.childReadyPromises.length=0,this.childThreads.size&&this.childThreads.forEach(((t,e)=>{1&l.f[15](t.threadDescriptor)||(f.R8("has child thread running, maybe resource leakage",M,684),t.worker.terminate(),c.M[16](t.thread+12,0),t.stackPointer&&h.s_.free(t.stackPointer),h.s_.free(t.threadDescriptor),this.childThreads.delete(e))})),this.builtinMalloc=null,this.instance=null,this.options.thread&&(this.options.threadDescriptor&&c.M[15](this.options.threadDescriptor+4,0),this.options.threadDescriptor&&(1&l.f[15](this.options.threadDescriptor)||4&l.f[15](this.options.thread+8))?2&l.f[15](this.options.threadDescriptor)||(h.wE&&h.s_.free(h.wE),h.s_.free(this.options.threadDescriptor),(0,m.sO)(this.options.thread,0,16),self.close()):(c.M[16](this.options.thread+12,0),w.me(this.options.thread+12,1))),this.threadPool&&this.threadPool.destroy(),this.threadPool=null,this.promisingMap&&(this.promisingMap.clear(),this.promisingMap=null)}}},76045:(t,e,i)=>{"use strict";i.d(e,{A:()=>p});var r=i(54001),s=i.n(r),a=i(67672),n=i(24175),o=i(34531),l=i(88096),c=i(92647),h=i(95335),d=i(26429),u=i(86834),f=i(44690);async function p(t,e={}){let i,r,p,m;if(e=h.X$({enableThread:d.USE_THREADS,initFuncs:e.child?[]:["__wasm_apply_data_relocs","_initialize"]},e),a.ai(t.dataSize)&&a.ai(t.tableSize))if(r=t.dataSize,p=t.dataSize,a.Yj(t.source)){const e={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(a.Pc(WebAssembly.compileStreaming))i=await WebAssembly.compileStreaming(fetch(t.source,e));else{const r=await fetch(t.source,e);m=await r.arrayBuffer(),i=await WebAssembly.compile(m)}}else i=await WebAssembly.compile(t.source),m=a.sv(t.source)?t.source:t.source.buffer;else{const h={ioReader:new n.A(1048576),ioWriter:new o.A(1048576),bufferEnded:!1,compileStopped:!1,error:"",abortController:null,pullResolve:null,bufferResolve:null,buffers:[],data:{},options:e},g=new Response(new ReadableStream({async start(e){if(a.Yj(t.source)){var i;AbortController&&(h.abortController=new AbortController);const r={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade",signal:null===(i=h.abortController)||void 0===i?void 0:i.signal},s=await fetch(t.source,r);let a;s.ok&&s.status>=200&&s.status<=299?a=s.body.getReader():e.error(`Http code invalid, ${s.status} ${s.statusText}`);const n=[];h.ioReader.onFlush=async t=>{let e=0;for(;n.length&&e<t.length;){const i=n.shift();i.length>t.length-e?(t.set(i.subarray(0,t.length-e),e),n.unshift(i.subarray(t.length-e)),e=t.length):(t.set(i,e),e+=i.length)}if(e>=t.length)return t.length;const{value:i,done:r}=await a.read();return r?e>0?e:-1048576:(h.buffers.push(i),i.length>t.length-e?(t.set(i.subarray(0,t.length-e),e),n.push(i.subarray(t.length-e)),t.length):(t.set(i,e),e+=i.length,e))}}else{let e=0,i=t.source.byteLength;const r=a.sv(t.source)?new Uint8Array(t.source):t.source;h.ioReader.onFlush=async t=>{if(e>=i)return-1048576;const s=Math.min(t.length,i-e);return t.set(r.subarray(e,e+s),0),e+=s,s}}h.ioWriter.onFlush=async t=>h.pullResolve?(h.pullResolve(t.slice()),h.pullResolve=null,0):((await new(s())(((t,e)=>{h.bufferResolve=t}))).enqueue(t.slice()),0),async function(t){try{for(await t.ioWriter.writeUint32(await t.ioReader.readUint32()),await t.ioWriter.writeUint32(await t.ioReader.readUint32());;){if(t.compileStopped){t.abortController&&t.abortController.abort();break}const e=await t.ioReader.readUint8();if(t.options.child&&11===e){await t.ioWriter.writeUint8(e),await(0,l.$z)(t.ioWriter,7),await(0,l.$z)(t.ioWriter,1),await(0,l.$z)(t.ioWriter,0),await t.ioWriter.writeUint8(65),await t.ioWriter.writeUint8(0),await t.ioWriter.writeUint8(11),await(0,l.$z)(t.ioWriter,1),await t.ioWriter.writeUint8(0);const i=await(0,l.GG)(t.ioReader);await t.ioReader.skip(i);continue}await t.ioWriter.writeUint8(e);const i=await(0,l.GG)(t.ioReader);await(0,l.$z)(t.ioWriter,i);const r=t.ioReader.getPos();if(11===e){const e=await(0,l.GG)(t.ioReader);if(await(0,l.$z)(t.ioWriter,e),e){for(await(0,l.$z)(t.ioWriter,await(0,l.GG)(t.ioReader));;){const e=await t.ioReader.readUint8();if(await t.ioWriter.writeUint8(e),11===e)break}t.data.dataSize=await(0,l.GG)(t.ioReader),await(0,l.$z)(t.ioWriter,t.data.dataSize)}}else if(2===e){let e=await(0,l.GG)(t.ioReader);await(0,l.$z)(t.ioWriter,e);let i=0;for(;e--;){const e=await(0,l.GG)(t.ioReader);await(0,l.$z)(t.ioWriter,e),await t.ioWriter.writeBuffer(await t.ioReader.readBuffer(e));const r=await(0,l.GG)(t.ioReader);await(0,l.$z)(t.ioWriter,r),await t.ioWriter.writeBuffer(await t.ioReader.readBuffer(r));const s=await t.ioReader.readUint8();switch(await t.ioWriter.writeUint8(s),s){case 0:await(0,l.$z)(t.ioWriter,await(0,l.GG)(t.ioReader));break;case 3:await(0,l.p7)(t.ioWriter,await(0,l.Ee)(t.ioReader)),await(0,l.$z)(t.ioWriter,await(0,l.GG)(t.ioReader));break;case 2:{let e=await(0,l.GG)(t.ioReader);t.options.enableThread?e|=2:e&=-3,await(0,l.$z)(t.ioWriter,e);const r=await(0,l.GG)(t.ioReader);if(await(0,l.$z)(t.ioWriter,d.HEAP_INITIAL||r),1&e){let e=await(0,l.GG)(t.ioReader);u.A.safari&&f.A.ios&&!u.A.checkVersion(u.A.majorVersion,"17",!0)&&t.options.enableThread||(e=d.HEAP_MAXIMUM),await(0,l.$z)(t.ioWriter,e)}i++;break}case 1:{await(0,l.p7)(t.ioWriter,await(0,l.Ee)(t.ioReader));const e=await(0,l.GG)(t.ioReader);await(0,l.$z)(t.ioWriter,e);const r=await(0,l.GG)(t.ioReader);await(0,l.$z)(t.ioWriter,r),t.data.tableSize=r,1&e&&await(0,l.$z)(t.ioWriter,await(0,l.GG)(t.ioReader)),i++;break}}if(2===i)break}}i-Number(t.ioReader.getPos()-r)&&await t.ioReader.pipe(t.ioWriter,i-Number(t.ioReader.getPos()-r))}}catch(e){-1048576===t.ioReader.error?t.bufferEnded=!0:t.error=e,t.ioReader.remainingLength()&&await t.ioWriter.writeBuffer(await t.ioReader.readBuffer(t.ioReader.remainingLength())),await t.ioWriter.flush()}}(h)},async pull(t){if(h.error)t.close();else{if(h.bufferResolve)return h.bufferResolve(t),void(h.bufferResolve=null);t.enqueue(await new(s())(((t,e)=>{h.pullResolve=t}))),h.bufferEnded?t.close():h.error&&t.error(h.error)}},cancel(t){h.compileStopped=!0}}),{headers:{"Content-Type":"application/wasm"}});i=a.Pc(WebAssembly.compileStreaming)?await WebAssembly.compileStreaming(g):await WebAssembly.compile(await g.arrayBuffer()),m=a.Yj(t.source)?(0,c.A)(Uint8Array,h.buffers).buffer:a.sv(t.source)?t.source:t.source.buffer,r=h.data.tableSize,p=h.data.dataSize}return e.child?{module:i,initFuncs:e.initFuncs||[]}:{module:i,tableSize:r,dataSize:p,initFuncs:e.initFuncs||[],buffer:m}}},81999:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>l});var r=i(10576);r.TK.imports={env:{}};let s,a,n=r.TK,o=0;function l(t){n.onmessage=e=>{const i=e.data,l=i.type,c=i.data;switch(l){case"run":n.postMessage({type:"run"}),r.TK.CHeap&&r.TK.CHeap.initThread&&r.TK.CHeap.initThread(c.cheap).then((()=>{function e(){r.TK.__SELF_THREAD__=c.runner.thread,c.runner.options.imports=r.TK.imports,s=new __WebAssemblyRunner__.__WebAssemblyRunner__(c.runner.resource,c.runner.options),s.runAsChild().then((()=>{__WebAssemblyRunner__.__WebAssemblyRunner__.getTable().get(c.runner.func)(c.runner.args),s.destroy()}))}t?t.then((()=>{e()})):e()}));break;case"ready":a=c.runner,o=c.cheap.stackPointer,r.TK.CHeap&&r.TK.CHeap.initThread&&r.TK.CHeap.initThread(c.cheap).then((()=>{t?t.then((()=>{n.postMessage({type:"ready"})})):n.postMessage({type:"ready"})}));break;case"wait":{async function h(){for(;;){for(__WebAssemblyRunner__.__WebAssemblyRunner__.mutexLock(o+16);0===__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(o);)__WebAssemblyRunner__.__WebAssemblyRunner__.condWait(o+12,o+16);r.TK.__SELF_THREAD__=__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(o),a.options.thread=__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(o),a.thread=__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(o),a.func=__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(o+4),a.args=__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(o+8),s=new __WebAssemblyRunner__.__WebAssemblyRunner__(a.resource,a.options),await s.runAsChild(),__WebAssemblyRunner__.__WebAssemblyRunner__.getTable().get(a.func)(a.args),s.destroy(),__WebAssemblyRunner__.__WebAssemblyRunner__.writePointer(o,0),__WebAssemblyRunner__.__WebAssemblyRunner__.mutexUnlock(o+16)}}a.options.imports=r.TK.imports,h();break}}}}},80905:(t,e,i)=>{"use strict";i.d(e,{Ko:()=>u,LK:()=>h,Ts:()=>f});var r=i(11473),s=i(4919),a=i(4624),n=i(35112),o=i.n(n),l=i(88096),c="src/cheap/webassembly/runtime/asm/libc.ts";let h,d=!0;function u(){return d}async function f(t){try{if(!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))return void(d=!1);{const e=(0,s.E_)(o());l.DD(e,!0),h=(await WebAssembly.instantiate(e,{env:{memory:t,malloc:function(t){return r.s_.malloc(t)},calloc:function(t,e){return r.s_.calloc(t,e)},realloc:function(t,e){return r.s_.realloc(t,e)},aligned_alloc:(t,e)=>r.s_.alignedAlloc(t,e),free:function(t){r.s_.free(t)}}})).instance,r.XI.set(2,h.exports.malloc),r.XI.set(1,h.exports.free),r.XI.set(3,h.exports.calloc),r.XI.set(4,h.exports.realloc),r.XI.set(5,h.exports.alignedAlloc)}}catch(t){d=!1,a.R8("thread asm not support, cannot use asm thread function",c,64)}}},24565:(t,e,i)=>{"use strict";i.d(e,{Ko:()=>d,LK:()=>c,Ts:()=>u});var r=i(4919),s=i(4624),a=i(47844),n=i.n(a),o=i(88096),l="src/cheap/webassembly/runtime/asm/thread.ts";let c,h=!0;function d(){return h}async function u(t,e){try{if(!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))return void(h=!1);{const e=(0,r.E_)(n());o.DD(e,!0),c=(await WebAssembly.instantiate(e,{env:{memory:t}})).instance}e({wasm_pthread_mutex_lock:c.exports.lock,wasm_pthread_mutex_trylock:c.exports.trylock,wasm_pthread_mutex_unlock:c.exports.unlock,wasm_pthread_cond_wait:c.exports.wait,wasm_pthread_cond_timedwait:c.exports.timedwait,wasm_pthread_cond_signal:c.exports.signal,wasm_pthread_cond_broadcast:c.exports.broadcast})}catch(t){h=!1,s.R8("thread asm not support, cannot use asm thread function",l,67)}}},1708:(t,e,i)=>{"use strict";i.r(e),i.d(e,{atomic_add_i16:()=>p,atomic_add_i32:()=>k,atomic_add_i64:()=>R,atomic_add_i8:()=>a,atomic_and_i16:()=>g,atomic_and_i32:()=>S,atomic_and_i64:()=>D,atomic_and_i8:()=>o,atomic_compare_exchange_i16:()=>x,atomic_compare_exchange_i32:()=>C,atomic_compare_exchange_i64:()=>F,atomic_compare_exchange_i8:()=>u,atomic_exchange_i16:()=>w,atomic_exchange_i32:()=>M,atomic_exchange_i64:()=>$,atomic_exchange_i8:()=>f,atomic_load_i16:()=>b,atomic_load_i32:()=>E,atomic_load_i64:()=>O,atomic_load_i8:()=>d,atomic_or_i16:()=>v,atomic_or_i32:()=>I,atomic_or_i64:()=>U,atomic_or_i8:()=>l,atomic_store_i16:()=>A,atomic_store_i32:()=>_,atomic_store_i64:()=>N,atomic_store_i8:()=>h,atomic_sub_i16:()=>m,atomic_sub_i32:()=>T,atomic_sub_i64:()=>B,atomic_sub_i8:()=>n,atomic_xor_i16:()=>y,atomic_xor_i32:()=>P,atomic_xor_i64:()=>L,atomic_xor_i8:()=>c,atomics_notify:()=>z,atomics_wait:()=>V,atomics_wait_timeout:()=>G,override:()=>W});var r=i(40046),s=i(6704);let a=function(t,e){return r.WQ(t,e,12,s._[12])},n=function(t,e){return r.jb(t,e,12,s._[12])},o=function(t,e){return r.Uo(t,e,12,s._[12])},l=function(t,e){return r.or(t,e,12,s._[12])},c=function(t,e){return r.I8(t,e,12,s._[12])},h=function(t,e){return r.M_(t,e,12,s._[12])},d=function(t){return r.Hh(t,12,s._[12])},u=function(t,e,i){return r.p_(t,e,i,12,s._[12])},f=function(t,e){return r.cv(t,e,12,s._[12])},p=function(t,e){return r.WQ(t,e,14,s._[14])},m=function(t,e){return r.jb(t,e,14,s._[14])},g=function(t,e){return r.Uo(t,e,14,s._[14])},v=function(t,e){return r.or(t,e,14,s._[14])},y=function(t,e){return r.I8(t,e,14,s._[14])},A=function(t,e){return r.M_(t,e,14,s._[14])},b=function(t){return r.Hh(t,14,s._[14])},x=function(t,e,i){return r.p_(t,e,i,14,s._[14])},w=function(t,e){return r.cv(t,e,14,s._[14])},k=function(t,e){return r.WQ(t,e,16,s._[16])},T=function(t,e){return r.jb(t,e,16,s._[16])},S=function(t,e){return r.Uo(t,e,16,s._[16])},I=function(t,e){return r.or(t,e,16,s._[16])},P=function(t,e){return r.I8(t,e,16,s._[16])},_=function(t,e){return r.M_(t,e,16,s._[16])},E=function(t){return r.Hh(t,16,s._[16])},C=function(t,e,i){return r.p_(t,e,i,16,s._[16])},M=function(t,e){return r.cv(t,e,16,s._[16])},R=function(t,e){return r.WQ(t,e,21,s._[21])},B=function(t,e){return r.jb(t,e,21,s._[21])},D=function(t,e){return r.Uo(t,e,21,s._[21])},U=function(t,e){return r.or(t,e,21,s._[21])},L=function(t,e){return r.I8(t,e,21,s._[21])},N=function(t,e){return r.M_(t,e,21,s._[21])},O=function(t){return r.Hh(t,21,s._[21])},F=function(t,e,i){return r.p_(t,e,i,21,s._[21])},$=function(t,e){return r.cv(t,e,21,s._[21])},z=function(t,e){return r.me(t,e)},V=function(t,e){return r.uk(t,e)},G=function(t,e,i){return r.j4(t,e,Number(BigInt.asIntN(32,i)))};function W(t){t.atomic_add_i8&&(a=t.atomic_add_i8),t.atomic_sub_i8&&(n=t.atomic_sub_i8),t.atomic_and_i8&&(o=t.atomic_and_i8),t.atomic_or_i8&&(l=t.atomic_or_i8),t.atomic_xor_i8&&(c=t.atomic_xor_i8),t.atomic_store_i8&&(h=t.atomic_store_i8),t.atomic_load_i8&&(d=t.atomic_load_i8),t.atomic_compare_exchange_i8&&(u=t.atomic_compare_exchange_i8),t.atomic_exchange_i8&&(f=t.atomic_exchange_i8),t.atomic_add_i16&&(p=t.atomic_add_i16),t.atomic_sub_i16&&(m=t.atomic_sub_i16),t.atomic_and_i16&&(g=t.atomic_and_i16),t.atomic_or_i16&&(v=t.atomic_or_i16),t.atomic_xor_i16&&(y=t.atomic_xor_i16),t.atomic_store_i16&&(A=t.atomic_store_i16),t.atomic_load_i16&&(b=t.atomic_load_i16),t.atomic_compare_exchange_i16&&(x=t.atomic_compare_exchange_i16),t.atomic_exchange_i16&&(w=t.atomic_exchange_i16),t.atomic_add_i32&&(k=t.atomic_add_i32),t.atomic_sub_i32&&(T=t.atomic_sub_i32),t.atomic_and_i32&&(S=t.atomic_and_i32),t.atomic_or_i32&&(I=t.atomic_or_i32),t.atomic_xor_i32&&(P=t.atomic_xor_i32),t.atomic_store_i32&&(_=t.atomic_store_i32),t.atomic_load_i32&&(E=t.atomic_load_i32),t.atomic_compare_exchange_i32&&(C=t.atomic_compare_exchange_i32),t.atomic_exchange_i32&&(M=t.atomic_exchange_i32),t.atomic_add_i64&&(R=t.atomic_add_i64),t.atomic_sub_i64&&(B=t.atomic_sub_i64),t.atomic_and_i64&&(D=t.atomic_and_i64),t.atomic_or_i64&&(U=t.atomic_or_i64),t.atomic_xor_i64&&(L=t.atomic_xor_i64),t.atomic_store_i64&&(N=t.atomic_store_i64),t.atomic_load_i64&&(O=t.atomic_load_i64),t.atomic_compare_exchange_i64&&(F=t.atomic_compare_exchange_i64),t.atomic_exchange_i64&&($=t.atomic_exchange_i64),t.atomics_notify&&(z=t.atomics_notify),t.atomics_wait&&(V=t.atomics_wait),t.atomics_wait_timeout&&(G=t.atomics_wait_timeout)}},14621:(t,e,i)=>{"use strict";i.d(e,{B:()=>m,CK:()=>g,LS:()=>v,Lq:()=>x,Pp:()=>w,WU:()=>b,h2:()=>A,nK:()=>y});var r=i(50932),s=i(63939),a=i(14686),n=i(50011);const o=[null,[],[]],l=0,c=28;function h(t,e){const i=o[t];0===e||10===e?(console.log.bind(console)(n.decode(i)),i.length=0):i.push(e)}const d={};let u,f="./this.program";function p(){if(!u){const t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:f||"./this.program"};for(let e in d)t[e]=d[e];const e=[];for(let i in t)e.push(i+"="+t[i]);u=e}return u}function m(t,e){let i=0;return p().forEach((function(s,a){const n=e+i;r.M[8](t+4*a,n),function(t,e,i){for(let i=0;i<t.length;++i)r.M[4](e,128&t.charCodeAt(i)?-(256-(255&t.charCodeAt(i))):255&t.charCodeAt(i)),e+=1;r.M[4](e,0)}(s,n),i+=s.length+1})),0}function g(t,e){const i=p();r.M[8](t,(0|i.length)>>>0);let s=0;return i.forEach((function(t){s+=t.length+1})),r.M[8](e,(0|s)>>>0),0}function v(t,e){let i=0;return 0==t?i=2:1!=t&&2!=t||(i=64),r.M[11](e,2),r.M[13](e+2,1),r.M[15](e+8,0|i),r.M[15](e+12,0),r.M[17](e+16,BigInt(0)),l}function y(t,e,i,a){let n=0;for(let r=0;r<i;r++){let i=s.f[8](e),r=s.f[8](e+4);e+=8;for(let e=0;e<r;e++)h(t,s.f[4](i+e));n+=r}return r.M[8](a,(0|n)>>>0),l}function A(t){throw t=`abort(${t+=""}). Build with -s ASSERTIONS=1 for more info.`,new WebAssembly.RuntimeError(t)}function b(t,e,i){if(0!==t)return c;const s=(new Date).getTime();return r.M[10](i,BigInt(s)*BigInt(1e6)),l}function x(t,e){return 0!==t?c:(r.M[10](e,BigInt(1e6)),l)}function w(t,e){const i=(0,a.s3)(t,e);return crypto.getRandomValues(i),l}},20357:(t,e,i)=>{"use strict";i.r(e),i.d(e,{override:()=>C,wasm_cpu_core_count:()=>_,wasm_pthread_cond_broadcast:()=>w,wasm_pthread_cond_destroy:()=>y,wasm_pthread_cond_init:()=>v,wasm_pthread_cond_signal:()=>x,wasm_pthread_cond_timedwait:()=>b,wasm_pthread_cond_wait:()=>A,wasm_pthread_equal2:()=>I,wasm_pthread_exit:()=>S,wasm_pthread_mutex_destroy:()=>f,wasm_pthread_mutex_init:()=>u,wasm_pthread_mutex_lock:()=>p,wasm_pthread_mutex_trylock:()=>m,wasm_pthread_mutex_unlock:()=>g,wasm_pthread_once:()=>k,wasm_pthread_self2:()=>T,wasm_pthread_support:()=>P,wasm_threw_error:()=>E});var r=i(63939),s=i(50932),a=i(73783),n=i(42518),o=i(26429),l=i(11473),c=i(40046),h=i(10576),d=i(14686);let u,f,p,m,g,v,y,A,b,x,w,k;function T(){return h.TK.__SELF_THREAD__}function S(t){const e=h.TK.__SELF_THREAD__;s.M[20](e+4,t),s.M[15](e+8,4|r.f[15](e+8))}function I(t,e){return r.f[15](t)===r.f[15](e)?1:0}function P(){return o.USE_THREADS?1:0}function _(){return navigator.hardwareConcurrency}function E(t,e){throw new Error((0,d.lH)(e))}function C(t){t.wasm_pthread_mutex_lock&&(p=t.wasm_pthread_mutex_lock),t.wasm_pthread_mutex_trylock&&(m=t.wasm_pthread_mutex_trylock),t.wasm_pthread_mutex_unlock&&(g=t.wasm_pthread_mutex_unlock),t.wasm_pthread_cond_wait&&(A=t.wasm_pthread_cond_wait),t.wasm_pthread_cond_timedwait&&(b=t.wasm_pthread_cond_timedwait),t.wasm_pthread_cond_signal&&(x=t.wasm_pthread_cond_signal),t.wasm_pthread_cond_broadcast&&(w=t.wasm_pthread_cond_broadcast)}u=function(t,e){return a.Ts(t)},f=function(t){return a.zr(t)},p=function(t){return a.s2(t)},m=function(t){return a.bh(t)},g=function(t){return a.Tl(t)},v=function(t,e){return n.Ts(t,e)},y=function(t){return n.zr(t)},A=function(t,e){return n.uk(t,e)},b=function(t,e,i){let s=1e3*Number(r.f[17](i))+r.f[15](i+8)/1e6;return n.XR(t,e,s)},x=function(t){return n.vP(t)},w=function(t){return n.mq(t)},k=function(t,e){return 0===c.WQ(t,1,16,2)&&l.XI.get(e)(),0}},77775:(t,e,i)=>{"use strict";i.r(e),i.d(e,{Timespec:()=>u,wasm_sem_destroy:()=>p,wasm_sem_init:()=>f,wasm_sem_post:()=>y,wasm_sem_timedwait:()=>v,wasm_sem_trywait:()=>g,wasm_sem_wait:()=>m});var r,s,a=i(134),n=i(80662),o=i.n(n),l=i(61499),c=i(12085),h=i(63939),d=i(79490);class u{constructor(){(0,a.A)(this,"tvSec",void 0),(0,a.A)(this,"tvNSec",void 0)}}function f(t,e,i){return d.Ts(t,i)}function p(t){return d.zr(t)}function m(t){return d.uk(t)}function g(t){return d.Zr(t)}function v(t,e){let i=1e3*Number(h.f[17](e))+h.f[15](e+8)/1e6;return d.XR(t,i)}function y(t){return d.bE(t)}r=u.prototype,(s=new(o())).set("tvSec",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("tvNSec",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,c.A)(r,l.Og,!0),(0,c.A)(r,l.dc,8),(0,c.A)(r,l.g7,16),(0,c.A)(r,l.JY,s)},13258:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(134);class s{constructor(t=0){(0,r.A)(this,"rcon",[0,1,2,4,8,16,32,64,128,27,54]),(0,r.A)(this,"subMix",[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)]),(0,r.A)(this,"invSubMix",[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)]),(0,r.A)(this,"sBox",new Uint32Array(256)),(0,r.A)(this,"invSBox",new Uint32Array(256)),(0,r.A)(this,"key",new Uint32Array(0)),(0,r.A)(this,"ksRows",0),(0,r.A)(this,"keySize",0),(0,r.A)(this,"keySchedule",void 0),(0,r.A)(this,"invKeySchedule",void 0),this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),i=new Uint32Array(4);for(let t=0;t<4;t++)i[t]=e.getUint32(4*t);return i}initTable(){const t=this.sBox,e=this.invSBox,i=this.subMix,r=i[0],s=i[1],a=i[2],n=i[3],o=this.invSubMix,l=o[0],c=o[1],h=o[2],d=o[3],u=new Uint32Array(256);let f=0,p=0,m=0;for(m=0;m<256;m++)u[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){let i=p^p<<1^p<<2^p<<3^p<<4;i=i>>>8^255&i^99,t[f]=i,e[i]=f;const o=u[f],m=u[o],g=u[m];let v=257*u[i]^16843008*i;r[f]=v<<24|v>>>8,s[f]=v<<16|v>>>16,a[f]=v<<8|v>>>24,n[f]=v,v=16843009*g^65537*m^257*o^16843008*f,l[i]=v<<24|v>>>8,c[i]=v<<16|v>>>16,h[i]=v<<8|v>>>24,d[i]=v,f?(f=o^u[u[u[g^o]]],p^=u[u[p]]):f=p=1}}async expandKey(t){const e=this.uint8ArrayToUint32Array_(t);if(this.key){let t=!0,i=0;for(;i<e.length&&t;)t=e[i]===this.key[i],i++;if(t)return}this.key=e;const i=this.keySize=this.key.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);const r=this.ksRows=4*(i+6+1);let s,a;const n=this.keySchedule=new Uint32Array(r),o=this.invKeySchedule=new Uint32Array(r),l=this.sBox,c=this.rcon,h=this.invSubMix,d=h[0],u=h[1],f=h[2],p=h[3];let m,g;for(s=0;s<r;s++)s<i?m=n[s]=e[s]:(g=m,s%i==0?(g=g<<8|g>>>24,g=l[g>>>24]<<24|l[g>>>16&255]<<16|l[g>>>8&255]<<8|l[255&g],g^=c[s/i|0]<<24):i>6&&s%i==4&&(g=l[g>>>24]<<24|l[g>>>16&255]<<16|l[g>>>8&255]<<8|l[255&g]),n[s]=m=(n[s-i]^g)>>>0);for(a=0;a<r;a++)s=r-a,g=3&a?n[s]:n[s-4],o[a]=a<4||s<=4?g:d[l[g>>>24]]^u[l[g>>>16&255]]^f[l[g>>>8&255]]^p[l[255&g]],o[a]=o[a]>>>0}networkToHostOrderSwap(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24}async decrypt(t,e){const i=this.keySize+6,r=this.invKeySchedule,s=this.invSBox,a=this.invSubMix,n=a[0],o=a[1],l=a[2],c=a[3],h=this.uint8ArrayToUint32Array_(e);let d=h[0],u=h[1],f=h[2],p=h[3];const m=new Int32Array(t.buffer).subarray(t.byteOffset>>>2,(t.byteOffset>>>2)+(t.length>>>2)),g=new Int32Array(m.length);let v,y,A,b,x,w,k,T,S,I,P,_,E,C;const M=this.networkToHostOrderSwap;let R=0;for(;R<m.length;){for(S=M(m[R]),I=M(m[R+1]),P=M(m[R+2]),_=M(m[R+3]),x=S^r[0],w=_^r[1],k=P^r[2],T=I^r[3],E=4,C=1;C<i;C++)v=n[x>>>24]^o[w>>16&255]^l[k>>8&255]^c[255&T]^r[E],y=n[w>>>24]^o[k>>16&255]^l[T>>8&255]^c[255&x]^r[E+1],A=n[k>>>24]^o[T>>16&255]^l[x>>8&255]^c[255&w]^r[E+2],b=n[T>>>24]^o[x>>16&255]^l[w>>8&255]^c[255&k]^r[E+3],x=v,w=y,k=A,T=b,E+=4;v=s[x>>>24]<<24^s[w>>16&255]<<16^s[k>>8&255]<<8^s[255&T]^r[E],y=s[w>>>24]<<24^s[k>>16&255]<<16^s[T>>8&255]<<8^s[255&x]^r[E+1],A=s[k>>>24]<<24^s[T>>16&255]<<16^s[x>>8&255]<<8^s[255&w]^r[E+2],b=s[T>>>24]<<24^s[x>>16&255]<<16^s[w>>8&255]<<8^s[255&k]^r[E+3],g[R]=M(v^d),g[R+1]=M(b^u),g[R+2]=M(A^f),g[R+3]=M(y^p),d=S,u=I,f=P,p=_,R+=4}return g.buffer}}},51678:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(134);class s{constructor(t=0){(0,r.A)(this,"subtle",void 0),(0,r.A)(this,"key",void 0),(0,r.A)(this,"mode",void 0),(0,r.A)(this,"keyBuffer",void 0),this.mode=t,this.subtle=crypto.subtle||crypto.webkitSubtle}getSubtleAlgoName(){switch(this.mode){case 0:return"AES-CBC";case 1:return"AES-CTR"}}async expandKey(t){let e=new Uint8Array(t);if(this.keyBuffer){let t=!0,i=0;for(;i<e.length&&t;)t=e[i]===this.keyBuffer[i],i++;if(t)return}this.keyBuffer=e,this.key=await this.subtle.importKey("raw",t,{name:this.getSubtleAlgoName()},!1,["encrypt","decrypt"])}async encryptPadding(t,e){return new Uint8Array(await crypto.subtle.encrypt({name:"AES-CBC",iv:e},this.key,t))}async decrypt(t,e){switch(this.mode){case 0:return this.subtle.decrypt({name:"AES-CBC",iv:e},this.key,t);case 1:return this.subtle.decrypt({name:"AES-CTR",counter:e,length:64},this.key,t)}}static isSupport(){return"object"==typeof(crypto.subtle||crypto.webkitSubtle)}}},6331:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(10576);class a{constructor(t,e){(0,r.A)(this,"type",void 0),(0,r.A)(this,"phase",void 0),(0,r.A)(this,"ns",void 0),(0,r.A)(this,"target",void 0),(0,r.A)(this,"originalEvent",void 0),(0,r.A)(this,"isPrevented",void 0),(0,r.A)(this,"isStopped",void 0),(0,r.A)(this,"listener",void 0),this.type=t,this.phase=a.PHASE_CURRENT,e&&(this.originalEvent=e)}preventDefault(){const t=this;if(!t.isPrevented){const{originalEvent:e}=t;e&&e.preventDefault(),t.isPrevented=s.rT}return t}stopPropagation(){const t=this;if(!t.isStopped){const{originalEvent:e}=t;e&&e.stopPropagation(),t.isStopped=s.rT}return t}prevent(){return this.preventDefault()}stop(){return this.stopPropagation()}}(0,r.A)(a,"PHASE_CURRENT",0),(0,r.A)(a,"PHASE_UPWARD",1),(0,r.A)(a,"PHASE_DOWNWARD",s.Cy)},96172:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var r=i(134),s=i(67672),a=i(72739),n=i(6331),o=i(95335),l=i(20525),c=i(56401),h=i(10576);class d{constructor(t){(0,r.A)(this,"ns",void 0),(0,r.A)(this,"listeners",void 0),(0,r.A)(this,"nativeListeners",void 0),this.ns=t||h.W8,this.listeners={}}fire(t,e,i){let r=this,l=s.Yj(t)?r.parse(t):t,d=r.listeners[l.type],u=h.rT;if(d){d=o.C(d);const t=e&&e[0]instanceof n.A?e[0]:h.ZH;a.__(d,(function(s){if(!p(l.ns,s,h.rT)||!a.zy(d,s)||i&&!i(l,e,s))return;t&&(t.listener=s.fn);let n=(0,c.A)(s.fn,s.ctx,e);return t&&(t.listener=h.ZH),s.num=s.num?s.num+1:1,s.num===s.max&&r.off(l,s.fn),t&&(n===h.W8?t.prevent().stop():t.isStopped&&(n=h.W8)),n===h.W8?u=h.W8:void 0}))}return u}on(t,e){const i=this,r=i.listeners,n=s.Pc(e)?{fn:e}:e;if(s.Ik(n)&&s.Pc(n.fn)){const e=s.Yj(t)?i.parse(t):t;n.ns=e.ns,a.VC(r[e.type]||(r[e.type]=[]),n)}return this}one(t,e){return s.Pc(e)?e={fn:e,max:1}:e.max=1,this.on(t,e)}off(t,e){const i=this,r=i.listeners;if(t){const n=s.Yj(t)?i.parse(t):t,l=n.type,c=n.ns,d=f(e),u=function(t,e){a.__(t,(function(e,i){d(e)&&t.splice(i,1)}),h.rT),t.length||delete r[e]},m=function(t,e){a.__(t,(function(e,i){p(c,e)&&t.splice(i,1)}),h.rT),t.length||delete r[e]};l?r[l]&&u(r[l],l):c&&o.__(r,m)}else i.listeners={}}has(t,e){let i=this.listeners,r=s.Yj(t)?this.parse(t):t,n=r.type,l=r.ns,c=h.rT,d=f(e);var u;return n?i[n]&&(u=i[n],a.__(u,(function(t){if(d(t))return c=h.W8}))):l&&o.__(i,(function(t){return a.__(t,(function(t){if(p(l,t))return c=h.W8})),c})),!c}parse(t){const e={type:t,ns:h.u1};if(this.ns){const i=l.qh(t,h.ZG);i>=0&&(e.type=l.di(t,0,i),e.ns=l.di(t,i+1))}return e}}function u(){return h.rT}function f(t){return s.Pc(t)?function(e){return t===e.fn}:u}function p(t,e,i){const{ns:r}=e;return r&&t?r===t:i?h.rT:h.W8}},84504:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(2148);function s(t,e,i=!1){const s=e.split("."),a=t.split(".");for(let t=0;t<a.length;t++){if(i&&t==a.length-1&&(0,r.A)(a[t])>=(0,r.A)(s[t]))return a.length>=s.length;if((0,r.A)(a[t])>(0,r.A)(s[t]))return!0;if((0,r.A)(a[t])<(0,r.A)(s[t]))return!1;if(t===s.length-1&&t===a.length-1)return i;if(t===s.length-1)return!0;if(t===a.length-1)return!1}return!0}},92647:(t,e,i)=>{"use strict";function r(t,e){if(!e.length)return null;if(1===e.length)return e[0];let i,r=0;for(i of e)r+=i.length;let s=new t(r),a=0;for(i of e)s.set(i,a),a+=i.length;return s}i.d(e,{A:()=>r})},78995:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(56401),s=i(72739),a=i(10576);function n(t,e,i,n=!1){let o,l;return function(){let c=this;n&&(l=s.$r(arguments)),o||(n||(l=s.$r(arguments)),i&&(0,r.A)(t,c,l),o=setTimeout((function(){o=a.ZH,i||(0,r.A)(t,c,l)}),e))}}},56401:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(67672),s=i(10576);function a(t,e,i){if(r.Pc(t))return r.YO(i)?t.apply(e,i):e!==s.ZH?t.call(e,i):i!==s.ZH?t(i):t()}},8284:(t,e,i)=>{"use strict";function r(){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:3&i|8).toString(16)}))}i.d(e,{A:()=>r})},86932:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(45249),s=i.n(r);function a(){return s()()}},54568:(t,e,i)=>{"use strict";function r(){return"function"==typeof registerProcessor&&"number"==typeof sampleRate&&"number"==typeof currentFrame&&"number"==typeof currentTime}i.d(e,{A:()=>r})},34677:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(10576);function s(t){return t!==r.ZH}},59135:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(34677);let s;function a(){if((0,r.A)(s))return s;const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),s=256===new Int16Array(t)[0],s}},20491:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(67672),s=i(62100),a=i(20525);function n(t){return r.Pc(t)&&a.zy((0,s.A)(t),"[native code]")}},39638:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(34677),s=i(54568);function a(){return!("object"==typeof window&&(0,r.A)(window.document)||(0,s.A)())}},7972:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(64236),s=i.n(r),a=i(20491),n=i(10576);let o;typeof s()===n.s0&&(0,a.A)(s())&&(o=s()),o=typeof MessageChannel===n.s0&&(0,a.A)(MessageChannel)?function(t){const e=new MessageChannel;e.port1.onmessage=t,e.port2.postMessage(1)}:"function"==typeof setTimeout?setTimeout:function(t){setTimeout(t)};const l=o},36:(t,e,i)=>{"use strict";function r(t,e,i){return t<e?t=e:t>i&&(t=i),t}i.d(e,{A:()=>r})},61837:(t,e,i)=>{"use strict";i.d(e,{A:()=>f});var r=i(69736),s=i.n(r),a=i(73146),n=i.n(a);const o='\nfunction webpackBootstrapFunc (modules) {\n  var installedModules = {};\n  function __webpack_require__(moduleId) {\n    if(installedModules[moduleId])\n    return installedModules[moduleId].exports;\n    var module = installedModules[moduleId] = {\n      i: moduleId,\n      l: false,\n      exports: {}\n    };\n    if (!modules[moduleId]) {\n      console.log(\'can not found module:\', moduleId)\n    }\n    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n    module.l = true;\n    return module.exports;\n  }\n  __webpack_require__.m = modules;\n  __webpack_require__.c = installedModules;\n  __webpack_require__.i = function(value) { return value; };\n  __webpack_require__.d = function(exports, definition, getter) {\n    if (typeof definition === \'string\') {\n      if(!__webpack_require__.o(exports, definition)) {\n        Object.defineProperty(exports, definition, {\n          enumerable: true,\n          get: getter\n        });\n      }\n    }\n    else {\n      for(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n          Object.defineProperty(exports, key, {\n            enumerable: true,\n            get: definition[key]\n          });\n        }\n      }\n    }\n  };\n  __webpack_require__.r = function(exports) {\n    if(typeof Symbol !== \'undefined\' && Symbol.toStringTag) {\n    \tObject.defineProperty(exports, Symbol.toStringTag, { value: \'Module\' });\n    }\n    Object.defineProperty(exports, \'__esModule\', { value: true });\n  };\n  __webpack_require__.f = {};\n  __webpack_require__.e = function(chunkId) {\n    return Promise.all(Object.keys(__webpack_require__.f).reduce(function (promises, key) {\n      __webpack_require__.f[key](chunkId, promises);\n        return promises;\n    \t}, []));\n\t};\n  __webpack_require__.u = function(chunkId) {\n    return chunkId + "LIB_NAME";\n  };\n  __webpack_require__.n = function(module) {\n    var getter = module && module.__esModule ?\n      function getDefault() { return module[\'default\']; } :\n      function getModuleExports() { return module; };\n    __webpack_require__.d(getter, \'a\', getter);\n    return getter;\n  };\n  (function() {\n    var installedChunks = {\n      "main": 0\n    };\n    __webpack_require__.f.j = function(chunkId, promises) {\n      var installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n      if (installedChunkData !== 0) {\n        if(installedChunkData) {\n          promises.push(installedChunkData[2]);\n        } else {\n          if (true) {\n            var promise = new Promise(function(resolve, reject){installedChunkData = installedChunks[chunkId] = [resolve, reject]});\n            promises.push(installedChunkData[2] = promise);\n            var url = __webpack_require__.p + __webpack_require__.u(chunkId);\n            var error = new Error();\n            var loadingEnded = function(event) {\n              if(__webpack_require__.o(installedChunks, chunkId)) {\n                installedChunkData = installedChunks[chunkId];\n                if(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n                if(installedChunkData) {\n                  var errorType = event && (event.type === \'load\' ? \'missing\' : event.type);\n                  var realSrc = url;\n                  error.message = "Loading chunk " + chunkId + " failed.\\n(" + errorType + ": " + realSrc + ")";\n                  error.name = "ChunkLoadError";\n                  error.type = errorType;\n                  error.request = realSrc;\n                  installedChunkData[1](error);\n                }\n              }\n            };\n            __webpack_require__.l(url, loadingEnded);\n          }\n        }\n      }\n    };\n    var webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n    var [chunkIds, moreModules, runtime] = data;\n    var moduleId, chunkId, i = 0;\n    if (chunkIds.some(function(id){return installedChunks[id] !== 0})) {\n      for(moduleId in moreModules) {\n        if(__webpack_require__.o(moreModules, moduleId)) {\n          __webpack_require__.m[moduleId] = moreModules[moduleId];\n        }\n      }\n      if(runtime) runtime(__webpack_require__);\n    }\n    if (parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n      for (;i < chunkIds.length; i++) {\n        chunkId = chunkIds[i];\n        if (__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n          installedChunks[chunkId][0]();\n        }\n        installedChunks[chunkId] = 0;\n      }\n    }\n    var self = typeof globalThis !== undefined ? globalThis : self\n    var exportName = \'LIBRARY_EXPORT_NAME\'\n    var chunkLoadingGlobal = self["webpackChunk" + exportName] = self["webpackChunk" + exportName] || [];\n    chunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\n    chunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));\n  })();\n  (function() {\n    var inProgress = {};\n    __webpack_require__.l = function(url, done) {\n      if (inProgress[url]) { inProgress[url].push(done); return; }\n        inProgress[url] = [done];\n        var onComplete = function(event) {\n          clearTimeout(timeout);\n          var doneFns = inProgress[url];\n          delete inProgress[url];\n          doneFns && doneFns.forEach(function(fn){fn(event)});\n        }\n        var timeout = setTimeout(onComplete.bind(null, undefined, { type: "timeout" }), 120000);\n      import(url).then(function() {\n        onComplete({\n          type: "load"\n        })\n      }, function (error) {\n        onComplete({\n          type: "missing"\n        })\n      });\n    };\n  })();\n  __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n  __webpack_require__.p = "ROOT_URL";\n  __webpack_require__.oe = function(err) { console.error(err); throw err; };\n  var f = __webpack_require__(__webpack_require__.s = ENTRY_MODULE);\n  return f;\n}\n',l="[\\.|\\-|\\+|\\w|/|@|!]+",c="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+l+").*?\\)";function h(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function d(t,e,r,a){const n={};n[r]=[];let o=e.toString();const d=o.match(/^(function)?\s?\w*\(\w+,\s*(\w+),\s*(\w+)\)/);if(!d)return n;const u=d[3];a.__webpack_exports_process__||(a.__webpack_require__=u,a.__webpack_exports__=d[2],a.__webpack_exports_process__=!0);let f,p=new RegExp("(\\\\n|\\W)"+h(u)+c,"g");for(;f=p.exec(o);)"dll-reference"!==f[3]&&n[r].push(f[3]);for(p=new RegExp("\\("+h(u)+'\\("(dll-reference\\s('+l+'))"\\)\\)'+c,"g");f=p.exec(o);)t[f[2]]||(n[r].push(f[1]),t[f[2]]=i(f[1]).m),n[f[2]]=n[f[2]]||[],n[f[2]].push(f[4]);const m=s()(n);for(let t=0;t<m.length;t++)for(let e=0;e<n[m[t]].length;e++)g=+n[m[t]][e],isNaN(g)||(n[m[t]][e]=+n[m[t]][e]);var g;return n}function u(t){return s()(t).reduce((function(e,i){return e||t[i].length>0}),!1)}function f(t,e){const r={main:i.m},a=function(t,e){const i={main:[e]},r={main:[],__webpack_exports__:"__webpack_exports__",__webpack_require__:"__webpack_require__",__webpack_exports_process__:!1},a={main:{}};for(;u(i);){const e=s()(i);for(let n=0;n<e.length;n++){let o=e[n],l=i[o].pop();if(a[o]=a[o]||{},a[o][l]||!t[o][l])continue;a[o][l]=!0,r[o]=r[o]||[],r[o].push(l);let c=d(t,t[o][l],o,r),h=s()(c);for(let t=0;t<h.length;t++)i[h[t]]=i[h[t]]||[],i[h[t]]=i[h[t]].concat(c[h[t]])}}return r}(r,t);let l=n()(t);return"var "+e.varName+"=("+o.replace("ENTRY_MODULE",l).replace("ROOT_URL",i.p||"").replace("LIBRARY_EXPORT_NAME","AVPlayer").replace("LIB_NAME",i.u&&i.u("")||"")+")({"+a.main.map((function(t){const i=n()(t);let s=i+": "+r.main[t].toString();if(i===l&&e.exportName&&e.pointName){const t=`;${a.__webpack_require__}.d(\n          ${a.__webpack_exports__},\n          "${e.exportName}",\n          function() {\n            if (${e.exportIsClass}) {\n              for (var key in ${a.__webpack_exports__}) {\n                if (key === '${e.exportName}') {\n                  continue;\n                }\n                var v = ${a.__webpack_exports__}[key];\n                if (typeof v === 'function' && v.name === '${e.pointName}') {\n                  return v;\n                }\n              }\n            }\n            return ${e.pointName};\n          }\n        );`;s=s.slice(0,s.length-1)+t+"}"}return s})).join(",")+"});"}},6498:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(67672),s=i(72739);function a(t,e){const i=[];return r.ai(t)&&(t+=""),t&&r.Yj(t)&&s.__(t.split(e),((t,e)=>{(t=t.trim())&&i.push(t)})),i}},2148:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(67672),s=i(10576);function a(t,e){return r.sH(t)?+t:e!==s.ZH?e:0}},62100:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(10576);function s(t,e){return t!=r.Cq&&t.toString?t.toString():e!==r.ZH?e:r.u1}},65196:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(134),s=i(54001),a=i.n(s),n=i(67672),o=i(72739);class l{constructor(){(0,r.A)(this,"queue",void 0),this.queue=[]}async execute(t){try{const e=await t.task();t.resolve(e)}catch(e){t.reject(e)}}async next(){if(this.queue.length){const t=this.queue[0];t.error?t.reject(t.error):await this.execute(t),this.queue.shift(),this.queue.length&&this.next()}}async push(t){if(!n.Pc(t))throw new TypeError("task must be a function");return new(a())(((e,i)=>{const r={task:t,resolve:e,reject:i};this.queue.push(r),1===this.queue.length&&this.next()}))}clear(t){o.__(this.queue,(e=>{e.error=t||new Error("command queue clear")}))}clearPadding(){this.queue.length=0}get length(){return this.queue.length}}},68391:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(134),s=i(67672),a=i(54058),n=i(86932);class o{constructor(t,e=0){(0,r.A)(this,"queue",void 0),(0,r.A)(this,"timer",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"onEnd",void 0),(0,r.A)(this,"lastTime",void 0),(0,r.A)(this,"interval",void 0),this.queue=[],this.interval=t,this.timer=new a.A((()=>{this.queue.length?this.queue.shift()():this.ended?(this.onEnd&&this.onEnd(),this.timer.stop()):this.lastTime=(0,n.A)()}),e,t)}push(t){if(!s.Pc(t))throw new TypeError("task must be a function");this.ended=!1;const e=(0,n.A)();this.timer.isStarted()&&!this.queue.length&&e-this.lastTime>this.interval?(t(),this.lastTime=e):(this.queue.push(t),1!==this.queue.length||this.timer.isStarted()||this.timer.start())}end(){this.ended=!0}reset(){this.timer.stop(),this.queue.length=0}}},61403:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(67672);class a{constructor(){(0,r.A)(this,"proxy",void 0),this.proxy=new Proxy(this,{get:(t,e,i)=>s.sH(e)?t.getIndexValue(+e):t[e],set:(t,e,i,r)=>(s.sH(e)?t.setIndexValue(+e,i):t[e]=i,!0)})}}},37246:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(4624);class a{constructor(t=1048576){(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"bitsLeft",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"endPointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.pos=BigInt(0),this.size=t,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}peekU1(){let t=0;(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();let e=this.pointer,i=this.bitsLeft;return 0===i&&(e++,i=8),t=this.buffer[e]>>i-1&1,t}readU1(){let t=0;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,t=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8,this.pos++),t}readU(t){let e=0;for(let i=0;i<t;i++)e|=this.readU1()<<t-i-1;return e}remainingLength(){return this.endPointer-this.pointer}getBitLeft(){return this.bitsLeft}getPointer(){return this.pointer}setPointer(t){this.pointer=t}getPos(){return this.pos}skip(t){const e=(t-t%8)/8;this.pointer+=e,this.pos+=BigInt(e);const i=t%8;this.bitsLeft<=i?(this.pointer++,this.pos++,this.bitsLeft=8-(i-this.bitsLeft)):this.bitsLeft-=i}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&(this.pointer++,this.pos++),!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);const t=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(t<0)throw this.error=t,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+t,this.pointer=0}else{const t=this.onFlush(this.buffer);if(this.endPointer=t,this.pointer=0,this.bitsLeft=8,t<0)throw this.error=t,Error("IOReader error, flush failed")}}getBuffer(){return this.buffer}appendBuffer(t){if(this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else{const e=Math.min(this.size-this.endPointer,t.length);this.buffer.set(t.subarray(0,e),this.endPointer),this.endPointer+=e,s.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src/common/io/BitReader.ts",241)}}reset(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0,this.pos=BigInt(0)}skipPadding(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++,this.pos++)}}},83314:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(134);class s{constructor(t=1048576){(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"bitPointer",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),this.pointer=0,this.bitPointer=0,this.size=t,this.error=0,this.pos=BigInt(0),this.buffer=new Uint8Array(this.size)}writeU1(t){(this.remainingLength()<1||1===this.remainingLength()&&this.bitPointer>=8)&&this.flush(),1&t?this.buffer[this.pointer]|=1<<7-this.bitPointer:this.buffer[this.pointer]&=~(1<<7-this.bitPointer),this.bitPointer++,8===this.bitPointer&&(this.pointer++,this.pos++,this.bitPointer=0)}writeU(t,e){for(let i=0;i<t;i++)this.writeU1(e>>t-i-1&1)}remainingLength(){return this.size-this.pointer}flush(){if(!this.onFlush)throw this.error=-1048574,Error("BSWriter error, flush failed because of no flush callback");if(this.pointer)if(this.bitPointer&&this.pointer>1){const t=this.onFlush(this.buffer.subarray(0,this.pointer-1));if(0!==t)throw this.error=t,Error("BSWriter error, flush failed");this.buffer[0]=this.buffer[this.pointer]}else if(0===this.bitPointer){const t=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("BSWriter error, flush failed")}this.pointer=0}padding(){for(;0!==this.bitPointer;)this.writeU1(0)}reset(){this.pointer=0,this.bitPointer=0,this.error=0,this.pos=BigInt(0)}getBuffer(){return this.buffer}getPointer(){return this.pointer}getPos(){return this.pos}}},31865:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(92647),a=i(50011);class n{constructor(t,e=!0){(0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"byteStart",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}readUint8(){return this.data.getUint8(this.pos+++this.byteStart)}readUint16(){const t=this.data.getUint16(this.pos+this.byteStart,this.littleEndian);return this.pos+=2,t}readUint24(){return this.readUint16()<<8|this.readUint8()}readUint32(){const t=this.data.getUint32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,t}readUint64(){const t=BigInt(this.readUint32()),e=BigInt(this.readUint32());return this.littleEndian?e<<BigInt(32)|t:t<<BigInt(32)|e}readInt8(){return this.data.getInt8(this.pos+++this.byteStart)}readInt16(){const t=this.data.getInt16(this.pos+this.byteStart,this.littleEndian);return this.pos+=2,t}readInt32(){const t=this.data.getInt32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,t}readInt64(){const t=BigInt(this.readInt32()),e=BigInt(this.readInt32());return this.littleEndian?e<<BigInt(32)|t:t<<BigInt(32)|e}readFloat(){const t=this.data.getFloat32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,t}readDouble(){const t=this.data.getFloat64(this.pos+this.byteStart,this.littleEndian);return this.pos+=8,t}readHex(t=1){let e="";for(let i=0;i<t;i++){const t=this.readUint8().toString(16);e+=1===t.length?"0"+t:t}return e}readString(t=1){let e="";if(t){let i=this.pos;for(let e=0;e<t&&0===this.buffer[this.pos+e];e++)i++;e=a.decode(this.buffer.subarray(i,i+t))}return this.pos+=t,e}readLine(){let t="";for(let e=this.pos;e<this.size;e++)if(10===this.buffer[e]||13===this.buffer[e]){t+=this.readString(e-this.pos);break}for(let t=this.pos;t<this.size&&(10===this.buffer[t]||13===this.buffer[t]);t++)this.readUint8();return t}getPos(){return BigInt(this.pos)}seek(t){t>this.size&&(t=this.size),this.pos=Math.max(0,t)}skip(t){this.seek(this.pos+t)}back(t){this.seek(this.pos-t)}remainingSize(){return this.size-this.pos}readBuffer(t){t=Math.min(t,this.remainingSize());const e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e}appendBuffer(t){this.buffer=(0,s.A)(Uint8Array,[this.buffer.slice(),t.slice()]),this.data=new DataView(this.buffer.buffer),this.size+=t.byteLength,this.byteStart=0}resetBuffer(t,e=!0){this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}}},729:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(4624),a=i(50011);class n{constructor(t,e=!0){(0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"byteStart",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}writeUint8(t){this.data.setUint8(this.pos+++this.byteStart,t)}writeUint16(t){this.data.setUint16(this.pos+this.byteStart,t,this.littleEndian),this.pos+=2}writeUint24(t){const e=3840&t,i=240&t,r=15&t;this.littleEndian?(this.writeUint8(r),this.writeUint8(i),this.writeUint8(e)):(this.writeUint8(e),this.writeUint8(i),this.writeUint8(r))}writeUint32(t){this.data.setUint32(this.pos+this.byteStart,t,this.littleEndian),this.pos+=4}writeUint64(t){const e=t&BigInt(4294967295),i=(t&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeUint32(Number(e)),this.writeUint32(Number(i))):(this.writeUint32(Number(i)),this.writeUint32(Number(e)))}writeInt8(t){this.data.setInt8(this.pos+++this.byteStart,t)}writeInt16(t){this.data.setInt16(this.pos+this.byteStart,t,this.littleEndian),this.pos+=2}writeInt32(t){this.data.setInt32(this.pos+this.byteStart,t,this.littleEndian),this.pos+=4}writeInt64(t){const e=t&BigInt(4294967295),i=(t&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeInt32(Number(e)),this.writeInt32(Number(i))):(this.writeInt32(Number(i)),this.writeInt32(Number(e)))}writeFloat(t){this.data.setFloat32(this.pos+this.byteStart,t,this.littleEndian),this.pos+=4}writeDouble(t){this.data.setFloat64(this.pos+this.byteStart,t,this.littleEndian),this.pos+=8}getPos(){return this.pos}seek(t){t>this.size&&(t=this.size),this.pos=Math.max(0,t)}skip(t){this.seek(this.pos+t)}back(t){this.seek(this.pos-t)}remainingSize(){return this.size-this.pos}writeBuffer(t){let e=t.length;this.remainingSize()<e&&(e=this.remainingSize(),s.R8(`the remaining buffer size is smaller then the wrote buffer, hope set ${t.length}, but set ${e}`,"src/common/io/BufferWriter.ts",211)),this.buffer.set(t,this.pos),this.pos+=t.length}writeString(t){const e=a.encode(t);return this.writeBuffer(e),e.length}getWroteBuffer(){return this.buffer.subarray(0,this.pos)}resetBuffer(t,e=!0){this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}}},24175:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(134),s=i(4624),a=i(50011),n=i(13724),o="src/common/io/IOReader.ts";class l{constructor(t=1048576,e=!0,i){if((0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"endPointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),(0,r.A)(this,"fileSize_",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),(0,r.A)(this,"onSeek",void 0),(0,r.A)(this,"onSize",void 0),(0,r.A)(this,"flags",void 0),this.pos=BigInt(0),this.pointer=0,this.error=0,this.endPointer=0,this.littleEndian=!e,this.flags=0,i&&i.view)this.size=i.length,this.buffer=i,this.data=i.view;else if(i&&!i.byteOffset)this.size=i.length,this.buffer=i,this.data=new DataView(this.buffer.buffer);else{if(i)throw new Error("not support subarray of ArrayBuffer");this.size=Math.max(t,102400),this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}async readUint8(){this.remainingLength()<1&&await this.flush(1);const t=this.data.getUint8(this.pointer);return this.pointer++,this.pos++,t}async peekUint8(){return this.remainingLength()<1&&await this.flush(1),this.data.getUint8(this.pointer)}async readUint16(){this.remainingLength()<2&&await this.flush(2);const t=this.data.getUint16(this.pointer,this.littleEndian);return this.pointer+=2,this.pos+=BigInt(2),t}async peekUint16(){return this.remainingLength()<2&&await this.flush(2),this.data.getUint16(this.pointer,this.littleEndian)}async readUint24(){return this.remainingLength()<3&&await this.flush(3),await this.readUint16()<<8|await this.readUint8()}async peekUint24(){this.remainingLength()<3&&await this.flush(3);const t=this.pointer,e=this.pos,i=await this.readUint16()<<8|await this.readUint8();return this.pointer=t,this.pos=e,i}async readUint32(){this.remainingLength()<4&&await this.flush(4);const t=this.data.getUint32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),t}async peekUint32(){return this.remainingLength()<4&&await this.flush(4),this.data.getUint32(this.pointer,this.littleEndian)}async readUint64(){this.remainingLength()<8&&await this.flush(8);const t=this.data.getBigUint64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),t}async peekUint64(){return this.remainingLength()<8&&await this.flush(8),this.data.getBigUint64(this.pointer,this.littleEndian)}async readInt8(){this.remainingLength()<1&&await this.flush(1);const t=this.data.getInt8(this.pointer);return this.pointer++,this.pos++,t}async peekInt8(){return this.remainingLength()<1&&await this.flush(1),this.data.getInt8(this.pointer)}async readInt16(){this.remainingLength()<2&&await this.flush(2);const t=this.data.getInt16(this.pointer,this.littleEndian);return this.pointer+=2,this.pos+=BigInt(2),t}async peekInt16(){return this.remainingLength()<2&&await this.flush(2),this.data.getInt16(this.pointer,this.littleEndian)}async readInt32(){this.remainingLength()<4&&await this.flush(4);const t=this.data.getInt32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),t}async peekInt32(){return this.remainingLength()<4&&await this.flush(4),this.data.getInt32(this.pointer,this.littleEndian)}async readInt64(){this.remainingLength()<8&&await this.flush(8);const t=this.data.getBigInt64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),t}async peekInt64(){return this.remainingLength()<8&&await this.flush(8),this.data.getBigInt64(this.pointer,this.littleEndian)}async readFloat(){this.remainingLength()<4&&await this.flush(4);const t=this.data.getFloat32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),t}async peekFloat(){return this.remainingLength()<4&&await this.flush(4),this.data.getFloat32(this.pointer,this.littleEndian)}async readDouble(){this.remainingLength()<8&&await this.flush(8);const t=this.data.getFloat64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),t}async peekDouble(){return this.remainingLength()<8&&await this.flush(8),this.data.getFloat64(this.pointer,this.littleEndian)}async readHex(t=1){let e="";for(let i=0;i<t;i++){const t=(await this.readUint8()).toString(16);e+=1===t.length?"0"+t:t}return e}async peekHex(t=1){t>this.size&&(this.error=-1048574,s.h2("peekHex, length too large",o,395)),this.remainingLength()<t&&await this.flush(t);const e=this.pointer,i=this.pos;let r="";for(let e=0;e<t;e++){const t=(await this.readUint8()).toString(16);r+=1===t.length?"0"+t:t}return this.pointer=e,this.pos=i,r}async readBuffer(t,e){if(e||(e=new Uint8Array(t)),this.remainingLength()<t){let i=0;if(this.remainingLength()>0){const r=this.remainingLength();e.set(this.buffer.subarray(this.pointer,this.pointer+r),i),i+=r,this.pointer+=r,this.pos+=BigInt(r),t-=r}for(;t>0;){await this.flush();const r=Math.min(this.endPointer-this.pointer,t);e.set(this.buffer.subarray(this.pointer,this.pointer+r),i),i+=r,this.pointer+=r,this.pos+=BigInt(r),t-=r}}else e.set(this.buffer.subarray(this.pointer,this.pointer+t),0),this.pointer+=t,this.pos+=BigInt(t);return e}async peekBuffer(t,e){return t>this.size&&(this.error=-1048574,s.h2("peekBuffer, length too large",o,480)),this.remainingLength()<t&&await this.flush(t),e||(e=new Uint8Array(t)),e.set(this.buffer.subarray(this.pointer,this.pointer+t),0),e}async readToBuffer(t,e){if(this.remainingLength()<t){let i=0;if(this.remainingLength()>0){const r=this.remainingLength();e.set(this.buffer.subarray(this.pointer,this.pointer+r),i),i+=r,this.pointer+=r,this.pos+=BigInt(r),t-=r}for(;t>0;){try{await this.flush()}catch(t){if(-1048576===this.error&&i)return i;throw t}const r=Math.min(this.endPointer-this.pointer,t);e.set(this.buffer.subarray(this.pointer,this.pointer+r),i),i+=r,this.pointer+=r,this.pos+=BigInt(r),t-=r}return i}return e.set(this.buffer.subarray(this.pointer,this.pointer+t),0),this.pointer+=t,this.pos+=BigInt(t),t}async readString(t=1){const e=await this.readBuffer(t);return a.decode(e)}async peekString(t=1){const e=await this.peekBuffer(t);return a.decode(e)}async readLine(){let t="";for(;;){let e=!1;for(let i=this.pointer;i<this.endPointer;i++)if(10===this.buffer[i]||13===this.buffer[i]){i!==this.pointer&&(t+=await this.readString(i-this.pointer)),e=!0;break}if(e)break;t+=await this.readString(this.remainingLength()),await this.flush()}let e=await this.peekUint8();return 10!==e&&13!==e||(this.pointer++,13===e&&(e=await this.peekUint8(),10===e&&this.pointer++)),t}async peekLine(){if(this.remainingLength()<this.size)try{await this.flush()}catch(t){if(-1048576!==this.error)throw t}let t="",e=!1;for(let i=this.pointer;i<this.endPointer;i++)if(10===this.buffer[i]||13===this.buffer[i]){t+=await this.peekString(i-this.pointer),e=!0;break}return e||(this.error=-1048574,s.h2("peekLine, out of buffer",o,638)),t}getPointer(){return this.pointer}getPos(){return this.pos}async skip(t){const e=t;for(;this.remainingLength()<t;)t-=this.remainingLength(),this.pointer=this.endPointer,await this.flush();this.remainingLength()>=t&&(this.pointer+=t),this.pos+=BigInt(e)}remainingLength(){return this.endPointer-this.pointer}async flush_(t){for(;;){const e=await this.onFlush(t);if(-1048575!==e)return e;await new n.A(0)}}async flush(t=0){if(this.onFlush||(this.error=-1048574,s.h2("IOReader error, flush failed because of no flush callback",o,712)),!(this.size-this.remainingLength()<=0)){if(t=Math.min(t,this.size),this.pointer<this.endPointer?(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer):this.endPointer=0,this.pointer=0,t)for(;this.remainingLength()<t;){const t=await this.flush_(this.buffer.subarray(this.endPointer));if(t<0)throw this.error=t,new Error(`IOReader error, flush ${-1048576===t?"ended":"failed"}, ret: ${t}`);this.endPointer+=t}else{const t=await this.flush_(this.buffer.subarray(this.endPointer));if(t<0)throw this.error=t,new Error(`IOReader error, flush ${-1048576===t?"ended":"failed"}, ret: ${t}`);this.endPointer+=t}this.error=0}}async seek(t,e=!1,i=!0){if(!e){const e=Number(t-this.pos);if(e<0&&Math.abs(e)<this.pointer)return this.pointer+=e,void(this.pos=t);if(e>0&&this.pointer+e<this.endPointer)return this.pointer+=e,void(this.pos=t);if(0===e)return}this.onSeek||(this.error=-1048574,s.h2("IOReader error, seek failed because of no seek callback",o,783)),this.pointer=this.endPointer=0,this.pos=t;const r=await this.onSeek(t);0!==r&&(this.error=r,s.h2("IOReader error, seek failed",o,792)),i&&await this.flush()}getBuffer(){return this.buffer}appendBuffer(t){if(this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else{const e=Math.min(this.size-this.endPointer,t.length);this.buffer.set(t.subarray(0,e),this.endPointer),this.endPointer+=e,s.R8("IOReader, call appendBuffer but the buffer's size is lagger then the remaining size",o,830)}}reset(){this.pointer=this.endPointer=0,this.pos=BigInt(0),this.error=0}setEndian(t){this.littleEndian=!t}async fileSize(){if(this.fileSize_)return this.fileSize_;if(!this.onSize)return s.R8("IOReader error, fileSize failed because of no onSize callback",o,863),BigInt(0);try{this.fileSize_=await this.onSize()}catch(t){s.R8(`IOReader error, call fileSize failed: ${t}`,o,870),this.fileSize_=BigInt(0)}return this.fileSize_}getBufferSize(){return this.size}async pipe(t,e){if(e)if(this.remainingLength()<e){if(this.remainingLength()>0){const i=this.remainingLength();await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+i)),this.pointer+=i,this.pos+=BigInt(i),e-=i}for(;e>0;){await this.flush();const i=Math.min(this.remainingLength(),e);await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+i)),this.pointer+=i,this.pos+=BigInt(i),e-=i}}else await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+e)),this.pointer+=e,this.pos+=BigInt(e);else{if(this.remainingLength()>0){const e=this.remainingLength();await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+e)),this.pointer+=e,this.pos+=BigInt(e)}for(;await this.flush_(this.buffer.subarray(0))>0;){const e=this.remainingLength();await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+e)),this.pointer+=e,this.pos+=BigInt(e)}}}}},34531:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(50011);class a{constructor(t=1048576,e=!0,i){if((0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),(0,r.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=t,this.littleEndian=!e,this.error=0,i&&i.view)this.size=i.length,this.buffer=i,this.data=i.view;else if(i&&!i.byteOffset)this.size=i.length,this.buffer=i,this.data=new DataView(this.buffer.buffer);else{if(i)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}async writeUint8(t){this.remainingLength()<1&&await this.flush(),this.data.setUint8(this.pointer,t),this.pointer++,this.pos++}async writeUint16(t){this.remainingLength()<2&&await this.flush(),this.data.setUint16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}async writeUint24(t){this.remainingLength()<3&&await this.flush();const e=(16711680&t)>>16,i=(65280&t)>>8,r=255&t;this.littleEndian?(await this.writeUint8(r),await this.writeUint8(i),await this.writeUint8(e)):(await this.writeUint8(e),await this.writeUint8(i),await this.writeUint8(r))}async writeUint32(t){this.remainingLength()<4&&await this.flush(),this.data.setUint32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeUint64(t){this.remainingLength()<8&&await this.flush(),this.data.setBigUint64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}async writeInt8(t){this.remainingLength()<1&&await this.flush(),this.data.setInt8(this.pointer,t),this.pointer++,this.pos++}async writeInt16(t){this.remainingLength()<2&&await this.flush(),this.data.setInt16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}async writeInt32(t){this.remainingLength()<4&&await this.flush(),this.data.setInt32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeInt64(t){this.remainingLength()<8&&await this.flush(),this.data.setBigInt64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}async writeFloat(t){this.remainingLength()<4&&await this.flush(),this.data.setFloat32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeDouble(t){this.remainingLength()<8&&await this.flush(),this.data.setFloat64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}getPointer(){return this.pointer}getPos(){return this.pos}remainingLength(){return this.size-this.pointer}async writeBuffer(t){if(!t.length)return;let e=t.length;if(this.remainingLength()<e){let i=0;for(;e>0;){await this.flush();const r=Math.min(this.size,e);this.buffer.set(t.subarray(i,i+r),this.pointer),this.pointer+=r,this.pos+=BigInt(r),i+=r,e-=r}}else this.buffer.set(t,this.pointer),this.pointer+=e,this.pos+=BigInt(e)}async writeString(t){const e=s.encode(t);return await this.writeBuffer(e),e.length}async flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const t=await this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}async flushToPos(t){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const e=await this.onFlush(this.buffer.subarray(0,this.pointer),t);if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}async seek(t){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");await this.flush();const e=await this.onSeek(t);if(0!==e)throw this.error=e,Error("IOWriter error, seek failed");this.pos=t}seekInline(t){const e=this.pointer;this.pointer=Math.max(0,Math.min(this.size,t)),this.pos+=BigInt(this.pointer-e)}skip(t){const e=this.pointer;this.pointer=Math.min(this.size,this.pointer+t),this.pos+=BigInt(this.pointer-e)}back(t){const e=this.pointer;this.pointer=Math.max(0,this.pointer-t),this.pos+=BigInt(this.pointer-e)}getBuffer(){return this.buffer.subarray(0,this.pointer)}setEndian(t){this.littleEndian=!t}reset(){this.pointer=0,this.pos=BigInt(0),this.error=0}getBufferSize(){return this.size}}},35336:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(50011);class a{constructor(t=1048576,e=!0,i){if((0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),(0,r.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=t,this.littleEndian=!e,this.error=0,i&&i.view)this.size=i.length,this.buffer=i,this.data=i.view;else if(i&&!i.byteOffset)this.size=i.length,this.buffer=i,this.data=new DataView(this.buffer.buffer);else{if(i)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}writeUint8(t){this.remainingLength()<1&&this.flush(),this.data.setUint8(this.pointer,t),this.pointer++,this.pos++}writeUint16(t){this.remainingLength()<2&&this.flush(),this.data.setUint16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeUint24(t){this.remainingLength()<3&&this.flush();const e=(16711680&t)>>16,i=(65280&t)>>8,r=255&t;this.littleEndian?(this.writeUint8(r),this.writeUint8(i),this.writeUint8(e)):(this.writeUint8(e),this.writeUint8(i),this.writeUint8(r))}writeUint32(t){this.remainingLength()<4&&this.flush(),this.data.setUint32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeUint64(t){this.remainingLength()<8&&this.flush(),this.data.setBigUint64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeInt8(t){this.remainingLength()<1&&this.flush(),this.data.setInt8(this.pointer,t),this.pointer++,this.pos++}writeInt16(t){this.remainingLength()<2&&this.flush(),this.data.setInt16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeInt32(t){this.remainingLength()<4&&this.flush(),this.data.setInt32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeInt64(t){this.remainingLength()<8&&this.flush(),this.data.setBigInt64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeFloat(t){this.remainingLength()<4&&this.flush(),this.data.setFloat32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeDouble(t){this.remainingLength()<8&&this.flush(),this.data.setFloat64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}getPointer(){return this.pointer}getPos(){return this.pos}remainingLength(){return this.size-this.pointer}writeBuffer(t){if(!t.length)return;let e=t.length;if(this.remainingLength()<e){let i=0;for(;e>0;){this.flush();const r=Math.min(this.size,e);this.buffer.set(t.subarray(i,i+r),this.pointer),this.pointer+=r,this.pos+=BigInt(r),i+=r,e-=r}}else this.buffer.set(t,this.pointer),this.pointer+=e,this.pos+=BigInt(e)}writeString(t){const e=s.encode(t);return this.writeBuffer(e),e.length}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const t=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}flushToPos(t){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const e=this.onFlush(this.buffer.subarray(0,this.pointer),t);if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}seek(t){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");this.flush();const e=this.onSeek(t);if(0!==e)throw this.error=e,Error("IOWriter error, seek failed");this.pos=t}seekInline(t){const e=this.pointer;this.pointer=Math.max(0,Math.min(this.size,t)),this.pos+=BigInt(this.pointer-e)}skip(t){const e=this.pointer;this.pointer=Math.min(this.size,this.pointer+t),this.pos+=BigInt(this.pointer-e)}back(t){const e=this.pointer;this.pointer=Math.max(0,this.pointer-t),this.pos+=BigInt(this.pointer-e)}getBuffer(){return this.buffer.subarray(0,this.pointer)}setEndian(t){this.littleEndian=!t}reset(){this.pointer=0,this.pos=BigInt(0),this.error=0}getBufferSize(){return this.size}}},22343:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(92647);class a{constructor(){(0,r.A)(this,"queue",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"startPos",void 0),(0,r.A)(this,"endPos",void 0),(0,r.A)(this,"index",void 0),(0,r.A)(this,"offset",void 0),this.queue=[],this.startPos=BigInt(0),this.endPos=BigInt(0),this.pos=BigInt(0)}write(t){if(this.pos===this.endPos)this.queue.push(t),this.endPos+=BigInt(t.length),this.pos+=BigInt(t.length);else if(t.length<this.queue[this.index].length-this.offset)this.queue[this.index].set(t,this.offset),this.offset+=t.length,this.pos+=BigInt(t.length),this.offset===this.queue[this.index].length&&(this.index++,this.offset=0),this.index===this.queue.length&&(this.index=-1,this.offset=-1,this.pos=this.endPos);else{let e=0;for(;e<t.length;){const i=Math.min(this.queue[this.index].length-this.offset,t.length-e);if(this.queue[this.index].set(t.subarray(e,e+i),this.offset),e+=i,this.offset+=i,this.pos+=BigInt(i),this.offset===this.queue[this.index].length){if(this.index+1===this.queue.length){if(e<t.length){const i=t.subarray(t.length-e);this.queue.push(i),this.endPos+=BigInt(i.length)}this.pos=this.endPos,this.index=-1,this.offset=-1;break}this.index++,this.offset=0}}}}seek(t){if(t<this.startPos||t>this.endPos)return!1;this.pos=t,this.index=-1,this.offset=-1;let e=this.startPos;for(let i=0;i<this.queue.length;i++){if(t<=e+BigInt(this.queue[i].length)){this.index=i,this.offset=Number(t-e);break}e+=BigInt(this.queue[i].length)}return this.index<0&&(this.pos=this.endPos),!0}flush(){this.startPos=this.endPos,this.pos=this.endPos,this.index=-1,this.offset=-1;const t=(0,s.A)(Uint8Array,this.queue);return this.queue.length=0,t}get size(){return this.queue.length}}},45726:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(134),s=i(72739),a=i(4624),n="src/common/math/Matrix3.ts";class o{static RowMajor(t){return new o([t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]])}static ColMajor(t){return new o(t)}constructor(t){(0,r.A)(this,"element",void 0),t?(this.element=new Float32Array(9),this.set(t)):this.element=new Float32Array([1,0,0,0,1,0,0,0,1])}rc(t,e){return this.getValue(3*e+t)}setRC(t,e,i){this.setValue(3*e+t,i)}getValue(t){if(t>=0&&t<9)return this.element[t];a.z3("index out of Matrix4's rang [0 - 9]",n,47)}setValue(t,e){t>=0&&t<9?this.element[t]=e:a.z3("index out of Matrix4's rang [0 - 9]",n,56)}setIdentity(){return this.element=new Float32Array([1,0,0,0,1,0,0,0,1]),this}set(t){return s.__(t,((t,e)=>{this.element[e]=t})),this}invert(){const t=this.element,e=t[0],i=t[1],r=t[2],s=t[3],a=t[4],n=t[5],o=t[6],l=t[7],c=t[8],h=c*a-n*l,d=n*o-c*s,u=l*s-a*o,f=e*h+i*d+r*u;if(0===f)return this.set([0,0,0,0,0,0,0,0,0]);const p=1/f;return t[0]=h*p,t[1]=(r*l-c*i)*p,t[2]=(n*i-r*a)*p,t[3]=d*p,t[4]=(c*e-r*o)*p,t[5]=(r*s-n*e)*p,t[6]=u*p,t[7]=(i*o-l*e)*p,t[8]=(a*e-i*s)*p,this}toArray(){let t=[];for(let e=0;e<9;e++)t[e]=this.element[e];return t}copy(){return(new o).set(this.toArray())}}},12535:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(134),s=i(72739),a=i(4624),n=i(1064),o="src/common/math/Matrix4.ts";let l;class c{static shared(){return l||(l=new c)}static RowMajor(t){return new c([t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]])}static ColMajor(t){return new c(t)}constructor(t){(0,r.A)(this,"element",void 0),t?(this.element=new Float32Array(16),this.set(t)):this.element=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}rc(t,e){return this.getValue(4*e+t)}setRC(t,e,i){this.setValue(4*e+t,i)}getValue(t){if(t>=0&&t<=15)return this.element[t];a.z3("index out of Matrix4's rang [0 - 15]",o,58)}setValue(t,e){t>=0&&t<=15?this.element[t]=e:a.z3("index out of Matrix4's rang [0 - 15]",o,67)}setIdentity(){return this.element=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this}set(t){return s.__(t,((t,e)=>{this.element[e]=t})),this}multiply(t){let e,i,r,s,a,n,o,l;if(s=i=this.element,r=t.element,s===r)for(r=new Float32Array(16),e=0;e<16;e++)r[e]=s[e];for(e=0;e<4;e++)a=i[e],n=i[e+4],o=i[e+8],l=i[e+12],s[e]=a*r[0]+n*r[1]+o*r[2]+l*r[3],s[e+4]=a*r[4]+n*r[5]+o*r[6]+l*r[7],s[e+8]=a*r[8]+n*r[9]+o*r[10]+l*r[11],s[e+12]=a*r[12]+n*r[13]+o*r[14]+l*r[15];return this}multiplyVector3(t){let e=this.element,i=t.element;return new n.P([i[0]*e[0]+i[1]*e[4]+i[2]*e[8]+e[12],i[0]*e[1]+i[1]*e[5]+i[2]*e[9]+e[13],i[0]*e[2]+i[1]*e[6]+i[2]*e[10]+e[14]])}multiplyVector4(t){let e=this.element,i=t.element;return new n.I([i[0]*e[0]+i[1]*e[4]+i[2]*e[8]+i[3]*e[12],i[0]*e[1]+i[1]*e[5]+i[2]*e[9]+i[3]*e[13],i[0]*e[2]+i[1]*e[6]+i[2]*e[10]+i[3]*e[14],i[0]*e[3]+i[1]*e[7]+i[2]*e[11]+i[3]*e[15]])}transpose(){let t,e;return t=this.element,e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setInverseOf(t){let e,i,r,s,a;if(i=t.element,r=this.element,s=new Float32Array(16),s[0]=i[5]*i[10]*i[15]-i[5]*i[11]*i[14]-i[9]*i[6]*i[15]+i[9]*i[7]*i[14]+i[13]*i[6]*i[11]-i[13]*i[7]*i[10],s[1]=-i[1]*i[10]*i[15]+i[1]*i[11]*i[14]+i[9]*i[2]*i[15]-i[9]*i[3]*i[14]-i[13]*i[2]*i[11]+i[13]*i[3]*i[10],s[2]=i[1]*i[6]*i[15]-i[1]*i[7]*i[14]-i[5]*i[2]*i[15]+i[5]*i[3]*i[14]+i[13]*i[2]*i[7]-i[13]*i[3]*i[6],s[3]=-i[1]*i[6]*i[11]+i[1]*i[7]*i[10]+i[5]*i[2]*i[11]-i[5]*i[3]*i[10]-i[9]*i[2]*i[7]+i[9]*i[3]*i[6],s[4]=-i[4]*i[10]*i[15]+i[4]*i[11]*i[14]+i[8]*i[6]*i[15]-i[8]*i[7]*i[14]-i[12]*i[6]*i[11]+i[12]*i[7]*i[10],s[5]=i[0]*i[10]*i[15]-i[0]*i[11]*i[14]-i[8]*i[2]*i[15]+i[8]*i[3]*i[14]+i[12]*i[2]*i[11]-i[12]*i[3]*i[10],s[6]=-i[0]*i[6]*i[15]+i[0]*i[7]*i[14]+i[4]*i[2]*i[15]-i[4]*i[3]*i[14]-i[12]*i[2]*i[7]+i[12]*i[3]*i[6],s[7]=i[0]*i[6]*i[11]-i[0]*i[7]*i[10]-i[4]*i[2]*i[11]+i[4]*i[3]*i[10]+i[8]*i[2]*i[7]-i[8]*i[3]*i[6],s[8]=i[4]*i[9]*i[15]-i[4]*i[11]*i[13]-i[8]*i[5]*i[15]+i[8]*i[7]*i[13]+i[12]*i[5]*i[11]-i[12]*i[7]*i[9],s[9]=-i[0]*i[9]*i[15]+i[0]*i[11]*i[13]+i[8]*i[1]*i[15]-i[8]*i[3]*i[13]-i[12]*i[1]*i[11]+i[12]*i[3]*i[9],s[10]=i[0]*i[5]*i[15]-i[0]*i[7]*i[13]-i[4]*i[1]*i[15]+i[4]*i[3]*i[13]+i[12]*i[1]*i[7]-i[12]*i[3]*i[5],s[11]=-i[0]*i[5]*i[11]+i[0]*i[7]*i[9]+i[4]*i[1]*i[11]-i[4]*i[3]*i[9]-i[8]*i[1]*i[7]+i[8]*i[3]*i[5],s[12]=-i[4]*i[9]*i[14]+i[4]*i[10]*i[13]+i[8]*i[5]*i[14]-i[8]*i[6]*i[13]-i[12]*i[5]*i[10]+i[12]*i[6]*i[9],s[13]=i[0]*i[9]*i[14]-i[0]*i[10]*i[13]-i[8]*i[1]*i[14]+i[8]*i[2]*i[13]+i[12]*i[1]*i[10]-i[12]*i[2]*i[9],s[14]=-i[0]*i[5]*i[14]+i[0]*i[6]*i[13]+i[4]*i[1]*i[14]-i[4]*i[2]*i[13]-i[12]*i[1]*i[6]+i[12]*i[2]*i[5],s[15]=i[0]*i[5]*i[10]-i[0]*i[6]*i[9]-i[4]*i[1]*i[10]+i[4]*i[2]*i[9]+i[8]*i[1]*i[6]-i[8]*i[2]*i[5],a=i[0]*s[0]+i[1]*s[4]+i[2]*s[8]+i[3]*s[12],0===a)return this;for(a=1/a,e=0;e<16;e++)r[e]=s[e]*a;return this}invert(){return this.setInverseOf(this),this}setOrtho(t,e,i,r,s,n){let l,c,h;return t!==e&&i!==r&&s!==n||a.h2("null frustum",o,240),l=1/(e-t),c=1/(r-i),h=1/(n-s),this.set([2*l,0,0,0,0,2*c,0,0,0,0,-2*h,0,-(e+t)*l,-(r+i)*c,-(n+s)*h,1]),this}ortho(t,e,i,r,s,a){return this.multiply((new c).setOrtho(t,e,i,r,s,a))}setFrustum(t,e,i,r,s,n){let l,c,h;return t!==e&&i!==r&&s!==n||a.z3("null frustum",o,281),s<=0&&a.h2("near <= 0",o,284),n<=0&&a.h2("far <= 0",o,287),l=1/(e-t),c=1/(r-i),h=1/(n-s),this.set([2*s*l,0,0,0,0,2*s*c,0,0,(e+t)*l,(r+i)*c,-(n+s)*h,-1,0,0,-2*s*n*h,0]),this}frustum(t,e,i,r,s,a){return this.multiply((new c).setOrtho(t,e,i,r,s,a))}setPerspective(t,e,i,r){let s,n,l;return i!==r&&0!==e||a.h2("null frustum",o,328),i<=0&&a.h2("near <= 0",o,331),r<=0&&a.h2("far <= 0",o,334),t=Math.PI*t/180/2,n=Math.sin(t),0===n&&a.h2("null frustum",o,342),s=1/(r-i),l=Math.cos(t)/n,this.set([l/e,0,0,0,0,l,0,0,0,0,-(r+i)*s,-1,0,0,-2*i*r*s,0]),this}perspective(t,e,i,r){return this.multiply((new c).setPerspective(t,e,i,r))}setScale(t){return this.set([t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1]),this}scale(t){let e=this.element;return e[0]*=t.x,e[1]*=t.x,e[2]*=t.x,e[3]*=t.x,e[4]*=t.y,e[5]*=t.y,e[6]*=t.y,e[7]*=t.y,e[8]*=t.z,e[9]*=t.z,e[10]*=t.z,e[11]*=t.z,this}setTranslate(t){return this.set([1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1]),this}preTranslate(t){let e=this.element;return e[12]+=e[0]*t.x+e[4]*t.y+e[8]*t.z,e[13]+=e[1]*t.x+e[5]*t.y+e[9]*t.z,e[14]+=e[2]*t.x+e[6]*t.y+e[10]*t.z,e[15]+=e[3]*t.x+e[7]*t.y+e[11]*t.z,this}postTranslate(t){let e=this.element;return e[0]+=t.x*e[3],e[1]+=t.y*e[3],e[2]+=t.z*e[3],e[4]+=t.x*e[7],e[5]+=t.y*e[7],e[6]+=t.z*e[7],e[8]+=t.x*e[11],e[9]+=t.y*e[11],e[10]+=t.z*e[11],e[12]+=t.x*e[15],e[13]+=t.y*e[15],e[14]+=t.z*e[15],this}setRotate(t,e){let i,r,s,a,n,o,l,c,h,d,u,f,p,m;return t=Math.PI*t/180,i=e.x,r=e.y,s=e.z,a=Math.sin(t),n=Math.cos(t),0!==e.x&&0===e.y&&0===e.z?(e.x<0&&(a=-a),this.set([1,0,0,0,0,n,-a,0,0,a,n,0,0,0,0,1])):0===e.x&&0!==e.y&&0===e.z?(e.y<0&&(a=-a),this.set([n,0,a,0,0,1,0,0,-a,0,n,0,0,0,0,1])):0===e.x&&0===e.y&&0!==e.z?(e.z<0&&(a=-a),this.set([n,-a,0,0,a,n,0,0,0,0,1,0,0,0,0,1])):(o=e.magnitude,1!==o&&(l=1/o,i*=l,r*=l,s*=l),c=1-n,h=i*r,d=r*s,u=s*i,f=i*a,p=r*a,m=s*a,this.set([i*i*c+n,h*c+m,u*c-p,0,h*c-m,r*r*c+n,d*c+f,0,u*c+p,d*c-f,s*s*c+n,0,0,0,0,1])),this}rotate(t,e){return this.multiply((new c).setRotate(t,e)),this}setLookAt(t,e,i){let r,s,a,o,l,c,h,d,u,f,p;return r=e.x-t.x,s=e.y-t.y,a=e.z-t.z,o=1/Math.sqrt(r*r+s*s+a*a),r*=o,s*=o,a*=o,l=s*i.z-a*i.y,c=a*i.x-r*i.z,h=r*i.y-s*i.x,d=1/Math.sqrt(l*l+c*c+h*h),l*=d,c*=d,h*=d,u=c*a-h*s,f=h*r-l*a,p=l*s-c*r,this.set([l,u,-r,0,c,f,-s,0,h,p,-a,0,0,0,0,1]),this.preTranslate(new n.P([-t.x,-t.y,-t.z]))}lookAt(t,e,i){return this.multiply((new c).setLookAt(t,e,i))}toArray(){let t=[];for(let e=0;e<16;e++)t[e]=this.element[e];return t}copy(){return(new c).set(this.toArray())}}},1064:(t,e,i)=>{"use strict";i.d(e,{I:()=>a,P:()=>s});var r=i(134);class s{constructor(t){(0,r.A)(this,"element",void 0),this.element=new Float32Array(3),t&&(this.element[0]=t[0],this.element[1]=t[1],this.element[2]=t[2])}normalize(){let t=this.x,e=this.y,i=this.z,r=this.magnitude;return r?(1===r||(r=1/r,this.x=t*r,this.y=e*r,this.z=i*r),this):(this.x=this.y=this.z=0,this)}toArray(){return[this.x,this.y,this.z]}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}get sqrMagnitude(){return this.x*this.x+this.y*this.y+this.z*this.z}get x(){return this.element[0]}set x(t){this.element[0]=t}get y(){return this.element[1]}set y(t){this.element[1]=t}get z(){return this.element[2]}set z(t){this.element[2]=t}}class a{constructor(t){(0,r.A)(this,"element",void 0),this.element=new Float32Array(4),t&&(this.element[0]=t[0],this.element[1]=t[1],this.element[2]=t[2],this.element[4]=t[3])}}},31658:(t,e,i)=>{"use strict";function r(t,e){for(;0!==e;)[t,e]=[e,t%e];return t}i.d(e,{A:()=>r})},66551:(t,e,i)=>{"use strict";i.d(e,{B:()=>s});var r=i(45726);function s(t,e){const i=new r.A([0,0,0,0,0,0,0,0,0]);for(let r=0;r<3;r++)for(let s=0;s<3;s++){let a=t.rc(r,0)*e.rc(0,s)+t.rc(r,1)*e.rc(1,s)+t.rc(r,2)*e.rc(2,s);i.setRC(r,s,a)}return i}},60153:(t,e,i)=>{"use strict";i.d(e,{Y3:()=>s});var r=i(1064);function s(t,e){const i=new r.P([0,0,0]);for(let r=0;r<3;r++)i.element[r]=t.rc(r,0)*e.x+t.rc(r,1)*e.y+t.rc(r,2)*e.z;return i}},42577:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134);class s extends EventTarget{constructor(...t){super(...t),(0,r.A)(this,"peer",void 0),(0,r.A)(this,"onmessage",void 0),(0,r.A)(this,"onmessageerror",void 0)}postMessage(t,e){var i;null!==(i=this.peer)&&void 0!==i&&i.onmessage&&this.peer.onmessage({data:t})}close(){this.peer=null}start(){}}class a{constructor(){(0,r.A)(this,"port1",void 0),(0,r.A)(this,"port2",void 0),this.port1=new s,this.port2=new s,this.port1.peer=this.port2,this.port2.peer=this.port1}}},84149:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>u,S3:()=>d,Wo:()=>h});var r=i(134),s=i(80662),a=i.n(s),n=i(54001),o=i.n(n),l=i(96172),c=i(34677);const h="notify",d="request";class u extends l.A{constructor(t){super(!0),(0,r.A)(this,"port",void 0),(0,r.A)(this,"requestMap",void 0),(0,r.A)(this,"seq",void 0),(0,r.A)(this,"closed",void 0),this.port=t,this.port.onmessage=this.handle.bind(this),this.seq=0,this.requestMap=new(a()),this.port.start(),this.closed=!1}handle(t){const e=t.data,i=e.type,r=e.data;if("notify"===i)this.fire(h,r);else if("reply"===i){const t=this.requestMap.get(r.seq);t&&((0,c.A)(r.result)?t.resolve(r.result):r.error?t.reject(r.error):t.resolve(void 0),this.requestMap.delete(r.seq))}else"request"===i&&this.fire(d,r)}notify(t,e={},i=[]){this.port.postMessage({type:"notify",data:{method:t,params:e}},i)}async request(t,e={},i=[]){return new(o())(((r,s)=>{const a=this.seq++;this.requestMap.set(a,{resolve:r,reject:s}),this.port.postMessage({type:"request",data:{seq:a,method:t,params:e}},i)}))}reply(t,e,i,r=[]){const s={seq:t.seq};(0,c.A)(e)?s.result=e:i&&(s.error=i),null!=r&&r.length?this.port.postMessage({type:"reply",data:s},r):this.port.postMessage({type:"reply",data:s})}getPort(){return this.port}destroy(){this.requestMap.size&&(this.requestMap.forEach((t=>{t.reject("ipc port close")})),this.requestMap.clear()),this.port&&(this.port.close(),this.port=null),this.closed=!0}}},6253:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var r=i(134),s=i(39638),a=i(86932),n=i(47222),o=i(78995);let l,c=0;function h(){return l?(c++,l):(l=new n.A,c=1,l)}function d(){0!==c&&(c--,0===c&&(l.destroy(),l=null))}class u{constructor(t,e=!0){(0,r.A)(this,"messageChannel",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"started",void 0),(0,r.A)(this,"timer",void 0),(0,r.A)(this,"workerTimer",void 0),(0,r.A)(this,"workerSetTimeout",void 0),(0,r.A)(this,"onClock",void 0),(0,r.A)(this,"nextTick",void 0),(0,r.A)(this,"a",void 0),(0,r.A)(this,"b",void 0),(0,r.A)(this,"beta",void 0),(0,r.A)(this,"alpha",void 0),(0,r.A)(this,"count",void 0),(0,r.A)(this,"equivalent",void 0),(0,r.A)(this,"timestamp",void 0),(0,r.A)(this,"onVisibilityChange",void 0),(0,r.A)(this,"timeoutNext",void 0),(0,r.A)(this,"running",void 0),(0,r.A)(this,"highPerformance",void 0),this.started=!1,this.interval=t,this.highPerformance=e,this.a=.2,this.b=4,this.equivalent=50,this.timestamp=0,this.nextTick=()=>{if(this.started&&!this.running)if(this.running=!0,this.interval>=4||!this.highPerformance)this.timeoutTick();else if(this.interval<=0)this.messageChannel.port1.postMessage(null);else{const t=(0,a.A)();t-this.timestamp>this.equivalent&&(this.count=0,this.timestamp=t),this.count<this.beta?this.messageChannel.port1.postMessage(null):this.timeoutTick()}},this.compute(),this.messageChannel=new MessageChannel,this.handleEvent(),this.timeoutNext=t=>{t?this.workerTimer=null:this.timer=null,this.running=!1,this.count++,this.onClock?this.onClock(this.nextTick):this.nextTick()},(0,s.A)()||"hidden"!==document.visibilityState||(this.workerSetTimeout=h()),this.running=!1}compute(t=!0){this.interval>0&&(this.beta=Math.ceil(this.equivalent*(1-this.b/this.interval)/(this.a-this.b)),this.alpha=Math.floor(this.equivalent/this.interval-this.beta),t&&(this.count=0))}timeoutTick(){this.workerSetTimeout&&"hidden"===document.visibilityState&&this.interval<1e3?this.workerTimer=this.workerSetTimeout.setTimeout(this.timeoutNext,this.interval):this.timer=setTimeout(this.timeoutNext,this.interval)}start(){this.started||(this.started=!0,this.timestamp=(0,a.A)(),this.nextTick())}stop(){this.started=!1,this.timer&&(clearTimeout(this.timer),this.timer=null),this.workerTimer&&this.workerSetTimeout&&this.workerSetTimeout.clearTimeout(this.workerTimer),this.running=!1}isStarted(){return this.started}setInterval(t){this.interval=Math.max(t,0),this.compute()}getInterval(){return this.interval}isZeroTimeout(){return this.interval<4}destroy(){this.stop(),this.workerSetTimeout&&(d(),this.workerSetTimeout=null),this.onVisibilityChange&&(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.onVisibilityChange=null)}handleEvent(){this.messageChannel.port2.onmessage=()=>{this.started&&(this.running=!1,this.count++,this.onClock?this.onClock(this.nextTick):this.nextTick())},(0,s.A)()||(this.onVisibilityChange=(0,o.A)((t=>{"hidden"===document.visibilityState?(this.workerSetTimeout=h(),this.timer&&(clearTimeout(this.timer),this.timer=null,this.running=!1),this.nextTick()):(this.workerTimer&&(this.workerSetTimeout.clearTimeout(this.workerTimer),this.workerTimer=null,this.running=!1),this.timer&&(clearTimeout(this.timer),this.timer=null,this.running=!1),d(),this.workerSetTimeout=null,this.nextTick())}),20),document.addEventListener("visibilitychange",this.onVisibilityChange))}}},39148:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(134),s=i(54001),a=i.n(s),n=i(6253),o=i(86932);class l{constructor(t,e=0,i=0,s=!0,a=!0){(0,r.A)(this,"task",void 0),(0,r.A)(this,"count",void 0),(0,r.A)(this,"emptyCount",void 0),(0,r.A)(this,"started",void 0),(0,r.A)(this,"clock",void 0),(0,r.A)(this,"timestamp",void 0),(0,r.A)(this,"timeout",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"startTimer",void 0),(0,r.A)(this,"autoInterval",void 0),(0,r.A)(this,"sync",void 0),(0,r.A)(this,"tickAfter",void 0),(0,r.A)(this,"processing",void 0),this.task=t,this.timeout=e,this.interval=i,this.autoInterval=s,this.sync=a,this.count=0,this.emptyCount=0,this.timestamp=0,this.started=!1,this.processing=!1,this.clock=new n.A(this.interval),this.clock.onClock=t=>{if(this.started)if(this.count++,this.sync)this.tickAfter&&(this.tickAfter(),this.tickAfter=null),!1===this.task()?this.stop():this.next(t);else{if(this.processing)return;this.processing=!0,this.task().then((e=>{this.processing=!1,this.tickAfter&&(this.tickAfter(),this.tickAfter=null),!1===e?this.stop():this.next(t)}))}}}next(t){if(!this.started)return;const e=(0,o.A)();if(this.autoInterval&&e-this.timestamp>50){const t=this.emptyCount/this.count;0===this.emptyCount?this.clock.setInterval(Math.max(this.clock.getInterval()>>1,this.interval)):t<.1?this.clock.setInterval(this.clock.getInterval()-1):t>.2?this.clock.setInterval(Math.min(this.clock.getInterval()+1,20)):t>.5&&this.clock.setInterval(this.clock.getInterval()<<1),this.count=0,this.emptyCount=0,this.timestamp=e}t()}start(){this.started=!0,this.timeout?this.startTimer=setTimeout((()=>{this.count=0,this.emptyCount=0,this.timestamp=(0,o.A)(),this.clock.start(),this.startTimer=null}),this.timeout):(this.count=0,this.emptyCount=0,this.timestamp=(0,o.A)(),this.clock.start())}stop(){this.started=!1,this.processing=!1,this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null),this.clock.stop()}async stopBeforeNextTick(){if(this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null),this.clock.isStarted())return this.sync?(this.started=!1,this.processing=!1,void this.clock.stop()):new(a())((t=>{this.tickAfter=()=>{this.started=!1,this.processing=!1,this.clock.stop(),t()}}))}isStarted(){return this.started}emptyTask(){this.emptyCount++}isZeroTimeout(){var t;return null===(t=this.clock)||void 0===t?void 0:t.isZeroTimeout()}restart(){this.clock&&(this.stop(),this.clock.setInterval(this.interval),this.start())}resetInterval(){this.clock.setInterval(Math.max(this.clock.getInterval()>>1,this.interval)),this.emptyCount=0,this.count=0,this.timestamp=(0,o.A)()}destroy(){this.stop(),this.task=null,this.timeout=null,this.interval=null}}},13724:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(134),s=i(45249),a=i.n(s);class n{constructor(t){(0,r.A)(this,"timeout",void 0),(0,r.A)(this,"timer",void 0),(0,r.A)(this,"resolve",void 0),(0,r.A)(this,"reject",void 0),(0,r.A)(this,"startTime",void 0),this.timeout=t}then(t,e){this.resolve=t,this.reject=e,this.startTime=a()(),this.timer=setTimeout((()=>{this.resolve(a()()-this.startTime),this.timer=null}),1e3*this.timeout)}stop(t=!0){this.timer&&(clearTimeout(this.timer),this.timer=null,this.resolve&&t?this.resolve(a()()-this.startTime):this.reject&&!t&&this.reject(a()()-this.startTime))}reset(t){t&&(this.timeout=t),this.timer&&(clearTimeout(this.timer),this.timer=setTimeout((()=>{this.resolve(a()()-this.startTime),this.timer=null}),1e3*this.timeout))}}},54058:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(134);class s{constructor(t,e,i){(0,r.A)(this,"task",void 0),(0,r.A)(this,"timeout",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"timer",void 0),this.task=t,this.timeout=e,this.interval=i}start(){const t=this;t.stop();let e=t.timeout;const i=t.interval,r=function(){!1!==t.task()&&t.timer?t.timer=setTimeout(r,t.interval):t.stop()};null==e&&(e=i),t.timer=setTimeout(r,e)}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null)}updateInterval(t){this.interval=t}isStarted(){return!!this.timer}destroy(){this.stop(),this.task=this.timeout=this.interval=null}}},47222:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(134),s=i(80662),a=i.n(s),n=i(61837);i(7903);class o{constructor(){(0,r.A)(this,"worker",void 0),(0,r.A)(this,"workerUrl",void 0),(0,r.A)(this,"taskMap",void 0),(0,r.A)(this,"id",void 0),this.id=0,this.taskMap=new(a());const t=`\n      ${(0,n.A)(7903,{varName:"workerSetTimeoutTask"})}\n      workerSetTimeoutTask.default(self)\n    `,e=new Blob([t],{type:"text/javascript"});this.workerUrl=URL.createObjectURL(e),this.worker=new Worker(this.workerUrl),this.worker.addEventListener("message",(t=>{const e=t.data,i=e.type,r=e.id;if("pong"===i){const t=this.taskMap.get(r);t&&t(!0)}}))}setTimeout(t,e=0){const i=this.id++;return this.taskMap.set(i,t),this.worker.postMessage({type:"ping",data:{timeout:e,id:i}}),i}clearTimeout(t){this.taskMap.delete(t)}destroy(){this.worker&&(this.worker.terminate(),this.worker=null),this.workerUrl&&(URL.revokeObjectURL(this.workerUrl),this.workerUrl=null),this.taskMap&&(this.taskMap.clear(),this.taskMap=null)}}},38724:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(6253);class a{constructor(t,e,i){(0,r.A)(this,"task",void 0),(0,r.A)(this,"timeout",void 0),(0,r.A)(this,"interval",void 0),(0,r.A)(this,"clock",void 0),(0,r.A)(this,"started",void 0),(0,r.A)(this,"timer",void 0),this.task=t,this.timeout=e,this.interval=i,this.started=!1,this.clock=new s.A(this.interval,!1),this.clock.onClock=t=>{this.started&&!1===this.task()?this.stop():t()}}start(){this.started=!0,this.timeout>0?this.timer=setTimeout((()=>{this.timer=null,this.clock.start()}),this.timeout):this.clock.start()}stop(){this.started=!1,this.clock.stop(),this.timer&&(clearTimeout(this.timer),this.timer=null)}isStarted(){return this.started}updateInterval(t){this.interval=t,this.clock.setInterval(t)}destroy(){this.clock&&(this.stop(),this.clock.destroy(),this.clock=null),this.started=!1,this.task=this.timeout=this.interval=null}}},7903:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var r=i(134),s=i(4624),a="src/common/timer/workerSetTimeoutTask.ts";class n{constructor(t){(0,r.A)(this,"worker",void 0),this.worker=t,this.handleEvents()}handleEvents(){this.worker.addEventListener("message",(t=>{var e;let i=t.data.data;setTimeout((()=>{this.worker.postMessage({type:"pong",id:i.id})}),Math.max(null!==(e=i.timeout)&&void 0!==e?e:0,4))}))}}function o(t){try{new n(t)}catch(t){s.z3("new WorkerSetTimeout failed",a,32)}}},72739:(t,e,i)=>{"use strict";i.d(e,{$r:()=>u,El:()=>f,TF:()=>h,VC:()=>l,_:()=>p,__:()=>n,qh:()=>c,zy:()=>d});var r=i(67672),s=i(10576),a=i(56401);function n(t,e,i){if(!t)return;const{length:r}=t;if(r)if(i)for(let i=r-1;i>=0&&e(t[i],i)!==s.W8;i--);else for(let i=0;i<r&&e(t[i],i)!==s.W8;i++);}function o(t,e){t[t.length]=e}function l(t,e){!function(t,e,i){r.YO(e)?n(e,(function(e){i(t,e)})):i(t,e)}(t,e,o)}function c(t,e,i){let r=s.Cy;return n(t,(function(t,a){if(i===s.W8?t==e:t===e)return r=a,s.W8})),r}function h(t,e,i){let r=0;return n(t,(function(a,n){(i===s.W8?a==e:a===e)&&(t.splice(n,1),r++)}),s.rT),r}function d(t,e,i){return c(t,e,i)>=0}function u(t){return r.YO(t)?t:(0,a.A)(s.Ml.slice,t)}function f(t,e){let i=0,r=t.length-1,s=-1;for(;i<=r;){let a=(i+r)/2>>>0;const n=e(t[a]);if(0===n){s=a;break}1===n?i=a+1:(r=a-1,s=a)}return s}function p(t,e,i){const r=f(t,i);r>-1?t.splice(r,0,e):t.push(e)}},90932:(t,e,i)=>{"use strict";i.d(e,{l:()=>s});const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";function s(t,e=!0){const i=t.length;let s=0,a=0,n="";for(let e=0;e<i;e++)for(a=a<<8|t[e],s+=8;s>=5;)n+=r[a>>>s-5&31],s-=5;if(s>0&&(n+=r[a<<5-s&31]),e)for(;n.length%8!=0;)n+="=";return n}},4919:(t,e,i)=>{"use strict";i.d(e,{E_:()=>a});var r=i(72739);const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function a(t){const e="function"==typeof atob?atob(t):function(t){function e(t){const e=s.indexOf(t);return-1===e?0:e}let i="";for(let r=0;r<t.length;){const s=e(t[r++]),a=e(t[r++]),n=e(t[r++]),o=e(t[r++]),l=s<<2|a>>4,c=(15&a)<<4|n>>2,h=(3&n)<<6|o;i+=String.fromCharCode(l),64!==n&&(i+=String.fromCharCode(c)),64!==o&&(i+=String.fromCharCode(h))}return i}(t),i=new Uint8Array(e.length);for(let t=0;t<e.length;t++)i[t]=e.charCodeAt(t);return i}const n={};r.__(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],((t,e)=>{n[t]=e}))},43607:(t,e,i)=>{"use strict";function r(t){return t>0?t:-t}function s(t,e){return t>e?t:e}function a(t,e){return t>e?e:t}i.d(e,{T9:()=>s,jk:()=>a,tn:()=>r})},86834:(t,e,i)=>{"use strict";i.d(e,{A:()=>f});var r=i(29967),s=i.n(r),a=i(72739),n=i(67672),o=i(84504);function l(t){return n.Yj(t)&&t.split(".").shift()||""}const c=[["alipay",/alipay/],["wechat",/micromessenger/],["dingtalk",/dingtalk[ \/]([\d_.]+)/],["baiduApp",/baiduboxapp/],["baidu",/baidubrowser/],["baidu",/bdbrowser/],["uc",/ucbrowser/],["uc",/ucweb/],["qq",/qqbrowser/],["qqApp",/qq/],["ie",/iemobile[ \/]([\d_.]+)/],["ie",/msie[ \/]([\d_.]+)/],["ie",/trident[ \/]([\d_.]+)/,4],["edge",/edge[ \/]([\d_.]+)/],["newEdge",/edg[ \/]([\d_.]+)/],["chrome",/chrome[ \/]([\d_.]+)/],["firefox",/firefox[ \/]([\d_.]+)/],["opera",/opera(?:.*version)?[ \/]([\d_.]+)/],["safari",/version[ \/]([\d_.]+) safari/],["safari",/version[ \/]([\d_.]+) \S* safari/],["safari",/safari/]],h={},d={},u=function(t){let e,i;return(0,a.__)(c,(r=>{let a=r[1].exec(t);if(a)return e=r[0],i=a[1],i&&(i=i.replace(/_/g,"."),r[2]&&(i=s()(i,10)+r[2]+".0")),!1})),{name:e||"",version:i||"",majorVersion:(h[e]||l)(i),checkVersion:d[e]||o.A}}(("object"==typeof navigator&&navigator.userAgent||"").toLowerCase());u.name&&(u[u.name]=!0);const f=u},10576:(t,e,i)=>{"use strict";i.d(e,{Cq:()=>o,Cy:()=>c,M_:()=>p,Ml:()=>v,TK:()=>m,W8:()=>n,ZG:()=>u,ZH:()=>l,aV:()=>h,jf:()=>f,rT:()=>a,s0:()=>d,u1:()=>y,x7:()=>g});var r=i(7403),s=i.n(r);const a=!0,n=!1,o=null,l=void 0,c=-1,h="undefined",d="function",u=".",f=typeof window!==h?window:l,p=(typeof document!==h&&document,typeof globalThis!==h?globalThis:typeof i.g!==h?i.g:f),m=typeof self!==h?self:p,g=function(){},v=(s()({}),s()([])),y=""},67672:(t,e,i)=>{"use strict";i.d(e,{Ik:()=>h,Pc:()=>l,YO:()=>c,Yj:()=>d,ai:()=>u,o:()=>f,sH:()=>m,sv:()=>g,zM:()=>p});var r=i(68632),s=i.n(r),a=i(88032),n=i.n(a),o=i(10576);function l(t){return typeof t===o.s0}function c(t){return s()(t)}function h(t){return t!==o.Cq&&"object"==typeof t}function d(t){return"string"==typeof t}function u(t){return"number"==typeof t&&!isNaN(t)}function f(t){return"bigint"==typeof t}function p(t){return"boolean"==typeof t}function m(t){return u(t)||d(t)&&!isNaN(n()(t))&&isFinite(+t)}function g(t){return t instanceof ArrayBuffer}},80198:(t,e,i)=>{"use strict";i.d(e,{ZV:()=>n,ay:()=>a,wb:()=>s});var r=i(95335);const s={a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,"`":192,"+":187,"-":189,"=":61,"[":219,"]":221,"\\":220,";":59,"'":222,",":188,".":190,"/":191,$0:96,$1:97,$2:98,$3:99,$4:100,$5:101,$6:102,$7:103,$8:104,$9:105,"$.":110,"$+":107,"$-":109,"$*":106,"$/":111,space:32,tab:9},a={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,enter:13,esc:27,capslock:20,insert:45,home:36,end:35,pageup:33,pagedown:34,left:37,right:39,up:38,down:40},n={shift:16,ctrl:17,meta:91,alt:18};(0,r.BE)(s),(0,r.BE)({backspace:8,delete:46}),(0,r.BE)(a),(0,r.BE)(n)},10534:(t,e,i)=>{"use strict";i.d(e,{__:()=>a});var r=i(10576);const s={};function a(t,e){const i=s.hasOwnProperty(t)?s[t]:s[t]=t.split(r.ZG);for(let t=0,s=i.length-1;t<=s&&e(i[t],t===s)!==r.W8;t++);}},4624:(t,e,i)=>{"use strict";i.d(e,{R8:()=>b,V$:()=>g,Yz:()=>y,h2:()=>w,pq:()=>A,rD:()=>o,z3:()=>x});var r=i(10576),s=i(62100);const a=0,n=1,o=2,l=3,c=4,h=5,d=typeof console!==r.aV?console:r.Cq,u=/common/.test((0,s.A)(r.x7))?o:l,f=(r.jf&&/edge|msie|trident/i.test(r.jf.navigator.userAgent),r.u1),p=d?f?function(t,e,i){d.log(f+t,i,e)}:function(t,e){d.log(t,e)}:r.x7;function m(){if(r.M_){const t=r.TK.COMMON_LOG_LEVEL;if(t>=a&&t<=h)return t}return u}function g(t){r.TK.COMMON_LOG_LEVEL=t}function v(t){return`background-color:${t};border-radius:12px;color:#fff;font-size:10px;padding:3px 6px;`}function y(t,e,i){m()<=n&&p(`[${arguments[1]}][line ${arguments[2]}] [debug]`,t,v("#999"))}function A(t,e,i){m()<=o&&p(`[${arguments[1]}][line ${arguments[2]}] [info]`,t,v("#2db7f5"))}function b(t,e,i){m()<=l&&p(`[${arguments[1]}][line ${arguments[2]}] [warn]`,t,v("#f90"))}function x(t,e,i){m()<=c&&p(`[${arguments[1]}][line ${arguments[2]}] [error]`,t,v("#ed4014"))}function w(t,e,i){if(m()<=h)throw x(t,e,i),new Error(`[${arguments[1]}][line ${arguments[2]}] [fatal]: ${t}`)}},95335:(t,e,i)=>{"use strict";i.d(e,{BE:()=>p,C:()=>f,HP:()=>c,X$:()=>u,__:()=>h});var r=i(69736),s=i.n(r),a=i(67672),n=i(72739),o=i(10576),l=i(34677);function c(t){return(0,l.A)(t)?s()(t):[]}function h(t,e){for(let i in t)if(e(t[i],i)===o.W8)break}function d(t,e){return a.Ik(t)?a.Ik(e)?(h(e,(function(e,i){t[i]=e})),t):t:e}function u(t,e,i){return d(d(t,e),i)}function f(t,e){let i=t;return a.YO(t)?e?(i=[],n.__(t,(function(t,r){i[r]=f(t,e)}))):i=t.slice():a.Ik(t)&&(i={},h(t,(function(t,r){i[r]=e?f(t,e):t}))),i}function p(t){const e={};return h(t,((t,i)=>{e[t]=i})),e}},44690:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});var r=i(72739);const s=[["iphone",/iphone os ([\d_.]+)/],["ipad",/ipad; cpu os ([\d_.]+)/],["itouch",/itouch; cpu os ([\d_.]+)/],["android",/android ([\d_.]+)/],["wp",/windows phone ([\d_.]+)/],["windows",/windows nt ([\d_.]+)/],["linux",/linux/],["mac",/mac os x ([\d_.]+)/]],a=function(t){let e,i;return(0,r.__)(s,(r=>{let s=r[1].exec(t);if(s)return e=r[0],i=s[1],i&&(i=i.replace(/_/g,".")),!1})),{name:e||"",version:i||""}}(("object"==typeof navigator&&navigator.userAgent||"").toLowerCase());a.name&&(a[a.name]=!0,{iphone:1,ipad:1,itouch:1}[a.name]&&(a.ios=!0));const n=a},20525:(t,e,i)=>{"use strict";i.d(e,{GP:()=>d,di:()=>l,qh:()=>c,zy:()=>h});var r=i(29967),s=i.n(r),a=i(67672),n=i(10576),o=i(62100);function l(t,e,i){return a.ai(i)?e===i?n.u1:t.slice(e,i):t.slice(e)}function c(t,e,i){return t.indexOf(e,i!==n.ZH?i:0)}function h(t,e){return c(t,e)>=0}function d(t,...e){let i=0;const r=e.length;return t.replace(/(%[sdvx%])|(%0(\d)+[dx])/g,(t=>{if(i>=r)return t;const a=e[i++];if(/%0(\d)+[dx]/g.test(t)){const e=s()(t.substring(1));let i="d"===t[t.length-1]?(0,o.A)(Number(a)):Number(a).toString(16);return e>i.length&&(i=new Array(e-i.length).fill("0").join("")+i),i}switch(t){case"%%":return"%";case"%s":return String(a);case"%d":return(0,o.A)(Number(a));case"%v":return"";case"%x":return Number(a).toString(16)}return t}))}},95797:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(20149),s=i.n(r),a=i(39638),n=i(86834);const o=function(){let t="function"==typeof Blob,e="object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate,i="function"==typeof fetch,r="object"==typeof document&&document.createElement("canvas"),o=r&&!!r.getContext("webgl"),l="function"==typeof OffscreenCanvas,c="function"==typeof Worker,h="function"==typeof ArrayBuffer,d="object"==typeof Atomics&&"Atomics"===Atomics[s()],u="function"==typeof AudioContext||"function"==typeof webkitAudioContext,f="function"==typeof AudioWorklet,p="function"==typeof VideoDecoder,m="function"==typeof VideoEncoder,g="function"==typeof AudioDecoder,v="function"==typeof AudioEncoder,y="function"==typeof SharedArrayBuffer,A="function"==typeof MediaSource||"function"==typeof ManagedMediaSource,b="function"==typeof Proxy,x=(c||(0,a.A)())&&y&&d&&b,w="function"==typeof WebAssembly.Suspending&&"function"==typeof WebAssembly.promising;n.A.safari&&!n.A.checkVersion(n.A.majorVersion,"11",!0)&&(e=!1),n.A.chrome&&!n.A.checkVersion(n.A.majorVersion,"94",!0)&&(p=!1,g=!1),n.A.safari&&!n.A.checkVersion(n.A.majorVersion,"17",!0)&&(p=!1);let k="object"==typeof navigator&&"object"==typeof navigator.gpu,T="function"==typeof MediaSourceHandle,S=e&&"function"==typeof WebAssembly.Global;return{browser:n.A,blob:t,wasm:e,fetch:i,webgl:o,worker:c,mse:A,arrayBuffer:h,audioContext:u,audioWorklet:f,videoDecoder:p,videoEncoder:m,audioDecoder:g,audioEncoder:v,atomics:d,shareArrayBuffer:y,thread:x,webgpu:k,offscreenCanvas:l,workerMSE:T,webAssemblyGlobal:S,jspi:w,proxy:b,simd:(n.A.chrome||n.A.newEdge)&&n.A.checkVersion(n.A.majorVersion,"91",!0)||n.A.firefox&&n.A.checkVersion(n.A.majorVersion,"89",!0)||n.A.safari&&n.A.checkVersion(n.A.version,"16.4",!0),wasmBaseSupported:i&&e&&o&&u&&h&&S}}()},50011:(t,e,i)=>{"use strict";i.r(e),i.d(e,{decode:()=>n,encode:()=>a});const r="function"==typeof TextEncoder?new TextEncoder:null,s="function"==typeof TextDecoder?new TextDecoder:null;function a(t){if(r)return r.encode(t);const e=[];for(let i=0;i<t.length;++i){let r=t.charCodeAt(i);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&t.charCodeAt(++i)),r<=127?e.push(r):r<=2047?(e.push(192|r>>6),e.push(128|63&r)):r<=65535?(e.push(224|r>>12),e.push(128|r>>6&63),e.push(128|63&r)):(e.push(240|r>>18),e.push(128|r>>12&63),e.push(128|r>>6&63),e.push(128|63&r))}return new Uint8Array(e)}function n(t){if(t instanceof Uint8Array&&s&&!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))return s.decode(t);let e="";for(let i=0;i<t.length;){let r=t[i++>>>0];if(!(128&r)){e+=String.fromCharCode(r);continue}let s=63&t[i++>>>0];if(192==(224&r)){e+=String.fromCharCode((31&r)<<6|s);continue}let a=63&t[i++>>>0];if(r=224==(240&r)?(15&r)<<12|s<<6|a:(7&r)<<18|s<<12|a<<6|63&t[i++>>>0],r<65536)e+=String.fromCharCode(r);else{let t=r-65536;e+=String.fromCharCode(55296|t>>10,56320|1023&t)}}return e}},54825:(t,e,i)=>{"use strict";function r(t){if(!(t=t.trim()))return-BigInt(1);let e=t.split(":"),i=BigInt(0);return 3===e.length&&(i+=BigInt(+e.shift().trim())*BigInt(36e5)),i+=BigInt(+e.shift().trim())*BigInt(6e4),e=e.shift().trim().split("."),i+=BigInt(+e.shift().trim())*BigInt(1e3),i+=BigInt(+e.shift().trim()),i}function s(t){if(!(t=t.trim()))return-BigInt(1);let e=t.split(":"),i=BigInt(0);return 3===e.length&&(i+=BigInt(+e.shift().trim())*BigInt(36e5)),i+=BigInt(+e.shift().trim())*BigInt(6e4),e=e.shift().trim().split(","),i+=BigInt(+e.shift().trim())*BigInt(1e3),i+=BigInt(+e.shift().trim()),i}i.d(e,{j:()=>r,t:()=>s})},8507:(t,e,i)=>{"use strict";i.d(e,{ll:()=>m,mA:()=>n,qg:()=>o}),i(73146);var r=i(67672),s=i(6498),a=i(72739);function n(t,e="&"){const i={};if(r.Yj(t)&&t.indexOf("=")>=0){let r=t.charAt(0),n="?"===r||"#"===r?1:0;n>0&&(t=t.substr(n)),a.__((0,s.A)(t,e),(t=>{let e=t.split("=");if(2===e.length){var r;let t=null===(r=e[0])||void 0===r?void 0:r.trim();t&&(i[t]=decodeURIComponent(e[1]))}}))}return i}function o(t){const e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i={},r=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);let s=14;for(;s--;){var a;i[e[s]]=null!==(a=r[s])&&void 0!==a?a:""}return{protocol:i.protocol,file:i.file,host:i.host,port:i.port,user:i.user,password:i.password,origin:`${i.protocol}://${i.authority}`,pathname:i.path,search:`?${i.query}`,hash:i.anchor?`#${i.anchor}`:""}}const l=/(?:\/|^)\.(?=\/)/g,c=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,h=/^(?=([^\/?#]*))\1([^]*)$/,d=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/;function u(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}function f(t){const e=d.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null}function p(t){for(t=t.split("").reverse().join("").replace(l,"");t.length!==(t=t.replace(c,"")).length;);return t.split("").reverse().join("")}function m(t,e,i){if(i=i||{},t=t.trim(),!(e=e.trim())){if(!i.alwaysNormalize)return t;let e=f(t);if(!e)throw new Error("Error trying to parse base URL.");return e.path=p(e.path),u(e)}let r=f(e);if(!r)throw new Error("Error trying to parse relative URL.");if(r.scheme)return i.alwaysNormalize?(r.path=p(r.path),u(r)):e;let s=f(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){let t=h.exec(s.path);s.netLoc=t[1],s.path=t[2]}s.netLoc&&!s.path&&(s.path="/");const a={scheme:s.scheme,netLoc:r.netLoc,path:null,params:r.params,query:r.query,fragment:r.fragment};if(!r.netLoc&&(a.netLoc=s.netLoc,"/"!==r.path[0]))if(r.path){let t=s.path,e=t.substring(0,t.lastIndexOf("/")+1)+r.path;a.path=p(e)}else a.path=s.path,r.params||(a.params=s.params,r.query||(a.query=s.query));return null===a.path&&(a.path=i.alwaysNormalize?p(r.path):r.path),u(a)}},88096:(t,e,i)=>{"use strict";i.d(e,{$z:()=>c,DD:()=>h,Ee:()=>o,GG:()=>a,p7:()=>l});var r=i(31865);function s(t){let e=0,i=0;for(;;){const r=t.readUint8();if(e|=(127&r)<<i,i+=7,!(128&r))break}return e}async function a(t){let e=0,i=0;for(;;){const r=await t.readUint8();if(e|=(127&r)<<i,i+=7,!(128&r))break}return e}function n(t){let e,i=0,r=0;for(;e=t.readUint8(),i|=(127&e)<<r,r+=7,128&e;);return 64&e&&(i|=-1<<r),i}async function o(t){let e,i=0,r=0;for(;e=await t.readUint8(),i|=(127&e)<<r,r+=7,128&e;);return 64&e&&(i|=-1<<r),i}async function l(t,e){let i=!0;for(;i;){let r=127&e;0==(e>>=7)&&!(64&r)||-1===e&&64&r?i=!1:r|=128,await t.writeUint8(r)}}async function c(t,e){do{let i=127&e;0!=(e>>=7)&&(i|=128),await t.writeUint8(i)}while(0!==e)}function h(t,e){const i=new r.A(t,!0);for(i.skip(8);i.remainingSize();){const r=i.readUint8(),a=s(i);if(2===r){let r=s(i);for(;r--;){const r=s(i);i.skip(r);const a=s(i);switch(i.skip(a),i.readUint8()){case 0:s(i);break;case 3:n(i),s(i);break;case 2:{const r=Number(i.getPos());return void(t[r]=e?2|t[r]:-3&t[r])}case 1:{n(i);const t=s(i);s(i),1&t&&s(i);break}}}return}i.skip(a)}}},79331:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(68632),s=i.n(r),a=i(72739);const n={aloneValueName:"_@attribute"},o=[" ","/",'"',"'","<",">"];function l(t,e=n){t=(t=(t=(t=t.replace(/<!--[\s\S]*?-->/g,"")).replace(/[\n\t\r]/g,"")).replace(/>[ \t]+</g,"><")).replace(/<\?[^>]*\?>/g,"");const i=[];let r=0;function l(t,r){const a=i[i.length-1];a&&(t===e.aloneValueName||null==a.obj[e.aloneValueName]?null==a.obj[t]?a.obj[t]=r:s()(a.obj[t])?a.obj[t].push(r):a.obj[t]=[a.obj[t],r]:a.obj[e.aloneValueName]=[a.obj[e.aloneValueName],{tagName:t,...r}])}function c(e){for(;r<t.length;){if(t[r]===e)return!0;r++}return!1}function h(){d();let e="";for(;r<t.length&&!a.zy(o,t[r]);)e+=t[r],r++;return e}function d(){for(;r<t.length&&/\s|\r|\n/.test(t[r]);)r++}const u=/\s/,f=/'/,p=/"/;function m(){if(r>=t.length)return!0;d();let e=u;'"'!==t[r]&&"'"!=t[r]||(e='"'===t[r]?p:f,r++);let i="";for(;r<t.length;){if(e.test(t[r])){r++;break}i+=t[r],r++}return i}function g(){d();let e="";for(;r<t.length&&"<"!==t[r];)e+=t[r],r++;return e}function v(){for(;"<"===t[r];){const e=r;if(r++,d(),"/"!==t[r]){r=e;break}if(r++,h()===i[i.length-1].tag){if(i.length>1){const t=i.pop();l(t.tag,t.obj)}c(">"),r++,d()}else i.pop(),c(">"),r++,d()}}return function s(){if(r>=t.length)return;let a=r;if(d(),"<"!==t[r])return r=a,l(e.aloneValueName,g()),v(),s();let n=c("<");if(!n)return;a=r,r++;const o=h();if(i.push({obj:{},tag:o,start:a}),function(){for(;d(),">"!==t[r]&&"/"!==t[r];){let t=h();if(!t)break;"="===t[t.length-1]?t=t.substring(0,t.length-1):(c("="),r++),l(t,m())}}(),d(),"/"===t[r]){if(r++,i.length>1){const t=i.pop();l(t.tag,t.obj)}return c(">"),r++,v(),s()}n=c(">"),n&&(r++,d(),"<"!==t[r]&&(l(e.aloneValueName,g()),d()),v(),s())}(),{[i[0].tag]:i[0].obj}}},72631:(t,e,i)=>{"use strict";i.d(e,{default:()=>$});var r=i(134),s=i(63939),a=i(61634),n=i(47451),o=i.n(n),l=i(95335),c=i(28090),h=i(67672),d=i(72739),u=i(8507),f=i(23601),p=i(76793),m=i(92053),g=i(37463),v=i(13203),y=i(30019),A=i(7233),b=i(64147),x=i(40777),w=i(59715),k=i(86213),T=i(91011),S=i(14667),I=i(45553),P=i(30499),_=i(65893),E=i(53891),C=i(44341),M=i(83327),R=i.n(M),B=i(89739),D=i.n(B),U=i(6204),L=i(78995),N=i(93108),O=i(64804);const F={name:"AVPlayer",template:R(),propTypes:{player:{type:"object",required:!0},indicatorUrl:{type:"string"},pauseStateUrl:{type:"string"},errorStateUrl:{type:"string"},fullscreenDom:{type:"object"},hasFolder:{type:"boolean",value:!0},hasHeader:{type:"boolean",value:!0}},data:function(){const t=(0,U.A)(),e=[{name:t.MENU_STATS,action:0}];return{style:D(),title:"",error:"",showBar:!0,played:!1,folded:!1,loading:!1,language:t,streams:[],isLive:!1,menu:e,showMenu:!1,menuTop:0,menuLeft:0,showInfo:!1,showSettings:!1}},events:{error:function(t,e){console.log("error",e.message),this.set("error",e.message)},closeInfo:function(){this.set("showInfo",!1)},openSettings:function(){this.set("showSettings",!0)},closeSettings:function(){this.set("showSettings",!1)}},watchers:{played:function(t){t&&(this.showBarTimer&&clearTimeout(this.showBarTimer),this.get("folded")&&(this.showBarTimer=setTimeout((()=>{this.set("showBar",!1),this.showBarTimer=null}),5e3)))},folded:function(t){t&&(this.showBarTimer&&clearTimeout(this.showBarTimer),this.showBarTimer=setTimeout((()=>{this.set("showBar",!1),this.showBarTimer=null}),5e3))}},computed:{hasVideoTrack:function(){return this.get("streams").filter((t=>0===s.f[15](t.codecpar))).filter((t=>d.zy(a.K,s.f[15](t.codecpar+4)))).length>1},hasAudioTrack:function(){return this.get("streams").filter((t=>1===s.f[15](t.codecpar))).filter((t=>d.zy(a.K,s.f[15](t.codecpar+4)))).length>1},hasSubtitleTrack:function(){const t=this.get("streams");return!this.get("isLive")&&t.filter((t=>0===s.f[15](t.codecpar))).filter((t=>d.zy(a.K,s.f[15](t.codecpar+4)))).length>0},hasPip:function(){return this.get("streams").filter((t=>0===s.f[15](t.codecpar))).filter((t=>d.zy(a.K,s.f[15](t.codecpar+4)))).length>0},hasPcmVisualization:function(){const t=this.get("streams");return t.filter((t=>1===s.f[15](t.codecpar))).filter((t=>d.zy(a.K,s.f[15](t.codecpar+4)))).length>0&&0===t.filter((t=>0===s.f[15](t.codecpar))).filter((t=>d.zy(a.K,s.f[15](t.codecpar+4)))).length}},methods:{init(t){const e=t.getSource();h.Yj(e)?this.set("title",u.qg(decodeURI(e)).file):this.set("title",e.name),this.set("streams",t.getStreams()),this.set("isLive",t.isLive())},mousemove(){setTimeout((()=>{this.set("showBar",!0),this.showBarTimer&&clearTimeout(this.showBarTimer),this.get("played")&&this.get("folded")&&(this.showBarTimer=setTimeout((()=>{this.set("showBar",!1),this.showBarTimer=null}),5e3))}))},playClick(t){this.$refs.play&&(!this.get("showMenu")&&this.get("showBar")||!t)&&this.$refs.play.playClick()},toggleFold(){this.set("folded",!this.get("folded"))},fold(){this.set("folded",!0)},unfold(){this.set("folded",!1)},menuAction(t){0===t&&this.set("showInfo",!0),this.set("showMenu",!1)},menuOutside(){this.set("showMenu",!1)}},afterMount(){this.namespace=".avplayer"+Math.random();const t=this.get("player"),e=this.$el.querySelectorAll(".avplayer-ui-player")[0];t.options.container=e,t.on(c.F5+this.namespace,(()=>{this.set("loading",!0),this.set("error","")})),t.on(c.S2+this.namespace,(()=>{this.init(t)})),t.on(c.CN+this.namespace,(()=>{this.set("loading",!1)})),t.on(c.yd+this.namespace,(()=>{this.set("title",""),this.set("streams",[])})),t.getStatus()>=4&&this.init(t),this.onresize=(0,L.A)((()=>{t.resize(e.offsetWidth,e.offsetHeight)}),500),window.addEventListener("resize",this.onresize),this.oncontextmenu=t=>{this.$refs.playerContainer.contains(t.target)&&(this.set("showMenu",!0),this.set("menuTop",t.clientY),this.set("menuLeft",t.clientX),t.preventDefault())},window.addEventListener("contextmenu",this.oncontextmenu)},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace),window.removeEventListener("resize",this.onresize),window.removeEventListener("contextmenu",this.oncontextmenu)},components:{Progress:f.A,Play:p.A,Volume:m.A,Timer:g.A,Setting:v.A,Fullscreen:y.A,Playrate:A.A,AudioTrack:b.A,VideoTrack:x.A,SubtitleTrack:w.A,Loop:k.A,Pip:T.A,Folder:S.A,Loading:I.A,PcmVisualization:P.A,LoadingTip:_.A,Info:E.A,Settings:C.A}};class $ extends a.A{constructor(t){var e,i;super(l.X$({},t,{container:null})),(0,r.A)(this,"ui",void 0),(0,r.A)(this,"keyboard",void 0),o().dom.addSpecialEvent("outside",O.A),this.ui=new(o())(l.X$({el:t.container,replace:!1,props:{player:this,indicatorUrl:t.indicatorUrl,pauseStateUrl:t.pauseStateUrl,errorStateUrl:t.errorStateUrl,fullscreenDom:t.fullscreenDom,hasFolder:null===(e=t.ui)||void 0===e?void 0:e.hasFolder,hasHeader:null===(i=t.ui)||void 0===i?void 0:i.hasHeader}},F)),this.keyboard=new N.A(this)}foldFolder(){this.ui.fold()}unfoldFolder(){this.ui.unfold()}async destroy(){await super.destroy(),this.keyboard.destroy(),this.ui.destroy()}}},93108:(t,e,i)=>{"use strict";i.d(e,{A:()=>f});var r=i(134),s=i(80662),a=i.n(s),n=i(80198),o=i(95335),l=i(72739),c=i(65196),h=i(43607),d=i(67672);const u={16:[{keyCode:n.wb["+"],with:[n.ZV.ctrl],action:"up",playerStatus:[6,7]},{keyCode:n.wb["+"],with:[n.ZV.ctrl,n.ZV.shift],action:"up",playerStatus:[6,7]}],17:[{keyCode:n.wb["-"],with:[n.ZV.ctrl],action:"up",playerStatus:[6,7]},{keyCode:n.wb["-"],with:[n.ZV.ctrl,n.ZV.shift],action:"up",playerStatus:[6,7]}],1:{keyCode:n.wb.space,with:[],action:"up",playerStatus:[6,7]},3:{keyCode:n.ay.right,with:[],action:"up",playerStatus:[6]},2:{keyCode:n.ay.left,with:[],action:"up",playerStatus:[6,7]},4:{keyCode:n.ay.right,with:[],action:"longDown",playerStatus:[6]},5:{keyCode:n.ay.right,with:[],action:"up",playerStatus:[6],longDownBefore:!0},6:{keyCode:n.wb.n,with:[n.ZV.ctrl],action:"up"},7:{keyCode:n.wb.p,with:[n.ZV.ctrl],action:"up"},8:{keyCode:n.ay.right,with:[],action:"up",playerStatus:[7]},9:{keyCode:n.wb.p,with:[n.ZV.ctrl,n.ZV.shift],action:"up",playerStatus:[7,6]},10:{keyCode:n.wb.s,with:[n.ZV.ctrl],action:"up",playerStatus:[7,6]},12:{keyCode:n.ay.down,with:[],action:"up"},11:{keyCode:n.ay.up,with:[],action:"up"},13:{keyCode:n.ay.esc,with:[],action:"up"},14:{keyCode:n.wb.f,with:[n.ZV.ctrl],action:"up"},15:{keyCode:n.wb.u,with:[n.ZV.ctrl],action:"up"}};class f{constructor(t){(0,r.A)(this,"onKeyDown_",void 0),(0,r.A)(this,"onKeyUp_",void 0),(0,r.A)(this,"player",void 0),(0,r.A)(this,"seekQueue",void 0),(0,r.A)(this,"lastPlayrate",void 0),(0,r.A)(this,"longDownTimer",void 0),(0,r.A)(this,"longDownRunning",void 0),this.player=t,this.longDownTimer=new(a()),this.longDownRunning=new(a()),this.seekQueue=new c.A,this.onKeyDown_=t=>{this.onKeyDown(t)},this.onKeyUp_=t=>{this.onKeyUp(t)},document.addEventListener("keydown",this.onKeyDown_),document.addEventListener("keyup",this.onKeyUp_)}actionPlayOrPause(){7===this.player.getStatus()?this.player.play():this.player.pause()}actionSeekForward(){this.seekQueue.clearPadding(),this.seekQueue.push((async()=>this.player.seek(h.jk(this.player.currentTime+BigInt(1e4),this.player.getDuration()-BigInt(1e4)))))}actionSeekBack(){this.seekQueue.clearPadding(),this.seekQueue.push((async()=>this.player.seek(h.T9(this.player.currentTime-BigInt(1e4),BigInt(0)))))}actionUpperPlayrate(){this.lastPlayrate=this.player.getPlaybackRate(),this.player.setPlaybackRate(2)}actionStopUpperPlayrate(){this.player.setPlaybackRate(this.lastPlayrate)}actionNextFile(){}actionPrevFile(){}actionNextFrame(){this.player.playNextFrame()}actionSnapshot(){if(!this.player.hasVideo())return;const t=this.player.snapshot("png"),e=atob(t.replace(/^data:image\/(png|jpeg|jpg);base64,/,"")),i=t.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(e.length),s=new Uint8Array(r);for(let t=0;t<e.length;t++)s[t]=e.charCodeAt(t);const a=new Blob([r],{type:i}),n=document.createElement("a");let o=this.player.getSource(),l="";l=d.Yj(o)?o:o.name;const c=l.split(".");c.pop(),n.download=c.join(".")+".png",n.href=URL.createObjectURL(a),n.click()}actionStop(){this.player.stop()}actionVolumeUp(){this.player.setVolume(Math.min(this.player.getVolume()+.1,1))}actionVolumeDown(){this.player.setVolume(Math.max(this.player.getVolume()-.1,0))}actionExitFullscreen(){this.player.exitFullscreen()}actionFoldFolder(){this.player.foldFolder()}actionUnFoldFolder(){this.player.unfoldFolder()}actionSubtitleDelayAdd(){this.player.setSubtitleDelay(Math.min(5e3,this.player.getSubtitleDelay()+100))}actionSubtitleDelaySub(){this.player.setSubtitleDelay(Math.max(-5e3,this.player.getSubtitleDelay()-100))}runAction(t){switch(t){case 1:this.actionPlayOrPause();break;case 8:this.actionNextFrame();break;case 13:this.actionExitFullscreen();break;case 6:this.actionNextFile();break;case 7:this.actionPrevFile();break;case 2:this.actionSeekBack();break;case 3:this.actionSeekForward();break;case 9:this.actionSnapshot();break;case 10:this.actionStop();break;case 14:this.actionFoldFolder();break;case 15:this.actionUnFoldFolder();break;case 4:this.actionUpperPlayrate();break;case 5:this.actionStopUpperPlayrate();break;case 12:this.actionVolumeDown();break;case 11:this.actionVolumeUp();break;case 16:this.actionSubtitleDelayAdd();break;case 17:this.actionSubtitleDelaySub()}}longDownAction(t,e){this.longDownTimer.has(e.keyCode)||this.longDownTimer.set(e.keyCode,setTimeout((()=>{this.longDownTimer.delete(e.keyCode),this.runAction(t),this.longDownRunning.set(e.keyCode,t)}),1e3))}getActionKeys(t,e,i=!1){let r,s;if(o.__(u,((a,o)=>{const c=a=>{if(a.keyCode===t.keyCode&&e===a.action&&(!a.playerStatus||l.zy(a.playerStatus,this.player.getStatus()))&&(!i||a.longDownBefore)){const e=[];if(t.shiftKey&&e.push(n.ZV.shift),t.ctrlKey&&e.push(n.ZV.ctrl),t.metaKey&&e.push(n.ZV.meta),t.altKey&&e.push(n.ZV.alt),e.length===a.with.length){let t=!0;for(let i=0;i<e.length;i++)if(!l.zy(a.with,e[i])){t=!1;break}if(t)return r=+o,s=a,!0}}};if(!d.YO(a))return!c(a);{let t=!1;if(l.__(a,(e=>{if(c(e))return t=!0,!1})),t)return!1}})),s)return{key:r,action:s}}onKeyDown(t){let e=this.getActionKeys(t,"down");e?this.runAction(e.key):(e=this.getActionKeys(t,"longDown"),e&&!this.longDownRunning.has(e.action.keyCode)&&this.longDownAction(e.key,e.action))}onKeyUp(t){this.longDownTimer.has(t.keyCode)&&(clearTimeout(this.longDownTimer.get(t.keyCode)),this.longDownTimer.delete(t.keyCode));let e=this.getActionKeys(t,"up",this.longDownRunning.has(t.keyCode));e&&(e.action.longDownBefore&&!this.longDownRunning.has(t.keyCode)||this.runAction(e.key)),this.longDownRunning.delete(t.keyCode)}destroy(){document.removeEventListener("keydown",this.onKeyDown_),document.removeEventListener("keyup",this.onKeyUp_)}}},64147:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(63939),s=i(28090),a=i(82723),n=i.n(a),o=i(42567),l=i.n(o);const c={name:"AudioTrack",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{streams:[],audioInfo:null,selectIndex:0,style:l()}},computed:{list:function(){const t=this.get("player"),e=this.get("streams"),i=this.get("audioInfo");if(!i)return e.map(((e,i)=>(e.id===t.getSelectedAudioStreamId()&&this.set("selectIndex",i),{value:e.id,name:e.metadata.title||e.metadata.languageString||e.metadata.language||e.metadata.name||"default"})));if(i.list.length){const t=i.list[i.selectedIndex].codecs;i.list.map(((t,e)=>({value:e,name:t.lang,codecs:t.codecs}))).filter((e=>e.codecs===t)).forEach(((t,e)=>{t.value===i.selectedIndex&&this.set("selectIndex",e)}))}return[]}},methods:{change:function(t){this.get("selectIndex")!==t&&this.get("player").selectAudio(this.get("list")[t].value).then((()=>{this.set("selectIndex",t)}))},init:function(t){t.isDash()||t.isHls()?this.set("audioInfo",t.getAudioList()):this.set("streams",t.getStreams().filter((t=>1===r.f[15](t.codecpar))))}},afterMount(){this.namespace=".component_control_audio_track"+Math.random();const t=this.get("player");t.on(s.S2+this.namespace,(()=>{this.init(t)})),t.on(s.xv+this.namespace,(()=>{this.init(t)})),t.getStatus()>=4&&this.init(t)},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},30019:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(22179),s=i.n(r),a=i(9371),n=i.n(a);const o={name:"Fullscreen",template:s(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0},dom:{type:"object"}},data:function(){return{style:n(),fullscreen:!1}},methods:{init(t){},fullscreenClick(){const t=this.get("player");if(this.get("fullscreen"))document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const e=this.get("dom")||t.getOptions().container.parentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}}},afterMount(){this.namespace=".component_control_fullscreen"+Math.random();const t=this.get("player");this.onfullscreenchange=()=>{if(null==document.fullscreenElement){const e=t.getOptions().container;t.resize(e.offsetWidth,e.offsetHeight),this.set("fullscreen",!1)}else t.resize(screen.width,screen.height),this.set("fullscreen",!0)},document.addEventListener("fullscreenchange",this.onfullscreenchange)},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace),document.removeEventListener("fullscreenchange",this.onfullscreenchange)}}},86213:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(11302),s=i(82237),a=i.n(s),n=i(85885),o=i.n(n);const l={name:"Loop",template:a(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:o(),loop:!!+r.Jt(r.vd,0)}},watchers:{loop:function(t){this.get("player").setLoop(t),r.hZ(r.vd,t?1:0)}},methods:{init(t){},change(){this.set("loop",!this.get("loop"))}},afterMount(){this.namespace=".component_control_loop"+Math.random(),this.get("player").setLoop(this.get("loop"))},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},91011:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(16979),s=i.n(r),a=i(6187),n=i.n(a);const o={name:"Pip",template:s(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:n(),pip:!1}},methods:{init(t){},async pipClick(){const t=this.get("player");if(this.get("pip"))if(this.set("pip",!1),t.isMSE())document.exitPictureInPicture();else{const e=this.pipWindow.document.body.children[0];e&&(this.playerContainer.prepend(e),t.resize(e.offsetWidth,e.offsetHeight)),this.pipWindow.close()}else t.isMSE()?t.video.requestPictureInPicture():(this.playerContainer=t.getOptions().container.parentElement,this.pipWindow=await documentPictureInPicture.requestWindow({disallowReturnToOpener:!0,width:320,height:180}),this.pipWindow.addEventListener("pagehide",(e=>{if(this.get("pip")){const i=e.target.body.children[0];i&&(this.playerContainer.prepend(i),t.resize(i.offsetWidth,i.offsetHeight)),this.set("pip",!1)}})),this.pipWindow.addEventListener("resize",(e=>{if(this.pipWindow.document){const e=this.pipWindow.document.children[0];t.resize(e.offsetWidth,e.offsetHeight)}})),[...document.styleSheets].forEach((t=>{try{const e=[...t.cssRules].map((t=>t.cssText)).join(""),i=document.createElement("style");i.textContent=e,this.pipWindow.document.head.appendChild(i)}catch(e){const i=document.createElement("link");i.rel="stylesheet",i.type=t.type,i.media=t.media,i.href=t.href,this.pipWindow.document.head.appendChild(i)}})),this.pipWindow.document.body.append(t.getOptions().container))}},afterMount(){this.namespace=".component_control_pip"+Math.random(),this.onenter=t=>{this.pipWindow=t.window,this.set("pip",!0)},"object"==typeof documentPictureInPicture&&documentPictureInPicture.addEventListener("enter",this.onenter)},beforeDestroy(){const t=this.get("player");"object"==typeof documentPictureInPicture&&documentPictureInPicture.removeEventListener("enter",this.onenter),this.namespace&&t.off(this.namespace)}}},76793:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(28090),s=i(1449),a=i.n(s),n=i(70409),o=i.n(n);const l={name:"Play",model:"played",template:a(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0},played:{type:"boolean",required:!0}},data:function(){return{style:o()}},methods:{playClick(){const t=this.get("player");if(t.getSource()){if(this.get("played")){if(t.isLive())return;t.pause()}else 0===t.getStatus()?t.load(t.getSource(),t.getExternalSubtitle()).then((()=>{t.play()})):t.play();this.set("played",!this.get("played"))}},init(t){this.set("played",6===t.getStatus())}},afterMount(){this.namespace=".component_control_play"+Math.random();const t=this.get("player");t.on(r.yd+this.namespace,(()=>{this.set("played",!1)})),t.on(r.NN+this.namespace,(()=>{this.set("played",!1)})),t.on(r.CN+this.namespace,(()=>{this.set("played",!0)})),t.on(r.S2+this.namespace,(()=>{this.init(t)})),t.getStatus()>=4&&this.init(t)},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},7233:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(72739),s=i(11302),a=i(8809),n=i.n(a),o=i(63197),l=i.n(o);const c={name:"Playrate",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){const t=[2,1.5,1.25,1,.75,.5];let e=r.qh(t,+s.Jt(s.Yt,1));return e<0&&(e=3),{list:t,index:e,style:l()}},watchers:{index:function(t){s.hZ(s.Yt,this.get("list")[t]),this.get("player").setPlaybackRate(this.get("list")[t])}},methods:{change:function(t){this.set("index",t)}},afterMount(){this.namespace=".component_control_play_rate"+Math.random(),this.get("player").setPlaybackRate(this.get("list")[this.get("index")])},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},13203:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(78675),s=i.n(r),a=i(51819),n=i.n(a);const o={name:"Setting",template:s(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:n()}},methods:{init(t){},click(){this.fire("openSettings")}},afterMount(){this.namespace=".component_control_setting"+Math.random(),this.get("player")},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},59715:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var r=i(63939),s=i(28090),a=i(95683),n=i.n(a),o=i(35995),l=i.n(o),c=i(9391);const h={name:"SubtitleTrack",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{streams:[],subtitleInfo:null,selectIndex:0,style:l(),accept:c._Y.map((t=>"."+t)).join(", "),canUseFilePicker:"function"==typeof showOpenFilePicker}},computed:{list:function(){const t=this.get("player"),e=this.get("streams"),i=this.get("subtitleInfo");if(!i)return e.map(((e,i)=>(e.id===t.getSelectedSubtitleStreamId()&&this.set("selectIndex",i),{value:e.id,name:e.metadata.title||e.metadata.languageString||e.metadata.language||e.metadata.name||"default"})));if(i.list.length){const t=i.list[i.selectedIndex].codecs;i.list.map(((t,e)=>({value:e,name:t.lang,codecs:t.codecs}))).filter((e=>e.codecs===t)).forEach(((t,e)=>{t.value===i.selectedIndex&&this.set("selectIndex",e)}))}return[]}},methods:{change:function(t){this.get("selectIndex")!==t&&this.get("player").selectSubtitle(this.get("list")[t].value).then((()=>{this.set("selectIndex",t)}))},openFile(){const t={startIn:"videos",types:[{description:"Subtitles",accept:{"application/octet-stream":c._Y.map((t=>"."+t))}}],excludeAcceptAllOption:!0,multiple:!0},e=this.get("player");showOpenFilePicker(t).then((async t=>{for(let i=0;i<t.length;i++){const r=await t[i].getFile(),s=r.name.split(".");s.pop(),e.loadExternalSubtitle({title:s.join("."),source:r})}}))},fileChange(t){const e=t.originalEvent.target.files[0],i=this.get("player"),r=e.name.split(".");r.pop(),i.loadExternalSubtitle({title:r.join("."),source:e})},init:function(t){t.isDash()||t.isHls()?this.set("subtitleInfo",t.getSubtitleList()):this.set("streams",t.getStreams().filter((t=>3===r.f[15](t.codecpar))))}},afterMount(){this.namespace=".component_control_subtitle_track"+Math.random();const t=this.get("player");t.on(s.S2+this.namespace,(()=>{this.init(t)})),t.on(s.xv+this.namespace,(()=>{this.init(t)})),t.getStatus()>=4&&this.init(t)},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},37463:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(28090),s=i(20525),a=i(9127),n=i.n(a),o=i(27983),l=i.n(o);const c={name:"Time",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{totalTime:BigInt(0),currentTime:BigInt(0),style:l()}},filters:{formatTime(t){t<0&&(t=BigInt(0));const e=Number(BigInt.asIntN(32,t/BigInt(1e3)%BigInt(60))),i=Number(BigInt.asIntN(32,t/BigInt(1e3)/BigInt(60)%BigInt(60))),r=Number(BigInt.asIntN(32,t/BigInt(1e3)/BigInt(3600)));return s.GP("%02d:%02d:%02d",r,i,e)}},methods:{init(t){this.set("currentTime",t.currentTime),this.set("totalTime",t.getDuration())}},afterMount(){this.namespace=".component_control_timer"+Math.random();const t=this.get("player");t.on(r.S2+this.namespace,(()=>{this.init(t)})),t.on(r.E9+this.namespace,(t=>{this.set("currentTime",t)})),t.getStatus()>=4&&this.init(t)},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},40777:(t,e,i)=>{"use strict";i.d(e,{A:()=>c});var r=i(63939),s=i(28090),a=i(43145),n=i.n(a),o=i(27189),l=i.n(o);const c={name:"VideoTrack",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{streams:[],videoInfo:null,selectIndex:0,style:l()}},computed:{list:function(){const t=this.get("player"),e=this.get("streams"),i=this.get("videoInfo");if(!i)return e.map(((e,i)=>(e.id===t.getSelectedVideoStreamId()&&this.set("selectIndex",i),{value:e.id,name:e.metadata.title||e.metadata.languageString||e.metadata.language||e.metadata.name||"default"})));if(i.list.length){const t=i.list[i.selectedIndex].codecs;i.list.map(((t,e)=>({value:e,name:`${t.width}*${t.height}${t.frameRate?`@${t.frameRate}`:""}`,codecs:t.codecs}))).filter((e=>e.codecs===t)).forEach(((t,e)=>{t.value===i.selectedIndex&&this.set("selectIndex",e)}))}return[]}},methods:{change:function(t){this.get("selectIndex")!==t&&this.get("player").selectVideo(this.get("list")[t].value).then((()=>{this.set("selectIndex",t)}))},init:function(t){t.isDash()||t.isHls()?this.set("videoInfo",t.getVideoList()):this.set("streams",t.getStreams().filter((t=>0===r.f[15](t.codecpar))))}},afterMount(){this.namespace=".component_control_video_track"+Math.random();const t=this.get("player");t.on(s.S2+this.namespace,(()=>{this.init(t)})),t.on(s.xv+this.namespace,(()=>{this.init(t)})),t.getStatus()>=4&&this.init(t)},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},92053:(t,e,i)=>{"use strict";i.d(e,{A:()=>h});var r=i(11302),s=i(53924),a=i(28090),n=i(93069),o=i.n(n),l=i(80253),c=i.n(l);const h={name:"Volume",template:o(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{lastVolume:50,volume:+r.Jt(r.xc,50),style:c()}},watchers:{volume:function(t){r.hZ(r.xc,t),this.get("player").setVolume(t/100)}},methods:{volumeClick(){this.get("volume")?(this.set("lastVolume",this.get("volume")),this.set("volume",0)):this.set("volume",this.get("lastVolume"))}},afterMount(){this.namespace=".component_control_volume"+Math.random();const t=this.get("player");t.on(a.Wu+this.namespace,(t=>{this.set("volume",Math.floor(100*t))})),t.setVolume(this.get("volume")/100)},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)},components:{Slider:s.A}}},14667:(t,e,i)=>{"use strict";i.d(e,{A:()=>m});var r=i(28090),s=i(94907),a=i.n(s),n=i(50055),o=i.n(n),l=i(9391),c=i(72739),h=i(66521),d=i(8284),u=i(4624),f=i(8507),p=i(67672);const m={name:"Folder",template:a(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:o(),canOpenFolder:"function"==typeof showDirectoryPicker,canUseFilePicker:"function"==typeof showOpenFilePicker,tip:"",tipTop:0,tipShow:!1,root:[],accept:l.z_.concat(l.KQ).map((t=>"."+t)).join(", ")}},methods:{init(t){},async addDir(t){let e=0;const i=[];async function r(t){const r=await t.getFile(),s=r.name.split(".").pop();if(c.zy(l.KQ,s)||c.zy(l.z_,s)){const s={id:(0,d.A)(),type:"file",name:r.name,depth:e,source:r,handle:t,played:!1,parent:i.length?i[i.length-1]:null};i[i.length-1].children.push(s)}}await async function t(s){const a={id:(0,d.A)(),type:"folder",name:s.name,depth:e,children:[],opened:!1,handle:s,played:!1,parent:i.length?i[i.length-1]:null};i.length&&i[i.length-1].children.push(a),i.push(a),e++;for await(const a of s.values())"file"===a.kind?await r(a):"directory"===a.kind&&(await t(a),i.pop(),e--)}(t),this.append("root",i.pop())},async addFile(t){const e=await t.getFile();this.append("root",{id:(0,d.A)(),type:"file",name:e.name,depth:0,source:e,handle:t})},addUrl(t,e){const i=f.qg(t);this.append("root",{id:(0,d.A)(),type:"file",name:i.file,depth:0,source:t,isLive:e})},openDir(){showDirectoryPicker({mode:"read",startIn:"videos"}).then((async t=>{this.addDir(t),this.root.push(t),h.M_(h.qd,this.root)}))},openFile(){const t={startIn:"videos",types:[{description:"Audios & Videos",accept:{"application/octet-stream":l.z_.map((t=>"."+t)).concat(l.KQ.map((t=>"."+t)))}}],excludeAcceptAllOption:!0,multiple:!0};showOpenFilePicker(t).then((async t=>{for(let e=0;e<t.length;e++)this.addFile(t[e]),this.root.push(t[e]);h.M_(h.qd,this.root)}))},generateStoreUrl:(t,e)=>`${e?"libmediaLive:":""}${t}`,openUrl(){const t=this.$refs.url.value;if(!t)return;const e=this.$refs.live.checked;this.addUrl(t,e),this.root.push(this.generateStoreUrl(t,e)),h.M_(h.qd,this.root),this.$refs.url.value="",this.$refs.live.checked=!1},fileChange(t){const e=t.originalEvent.target.files[0];this.append("root",{id:(0,d.A)(),type:"file",name:e.name,depth:0,source:e})},findNodeById(t,e){for(let i=0;i<e.length;i++){if(e[i].id===t)return e[i];if("folder"===e[i].type){let r=this.findNodeById(t,e[i].children);if(r)return r}}},async findSubtitle(t){const e=t.parent,i=t.handle,r=[];if(e){let t=(await i.getFile()).name.split(".");t.pop();let s=t.join(".");for await(const t of e.handle.values())if("file"===t.kind){const e=await t.getFile(),i=e.name.split(".").pop();let a=e.name.split(".");a.pop();let n=a.join(".");c.zy(l._Y,i)&&s===n&&r.push({title:n,source:e})}if(r.length){const t=this.get("player");r.forEach((e=>{t.loadExternalSubtitle(e)}))}}},preventDefault(t){t.preventDefault()}},events:{play(t,e){const i=this.get("player");if(e.get("node.id")===this.playNodeId)return void(6===i.getStatus()?(i.pause(),e.set("node.paused",!0)):7===i.getStatus()&&(i.play(),e.set("node.paused",!1)));if(this.playNodeId){let t=this.findNodeById(this.playNodeId,this.get("root"));for(;t;)t.ref?t.ref.set("node.played",!1):t.played=!1,t=t.parent;this.playNodeId=null}let r=e;for(;r!==this;)r.set("node.played",!0),r=r.$parent;1!==i.getStatus()&&2!==i.getStatus()&&(0===i.getStatus()?(i.setIsLive(!!e.get("node.isLive")),i.load(e.get("node.source")).then((()=>{i.play().catch((t=>{this.fire("error",{message:`${t}`})})),e.set("node.paused",!1),this.findSubtitle(e.get("node"))})).catch((t=>{this.fire("error",{message:`${t}`})})),this.playNodeId=e.get("node.id"),this.fire("playNode",e.get("node"))):i.stop().then((()=>{i.setIsLive(!!e.get("node.isLive")),i.load(e.get("node.source")).then((()=>{i.play().catch((t=>{this.fire("error",{message:`${t}`})})),e.set("node.paused",!1),this.findSubtitle(e.get("node"))})).catch((t=>{this.fire("error",{message:`${t}`})})),this.playNodeId=e.get("node.id"),this.fire("playNode",e.get("node"))})))},delete(t,e){let i=-1;const r=this.get("root");for(let t=0;t<r.length;t++)if(r[t].id===e.id){i=t;break}i>-1&&this.removeAt("root",i),c.TF(this.root,e.handle||this.generateStoreUrl(e.source,e.isLive)),h.M_(h.qd,this.root)},tip(t,e){e?(this.set("tipShow",!0),this.set("tip",e.text),this.set("tipTop",e.top-this.$refs.scroll.scrollTop+90)):this.set("tipShow",!1)}},afterMount(){this.namespace=".component_folder"+Math.random(),(this.get("canOpenFolder")||this.get("canUseFilePicker"))&&h.Hh(h.qd).then((async t=>{this.root=t||[];const e=[];for(let t=0;t<this.root.length;t++){const i=this.root[t];try{if(p.Yj(i)){let t=i;const e=/^libmediaLive:/.test(t);e&&(t=t.replace(/^libmediaLive:/,"")),this.addUrl(t,e)}else{let t=await i.queryPermission({mode:"read"});if("granted"!==t&&(t=await i.requestPermission({mode:"read"}),"granted"!==t))throw new Error(`not has permission to access ${i.name}`);"file"===i.kind?await this.addFile(i):"directory"===i.kind&&await this.addDir(i)}e.push(i)}catch(t){u.z3("load file handle error, ignore it","src/ui/avplayer/components/folder/Folder.ts",437)}}e.length!==this.root.length&&h.M_(h.qd,e)}));const t=this.get("player");t.on(r.yd+this.namespace,(()=>{if(this.playNodeId){let t=this.findNodeById(this.playNodeId,this.get("root"));if(t){t.ref?t.ref.set("node.paused",!0):t.paused=!0;let e=t;for(;e;)e.ref?e.ref.set("node.played",!1):e.played=!1,e=e.parent}}})),t.on(r.NN+this.namespace,(()=>{if(this.playNodeId){let t=this.findNodeById(this.playNodeId,this.get("root"));t&&(t.ref?t.ref.set("node.paused",!0):t.paused=!0)}})),t.on(r.CN+this.namespace,(()=>{if(this.playNodeId){let t=this.findNodeById(this.playNodeId,this.get("root"));t&&(t.ref?t.ref.set("node.paused",!1):t.paused=!1)}}))},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)},components:{FolderNode:l.Ay}}},9391:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>h,KQ:()=>o,_Y:()=>l,z_:()=>n});var r=i(67672),s=i(72739),a=i(81747);const n=["mp3","aac","flac","oggs","ogg","wav","m4a","mka","opus"],o=["mp4","webm","mkv","flv","ts","mov","m4s","h264","264","avc","h265","265","hevc","h266","266","vvc","ivf"],l=["ass","ssa","vvt","srt","xml","ttml"],c={name:"Node",template:i.n(a)(),propTypes:{node:{type:"object"},language:{type:"object",required:!0}},data:function(){return{}},filters:{isFolder:function(t){return"folder"===t.type},paddingStart:function(t){return 24*t.depth},isUrl:function(t){return r.Yj(t.source)},isMusic:function(t){const e=t.source.name.split(".").pop();return s.zy(n,e)}},methods:{toggle(){this.set("node.opened",!this.get("node.opened"))},play(){this.fire("play",this)},delete(){this.fire("delete",this.get("node"))},mouseenter(){this.$refs.name.scrollWidth>this.$refs.name.clientWidth&&this.fire("tip",{top:this.$el.offsetTop,text:r.Yj(this.get("node.source"))?this.get("node.source"):this.get("node.name")})},mouseleave(){this.fire("tip","")}},afterMount(){this.get("node").ref=this},beforeDestroy(){this.get("node").ref=null},components:{}};c.components.FolderNode=c;const h=c},53891:(t,e,i)=>{"use strict";i.d(e,{A:()=>f});var r=i(28090),s=i(67672),a=i(15491),n=i.n(a),o=i(90615),l=i.n(o),c=i(548);const h=["jitter","bandwidth"],d=["audioStutter","audioBitrate","audioEncodeFramerate","audioDecodeFramerate","audioRenderFramerate","audioFrameDecodeIntervalMax","audioFrameRenderIntervalMax"],u=["videoStutter","videoBitrate","videoEncodeFramerate","videoDecodeFramerate","videoRenderFramerate","keyFrameInterval","videoFrameDecodeIntervalMax","videoFrameRenderIntervalMax"],f={name:"Info",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:l(),info:"",list:[]}},methods:{getStats:function(t){const e=t.getStats();this.set("list",[]);let i=h;t.hasVideo()&&(i=i.concat(u)),t.hasAudio()&&(i=i.concat(d)),i.forEach((t=>{let i=e[t];"audioBitrate"!==t&&"videoBitrate"!==t&&"bandwidth"!==t||(i=8*i/1e3+" kbps"),this.append("list",{key:t.replace(/([A-Z])/g," $1").replace(/^[a-z]/,(t=>t.toUpperCase())),value:i})}))},init(t){const e=t.getSource(),i=(0,c.Ay)([t.getFormatContext()],[{from:s.Yj(e)?e:e.name,tag:"Input"}]);this.set("info",i.replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;")),this.set("list",[]),this.getStats(t),this.timer||(this.timer=setInterval((()=>{this.getStats(t)}),1e3))},close(){return this.fire("closeInfo"),!1},preventDefault(t){t.preventDefault()}},afterMount(){this.namespace=".component_info"+Math.random();const t=this.get("player");t.on(r.S2+this.namespace,(()=>{this.init(t)})),t.getStatus()>=4&&this.init(t)},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace),this.timer&&(clearInterval(this.timer),this.timer=null)}}},45553:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(28090),s=i(32849),a=i.n(s),n=i(57817),o=i.n(n);const l={name:"Loading",template:a(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:o(),loading:!1}},methods:{},afterMount(){this.namespace=".component_loading"+Math.random();const t=this.get("player");t.on(r.CN+this.namespace,(()=>{this.timer&&(clearTimeout(this.timer),this.timer=null),this.set("loading",!1)})),t.on(r.F5+this.namespace,(()=>{this.timer&&clearTimeout(this.timer),this.timer=setTimeout((()=>{this.set("loading",!0),this.timer=null}),500)})),this.set("loading",3===t.getStatus())},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},65893:(t,e,i)=>{"use strict";i.d(e,{A:()=>u});var r=i(63939),s=i(28090),a=i(23077),n=i.n(a),o=i(6453),l=i.n(o),c=i(548),h=i(68391);const d={0:"LOADING_MESSAGE_OPEN_FILE",1:"LOADING_MESSAGE_ANALYZE_FILE",2:"LOADING_MESSAGE_LOAD_AUDIO_DECODER",3:"LOADING_MESSAGE_LOAD_VIDEO_DECODER"},u={name:"LoadingTip",template:n(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0},error:{type:"string"}},data:function(){return{style:l(),messages:[],showMessage:!1}},watchers:{error:function(){this.queue.push((()=>{this.append("message",this.get("language.LOADING_MESSAGE_LOAD_FAILED"))}))}},methods:{},afterMount(){this.namespace=".component_loading"+Math.random();const t=this.get("player");this.queue=new h.A(100),this.queue.onEnd=()=>{this.showTimer&&clearTimeout(this.showTimer),this.showTimer=setTimeout((()=>{this.set("showMessage",!1),this.showTimer=null}),2e3)},t.on(s.CN+this.namespace,(()=>{this.queue.push((()=>{this.append("message",this.get("language.LOADING_MESSAGE_LOAD_END"))})),this.queue.end()})),t.on(s.F5+this.namespace,(()=>{this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null),this.queue.reset(),this.set("message",[]),this.set("showMessage",!0)})),t.on(s.Gd+this.namespace,((t,e)=>{let i=this.get("language."+d[t]);switch(t){case 1:i=i.replace("${mux}",e);break;case 2:case 3:i=i.replace("${decoder}",(0,c.eG)(r.f[15](e.codecpar),r.f[15](e.codecpar+4)))}this.queue.push((()=>{this.append("message",i)}))}))},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},30499:(t,e,i)=>{"use strict";i.d(e,{A:()=>m});var r=i(134),s=i(61634),a=i(28090),n=i(65051),o=i.n(n),l=i(9067),c=i.n(l),h=i(78995),d=i(86932);function u(t,e,i){let r,s,a;if(0==e)r=s=a=i;else{const n=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<.16666666666666666?t+6*(e-t)*i:i<.3333333333333333?e:i<.5?t+(e-t)*(.6666666666666666-i)*6:t},o=i<.5?i*(1+e):i+e-i*e,l=2*i-o;r=n(l,o,.3333333333333333+(t/=360)),s=n(l,o,t),a=n(l,o,t-.3333333333333333)}return[Math.round(255*r),Math.round(255*s),Math.round(255*a)]}function f(t,e){let i=(t+e)%360;return i<0&&(i+=360),i}class p{constructor(){(0,r.A)(this,"OUTER_MAX_HEIGHT",.4),(0,r.A)(this,"MIDDLE_MAX_HEIGHT",.3),(0,r.A)(this,"INNER_MAX_HEIGHT",.2),(0,r.A)(this,"MAX_LENGTH",100),(0,r.A)(this,"MAX_FRAMERATE",30),(0,r.A)(this,"timeDelta",Math.floor(1e3/this.MAX_FRAMERATE)),(0,r.A)(this,"lastTimestamp",(0,d.A)())}draw(t,e){const i=(0,d.A)();if(i-this.lastTimestamp<this.timeDelta)return;this.lastTimestamp=i;const r=e.canvas.width,s=e.canvas.height,a=Math.min(r,s)/2;let n=Math.floor(this.MAX_LENGTH*(1+Math.min(1,(a-500)/200)));const o=Math.floor(t.length/n*.6);e.clearRect(0,0,r,s);const l=Math.min(r/2,s/2)*(.95-this.OUTER_MAX_HEIGHT),c=[],h=[],p=[],m=[],g=2*Math.PI/n,v=360/n,y=function(t,e,i){const r=Math.max(1,0,0),s=Math.min(1,0,0);let a,n,o=(r+s)/2;if(r===s)a=n=0;else{const t=r-s;switch(n=o>.5?t/(2-r-s):t/(r+s),r){case 1:a=0/t+0;break;case 0:a=-1/t+2;break;case 0:a=1/t+4}a/=6}return[360*a,n,o]}();for(let e=0;e<n;e++){const i=Math.pow(t[e*o]/255,1.5),n=Math.pow(t[e*o]/255,1),d=Math.pow(t[e*o]/255,2.2);c.push({x:r/2+(l+this.OUTER_MAX_HEIGHT*a*i)*Math.cos(e*g*-1),y:s/2+(l+this.OUTER_MAX_HEIGHT*a*i)*Math.sin(e*g*-1)}),p.push({x:r/2+(l-this.INNER_MAX_HEIGHT*a*n)*Math.cos(e*g*-1),y:s/2+(l-this.INNER_MAX_HEIGHT*a*n)*Math.sin(e*g*-1)}),h.push({start:{x:r/2+l*Math.cos(e*g*-1),y:s/2+l*Math.sin(e*g*-1)},end:{x:r/2+(l+this.MIDDLE_MAX_HEIGHT*a*d)*Math.cos(e*g*-1),y:s/2+(l+this.MIDDLE_MAX_HEIGHT*a*d)*Math.sin(e*g*-1)}});let A=Math.floor(e*v)-60;A<0&&(A+=360);const b=u(f(y[0],A),y[1],y[2]);m.push(`rgb(${b[0]},${b[1]},${b[2]})`)}e.lineCap="round",e.lineWidth=8,e.shadowBlur=20,e.shadowOffsetX=0,e.shadowOffsetY=0;for(let t=0;t<c.length;t++)e.strokeStyle=m[t],e.fillStyle=m[t],e.shadowColor=m[t],e.beginPath(),e.arc(c[t].x,c[t].y,4,0,2*Math.PI,!0),e.fill(),e.beginPath(),e.arc(p[t].x,p[t].y,4,0,2*Math.PI,!0),e.fill(),e.beginPath(),e.moveTo(h[t].start.x,h[t].start.y),e.lineTo(h[t].end.x,h[t].end.y),e.stroke();e.lineWidth=2;for(let t=0;t<p.length;t++){let i=t===p.length-1?0:t+1;const r=e.createLinearGradient(p[t].x,p[t].y,p[i].x,p[i].y);r.addColorStop(0,m[t]),r.addColorStop(1,m[i]),e.strokeStyle=r,e.shadowColor=m[t],e.beginPath(),e.moveTo(p[t].x,p[t].y),e.lineTo(p[i].x,p[i].y),e.stroke()}}}const m={name:"PcmVisualization",template:o(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){return{style:c()}},methods:{draw(){this.analyser.getByteFrequencyData(this.buffer),this.drawer.draw(this.buffer,this.context),requestAnimationFrame((()=>{this.playing&&this.draw()}))},init(t){t.hasVideo()?(this.playing=!1,this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)):t.hasAudio()&&(this.playing=!0,this.analyser||(this.analyser=s.A.audioContext.createAnalyser(),this.buffer=new Uint8Array(this.analyser.frequencyBinCount)),t.getAudioOutputNode().connect(this.analyser),this.draw())}},afterMount(){this.namespace=".component_pcm_visualization"+Math.random(),this.$refs.canvas.width=this.$el.offsetWidth*devicePixelRatio,this.$refs.canvas.height=this.$el.offsetHeight*devicePixelRatio,this.context=this.$refs.canvas.getContext("2d"),this.drawer=new p;const t=this.get("player");t.on(a.CN+this.namespace,(()=>{this.init(t)})),6===t.getStatus()&&this.init(t),this.onresize=(0,h.A)((()=>{this.$refs.canvas.width=this.$el.offsetWidth*devicePixelRatio,this.$refs.canvas.height=this.$el.offsetHeight*devicePixelRatio}),500),window.addEventListener("resize",this.onresize)},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace),this.playing=!1,window.removeEventListener("resize",this.onresize)}}},23601:(t,e,i)=>{"use strict";i.d(e,{A:()=>g});var r=i(29967),s=i.n(r),a=i(9599),n=i(29170),o=i(90577),l=i.n(o),c=i(57165),h=i.n(c),d=i(28090),u=i(44328),f=i(20525),p=i(67672),m=i(77231);const g={name:"Progress",template:l(),propTypes:{player:{type:"object",required:!0},indicatorUrl:{type:"string"}},data:function(){return{style:h(),startX:0,start:!1,seekTime:0,currentTime:0,totalTime:0,loadedTime:0,hoverX:0,indicatorSize:0,showTip:!1,isFileSource:!1,chapters:[],hoverChapter:""}},computed:{playedWidth:function(){const t=this.get("seekTime"),e=this.get("currentTime"),i=this.get("totalTime");return this.get("start")?t/i*100:e/i*100},loadedWidth:function(){return this.get("isFileSource")?0:(this.get("currentTime")+this.get("loadedTime"))/this.get("totalTime")*100},hoverWidth:function(){const t=this.get("hoverX");if(this.$refs&&this.$refs.slider){let e=t-this.$refs.slider.getBoundingClientRect().left;return e<0&&(e=0),e>this.$refs.slider.offsetWidth&&(e=this.$refs.slider.offsetWidth),e/this.$refs.slider.offsetWidth*100}return 0},hoverTime:function(){const t=this.get("hoverWidth");return Math.round(t/100*this.get("totalTime"))}},filters:{formatTime(t){t<0&&(t=0);const e=t/1e3%60|0,i=t/1e3/60%60|0,r=t/1e3/3600|0;return r?f.GP("%02d:%02d:%02d",r,i,e):f.GP("%02d:%02d",i,e)}},methods:{mousemove:function(t){if(!this.get("start"))return;const e=this.get("startX"),i=this.$refs.slider.offsetWidth;let r=0;r=(t.screenX-e)/i*this.get("totalTime");let s=this.get("seekTime")+r;s<0&&(s=0),s>this.get("totalTime")&&(s=this.get("totalTime")),this.set("seekTime",s),this.set("startX",t.screenX)},mouseup:function(){if(this.get("start")){this.set("start",!1);const t=this.get("player");this.seeking=!0,t.seek(BigInt(Math.floor(this.get("seekTime")))).then((()=>{this.seeking=!1})),this.set("currentTime",this.get("seekTime"))}},hoverEnter:function(t){this.set("hoverX",t.originalEvent.clientX),this.set("showTip",!0)},hoverMove:function(t){this.set("hoverX",t.originalEvent.clientX)},hoverLeave:function(t){this.set("hoverX",this.$refs.slider.offsetLeft),this.set("showTip",!1)},hoverClick:function(t){const e=this.get("player"),i=e.getStatus();6!==i&&7!==i||(this.seeking=!0,e.seek(BigInt(Math.floor(this.get("hoverTime")))).then((()=>{this.seeking=!1})),this.set("currentTime",this.get("hoverTime")))},indicatorDown:function(t){this.set("startX",t.originalEvent.screenX),this.set("start",!0),this.set("seekTime",this.get("currentTime"))},chapterEnter(t){this.set("hoverChapter",t.text),this.set("showTip",!0)},chapterLeave(t){this.set("hoverChapter",""),this.set("showTip",!0)},chapterClick(t){const e=this.get("player");this.seeking=!0,e.seek(t.start).then((()=>{this.seeking=!1})),this.set("currentTime",Number(t.start))},init(t){this.set("currentTime",Number(t.currentTime)),this.set("totalTime",Number(t.getDuration())),this.set("isFileSource",!p.Yj(t.getSource())),this.set("chapters",t.getChapters().map((t=>{const e=(0,u.k)(t.start,t.timeBase,m.i0);return{text:t.metadata.title,start:e,left:Number(e)/this.get("totalTime")*100}})))}},afterMount(){this.onmouseup=t=>{this.mouseup()},this.onmousemove=t=>{this.mousemove(t)},document.addEventListener("mouseup",this.onmouseup),document.addEventListener("mousemove",this.onmousemove),this.namespace=".Progress"+Math.random();const t=this.get("player");t.on(d.S2+this.namespace,(()=>{this.init(t)})),t.on(d.yd+this.namespace,(()=>{this.set("currentTime",0),this.set("loadedTime",0)})),t.on(d.mQ+this.namespace,(()=>{this.set("currentTime",Number(t.currentTime))})),t.on(d.E9+this.namespace,(e=>{if(this.seeking)return;this.set("currentTime",Number(e));const i=t.getStats(),r=t.getStreams();if(t.hasAudio()){const e=r.find((e=>e.id===t.getSelectedAudioStreamId()));e&&this.set("loadedTime",i.audioPacketQueueLength/(0,u.lb)((0,n.A)(e.codecpar+72,a.P))*1e3)}else if(t.hasVideo()){const e=r.find((e=>e.id===t.getSelectedVideoStreamId()));e&&this.set("loadedTime",i.videoPacketQueueLength/(0,u.lb)((0,n.A)(e.codecpar+72,a.P))*1e3)}})),t.getStatus()>=4&&this.init(t);const e=document.querySelector("#avplayer-ui-container"),i=getComputedStyle(e).getPropertyValue("--libmedia-ui-indicator-size").trim();this.set("indicatorSize",s()(i))},beforeDestroy(){document.removeEventListener("mouseup",this.onmouseup),document.removeEventListener("mousemove",this.onmousemove),this.get("player").off(this.namespace)}}},44341:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r,s=i(42461),a=i.n(s),n=i(9217),o=i.n(n);!function(t){t[t.DECODER=0]="DECODER",t[t.PLAY=1]="PLAY",t[t.SUBTITLE=2]="SUBTITLE",t[t.VIDEO=3]="VIDEO",t[t.AUDIO=4]="AUDIO",t[t.FILTER=5]="FILTER",t[t.KEYBOARD=6]="KEYBOARD",t[t.LANGUAGE=7]="LANGUAGE",t[t.SKIN=8]="SKIN"}(r||(r={}));const l={name:"Settings",template:a(),propTypes:{player:{type:"object",required:!0},language:{type:"object",required:!0}},data:function(){const t=this.get("language"),e=[{id:r.DECODER,name:t.SETTING_TAB_DECODER},{id:r.PLAY,name:t.SETTING_TAB_PLAY},{id:r.SUBTITLE,name:t.SETTING_TAB_SUBTITLE},{id:r.VIDEO,name:t.SETTING_TAB_VIDEO},{id:r.AUDIO,name:t.SETTING_TAB_AUDIO},{id:r.FILTER,name:t.SETTING_TAB_FILTER},{id:r.KEYBOARD,name:t.SETTING_TAB_KEYBOARD},{id:r.LANGUAGE,name:t.SETTING_TAB_LANGUAGE},{id:r.SKIN,name:t.SETTING_TAB_SKIN}];return{style:o(),tab:r.DECODER,list:e}},methods:{close:function(){this.fire("closeSettings")}},afterMount(){this.namespace=".component_settings"+Math.random()},beforeDestroy(){const t=this.get("player");this.namespace&&t.off(this.namespace)}}},93269:(t,e,i)=>{"use strict";i.r(e),i.d(e,{BUTTON_ADD:()=>w,CHECKBOX_LIVE:()=>k,CONTROL_AUDIO_TRACK:()=>m,CONTROL_PLAYRATE:()=>p,CONTROL_SUBTITLE_TRACK:()=>v,CONTROL_SUBTITLE_TRACK_ADD:()=>y,CONTROL_VIDEO_TRACK:()=>g,FOLDER_OPEN_DIR:()=>A,FOLDER_OPEN_FILE:()=>b,FOLDER_OPEN_URL_PLACEHOLDER:()=>x,INFO_TITLE:()=>C,LOADING_MESSAGE_ANALYZE_FILE:()=>S,LOADING_MESSAGE_LOAD_AUDIO_DECODER:()=>I,LOADING_MESSAGE_LOAD_END:()=>_,LOADING_MESSAGE_LOAD_FAILED:()=>E,LOADING_MESSAGE_LOAD_VIDEO_DECODER:()=>P,LOADING_MESSAGE_OPEN_FILE:()=>T,MENU_STATS:()=>M,SETTINGS_TITLE:()=>R,SETTING_TAB_AUDIO:()=>N,SETTING_TAB_DECODER:()=>B,SETTING_TAB_FILTER:()=>O,SETTING_TAB_KEYBOARD:()=>F,SETTING_TAB_LANGUAGE:()=>$,SETTING_TAB_PLAY:()=>D,SETTING_TAB_SKIN:()=>z,SETTING_TAB_SUBTITLE:()=>U,SETTING_TAB_VIDEO:()=>L,TIP_DELETE:()=>f,TIP_FOLD:()=>d,TIP_FULLSCREEN:()=>n,TIP_LOOP_START:()=>o,TIP_LOOP_STOP:()=>l,TIP_PAUSE:()=>s,TIP_PIP_START:()=>c,TIP_PIP_STOP:()=>h,TIP_PLAY:()=>r,TIP_SETTING:()=>a,TIP_UNFOLD:()=>u});const r="播放",s="暂停",a="设置",n="全屏",o="开启循环播放",l="关闭循环播放",c="开启画中画",h="关闭画中画",d="折叠",u="展开",f="删除",p="倍速",m="音频",g="视频",v="字幕",y="添加字幕",A="打开文件夹",b="打开文件",x="输入网络地址",w="添加",k="直播",T="正在打开源...",S="正在分析源(${mux})...",I="正在加载音频解码器(${decoder})...",P="正在加载视频解码器(${decoder})...",_="已就绪 (`･ω･´)ゞ",E="加载失败 (∩︵∩)",C="统计信息",M="源统计信息",R="设置",B="解码器",D="播放",U="字幕",L="画面",N="声音",O="滤镜",F="快捷键",$="语言",z="皮肤"},69094:(t,e,i)=>{"use strict";i.r(e),i.d(e,{BUTTON_ADD:()=>x,CHECKBOX_LIVE:()=>w,CONTROL_AUDIO_TRACK:()=>p,CONTROL_PLAYRATE:()=>f,CONTROL_SUBTITLE_TRACK:()=>g,CONTROL_SUBTITLE_TRACK_ADD:()=>v,CONTROL_VIDEO_TRACK:()=>m,FOLDER_OPEN_DIR:()=>y,FOLDER_OPEN_FILE:()=>A,FOLDER_OPEN_URL_PLACEHOLDER:()=>b,INFO_TITLE:()=>E,LOADING_MESSAGE_ANALYZE_FILE:()=>T,LOADING_MESSAGE_LOAD_AUDIO_DECODER:()=>S,LOADING_MESSAGE_LOAD_END:()=>P,LOADING_MESSAGE_LOAD_FAILED:()=>_,LOADING_MESSAGE_LOAD_VIDEO_DECODER:()=>I,LOADING_MESSAGE_OPEN_FILE:()=>k,MENU_STATS:()=>C,SETTINGS_TITLE:()=>M,SETTING_TAB_AUDIO:()=>L,SETTING_TAB_DECODER:()=>R,SETTING_TAB_FILTER:()=>N,SETTING_TAB_KEYBOARD:()=>O,SETTING_TAB_LANGUAGE:()=>F,SETTING_TAB_PLAY:()=>B,SETTING_TAB_SKIN:()=>$,SETTING_TAB_SUBTITLE:()=>D,SETTING_TAB_VIDEO:()=>U,TIP_DELETE:()=>u,TIP_FOLD:()=>h,TIP_FULLSCREEN:()=>n,TIP_LOOP_START:()=>o,TIP_LOOP_STOP:()=>l,TIP_PAUSE:()=>s,TIP_PIP:()=>c,TIP_PLAY:()=>r,TIP_SETTING:()=>a,TIP_UNFOLD:()=>d});const r="Play",s="Pause",a="Settings",n="Fullscreen",o="Open Loop",l="Close Loop",c="Picture In Picture",h="Fold",d="Unfold",u="Delete",f="Speed",p="Audio",m="Video",g="Subtitle",v="Add",y="Open Fold",A="Open File",b="Input Url",x="Add",w="Live",k="opening source...",T="analyzing source(${mux})...",S="loading audio decoder(${decoder})...",I="loading video decoder(${decoder})...",P="readied (`･ω･´)ゞ",_="failed (∩︵∩)",E="Stats Info",C="Source Stats Info",M="Settings",R="Decoder",B="Play",D="Subtitle",U="Picture",L="Sound",N="Filter",O="Shortcut",F="Language",$="Skin"},6204:(t,e,i)=>{"use strict";i.d(e,{A:()=>l});var r=i(93269),s=i(69094),a=i(8507),n=i(11302);const o={chinese:1,chinese_traditional:1,english:1};function l(){let t=a.mA(location.search).language;switch(o[t]||(t=n.Jt(n.f7),t||(t=(navigator.systemLanguage||navigator.browserLanguage||navigator.userLanguage||navigator.language).toLowerCase(),t=t.indexOf("en")>-1?"english":t.indexOf("zh-hk")>-1||t.indexOf("zh-tw")>-1?"chinese_traditional":(t.indexOf("zh"),"chinese")),n.hZ(n.f7,t)),t){case"chinese":default:return r;case"english":return s}}},53924:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});var r=i(82042);const s={name:"slider",model:"value",template:i.n(r)(),propTypes:{value:{type:"number",required:!0},max:{type:"number",value:100},min:{type:"number",value:0},step:{type:"number",value:1},direction:{type:"string",value:"vertical"}},data:function(){return{startX:0,startY:0,start:!1}},computed:{offset:function(){return"vertical"===this.get("direction")?`top: ${100*(1-this.get("value")/this.get("max"))}%`:`right: ${100*(1-this.get("value")/this.get("max"))}%`}},methods:{mousedown:function(t){this.set("startX",t.originalEvent.screenX),this.set("startY",t.originalEvent.screenY),this.set("start",!0)},mousemove:function(t){if(!this.get("start"))return;const e=this.get("startX"),i=this.get("startY");let r=0;const s=this.get("direction"),a=this.get("step");if("vertical"===s){const e=this.$refs.slider.offsetHeight;r=-(t.screenY-i)/e*this.get("max")*a}else if("horizontal"===s){const i=this.$refs.slider.offsetWidth;r=(t.screenX-e)/i*this.get("max")*a}let n=this.get("value")+r;n<this.get("min")&&(n=this.get("min")),n>this.get("max")&&(n=this.get("max")),this.set("value",Math.round(n)),this.set("startX",t.screenX),this.set("startY",t.screenY)},mouseup:function(){this.get("start")&&this.set("start",!1)}},afterMount(){this.onmouseup=t=>{this.mouseup()},this.onmousemove=t=>{this.mousemove(t)},document.addEventListener("mouseup",this.onmouseup),document.addEventListener("mousemove",this.onmousemove)},beforeDestroy(){document.removeEventListener("mouseup",this.onmouseup),document.removeEventListener("mousemove",this.onmousemove)}}},66521:(t,e,i)=>{"use strict";i.d(e,{Hh:()=>d,M_:()=>u,qd:()=>a});var r=i(54001),s=i.n(r);const a="libmedia_folder_root",n="libmedia_db",o="store";let l,c;async function h(){return c=new(s())(((t,e)=>{const i=indexedDB.open(n,1);i.onupgradeneeded=function(t){l=t.target.result,l.objectStoreNames.contains(o)||l.createObjectStore(o,{keyPath:"id",autoIncrement:!0}).createIndex("name","name",{unique:!1})},i.onsuccess=function(e){l=e.target.result,t()},i.onerror=function(t){e(t)}})),c}async function d(t){return l||(c?await c:await h()),new(s())(((e,i)=>{const r=l.transaction([o],"readwrite").objectStore(o).index("name").get(t);r.onsuccess=function(t){var i;e(null===(i=t.target.result)||void 0===i?void 0:i.data)},r.onerror=function(t){i(t)}}))}async function u(t,e){return l||(c?await c:await h()),new(s())(((i,r)=>{const s=l.transaction([o],"readwrite").objectStore(o),a=s.index("name").get(t);a.onsuccess=function(a){if(a.target.result){const n=s.put({id:a.target.result.id,name:t,data:e});n.onsuccess=function(){i()},n.onerror=function(t){r(t)}}else{const a=s.put({name:t,data:e});a.onsuccess=function(){i()},a.onerror=function(t){r(t)}}},a.onerror=function(t){r(t)}}))}},64804:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});const r={on:function(t,e,i){setTimeout((function(){document.addEventListener("click",e.onOutside=function(i){let r=i.target;r.parentNode&&!t.contains(r)&&e(i)})}),0)},off:function(t,e,i){e.onOutside&&(document.removeEventListener("click",e.onOutside),e.onOutside=null)}}},11302:(t,e,i)=>{"use strict";i.d(e,{Jt:()=>l,Yt:()=>a,f7:()=>s,hZ:()=>o,vd:()=>n,xc:()=>r});const r="libmedia_volume",s="libmedia_system_language",a="libmedia_play_rate",n="libmedia_play_loop";function o(t,e){localStorage.setItem(t,e)}function l(t,e){const i=localStorage.getItem(t);return null==i?e:i}},34268:(t,e,i)=>{"use strict";var r=i(134),s=i(54001),a=i.n(s),n=i(84149),o=i(87503),l=i(67672),c=i(4624),h=i(44690);const d=h.A.windows||h.A.mac||h.A.linux?10:20;class u extends o.A{constructor(){super(),(0,r.A)(this,"pullIPC",void 0),(0,r.A)(this,"frontBuffer",void 0),(0,r.A)(this,"backBuffer",void 0),(0,r.A)(this,"channels",void 0),(0,r.A)(this,"backBufferOffset",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"frontBuffered",void 0),(0,r.A)(this,"pause",void 0),(0,r.A)(this,"firstRendered",void 0),(0,r.A)(this,"stopped",void 0),(0,r.A)(this,"afterPullResolve",void 0),this.ended=!1,this.pause=!0,this.ipcPort.on(n.S3,(async t=>{switch(t.method){case"init":this.ipcPort.reply(t);break;case"start":{const{port:e,channels:i}=t.params;this.channels=i,this.pullIPC=new n.Ay(e);const r=[],s=[];await this.pull(r),await this.pull(s),this.frontBuffer=s,this.backBuffer=r,this.backBufferOffset=0,this.ended=!1,this.frontBuffered=!0,this.pause=!1,this.firstRendered=!1,this.stopped=!1,this.ipcPort.reply(t);break}case"restart":{if(!this.ended)return void this.ipcPort.reply(t);const e=[],i=[];await this.pull(e),await this.pull(i),this.frontBuffer=i,this.backBuffer=e,this.backBufferOffset=0,this.ended=!1,this.frontBuffered=!0,this.pause=!1,this.firstRendered=!1,this.stopped=!1,this.ipcPort.reply(t);break}case"clear":this.backBufferOffset=d,this.ipcPort.reply(t);break;case"stop":this.ended||this.pause||await new(a())((t=>{this.afterPullResolve=t})),this.stopped=!0,this.pullIPC.destroy(),this.ipcPort.reply(t);break;case"pause":this.pause=!0,this.ipcPort.reply(t);break;case"unpause":this.pause=!1,this.ipcPort.reply(t)}}))}async pull(t){const e=await this.pullIPC.request("pullBuffer",{nbSamples:128*d});if(l.ai(e))this.ended=!0;else{const i=new Float32Array(e);for(let e=0;e<this.channels;e++)t[e]=i.subarray(e*d*128,(e+1)*d*128)}this.afterPullResolve&&this.afterPullResolve()}swapBuffer(){return!!this.frontBuffered&&(this.backBuffer=this.frontBuffer,this.backBufferOffset=0,this.frontBuffer=[],this.frontBuffered=!1,this.pull(this.frontBuffer).then((()=>{this.frontBuffered=!0})),!0)}process(t,e,i){if(this.stopped)return!1;if(this.backBuffer&&!this.pause){if(this.backBufferOffset===d){if(this.ended)return this.backBuffer=null,this.frontBuffer=null,c.pq("audio source ended","src/avrender/pcm/AudioSourceWorkletProcessor.ts",199),this.ipcPort.notify("ended"),!0;if(!this.swapBuffer())return this.ipcPort.notify("stutter"),!0}const t=e[0];for(let e=0;e<this.channels;e++)t[e].set(this.backBuffer[e].subarray(128*this.backBufferOffset,128*(this.backBufferOffset+1)),0);this.backBufferOffset++,this.firstRendered||(this.firstRendered=!0,this.ipcPort.notify("firstRendered"))}return!0}}registerProcessor("audio-source-processor",u)},5676:(t,e,i)=>{"use strict";var r=i(134),s=i(54001),a=i.n(s),n=i(63939),o=i(50932),l=i(84149),c=i(87503),h=i(11473),d=i(37837),u=i(4624),f=i(44690);const p=f.A.windows||f.A.mac||f.A.linux?10:20;class m extends c.A{constructor(){super(),(0,r.A)(this,"pullIPC",void 0),(0,r.A)(this,"frontBuffer",void 0),(0,r.A)(this,"backBuffer",void 0),(0,r.A)(this,"channels",void 0),(0,r.A)(this,"backBufferOffset",void 0),(0,r.A)(this,"ended",void 0),(0,r.A)(this,"frontBuffered",void 0),(0,r.A)(this,"firstRendered",void 0),(0,r.A)(this,"float32",void 0),(0,r.A)(this,"pause",void 0),(0,r.A)(this,"stopped",void 0),(0,r.A)(this,"afterPullResolve",void 0),this.ended=!1,this.pause=!0,this.ipcPort.on(l.S3,(async t=>{switch(t.method){case"init":{const{memory:e}=t.params;await(0,h.Tg)({memory:e,disableAsm:!0}),this.ipcPort.reply(t);break}case"start":{const{port:e,channels:i}=t.params;this.channels=i,this.pullIPC=new l.Ay(e);const r=this.allocBuffer(),s=this.allocBuffer();await this.pullIPC.request("pull",{buffer:s}),await this.pullIPC.request("pull",{buffer:r}),this.frontBuffer=r,this.backBuffer=s,this.backBufferOffset=0,this.ended=!1,this.pause=!1,this.frontBuffered=!0,this.firstRendered=!1,this.stopped=!1,this.float32=new Float32Array((0,h.eq)().buffer),this.ipcPort.reply(t);break}case"restart":{if(!this.ended)return void this.ipcPort.reply(t);const e=this.allocBuffer(),i=this.allocBuffer();await this.pullIPC.request("pull",{buffer:i}),await this.pullIPC.request("pull",{buffer:e}),this.frontBuffer=e,this.backBuffer=i,this.backBufferOffset=0,this.ended=!1,this.pause=!1,this.frontBuffered=!0,this.firstRendered=!1,this.stopped=!1,this.float32=new Float32Array((0,h.eq)().buffer),this.ipcPort.reply(t);break}case"stop":this.ended||this.pause||await new(a())((t=>{this.afterPullResolve=t})),this.freeBuffer(this.backBuffer),this.freeBuffer(this.frontBuffer),this.backBuffer=0,this.frontBuffer=0,this.stopped=!0,this.pullIPC.destroy(),this.ipcPort.reply(t);break;case"clear":this.backBufferOffset=p,this.ipcPort.reply(t);break;case"pause":this.pause=!0,this.ipcPort.reply(t);break;case"unpause":this.pause=!1,this.ipcPort.reply(t)}}))}allocBuffer(){const t=(0,d.Gy)(40);o.M[20](t,(0,d.Gy)(4*this.channels));const e=(0,d.Gy)(512*p*this.channels);for(let i=0;i<this.channels;i++)o.M[20](n.f[20](t)+4*i,e+128*p*4*i);return o.M[15](t+12,128*p),t}freeBuffer(t){t&&((0,d.aI)(n.f[20](t)),(0,d.aI)(t),(0,d.Eb)(t))}async pull(){await this.pullIPC.request("pull",{buffer:this.frontBuffer})<0&&(this.ended=!0),this.afterPullResolve&&this.afterPullResolve()}swapBuffer(){if(!this.frontBuffered)return!1;{const t=this.backBuffer;this.backBuffer=this.frontBuffer,this.frontBuffer=t,this.backBufferOffset=0}return this.frontBuffered=!1,this.pull().then((()=>{this.frontBuffered=!0})),!0}process(t,e,i){if(this.stopped)return!1;if(this.backBuffer&&!this.pause){if(this.backBufferOffset===p){if(this.ended)return this.freeBuffer(this.backBuffer),this.freeBuffer(this.frontBuffer),this.backBuffer=0,this.frontBuffer=0,u.pq("audio source ended","src/avrender/pcm/AudioSourceWorkletProcessor2.ts",239),this.ipcPort.notify("ended"),!0;if(!this.swapBuffer())return this.ipcPort.notify("stutter"),!0}const t=e[0];for(let e=0;e<this.channels;e++)t[e].set(this.float32.subarray((n.f[20](n.f[20](this.backBuffer)+4*e)>>>2)+128*this.backBufferOffset,(n.f[20](n.f[20](this.backBuffer)+4*e)>>>2)+128*(this.backBufferOffset+1)),0);this.backBufferOffset++,this.firstRendered||(this.firstRendered=!0,this.ipcPort.notify("firstRendered"))}return!0}}registerProcessor("audio-source-processor",m)},87503:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(134),s=i(84149);class a extends AudioWorkletProcessor{constructor(){super(),(0,r.A)(this,"ipcPort",void 0),this.ipcPort=new s.Ay(this.port)}async request(t,e,i){return this.ipcPort.request(t,e,i)}notify(t,e,i){this.ipcPort.notify(t,e,i)}}},37149:(t,e,i)=>{i(18355),t.exports=i(46438).Array.isArray},87172:(t,e,i)=>{i(23204),t.exports=i(46438).Date.now},85079:(t,e,i)=>{var r=i(46438),s=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},92861:(t,e,i)=>{i(78978),i(97863),i(7914),i(96050),i(28337),i(74674),i(62223),t.exports=i(46438).Map},63342:(t,e,i)=>{i(5882),t.exports=i(46438).Number.isInteger},11837:(t,e,i)=>{i(21489),t.exports=i(46438).Number.isNaN},19737:(t,e,i)=>{i(56477),t.exports=i(46438).Number.parseFloat},58886:(t,e,i)=>{i(15706),t.exports=i(46438).Number.parseInt},92696:(t,e,i)=>{i(74712);var r=i(46438).Object;t.exports=function(t,e,i){return r.defineProperty(t,e,i)}},22948:(t,e,i)=>{i(51780),t.exports=i(46438).Object.freeze},62160:(t,e,i)=>{i(18128),t.exports=i(46438).Object.getPrototypeOf},47567:(t,e,i)=>{i(96847),t.exports=i(46438).Object.keys},21724:(t,e,i)=>{i(4284),t.exports=i(46438).Object.setPrototypeOf},27279:(t,e,i)=>{i(95828),t.exports=i(46438).parseFloat},25216:(t,e,i)=>{i(65331),t.exports=i(46438).parseInt},34750:(t,e,i)=>{i(78978),i(97863),i(7914),i(91229),i(2639),i(46121),t.exports=i(46438).Promise},31707:(t,e,i)=>{i(66801),t.exports=i(46438).setImmediate},16560:(t,e,i)=>{i(19626),i(78978),i(42860),i(60716),t.exports=i(46438).Symbol},54220:(t,e,i)=>{i(97863),i(7914),t.exports=i(84336).f("iterator")},39967:(t,e,i)=>{t.exports=i(84336).f("toPrimitive")},48652:(t,e,i)=>{i(78978),t.exports=i(84336).f("toStringTag")},25219:t=>{t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},12560:t=>{t.exports=function(){}},2832:t=>{t.exports=function(t,e,i,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(i+": incorrect invocation!");return t}},80812:(t,e,i)=>{var r=i(24401);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},77076:(t,e,i)=>{var r=i(95838);t.exports=function(t,e){var i=[];return r(t,!1,i.push,i,e),i}},84448:(t,e,i)=>{var r=i(65133),s=i(70181),a=i(72917);t.exports=function(t){return function(e,i,n){var o,l=r(e),c=s(l.length),h=a(n,c);if(t&&i!=i){for(;c>h;)if((o=l[h++])!=o)return!0}else for(;c>h;h++)if((t||h in l)&&l[h]===i)return t||h||0;return!t&&-1}}},48219:(t,e,i)=>{var r=i(58852),s=i(7001),a=i(66310),n=i(70181),o=i(99244);t.exports=function(t,e){var i=1==t,l=2==t,c=3==t,h=4==t,d=6==t,u=5==t||d,f=e||o;return function(e,o,p){for(var m,g,v=a(e),y=s(v),A=r(o,p,3),b=n(y.length),x=0,w=i?f(e,b):l?f(e,0):void 0;b>x;x++)if((u||x in y)&&(g=A(m=y[x],x,v),t))if(i)w[x]=g;else if(g)switch(t){case 3:return!0;case 5:return m;case 6:return x;case 2:w.push(m)}else if(h)return!1;return d?-1:c||h?h:w}}},49742:(t,e,i)=>{var r=i(24401),s=i(15461),a=i(30254)("species");t.exports=function(t){var e;return s(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!s(e.prototype)||(e=void 0),r(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},99244:(t,e,i)=>{var r=i(49742);t.exports=function(t,e){return new(r(t))(e)}},44968:(t,e,i)=>{var r=i(93417),s=i(30254)("toStringTag"),a="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),s))?i:a?r(e):"Object"==(n=r(e))&&"function"==typeof e.callee?"Arguments":n}},93417:t=>{var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},95933:(t,e,i)=>{"use strict";var r=i(78423).f,s=i(22087),a=i(30953),n=i(58852),o=i(2832),l=i(95838),c=i(88839),h=i(20322),d=i(45274),u=i(58219),f=i(75172).fastKey,p=i(6096),m=u?"_s":"size",g=function(t,e){var i,r=f(e);if("F"!==r)return t._i[r];for(i=t._f;i;i=i.n)if(i.k==e)return i};t.exports={getConstructor:function(t,e,i,c){var h=t((function(t,r){o(t,h,e,"_i"),t._t=e,t._i=s(null),t._f=void 0,t._l=void 0,t[m]=0,null!=r&&l(r,i,t[c],t)}));return a(h.prototype,{clear:function(){for(var t=p(this,e),i=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete i[r.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var i=p(this,e),r=g(i,t);if(r){var s=r.n,a=r.p;delete i._i[r.i],r.r=!0,a&&(a.n=s),s&&(s.p=a),i._f==r&&(i._f=s),i._l==r&&(i._l=a),i[m]--}return!!r},forEach:function(t){p(this,e);for(var i,r=n(t,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(r(i.v,i.k,this);i&&i.r;)i=i.p},has:function(t){return!!g(p(this,e),t)}}),u&&r(h.prototype,"size",{get:function(){return p(this,e)[m]}}),h},def:function(t,e,i){var r,s,a=g(t,e);return a?a.v=i:(t._l=a={i:s=f(e,!0),k:e,v:i,p:r=t._l,n:void 0,r:!1},t._f||(t._f=a),r&&(r.n=a),t[m]++,"F"!==s&&(t._i[s]=a)),t},getEntry:g,setStrong:function(t,e,i){c(t,e,(function(t,i){this._t=p(t,e),this._k=i,this._l=void 0}),(function(){for(var t=this,e=t._k,i=t._l;i&&i.r;)i=i.p;return t._t&&(t._l=i=i?i.n:t._t._f)?h(0,"keys"==e?i.k:"values"==e?i.v:[i.k,i.v]):(t._t=void 0,h(1))}),i?"entries":"values",!i,!0),d(e)}}},5874:(t,e,i)=>{var r=i(44968),s=i(77076);t.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");return s(this)}}},99373:(t,e,i)=>{"use strict";var r=i(66670),s=i(88535),a=i(75172),n=i(81984),o=i(2677),l=i(30953),c=i(95838),h=i(2832),d=i(24401),u=i(1356),f=i(78423).f,p=i(48219)(0),m=i(58219);t.exports=function(t,e,i,g,v,y){var A=r[t],b=A,x=v?"set":"add",w=b&&b.prototype,k={};return m&&"function"==typeof b&&(y||w.forEach&&!n((function(){(new b).entries().next()})))?(b=e((function(e,i){h(e,b,t,"_c"),e._c=new A,null!=i&&c(i,v,e[x],e)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(t){var e="add"==t||"set"==t;!(t in w)||y&&"clear"==t||o(b.prototype,t,(function(i,r){if(h(this,b,t),!e&&y&&!d(i))return"get"==t&&void 0;var s=this._c[t](0===i?0:i,r);return e?this:s}))})),y||f(b.prototype,"size",{get:function(){return this._c.size}})):(b=g.getConstructor(e,t,v,x),l(b.prototype,i),a.NEED=!0),u(b,t),k[t]=b,s(s.G+s.W+s.F,k),y||g.setStrong(b,t,v),b}},46438:t=>{var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)},58852:(t,e,i)=>{var r=i(25219);t.exports=function(t,e,i){if(r(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,r){return t.call(e,i,r)};case 3:return function(i,r,s){return t.call(e,i,r,s)}}return function(){return t.apply(e,arguments)}}},87608:t=>{t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},58219:(t,e,i)=>{t.exports=!i(81984)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},3802:(t,e,i)=>{var r=i(24401),s=i(66670).document,a=r(s)&&r(s.createElement);t.exports=function(t){return a?s.createElement(t):{}}},77956:t=>{t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},36473:(t,e,i)=>{var r=i(54311),s=i(59820),a=i(36569);t.exports=function(t){var e=r(t),i=s.f;if(i)for(var n,o=i(t),l=a.f,c=0;o.length>c;)l.call(t,n=o[c++])&&e.push(n);return e}},88535:(t,e,i)=>{var r=i(66670),s=i(46438),a=i(58852),n=i(2677),o=i(75509),l="prototype",c=function(t,e,i){var h,d,u,f=t&c.F,p=t&c.G,m=t&c.S,g=t&c.P,v=t&c.B,y=t&c.W,A=p?s:s[e]||(s[e]={}),b=A[l],x=p?r:m?r[e]:(r[e]||{})[l];for(h in p&&(i=e),i)(d=!f&&x&&void 0!==x[h])&&o(A,h)||(u=d?x[h]:i[h],A[h]=p&&"function"!=typeof x[h]?i[h]:v&&d?a(u,r):y&&x[h]==u?function(t){var e=function(e,i,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,r)}return t.apply(this,arguments)};return e[l]=t[l],e}(u):g&&"function"==typeof u?a(Function.call,u):u,g&&((A.virtual||(A.virtual={}))[h]=u,t&c.R&&b&&!b[h]&&n(b,h,u)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},81984:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},95838:(t,e,i)=>{var r=i(58852),s=i(27904),a=i(12828),n=i(80812),o=i(70181),l=i(55298),c={},h={},d=t.exports=function(t,e,i,d,u){var f,p,m,g,v=u?function(){return t}:l(t),y=r(i,d,e?2:1),A=0;if("function"!=typeof v)throw TypeError(t+" is not iterable!");if(a(v)){for(f=o(t.length);f>A;A++)if((g=e?y(n(p=t[A])[0],p[1]):y(t[A]))===c||g===h)return g}else for(m=v.call(t);!(p=m.next()).done;)if((g=s(m,y,p.value,e))===c||g===h)return g};d.BREAK=c,d.RETURN=h},66670:t=>{var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},75509:t=>{var e={}.hasOwnProperty;t.exports=function(t,i){return e.call(t,i)}},2677:(t,e,i)=>{var r=i(78423),s=i(86260);t.exports=i(58219)?function(t,e,i){return r.f(t,e,s(1,i))}:function(t,e,i){return t[e]=i,t}},76260:(t,e,i)=>{var r=i(66670).document;t.exports=r&&r.documentElement},32484:(t,e,i)=>{t.exports=!i(58219)&&!i(81984)((function(){return 7!=Object.defineProperty(i(3802)("div"),"a",{get:function(){return 7}}).a}))},20709:t=>{t.exports=function(t,e,i){var r=void 0===i;switch(e.length){case 0:return r?t():t.call(i);case 1:return r?t(e[0]):t.call(i,e[0]);case 2:return r?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},7001:(t,e,i)=>{var r=i(93417);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},12828:(t,e,i)=>{var r=i(20210),s=i(30254)("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||a[s]===t)}},15461:(t,e,i)=>{var r=i(93417);t.exports=Array.isArray||function(t){return"Array"==r(t)}},25194:(t,e,i)=>{var r=i(24401),s=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&s(t)===t}},24401:t=>{t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},27904:(t,e,i)=>{var r=i(80812);t.exports=function(t,e,i,s){try{return s?e(r(i)[0],i[1]):e(i)}catch(e){var a=t.return;throw void 0!==a&&r(a.call(t)),e}}},48248:(t,e,i)=>{"use strict";var r=i(22087),s=i(86260),a=i(1356),n={};i(2677)(n,i(30254)("iterator"),(function(){return this})),t.exports=function(t,e,i){t.prototype=r(n,{next:s(1,i)}),a(t,e+" Iterator")}},88839:(t,e,i)=>{"use strict";var r=i(74742),s=i(88535),a=i(61331),n=i(2677),o=i(20210),l=i(48248),c=i(1356),h=i(66123),d=i(30254)("iterator"),u=!([].keys&&"next"in[].keys()),f="keys",p="values",m=function(){return this};t.exports=function(t,e,i,g,v,y,A){l(i,e,g);var b,x,w,k=function(t){if(!u&&t in P)return P[t];switch(t){case f:case p:return function(){return new i(this,t)}}return function(){return new i(this,t)}},T=e+" Iterator",S=v==p,I=!1,P=t.prototype,_=P[d]||P["@@iterator"]||v&&P[v],E=_||k(v),C=v?S?k("entries"):E:void 0,M="Array"==e&&P.entries||_;if(M&&(w=h(M.call(new t)))!==Object.prototype&&w.next&&(c(w,T,!0),r||"function"==typeof w[d]||n(w,d,m)),S&&_&&_.name!==p&&(I=!0,E=function(){return _.call(this)}),r&&!A||!u&&!I&&P[d]||n(P,d,E),o[e]=E,o[T]=m,v)if(b={values:S?E:k(p),keys:y?E:k(f),entries:C},A)for(x in b)x in P||a(P,x,b[x]);else s(s.P+s.F*(u||I),e,b);return b}},27899:(t,e,i)=>{var r=i(30254)("iterator"),s=!1;try{var a=[7][r]();a.return=function(){s=!0},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var i=!1;try{var a=[7],n=a[r]();n.next=function(){return{done:i=!0}},a[r]=function(){return n},t(a)}catch(t){}return i}},20322:t=>{t.exports=function(t,e){return{value:e,done:!!t}}},20210:t=>{t.exports={}},74742:t=>{t.exports=!0},75172:(t,e,i)=>{var r=i(19191)("meta"),s=i(24401),a=i(75509),n=i(78423).f,o=0,l=Object.isExtensible||function(){return!0},c=!i(81984)((function(){return l(Object.preventExtensions({}))})),h=function(t){n(t,r,{value:{i:"O"+ ++o,w:{}}})},d=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,r)){if(!l(t))return"F";if(!e)return"E";h(t)}return t[r].i},getWeak:function(t,e){if(!a(t,r)){if(!l(t))return!0;if(!e)return!1;h(t)}return t[r].w},onFreeze:function(t){return c&&d.NEED&&l(t)&&!a(t,r)&&h(t),t}}},53792:(t,e,i)=>{var r=i(66670),s=i(8036).set,a=r.MutationObserver||r.WebKitMutationObserver,n=r.process,o=r.Promise,l="process"==i(93417)(n);t.exports=function(){var t,e,i,c=function(){var r,s;for(l&&(r=n.domain)&&r.exit();t;){s=t.fn,t=t.next;try{s()}catch(r){throw t?i():e=void 0,r}}e=void 0,r&&r.enter()};if(l)i=function(){n.nextTick(c)};else if(!a||r.navigator&&r.navigator.standalone)if(o&&o.resolve){var h=o.resolve(void 0);i=function(){h.then(c)}}else i=function(){s.call(r,c)};else{var d=!0,u=document.createTextNode("");new a(c).observe(u,{characterData:!0}),i=function(){u.data=d=!d}}return function(r){var s={fn:r,next:void 0};e&&(e.next=s),t||(t=s,i()),e=s}}},11642:(t,e,i)=>{"use strict";var r=i(25219);function s(t){var e,i;this.promise=new t((function(t,r){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=r})),this.resolve=r(e),this.reject=r(i)}t.exports.f=function(t){return new s(t)}},22087:(t,e,i)=>{var r=i(80812),s=i(90082),a=i(77956),n=i(4566)("IE_PROTO"),o=function(){},l="prototype",c=function(){var t,e=i(3802)("iframe"),r=a.length;for(e.style.display="none",i(76260).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;r--;)delete c[l][a[r]];return c()};t.exports=Object.create||function(t,e){var i;return null!==t?(o[l]=r(t),i=new o,o[l]=null,i[n]=t):i=c(),void 0===e?i:s(i,e)}},78423:(t,e,i)=>{var r=i(80812),s=i(32484),a=i(10752),n=Object.defineProperty;e.f=i(58219)?Object.defineProperty:function(t,e,i){if(r(t),e=a(e,!0),r(i),s)try{return n(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},90082:(t,e,i)=>{var r=i(78423),s=i(80812),a=i(54311);t.exports=i(58219)?Object.defineProperties:function(t,e){s(t);for(var i,n=a(e),o=n.length,l=0;o>l;)r.f(t,i=n[l++],e[i]);return t}},81033:(t,e,i)=>{var r=i(36569),s=i(86260),a=i(65133),n=i(10752),o=i(75509),l=i(32484),c=Object.getOwnPropertyDescriptor;e.f=i(58219)?c:function(t,e){if(t=a(t),e=n(e,!0),l)try{return c(t,e)}catch(t){}if(o(t,e))return s(!r.f.call(t,e),t[e])}},36309:(t,e,i)=>{var r=i(65133),s=i(1743).f,a={}.toString,n="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return n&&"[object Window]"==a.call(t)?function(t){try{return s(t)}catch(t){return n.slice()}}(t):s(r(t))}},1743:(t,e,i)=>{var r=i(85081),s=i(77956).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,s)}},59820:(t,e)=>{e.f=Object.getOwnPropertySymbols},66123:(t,e,i)=>{var r=i(75509),s=i(66310),a=i(4566)("IE_PROTO"),n=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=s(t),r(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?n:null}},85081:(t,e,i)=>{var r=i(75509),s=i(65133),a=i(84448)(!1),n=i(4566)("IE_PROTO");t.exports=function(t,e){var i,o=s(t),l=0,c=[];for(i in o)i!=n&&r(o,i)&&c.push(i);for(;e.length>l;)r(o,i=e[l++])&&(~a(c,i)||c.push(i));return c}},54311:(t,e,i)=>{var r=i(85081),s=i(77956);t.exports=Object.keys||function(t){return r(t,s)}},36569:(t,e)=>{e.f={}.propertyIsEnumerable},47331:(t,e,i)=>{var r=i(88535),s=i(46438),a=i(81984);t.exports=function(t,e){var i=(s.Object||{})[t]||Object[t],n={};n[t]=e(i),r(r.S+r.F*a((function(){i(1)})),"Object",n)}},49709:(t,e,i)=>{var r=i(66670).parseFloat,s=i(24269).trim;t.exports=1/r(i(80459)+"-0")!=-1/0?function(t){var e=s(String(t),3),i=r(e);return 0===i&&"-"==e.charAt(0)?-0:i}:r},15722:(t,e,i)=>{var r=i(66670).parseInt,s=i(24269).trim,a=i(80459),n=/^[-+]?0[xX]/;t.exports=8!==r(a+"08")||22!==r(a+"0x16")?function(t,e){var i=s(String(t),3);return r(i,e>>>0||(n.test(i)?16:10))}:r},41704:t=>{t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},61037:(t,e,i)=>{var r=i(80812),s=i(24401),a=i(11642);t.exports=function(t,e){if(r(t),s(e)&&e.constructor===t)return e;var i=a.f(t);return(0,i.resolve)(e),i.promise}},86260:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},30953:(t,e,i)=>{var r=i(2677);t.exports=function(t,e,i){for(var s in e)i&&t[s]?t[s]=e[s]:r(t,s,e[s]);return t}},61331:(t,e,i)=>{t.exports=i(2677)},643:(t,e,i)=>{"use strict";var r=i(88535),s=i(25219),a=i(58852),n=i(95838);t.exports=function(t){r(r.S,t,{from:function(t){var e,i,r,o,l=arguments[1];return s(this),(e=void 0!==l)&&s(l),null==t?new this:(i=[],e?(r=0,o=a(l,arguments[2],2),n(t,!1,(function(t){i.push(o(t,r++))}))):n(t,!1,i.push,i),new this(i))}})}},44398:(t,e,i)=>{"use strict";var r=i(88535);t.exports=function(t){r(r.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},32074:(t,e,i)=>{var r=i(24401),s=i(80812),a=function(t,e){if(s(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=i(58852)(Function.call,i(81033).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return a(t,i),e?t.__proto__=i:r(t,i),t}}({},!1):void 0),check:a}},45274:(t,e,i)=>{"use strict";var r=i(66670),s=i(46438),a=i(78423),n=i(58219),o=i(30254)("species");t.exports=function(t){var e="function"==typeof s[t]?s[t]:r[t];n&&e&&!e[o]&&a.f(e,o,{configurable:!0,get:function(){return this}})}},1356:(t,e,i)=>{var r=i(78423).f,s=i(75509),a=i(30254)("toStringTag");t.exports=function(t,e,i){t&&!s(t=i?t:t.prototype,a)&&r(t,a,{configurable:!0,value:e})}},4566:(t,e,i)=>{var r=i(96308)("keys"),s=i(19191);t.exports=function(t){return r[t]||(r[t]=s(t))}},96308:(t,e,i)=>{var r=i(46438),s=i(66670),a="__core-js_shared__",n=s[a]||(s[a]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:i(74742)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},85614:(t,e,i)=>{var r=i(80812),s=i(25219),a=i(30254)("species");t.exports=function(t,e){var i,n=r(t).constructor;return void 0===n||null==(i=r(n)[a])?e:s(i)}},43172:(t,e,i)=>{var r=i(49383),s=i(87608);t.exports=function(t){return function(e,i){var a,n,o=String(s(e)),l=r(i),c=o.length;return l<0||l>=c?t?"":void 0:(a=o.charCodeAt(l))<55296||a>56319||l+1===c||(n=o.charCodeAt(l+1))<56320||n>57343?t?o.charAt(l):a:t?o.slice(l,l+2):n-56320+(a-55296<<10)+65536}}},24269:(t,e,i)=>{var r=i(88535),s=i(87608),a=i(81984),n=i(80459),o="["+n+"]",l=RegExp("^"+o+o+"*"),c=RegExp(o+o+"*$"),h=function(t,e,i){var s={},o=a((function(){return!!n[t]()||"​"!="​"[t]()})),l=s[t]=o?e(d):n[t];i&&(s[i]=l),r(r.P+r.F*o,"String",s)},d=h.trim=function(t,e){return t=String(s(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(c,"")),t};t.exports=h},80459:t=>{t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},8036:(t,e,i)=>{var r,s,a,n=i(58852),o=i(20709),l=i(76260),c=i(3802),h=i(66670),d=h.process,u=h.setImmediate,f=h.clearImmediate,p=h.MessageChannel,m=h.Dispatch,g=0,v={},y="onreadystatechange",A=function(){var t=+this;if(v.hasOwnProperty(t)){var e=v[t];delete v[t],e()}},b=function(t){A.call(t.data)};u&&f||(u=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return v[++g]=function(){o("function"==typeof t?t:Function(t),e)},r(g),g},f=function(t){delete v[t]},"process"==i(93417)(d)?r=function(t){d.nextTick(n(A,t,1))}:m&&m.now?r=function(t){m.now(n(A,t,1))}:p?(a=(s=new p).port2,s.port1.onmessage=b,r=n(a.postMessage,a,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(r=function(t){h.postMessage(t+"","*")},h.addEventListener("message",b,!1)):r=y in c("script")?function(t){l.appendChild(c("script"))[y]=function(){l.removeChild(this),A.call(t)}}:function(t){setTimeout(n(A,t,1),0)}),t.exports={set:u,clear:f}},72917:(t,e,i)=>{var r=i(49383),s=Math.max,a=Math.min;t.exports=function(t,e){return(t=r(t))<0?s(t+e,0):a(t,e)}},49383:t=>{var e=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:e)(t)}},65133:(t,e,i)=>{var r=i(7001),s=i(87608);t.exports=function(t){return r(s(t))}},70181:(t,e,i)=>{var r=i(49383),s=Math.min;t.exports=function(t){return t>0?s(r(t),9007199254740991):0}},66310:(t,e,i)=>{var r=i(87608);t.exports=function(t){return Object(r(t))}},10752:(t,e,i)=>{var r=i(24401);t.exports=function(t,e){if(!r(t))return t;var i,s;if(e&&"function"==typeof(i=t.toString)&&!r(s=i.call(t)))return s;if("function"==typeof(i=t.valueOf)&&!r(s=i.call(t)))return s;if(!e&&"function"==typeof(i=t.toString)&&!r(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},19191:t=>{var e=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+i).toString(36))}},80218:(t,e,i)=>{var r=i(66670).navigator;t.exports=r&&r.userAgent||""},6096:(t,e,i)=>{var r=i(24401);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},67816:(t,e,i)=>{var r=i(66670),s=i(46438),a=i(74742),n=i(84336),o=i(78423).f;t.exports=function(t){var e=s.Symbol||(s.Symbol=a?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||o(e,t,{value:n.f(t)})}},84336:(t,e,i)=>{e.f=i(30254)},30254:(t,e,i)=>{var r=i(96308)("wks"),s=i(19191),a=i(66670).Symbol,n="function"==typeof a;(t.exports=function(t){return r[t]||(r[t]=n&&a[t]||(n?a:s)("Symbol."+t))}).store=r},55298:(t,e,i)=>{var r=i(44968),s=i(30254)("iterator"),a=i(20210);t.exports=i(46438).getIteratorMethod=function(t){if(null!=t)return t[s]||t["@@iterator"]||a[r(t)]}},18355:(t,e,i)=>{var r=i(88535);r(r.S,"Array",{isArray:i(15461)})},52293:(t,e,i)=>{"use strict";var r=i(12560),s=i(20322),a=i(20210),n=i(65133);t.exports=i(88839)(Array,"Array",(function(t,e){this._t=n(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,s(1)):s(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])}),"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},23204:(t,e,i)=>{var r=i(88535);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},96050:(t,e,i)=>{"use strict";var r=i(95933),s=i(6096),a="Map";t.exports=i(99373)(a,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=r.getEntry(s(this,a),t);return e&&e.v},set:function(t,e){return r.def(s(this,a),0===t?0:t,e)}},r,!0)},5882:(t,e,i)=>{var r=i(88535);r(r.S,"Number",{isInteger:i(25194)})},21489:(t,e,i)=>{var r=i(88535);r(r.S,"Number",{isNaN:function(t){return t!=t}})},56477:(t,e,i)=>{var r=i(88535),s=i(49709);r(r.S+r.F*(Number.parseFloat!=s),"Number",{parseFloat:s})},15706:(t,e,i)=>{var r=i(88535),s=i(15722);r(r.S+r.F*(Number.parseInt!=s),"Number",{parseInt:s})},74712:(t,e,i)=>{var r=i(88535);r(r.S+r.F*!i(58219),"Object",{defineProperty:i(78423).f})},51780:(t,e,i)=>{var r=i(24401),s=i(75172).onFreeze;i(47331)("freeze",(function(t){return function(e){return t&&r(e)?t(s(e)):e}}))},18128:(t,e,i)=>{var r=i(66310),s=i(66123);i(47331)("getPrototypeOf",(function(){return function(t){return s(r(t))}}))},96847:(t,e,i)=>{var r=i(66310),s=i(54311);i(47331)("keys",(function(){return function(t){return s(r(t))}}))},4284:(t,e,i)=>{var r=i(88535);r(r.S,"Object",{setPrototypeOf:i(32074).set})},78978:()=>{},95828:(t,e,i)=>{var r=i(88535),s=i(49709);r(r.G+r.F*(parseFloat!=s),{parseFloat:s})},65331:(t,e,i)=>{var r=i(88535),s=i(15722);r(r.G+r.F*(parseInt!=s),{parseInt:s})},91229:(t,e,i)=>{"use strict";var r,s,a,n,o=i(74742),l=i(66670),c=i(58852),h=i(44968),d=i(88535),u=i(24401),f=i(25219),p=i(2832),m=i(95838),g=i(85614),v=i(8036).set,y=i(53792)(),A=i(11642),b=i(41704),x=i(80218),w=i(61037),k="Promise",T=l.TypeError,S=l.process,I=S&&S.versions,P=I&&I.v8||"",_=l[k],E="process"==h(S),C=function(){},M=s=A.f,R=!!function(){try{var t=_.resolve(1),e=(t.constructor={})[i(30254)("species")]=function(t){t(C,C)};return(E||"function"==typeof PromiseRejectionEvent)&&t.then(C)instanceof e&&0!==P.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(t){}}(),B=function(t){var e;return!(!u(t)||"function"!=typeof(e=t.then))&&e},D=function(t,e){if(!t._n){t._n=!0;var i=t._c;y((function(){for(var r=t._v,s=1==t._s,a=0,n=function(e){var i,a,n,o=s?e.ok:e.fail,l=e.resolve,c=e.reject,h=e.domain;try{o?(s||(2==t._h&&N(t),t._h=1),!0===o?i=r:(h&&h.enter(),i=o(r),h&&(h.exit(),n=!0)),i===e.promise?c(T("Promise-chain cycle")):(a=B(i))?a.call(i,l,c):l(i)):c(r)}catch(t){h&&!n&&h.exit(),c(t)}};i.length>a;)n(i[a++]);t._c=[],t._n=!1,e&&!t._h&&U(t)}))}},U=function(t){v.call(l,(function(){var e,i,r,s=t._v,a=L(t);if(a&&(e=b((function(){E?S.emit("unhandledRejection",s,t):(i=l.onunhandledrejection)?i({promise:t,reason:s}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",s)})),t._h=E||L(t)?2:1),t._a=void 0,a&&e.e)throw e.v}))},L=function(t){return 1!==t._h&&0===(t._a||t._c).length},N=function(t){v.call(l,(function(){var e;E?S.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})}))},O=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),D(e,!0))},F=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw T("Promise can't be resolved itself");(e=B(t))?y((function(){var r={_w:i,_d:!1};try{e.call(t,c(F,r,1),c(O,r,1))}catch(t){O.call(r,t)}})):(i._v=t,i._s=1,D(i,!1))}catch(t){O.call({_w:i,_d:!1},t)}}};R||(_=function(t){p(this,_,k,"_h"),f(t),r.call(this);try{t(c(F,this,1),c(O,this,1))}catch(t){O.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i(30953)(_.prototype,{then:function(t,e){var i=M(g(this,_));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=E?S.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&D(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),a=function(){var t=new r;this.promise=t,this.resolve=c(F,t,1),this.reject=c(O,t,1)},A.f=M=function(t){return t===_||t===n?new a(t):s(t)}),d(d.G+d.W+d.F*!R,{Promise:_}),i(1356)(_,k),i(45274)(k),n=i(46438)[k],d(d.S+d.F*!R,k,{reject:function(t){var e=M(this);return(0,e.reject)(t),e.promise}}),d(d.S+d.F*(o||!R),k,{resolve:function(t){return w(o&&this===n?_:this,t)}}),d(d.S+d.F*!(R&&i(27899)((function(t){_.all(t).catch(C)}))),k,{all:function(t){var e=this,i=M(e),r=i.resolve,s=i.reject,a=b((function(){var i=[],a=0,n=1;m(t,!1,(function(t){var o=a++,l=!1;i.push(void 0),n++,e.resolve(t).then((function(t){l||(l=!0,i[o]=t,--n||r(i))}),s)})),--n||r(i)}));return a.e&&s(a.v),i.promise},race:function(t){var e=this,i=M(e),r=i.reject,s=b((function(){m(t,!1,(function(t){e.resolve(t).then(i.resolve,r)}))}));return s.e&&r(s.v),i.promise}})},97863:(t,e,i)=>{"use strict";var r=i(43172)(!0);i(88839)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=r(e,i),this._i+=t.length,{value:t,done:!1})}))},19626:(t,e,i)=>{"use strict";var r=i(66670),s=i(75509),a=i(58219),n=i(88535),o=i(61331),l=i(75172).KEY,c=i(81984),h=i(96308),d=i(1356),u=i(19191),f=i(30254),p=i(84336),m=i(67816),g=i(36473),v=i(15461),y=i(80812),A=i(24401),b=i(66310),x=i(65133),w=i(10752),k=i(86260),T=i(22087),S=i(36309),I=i(81033),P=i(59820),_=i(78423),E=i(54311),C=I.f,M=_.f,R=S.f,B=r.Symbol,D=r.JSON,U=D&&D.stringify,L="prototype",N=f("_hidden"),O=f("toPrimitive"),F={}.propertyIsEnumerable,$=h("symbol-registry"),z=h("symbols"),V=h("op-symbols"),G=Object[L],W="function"==typeof B&&!!P.f,H=r.QObject,j=!H||!H[L]||!H[L].findChild,X=a&&c((function(){return 7!=T(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a}))?function(t,e,i){var r=C(G,e);r&&delete G[e],M(t,e,i),r&&t!==G&&M(G,e,r)}:M,q=function(t){var e=z[t]=T(B[L]);return e._k=t,e},Y=W&&"symbol"==typeof B.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof B},K=function(t,e,i){return t===G&&K(V,e,i),y(t),e=w(e,!0),y(i),s(z,e)?(i.enumerable?(s(t,N)&&t[N][e]&&(t[N][e]=!1),i=T(i,{enumerable:k(0,!1)})):(s(t,N)||M(t,N,k(1,{})),t[N][e]=!0),X(t,e,i)):M(t,e,i)},Q=function(t,e){y(t);for(var i,r=g(e=x(e)),s=0,a=r.length;a>s;)K(t,i=r[s++],e[i]);return t},Z=function(t){var e=F.call(this,t=w(t,!0));return!(this===G&&s(z,t)&&!s(V,t))&&(!(e||!s(this,t)||!s(z,t)||s(this,N)&&this[N][t])||e)},J=function(t,e){if(t=x(t),e=w(e,!0),t!==G||!s(z,e)||s(V,e)){var i=C(t,e);return!i||!s(z,e)||s(t,N)&&t[N][e]||(i.enumerable=!0),i}},tt=function(t){for(var e,i=R(x(t)),r=[],a=0;i.length>a;)s(z,e=i[a++])||e==N||e==l||r.push(e);return r},et=function(t){for(var e,i=t===G,r=R(i?V:x(t)),a=[],n=0;r.length>n;)!s(z,e=r[n++])||i&&!s(G,e)||a.push(z[e]);return a};W||(o((B=function(){if(this instanceof B)throw TypeError("Symbol is not a constructor!");var t=u(arguments.length>0?arguments[0]:void 0),e=function(i){this===G&&e.call(V,i),s(this,N)&&s(this[N],t)&&(this[N][t]=!1),X(this,t,k(1,i))};return a&&j&&X(G,t,{configurable:!0,set:e}),q(t)})[L],"toString",(function(){return this._k})),I.f=J,_.f=K,i(1743).f=S.f=tt,i(36569).f=Z,P.f=et,a&&!i(74742)&&o(G,"propertyIsEnumerable",Z,!0),p.f=function(t){return q(f(t))}),n(n.G+n.W+n.F*!W,{Symbol:B});for(var it="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;it.length>rt;)f(it[rt++]);for(var st=E(f.store),at=0;st.length>at;)m(st[at++]);n(n.S+n.F*!W,"Symbol",{for:function(t){return s($,t+="")?$[t]:$[t]=B(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in $)if($[e]===t)return e},useSetter:function(){j=!0},useSimple:function(){j=!1}}),n(n.S+n.F*!W,"Object",{create:function(t,e){return void 0===e?T(t):Q(T(t),e)},defineProperty:K,defineProperties:Q,getOwnPropertyDescriptor:J,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var nt=c((function(){P.f(1)}));n(n.S+n.F*nt,"Object",{getOwnPropertySymbols:function(t){return P.f(b(t))}}),D&&n(n.S+n.F*(!W||c((function(){var t=B();return"[null]"!=U([t])||"{}"!=U({a:t})||"{}"!=U(Object(t))}))),"JSON",{stringify:function(t){for(var e,i,r=[t],s=1;arguments.length>s;)r.push(arguments[s++]);if(i=e=r[1],(A(e)||void 0!==t)&&!Y(t))return v(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!Y(e))return e}),r[1]=e,U.apply(D,r)}}),B[L][O]||i(2677)(B[L],O,B[L].valueOf),d(B,"Symbol"),d(Math,"Math",!0),d(r.JSON,"JSON",!0)},62223:(t,e,i)=>{i(643)("Map")},74674:(t,e,i)=>{i(44398)("Map")},28337:(t,e,i)=>{var r=i(88535);r(r.P+r.R,"Map",{toJSON:i(5874)("Map")})},2639:(t,e,i)=>{"use strict";var r=i(88535),s=i(46438),a=i(66670),n=i(85614),o=i(61037);r(r.P+r.R,"Promise",{finally:function(t){var e=n(this,s.Promise||a.Promise),i="function"==typeof t;return this.then(i?function(i){return o(e,t()).then((function(){return i}))}:t,i?function(i){return o(e,t()).then((function(){throw i}))}:t)}})},46121:(t,e,i)=>{"use strict";var r=i(88535),s=i(11642),a=i(41704);r(r.S,"Promise",{try:function(t){var e=s.f(this),i=a(t);return(i.e?e.reject:e.resolve)(i.v),e.promise}})},42860:(t,e,i)=>{i(67816)("asyncIterator")},60716:(t,e,i)=>{i(67816)("observable")},7914:(t,e,i)=>{i(52293);for(var r=i(66670),s=i(2677),a=i(20210),n=i(30254)("toStringTag"),o="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<o.length;l++){var c=o[l],h=r[c],d=h&&h.prototype;d&&!d[n]&&s(d,n,c),a[c]=a.Array}},66801:(t,e,i)=>{var r=i(88535),s=i(8036);r(r.G+r.B,{setImmediate:s.set,clearImmediate:s.clear})},14397:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});const r="precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 point;\nattribute vec4 color;\nvarying vec4 v_color;\n\nuniform mat4 rotateMatrix;\n\nvoid main(void){\n  gl_Position = rotateMatrix * vec4(point, 1.0);\n  v_color = color;\n}\n"},57914:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});const r="\nstruct Meta {\n  max: u32,\n  width: u32,\n  height: u32\n};\n\n@group(0) @binding(0) var<uniform> metaData: Meta;\n@group(0) @binding(1) var input: texture_2d<u32>;\n@group(0) @binding(2) var output: texture_storage_2d<r32float, write>;\n\n@compute @workgroup_size(8, 8) fn main(\n  @builtin(workgroup_id) workgroup_id: vec3<u32>,\n  @builtin(local_invocation_id) local_invocation_id: vec3<u32>\n) {\n  var x = workgroup_id.x * 8 + local_invocation_id.x;\n  var y = workgroup_id.y * 8 + local_invocation_id.y;\n  if (x < metaData.width && y < metaData.height) {\n    var value: u32 = textureLoad(input, vec2(x, y), 0).x;\n    var low = value & 0xff;\n    var high = (value >> 8) & 0xff;\n    value = (low << 8) | high;\n    var value_no: f32 = f32(value) / f32(metaData.max);\n    textureStore(output, vec2(x, y), vec4(value_no, 0, 0, 0));\n  }\n}"},62496:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});const r="\nstruct Meta {\n  max: u32,\n  width: u32,\n  height: u32\n};\n\n@group(0) @binding(0) var<uniform> metaData: Meta;\n@group(0) @binding(1) var input: texture_2d<u32>;\n@group(0) @binding(2) var output: texture_storage_2d<r32float, write>;\n\n@compute @workgroup_size(8, 8) fn main(\n  @builtin(workgroup_id) workgroup_id: vec3<u32>,\n  @builtin(local_invocation_id) local_invocation_id: vec3<u32>\n) {\n  var x = workgroup_id.x * 8 + local_invocation_id.x;\n  var y = workgroup_id.y * 8 + local_invocation_id.y;\n  if (x < metaData.width && y < metaData.height) {\n    var value: u32 = textureLoad(input, vec2(x, y), 0).x;\n    var value_no: f32 = f32(value) / f32(metaData.max);\n    textureStore(output, vec2(x, y), vec4(value_no, 0, 0, 0));\n  }\n}"},23195:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});const r="\n@group(0) @binding(1) var eTexture: texture_external;\n@group(0) @binding(2) var s: sampler;\n\n@fragment\nfn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n  return textureSampleBaseClampToEdge(eTexture, s, in_texcoord.xy);\n}"},54895:(t,e,i)=>{"use strict";i.d(e,{A:()=>r});const r="struct PositionColorInput {\n    @location(0) in_position_3d: vec3<f32>,\n    @location(1) in_color_rgba: vec4<f32>\n};\n\nstruct PositionColorOutput {\n    @builtin(position) coords_output: vec4<f32>,\n    @location(0) color_output: vec4<f32>\n};\n\nstruct RotateMatrix {\n    matrix: mat4x4<f32>\n};\n\n@group(0) @binding(0) var<uniform> rotateMatrix: RotateMatrix;\n\n@vertex\nfn main(input: PositionColorInput) -> PositionColorOutput {\n    var output: PositionColorOutput;\n    output.color_output = input.in_color_rgba;\n    output.coords_output = rotateMatrix.matrix * vec4<f32>(input.in_position_3d, 1.0);\n    return output;\n}"},47451:function(t){t.exports=function(){"use strict";var t="model",e="beforeCreate",i="afterCreate",r="beforeRender",s="afterRender",a="beforeMount",n="beforeUpdate",o="beforeDestroy",l="afterDestroy",c=!0,h=!1,d=null,u=void 0,f="true",p="false",m="undefined",g="component",v="function",y="length",A=".",b=typeof window!==m?window:u,x=typeof document!==m?document:u,w="tap",k="click",T="input",S="change",I="model",P=function(){},_=Object.freeze({}),E=Object.freeze([]),C="",M=/yox/.test(P.toString())?2:3,R={leftDelimiter:"{",rightDelimiter:"}",uglifyCompiled:h,minifyCompiled:h,logLevel:M};function B(t){return typeof t===v}function D(t){return Array.isArray(t)}function U(t){return t!==d&&"object"==typeof t}function L(t){return"string"==typeof t}function N(t){return"number"==typeof t&&!isNaN(t)}function O(t){return t===c||t===h}function F(t){return!isNaN(t-parseFloat(t))}var $=Object.freeze({__proto__:null,func:B,array:D,object:U,string:L,number:N,boolean:O,numeric:F});function z(t,e,i){return D(i)?t.apply(e,i):e!==u?t.call(e,i):i!==u?t(i):t()}var V=function(t,e){this.type=t,this.phase=V.PHASE_CURRENT,e&&(this.originalEvent=e)};function G(t,e,i){var r=t.length;if(r)if(i)for(var s=r-1;s>=0&&e(t[s],s)!==h;s--);else for(var a=0;a<r&&e(t[a],a)!==h;a++);}function W(t,e){t[t.length]=e}function H(t,e){t.unshift(e)}function j(t,e,i){D(e)?G(e,(function(e){i(t,e)})):i(t,e)}function X(t,e){j(t,e,W)}function q(t,e){j(t,e,H)}function Y(t,e,i){var r=-1;return G(t,(function(t,s){if(i===h?t==e:t===e)return r=s,h})),r}function K(t){var e=t.length;if(e>0)return t[e-1]}function Q(t,e,i){var r=0;return G(t,(function(s,a){(i===h?s==e:s===e)&&(t.splice(a,1),r++)}),c),r}function Z(t,e,i){return Y(t,e,i)>=0}function J(t){return D(t)?t:z(E.slice,t)}function tt(t,e,i){var r={};return G(t,(function(t){r[e?t[e]:t]=i||t})),r}function et(t,e){return t.join(e)}function it(t){return!D(t)||!t.length}V.is=function(t){return t instanceof V},V.prototype.preventDefault=function(){var t=this;if(!t.isPrevented){var e=t.originalEvent;e&&e.preventDefault(),t.isPrevented=c}return t},V.prototype.stopPropagation=function(){var t=this;if(!t.isStoped){var e=t.originalEvent;e&&e.stopPropagation(),t.isStoped=c}return t},V.prototype.prevent=function(){return this.preventDefault()},V.prototype.stop=function(){return this.stopPropagation()},V.PHASE_CURRENT=0,V.PHASE_UPWARD=1,V.PHASE_DOWNWARD=-1;var rt=Object.freeze({__proto__:null,each:G,push:X,unshift:q,indexOf:Y,last:K,pop:function(t){if(t.length>0)return t.pop()},remove:Q,has:Z,toArray:J,toObject:tt,join:et,falsy:it});function st(t,e){return t!=d&&t.toString?t.toString():e!==u?e:C}function at(t){return B(t)&&st(t).indexOf("[native code]")>=0}var nt=function(){var t=Object.create(d);return{get:function(e){return t[e]},set:function(e,i){t[e]=i},has:function(e){return e in t},keys:function(){return Object.keys(t)}}};function ot(t){var e=nt();return function(i){var r=e.get(i);if(r!==u)return r;var s=t(i);return e.set(i,s),s}}function lt(t){var e=nt();return function(i,r){var s=e.get(i);if(s){var a=s.get(r);if(a)return a}else s=nt(),e.set(i,s);var n=t(i,r);return s.set(r,n),n}}var ct=/-([a-z])/gi,ht=/\B([A-Z])/g,dt=/^[a-z]/,ut=ot((function(t){return t.replace(ct,(function(t,e){return xt(e)}))})),ft=ot((function(t){return t.replace(ht,(function(t,e){return"-"+wt(e)}))})),pt=ot((function(t){return t.replace(dt,xt)}));function mt(t){return St(t)?C:t.trim()}function gt(t,e,i){return N(i)?e===i?C:t.slice(e,i):t.slice(e)}function vt(t,e,i){return t.indexOf(e,i!==u?i:0)}function yt(t,e,i){return t.lastIndexOf(e,i!==u?i:t.length)}function At(t,e){return 0===vt(t,e)}function bt(t,e){return t.charCodeAt(e||0)}function xt(t){return t.toUpperCase()}function wt(t){return t.toLowerCase()}function kt(t,e){return vt(t,e)>=0}function Tt(t,e){var i=Object.create(d);return G(t.split(e||","),(function(t){i[t]=c})),i}function St(t){return!L(t)||!t.length}var It=Object.freeze({__proto__:null,camelize:ut,hyphenate:ft,capitalize:pt,repeat:function(t,e){return et(new Array(e+1),t)},trim:mt,slice:gt,indexOf:vt,lastIndexOf:yt,startsWith:At,endsWith:function(t,e){var i=t.length-e.length;return i>=0&&yt(t,e)===i},charAt:function(t,e){return t.charAt(e||0)},codeAt:bt,upper:xt,lower:wt,has:kt,toMap:Tt,falsy:St}),Pt=/\./g,_t=/\*/g,Et=/\*\*/g,Ct=lt((function(t,e){return t===e||At(t,e+=A)?e.length:-1})),Mt=ot((function(t){return vt(t,A)<0?[t]:t.split(A)}));function Rt(t,e){for(var i=L(t)?Mt(t):t,r=0,s=i.length-1;r<=s&&e(i[r],r,s)!==h;r++);}var Bt=lt((function(t,e){return t&&e?t+A+e:t||e})),Dt=ot((function(t){return kt(t,"*")})),Ut=ot((function(t){return new RegExp("^"+t.replace(Pt,"\\.").replace(_t,"(\\w+)").replace(Et,"([.\\w]+?)")+"$")})),Lt=lt((function(t,e){var i=t.match(Ut(e));return i?i[1]:u})),Nt={value:u};function Ot(t){return Object.keys(t)}function Ft(t,e){for(var i in t)if(e(t[i],i)===h)break}function $t(t,e){return Ft(e,(function(e,i){t[i]=e})),t}function zt(t,e){var i=t;return D(t)?e?(i=[],G(t,(function(t,r){i[r]=zt(t,e)}))):i=t.slice():U(t)&&(i={},Ft(t,(function(t,r){i[r]=e?zt(t,e):t}))),i}function Vt(t){return B(t.get)?t.get():t}function Gt(t,e,i){var r=t;return Rt(e,(function(t,e,s){if(r==d)return r=u,h;var a=r[t],n=a!==u;a&&(a=(i||Vt)(a)),e===s?n?(Nt.value=a,r=Nt):r=u:r=a})),r}function Wt(t,e){return t[e]!==u}var Ht=Object.freeze({__proto__:null,keys:Ot,each:Ft,extend:$t,merge:function(t,e){return t&&e?$t($t({},t),e):t||e},copy:zt,get:Gt,set:function(t,e,i,r){var s=t;Rt(e,(function(t,e,a){if(e===a)s[t]=i;else if(s[t])s=s[t];else{if(!r)return h;s=s[t]={}}}))},has:Wt,falsy:function(t){return!U(t)||D(t)||!Ot(t).length}}),jt=1,Xt=5,qt=typeof console!==m?console:d,Yt=b&&/edge|msie|trident/i.test(b.navigator.userAgent)?C:"%c",Kt=qt?Yt?function(t,e,i){qt.log(Yt+t,i,e)}:function(t,e){qt.log(t,e)}:P;function Qt(){var t=R.logLevel;return t>=jt&&t<=Xt?t:M}function Zt(t){return"background-color:"+t+";border-radius:12px;color:#fff;font-size:10px;padding:3px 6px;"}var Jt=Object.freeze({__proto__:null,DEBUG:jt,INFO:2,WARN:3,ERROR:4,FATAL:Xt,debug:function(t,e){Qt()<=jt&&Kt(e||"Yox debug",t,Zt("#999"))},info:function(t,e){Qt()<=2&&Kt(e||"Yox info",t,Zt("#2db7f5"))},warn:function(t,e){Qt()<=3&&Kt(e||"Yox warn",t,Zt("#f90"))},error:function(t,e){Qt()<=4&&Kt(e||"Yox error",t,Zt("#ed4014"))},fatal:function(t,e){if(Qt()<=Xt)throw new Error("["+(e||"Yox fatal")+"]: "+t)}}),te=function(t){this.ns=t||h,this.listeners={}};function ee(t,e){return t?t===e.listener:c}function ie(t,e){var i=e.ns;return i&&t?i===t:c}te.prototype.fire=function(t,e,i){var r=this,s=L(t)?r.toEvent(t):t,a=r.listeners[s.type],n=c;if(a){a=a.slice();for(var o=e&&V.is(e[0])?e[0]:u,l=0,d=a.length;l<d;l++){var f=a[l];if(ie(s.ns,f)&&Z(a,f)&&(!i||i(s,e,f))){var p=z(f.listener,f.ctx,e);if(f.num=f.num?f.num+1:1,f.num===f.max&&r.off(s.type,{ns:s.ns,listener:f.listener}),o&&(p===h?o.prevent().stop():o.isStoped&&(p=h)),p===h){n=h;break}}}}return n},te.prototype.on=function(t,e){var i=this.listeners,r=B(e)?{listener:e}:e;if(U(r)&&B(r.listener)){if(!L(r.ns)){var s=this.toEvent(t);r.ns=s.ns,t=s.type}X(i[t]||(i[t]=[]),r)}},te.prototype.off=function(t,e){var i=this,r=i.listeners;if(t){var s=i.toFilter(t,e),a=function(t,e){G(t,(function(e,i){ee(s.listener,e)&&ie(s.ns,e)&&t.splice(i,1)}),c),t.length||delete r[e]};s.type?r[s.type]&&a(r[s.type],s.type):s.ns&&Ft(r,a)}else i.listeners={}},te.prototype.has=function(t,e){var i=this.listeners,r=this.toFilter(t,e),s=c,a=function(t){return G(t,(function(t){if(ee(r.listener,t)&&ie(r.ns,t))return s=h})),s};return r.type?i[r.type]&&a(i[r.type]):r.ns&&Ft(i,a),!s},te.prototype.toEvent=function(t){var e={type:t,ns:C};if(this.ns){var i=vt(t,A);i>=0&&(e.type=gt(t,0,i),e.ns=gt(t,i+1))}return e},te.prototype.toFilter=function(t,e){var i;if(L((i=e?B(e)?{listener:e}:e:{}).ns))i.type=t;else{var r=this.toEvent(t);i.type=r.type,i.ns=r.ns}return i},typeof setImmediate===v&&at(setImmediate)&&setImmediate;var re,se=typeof MessageChannel===v&&at(MessageChannel)?function(t){var e=new MessageChannel;e.port1.onmessage=t,e.port2.postMessage(1)}:setTimeout,ae=function(t){this.tasks=[],this.hooks=t||_};function ne(t,e,i){var r;return function(){if(!r){var s=J(arguments);i&&z(t,u,s),r=setTimeout((function(){r=u,i||z(t,u,s)}),e)}}}ae.shared=function(){return re||(re=new ae)},ae.prototype.append=function(t,e){var i=this,r=i.tasks;X(r,{fn:t,ctx:e}),1===r.length&&se((function(){i.run()}))},ae.prototype.prepend=function(t,e){var i=this,r=i.tasks;q(r,{fn:t,ctx:e}),1===r.length&&se((function(){i.run()}))},ae.prototype.clear=function(){this.tasks.length=0},ae.prototype.run=function(){var t=this,e=t.tasks,i=t.hooks,r=e.length;if(r){t.tasks=[],i.beforeTask&&i.beforeTask();for(var s=0;s<r;s++)z(e[s].fn,e[s].ctx);i.afterTask&&i.afterTask()}};var oe="$vnode",le="$loading",ce="$leaving",he="$model_control",de="$model_destroy",ue="$event_destroy",fe="$directive_hooks",pe="$directive_updating";function me(t,e,i,r,s,a,n){var o=n.name,l=n.listener;if(a){var h=a[o]||a[C];h===c?o=S:h>0&&(l=ne(l,h,o===k||o===w))}if(i){if(n.isNative){var d=i.$el;return t.on(d,o,l),function(){t.off(d,o,l)}}i.on(o,n),r[ue+s]=function(){i.off(o,n),delete r[ue+s]}}else t.on(e,o,l),r[ue+s]=function(){t.off(e,s,l),delete r[ue+s]}}var ge=Object.freeze({__proto__:null,afterCreate:function(t,e){var i=e.events;if(i){var r=e.node,s=e.component,a=e.lazy,n=e.data;for(var o in i)me(t,r,s,n,o,a,i[o])}},afterUpdate:function(t,e,i){var r=e.events,s=i.events;if(r!==s){var a=e.node,n=e.component,o=e.lazy,l=e.data;if(s){var c=r||_;for(var h in s)if(!c[h]){var d=l[ue+h];d&&d()}}if(r){var u=s||_;for(var f in r){var p=r[f],m=u[f];if(m)if(p.value!==m.value){var g=l[ue+f];g&&g(),me(t,a,n,l,f,o,p)}else m.runtime&&p.runtime&&(m.runtime.execute=p.runtime.execute,p.runtime=m.runtime);else me(t,a,n,l,f,o,p)}}}},beforeDestroy:function(t,e){var i=e.events,r=e.data;if(i)for(var s in i){var a=r[ue+s];a&&a()}}});function ve(t,e){return e&&e!==c?ne(t,e):t}var ye={set:function(t,e){t.value=st(e)},sync:function(t,e,i){i.set(e,t.value)}},Ae={set:function(t,e){t.checked=t.value===st(e)},sync:function(t,e,i){t.checked&&i.set(e,t.value)}},be={set:function(t,e){t.checked=D(e)?Z(e,t.value,h):!!e},sync:function(t,e,i){var r=i.get(e);D(r)?t.checked?i.append(e,t.value):i.removeAt(e,Y(r,t.value,h)):i.set(e,t.checked)}},xe={set:function(t,e){for(var i=t.multiple,r=t.options,s=0,a=r.length;s<a;s++)if(i)r[s].selected=Z(e,r[s].value,h);else if(r[s].value==e)return void(t.selectedIndex=s);i||(t.selectedIndex=-1)},sync:function(t,e,i){var r=t.multiple,s=t.options;if(r){for(var a=[],n=0,o=s.length;n<o;n++)s[n].selected&&a.push(s[n].value);i.set(e,a)}else i.set(e,s[t.selectedIndex].value)}};function we(e,i,r,s,a){var n=a.context,o=a.model,l=a.lazy,h=a.nativeAttrs,d=o.keypath,u=o.value,f=l&&(l[t]||l[C]);if(r){var p=r.$model,m=ve((function(t){n.set(d,t)}),f);r.watch(p,m),s[de]=function(){r.unwatch(p,m),delete s[de]}}else{var g="select"===a.tag?xe:ye,v=S;if(g===ye){var y=h&&h.type;"radio"===y?g=Ae:"checkbox"===y?g=be:f!==c&&(v=I)}var A=ve((function(){g.sync(i,d,n)}),f);e.on(i,v,A),g.set(i,u),s[he]=g,s[de]=function(){e.off(i,v,A),delete s[de],delete s[he]}}}var ke=Object.freeze({__proto__:null,afterCreate:function(t,e){e.model&&we(t,e.node,e.component,e.data,e)},afterUpdate:function(t,e,i){var r=e.data,s=e.model,a=i.model;if(s){var n=e.node,o=e.component;if(a)if(s.keypath!==a.keypath)r[de](),we(t,n,o,r,e);else if(o)o.set(o.$model,s.value);else{var l=r[he];l&&l.set(n,s.value)}else we(t,n,o,r,e)}else a&&r[de]()},beforeDestroy:function(t,e){var i=e.data[de];i&&i()}});var Te=Object.freeze({__proto__:null,afterCreate:function(t,e){var i=e.nativeAttrs;if(i){var r=e.node;for(var s in i)t.setAttr(r,s,i[s])}},afterUpdate:function(t,e,i){var r=e.nativeAttrs,s=i.nativeAttrs;if(r!==s){var a=e.node;if(r){var n=s||_;for(var o in r)n[o]!==u&&r[o]===n[o]||t.setAttr(a,o,r[o])}if(s){var l=r||_;for(var c in s)l[c]===u&&t.removeAttr(a,c)}}}});var Se=Object.freeze({__proto__:null,afterCreate:function(t,e){var i=e.nativeStyles;if(i){var r=e.node.style;for(var s in i)t.setStyle(r,s,i[s])}},afterUpdate:function(t,e,i){var r=e.nativeStyles,s=i.nativeStyles;if(r!==s){var a=e.node.style;if(r){var n=s||_;for(var o in r)n[o]!==u&&r[o]===n[o]||t.setStyle(a,o,r[o])}if(s){var l=r||_;for(var c in s)l[c]===u&&t.removeStyle(a,c)}}}});function Ie(t,e,i){t[fe+i.name]=i.create(e.component||e.node,i,e)}function Pe(t,e,i,r){var s=t[fe+i.name],a=s&&s[r];a&&a(i,e)}function _e(t){return function(e,i){var r=i.directives;if(r){var s=i.data;for(var a in r)Pe(s,i,r[a],t)}}}var Ee=_e("afterMount"),Ce=_e("beforeDestroy"),Me=Object.freeze({__proto__:null,afterCreate:function(t,e){var i=e.directives;if(i){var r=e.data;for(var s in i)Ie(r,e,i[s])}},beforeUpdate:function(t,e,i){var r=e.directives,s=i.directives,a=e.data;if(s){var n=r||_;for(var o in s)n[o]===u&&Pe(a,e,s[o],"beforeDestroy")}if(r){var l=s||_,c=[];for(var h in r){var d=r[h];l[h]===u?Ie(a,e,d):d.value!==l[h].value&&(Pe(a,e,d,"beforeUpdate"),c.push(d))}a[pe]=c}},afterUpdate:function(t,e,i){var r=e.data;if(r){var s=r[pe];if(s){for(var a=0,n=s.length;a<n;a++)Pe(r,e,s[a],"afterUpdate");r[pe]=u}}},afterMount:Ee,beforeDestroy:Ce});function Re(t,e){if(5===e.type||7===e.type){var i=e.children[0];return i?Re(t,i):t.createComment(C)}return e.node}function Be(t,e,i,r){r?t.before(e,i,r):t.append(e,i)}function De(t,e,i){var r=i.node;e.node=r,e.parentNode=i.parentNode,e.text!==i.text&&t.setNodeText(r,e.text)}function Ue(t){t.data&&hi(t,t.node)}function Le(t,e){t.data&&di(t,t.node,e)||e()}function Ne(t,e,i,r){r?t.before(e,i.node,r.node):t.append(e,i.node)}function Oe(t,e){t.remove(e.parentNode,e.node)}function Fe(t,e){e()}function $e(t,e){for(var i=e.children,r=0,s=i.length;r<s;r++)si(t,i[r])}function ze(t,e,i,r){ui(t,e,i.children,r.children)}function Ve(t,e){for(var i=e.children,r=0,s=i.length;r<s;r++)li(t,i[r])}function Ge(t,e,i,r){for(var s=i.children,a=0,n=s.length;a<n;a++)ni(t,e,s[a],r)}function We(t,e){for(var i=e.children,r=0,s=i.length;r<s;r++)ci(t,i[r])}var He={create:function(t,e){e.node=t.createText(e.text)},update:De,destroy:P,insert:Ne,remove:Oe,enter:P,leave:Fe},je={create:function(t,e){e.node=t.createComment(e.text)},update:De,destroy:P,insert:Ne,remove:Oe,enter:P,leave:Fe},Xe=[Te,Se,Object.freeze({__proto__:null,afterCreate:function(t,e){var i=e.ref;if(i){var r=e.context,s=r.$refs;s||(s=r.$refs={}),s[i]=e.component||e.node}},beforeUpdate:function(t,e,i){var r=e.ref,s=i.ref;if(r||s){var a=e.context,n=e.component||e.node,o=a.$refs;r?s?r!==s&&(o?o[r]===n&&delete o[r]:o=a.$refs={},o[r]=n):(o||(o=a.$refs={}),o[r]=n):o&&s&&o[s]===n&&delete o[s]}},beforeDestroy:function(t,e){var i=e.ref;if(i){var r=e.context.$refs,s=e.component||e.node;r&&r[i]===s&&delete r[i]}}}),ge,ke,Me],qe=Xe.length;function Ye(t,e){for(var i=0;i<qe;i++){var r=Xe[i][t];r&&r.apply(u,e)}}var Ke={create:function(t,e){var i=e.node=t.createElement(e.tag,e.isSvg);e.children?ai(t,i,e.children):e.text?t.setElementText(i,e.text):e.html&&t.setHtml(i,e.html),e.isPure||(e.data={}),Ye("afterCreate",[t,e])},update:function(t,e,i){var r=i.node;e.node=r,e.parentNode=i.parentNode,e.data=i.data,!e.isPure&&i.isPure&&(e.data={}),Ye("beforeUpdate",[t,e,i]);var s=e.text,a=e.html,n=e.children,o=i.text,l=i.html,c=i.children;L(s)?(c&&oi(t,c),s!==o&&t.setElementText(r,s)):L(a)?(c&&oi(t,c),a!==l&&t.setHtml(r,a)):n?c?n!==c&&ui(t,r,n,c):((o||l)&&t.setElementText(r,C),ai(t,r,n)):c?oi(t,c):(o||l)&&t.setElementText(r,C),Ye("afterUpdate",[t,e,i])},destroy:function(t,e){if(!e.isPure){Ye("beforeDestroy",[t,e]);var i=e.children;if(i)for(var r=0,s=i.length;r<s;r++)li(t,i[r])}},insert:Ne,remove:Oe,enter:Ue,leave:Le},Qe={create:function(t,e){var i=e.data={},r=u;e.tag&&e.context.loadComponent(e.tag,(function(s){Wt(i,le)?i[le]&&(i[oe]&&(e=i[oe],delete i[oe]),ri(t,e,s),e.operator.enter(e)):r=s})),e.node=t.createComment(g),r?ri(t,e,r):i[le]=c},update:function(t,e,i){var r=i.data;if(e.data=r,e.node=i.node,e.parentNode=i.parentNode,e.component=i.component,r[le])r[oe]=e;else{Ye("beforeUpdate",[t,e,i]);var s=e.component,a=e.slots;if(s){var n=e.props;a&&(n=$t(n||{},a)),n&&s.forceUpdate(n)}Ye("afterUpdate",[t,e,i])}},destroy:function(t,e){var i=e.component;i?(Ye("beforeDestroy",[t,e]),i.destroy(),e.shadow=i.$vnode,e.component=u):e.data[le]=h},insert:function(t,e,i,r){var s=i.shadow;s?(s.operator.insert(t,e,s,r),s.parentNode=e):Ne(t,e,i,r)},remove:function(t,e){var i=e.shadow;i?(i.operator.remove(t,i),i.parentNode=u):Oe(t,e)},enter:function(t){var e=t.shadow;e&&(t.transition?hi(t,e.node):e.operator.enter(e))},leave:function(t,e){var i=t.shadow;if(i){if(!t.transition)return void i.operator.leave(i,e);if(di(t,i.node,e))return}e()}},Ze={create:function(t,e){$e(t,e),e.node=Re(t,e)},update:function(t,e,i){var r=i.parentNode;e.node=i.node,e.parentNode=r,ze(t,r,e,i)},destroy:Ve,insert:Ge,remove:We,enter:P,leave:Fe},Je={create:function(t,e){var i=u;e.to&&(i=t.find(e.to)),i||(i=t.getBodyElement()),e.target=i,e.node=t.createComment(C);for(var r=e.children,s=0,a=r.length;s<a;s++)si(t,r[s]),ni(t,i,r[s])},update:function(t,e,i){var r=i.target;e.node=i.node,e.parentNode=i.parentNode,e.target=r,ze(t,r,e,i)},destroy:function(t,e){for(var i=e.children,r=0,s=i.length;r<s;r++)li(t,i[r]),ci(t,i[r])},insert:Ne,remove:Oe,enter:P,leave:Fe},ti={create:function(t,e){$e(t,e),e.data={},e.node=Re(t,e),Ye("afterCreate",[t,e])},update:function(t,e,i){var r=i.parentNode;e.node=i.node,e.parentNode=r,e.data=i.data,Ye("beforeUpdate",[t,e,i]),ze(t,r,e,i),Ye("afterUpdate",[t,e,i])},destroy:function(t,e){Ye("beforeDestroy",[t,e]),Ve(t,e)},insert:Ge,remove:We,enter:Ue,leave:Le};function ei(t,e){return t.type===e.type&&t.tag===e.tag&&t.key===e.key}function ii(t,e,i){for(var r,s,a;e<=i;)(s=t[e])&&(a=s.key)&&(r||(r={}),r[a]=e),e++;return r||_}function ri(t,e,i){var r=e.data,s=(e.parent||e.context).createComponent(i,e);return e.component=s,e.shadow=s.$vnode,r[le]=h,Ye("afterCreate",[t,e]),s}function si(t,e){e.node||e.operator.create(t,e)}function ai(t,e,i,r,s,a){for(var n,o=r||0,l=s!==u?s:i.length-1;o<=l;)si(t,n=i[o]),ni(t,e,n,a),o++}function ni(t,e,i,r){var s=i.operator;s.insert(t,e,i,r),i.parentNode=e,Ye("afterMount",[t,i]),s.enter(i)}function oi(t,e,i,r){for(var s,a=i||0,n=r!==u?r:e.length-1;a<=n;)(s=e[a])&&(li(t,s),ci(t,s)),a++}function li(t,e){e.operator.destroy(t,e)}function ci(t,e){var i=e.operator;i.leave(e,(function(){i.remove(t,e),e.parentNode=u}))}function hi(t,e){var i=t.context,r=t.transition,s=t.data[ce];if(s&&s(),r){var a=r.enter;a&&a.call(i,e)}}function di(t,e,i){var r=t.context,s=t.transition,a=t.data,n=a[ce];if(n&&n(),s){var o=s.leave;if(o)return o.call(r,e,a[ce]=function(){a[ce]&&(i(),a[ce]=u)}),c}}function ui(t,e,i,r){for(var s,a,n=0,o=i.length-1,l=i[n],c=i[o],h=0,d=r.length-1,f=r[h],p=r[d];h<=d&&n<=o;)l?c?f?p?ei(l,f)?(fi(t,l,f),l=i[++n],f=r[++h]):ei(c,p)?(fi(t,c,p),c=i[--o],p=r[--d]):ei(c,f)?(fi(t,c,f),Be(t,e,f.node,t.next(p.node)),c=i[--o],f=r[++h]):ei(l,p)?(fi(t,l,p),Be(t,e,p.node,f.node),l=i[++n],p=r[--d]):(s||(s=ii(r,h,d)),(a=l.key?s[l.key]:u)!==u?(pi(t,l,r[a]),r[a]=u):si(t,l),ni(t,e,l,f),l=i[++n]):p=r[--d]:f=r[++h]:c=i[--o]:l=i[++n];h>d?ai(t,e,i,n,o,i[o+1]):n>o&&oi(t,r,h,d)}function fi(t,e,i){e!==i&&e.operator.update(t,e,i)}function pi(t,e,i){if(e!==i){if(!ei(e,i)){var r=i.parentNode;return si(t,e),void(r&&(ni(t,r,e,i),li(t,i),ci(t,i)))}fi(t,e,i)}}function mi(t){var e=t.children;return{type:t.type,data:t.data,node:t.node,parentNode:t.parentNode,target:t.target,shadow:t.shadow,parent:t.parent,component:t.component,context:t.context,operator:t.operator,tag:t.tag,isSvg:t.isSvg,isStatic:t.isStatic,isPure:t.isPure,slots:t.slots,props:t.props,nativeAttrs:t.nativeAttrs,nativeStyles:t.nativeStyles,directives:t.directives,events:t.events,lazy:t.lazy,transition:t.transition,model:t.model,to:t.to,ref:t.ref,key:t.key,text:t.text,html:t.html,children:e?e.map(mi):e}}function gi(t,e){return st(e)}function vi(t,e,i){var r=e===c||e===f||e===t;return r===i?u:r?f:p}Tt("abstract,goto,native,static,enum,implements,package,super,byte,export,import,private,protected,public,synchronized,char,extends,int,throws,class,final,interface,transient,yield,let,const,float,double,boolean,long,short,volatile,default");function yi(t){var e=t.input,i=t.getter;t.value=e?i.apply(u,e):i()}var Ai=function(){this.map={},this.list=[]};Ai.prototype.add=function(t,e){var i=this.map[t.id]||(this.map[t.id]={});i[e]||(i[e]=t,this.list.push([t,e]))},Ai.prototype.watch=function(t){var e=this.list;if(e)for(var i=0,r=e.length;i<r;i++)e[i][0].watch(e[i][1],t)},Ai.prototype.unwatch=function(t){var e=this.list;if(e)for(var i=0,r=e.length;i<r;i++)e[i][0].unwatch(e[i][1],t)};var bi=function(t,e,i,r,s,a,n,o){var l=this;l.status=1,l.keypath=t,l.cache=e,l.input=r,l.output=s,l.setter=n,l.getter=a,l.onChange=o,l.watcherOptions={sync:i,watcher:function(){l.refresh()}}};bi.prototype.get=function(){var t=this,e=t.status,i=t.watcherOptions;if(t.cache){if(2!==e)if(t.staticDeps)yi(t);else{var r=t.dynamicDeps;r&&r.unwatch(i.watcher),t.dynamicDeps=u;var s=bi.current;bi.current=t,yi(t),bi.current=s,(r=t.dynamicDeps)&&r.watch(i)}}else yi(t);return 2!==e&&(t.status=2),function(t){var e=t.value,i=t.output;return i?i(e):e}(t)},bi.prototype.set=function(t){var e=this.setter;e?e(t):B(t)&&(this.getter=t,this.refresh())},bi.prototype.refresh=function(){var t=this.value;this.status=3;var e=this.get();e!==t&&this.onChange(this.keypath,e,t)},bi.prototype.addStaticDeps=function(t,e){for(var i=this.staticDeps||(this.staticDeps=new Ai),r=0,s=e.length;r<s;r++)i.add(t,e[r]);i.watch(this.watcherOptions)},bi.prototype.addDynamicDep=function(t,e){(this.dynamicDeps||(this.dynamicDeps=new Ai)).add(t,e)};var xi=function(t,e,i){this.keypath=t,this.scopeValue=e,this.scopeKey=i};function wi(t,e,i,r,s,a,n,o,l,d){var f=C,p=[new xi(f,i)],m=[],g=function(t,e,i,r){if(t[e])t[e][i]=r;else{var s={};s[i]=r,t[e]=s}},v=function(t){var e={};return function(t,e){for(var i=t.split(";"),r=0,s=i.length;r<s;r++){var a=i[r],n=a.indexOf(":");if(n>0){var o=mt(a.substring(0,n)),l=mt(a.substring(n+1));o&&l&&e(ut(o),l)}}}(t,(function(t,i){e[t]=i})),e},y=function(t){if(D(t)){for(var e={},i=0,r=t.length;i<r;i++){var s=y(t[i]);if(s)for(var a in s)e[a]=s[a]}return e}return U(t)?t:L(t)?v(t):void 0},b=function(t,e){return e},x=function(t){return{keypath:t.keypath,value:t.value}},w=function(e,i,r){return function(s,a,n){r&&s.phase===V.PHASE_DOWNWARD||(e===s.type&&i===s.ns||((s=new V(e,n?s.originalEvent:s)).ns=i),t.fire(s,a))}},k=function(t,e,i){return function(r,s){i&&r.phase===V.PHASE_DOWNWARD||P(t,e?e.execute(r,s):s?[r,s]:[r])===h&&r.prevent().stop()}},T=function(t,e,i,r,s,a,n,o){return{key:t,value:e,name:i,ns:r,isNative:o,runtime:a,listener:k(s,a,n)}},S=function(t,e,i,r,s,a,n,o){return{key:t,value:e,name:i,ns:r,isNative:o,listener:w(s,a,n)}},I=function(t,e,i,r,s){return{ns:"o",name:e,value:r,modifier:i,create:s}},P=function(e,i){var r=t[e];return i&&i.length>0?z(r,t,i):t[e]()},_=function(t,e,i){if(U(i))for(var r in i)g(t,e,r,i[r])},E=function(t,e,i){var r=t.keypath,s=t.value,a=0,n=!!r,o=p,l=K(p).keypath;if(D(s)){a=s.length;for(var c=0;c<a;c++)n&&(l=r+A+c,(p=o.slice()).push(new xi(l,s,c))),e(p,s[c],l,a,c)}else if(U(s)){var h=Ot(s);a=h.length;for(var d=0;d<a;d++){var u=h[d];n&&(l=r+A+u,(p=o.slice()).push(new xi(l,s,u))),e(p,s[u],l,a,u)}}p!==o&&(p=o),i&&0===a&&i()},M=function(t,e,i,r,s){var a=0,n=0,o=K(p).keypath;if(t<e)if(n=e-t,i)for(var l=t;l<=e;l++)r(p,l,o,n,a++);else for(var c=t;c<e;c++)r(p,c,o,n,a++);else if(n=t-e,i)for(var h=t;h>=e;h--)r(p,h,o,n,a++);else for(var d=t;d>e;d--)r(p,d,o,n,a++);s&&0===n&&s()},R=function(t,e){d(t);var r=i[t];if(r)return r instanceof bi?e?r.getter(e):r.get():r},N=function(t,e,i,r,s,a){for(var n;e>=0;){var o=t[e],l=o.getKeypath(i),c=Gt(o.getScope(),r),h=$(c?c.value:u,l);if(c)return h;if(n||(n=h),!(s&&e>0))break;e--}return a?$(a):n},O=function(t,e,i,r){return N(t,e,i,[i],c,r)},F=function(t,e){var i=Gt(t,e);return $(i?i.value:u)},$=function(t,e){return t&&B(t.get)&&(t=t.get()),Nt.keypath=e,Nt.value=t,e!==u&&d(e),Nt};return function(e,i,c,h){e(v,y,b,x,T,S,I,_,E,M,R,g,gi,vi,N,O,F,$,st,He,je,Ke,Qe,Ze,Je,ti,t,Jt,r,s,a,n,o,l,p,i,c,h)}(e,i,f,m),m[0]}xi.prototype.getScope=function(){var t=this.scopeValue,e=this.scopeKey;return e!==u?t[e]:t},xi.prototype.getKeypath=function(t){var e=this.keypath;return e?e+A+t:t};var ki=0,Ti="textContent",Si=Ti,Ii="innerHTML",Pi="cssFloat",_i=function(t,e,i){t.addEventListener(e,i,h)},Ei=function(t,e,i){t.removeEventListener(e,i,h)},Ci=function(t,e){t.classList.add(e)},Mi=function(t,e){t.classList.remove(e)};if(x){var Ri=x.documentElement;Pi in Ri.style||(Pi="styleFloat"),Ri.classList||(Ci=function(t,e){var i=t.className.split(Bi);Z(i,e)||(X(i,e),t.className=et(i,Bi))},Mi=function(t,e){var i=t.className.split(Bi);Q(i,e)&&(t.className=et(i,Bi))}),Ri=u}var Bi=" ",Di="$event",Ui="compositionstart",Li="compositionend",Ni="http://www.w3.org/2000/svg",Oi={},Fi={},$i={},zi={};function Vi(t){return x.createComment(t)}function Gi(t,e){t.appendChild(e)}zi[I]={on:function(t,e){var i=h;qi(t,Ui,e[Ui]=function(){i=c}),qi(t,Li,e[Li]=function(t){i=h,e(t)}),_i(t,T,e[T]=function(t){i||e(t)})},off:function(t,e){Yi(t,Ui,e[Ui]),Yi(t,Li,e[Li]),Ei(t,T,e[T]),e[Ui]=e[Li]=e[T]=u}};var Wi=function(t){var e=x.querySelector(t);if(e)return e};function Hi(t){return t[Ii]}var ji=Ci,Xi=Mi;function qi(t,e,i){var r=t[Di]||(t[Di]=++ki),s=Fi[r]||(Fi[r]={}),a=$i[r]||($i[r]={}),n=a[e]||(a[e]=[]);if(!s[e]){var o=zi[e],l=function(t){var i;V.is(t)?(i=t).type!==e&&(i.type=e):i=new V(e,function(t,e){return t}(t));for(var r=n.slice(),s=0,a=r.length;s<a;s++)r[s](i,u,c)};s[e]=l,Oi[r]?Oi[r]++:Oi[r]=1,o?o.on(t,l):_i(t,e,l)}n.push(i)}function Yi(t,e,i){var r=t[Di],s=Fi[r],a=$i[r],n=a&&a[e];if(n&&(Q(n,i),n.length||(n=u,delete a[e])),s&&s[e]&&!n){var o=zi[e],l=s[e];o?o.off(t,l):Ei(t,e,l),delete s[e],Oi[r]&&Oi[r]--}Oi[r]||(t[Di]=u,delete Fi[r],delete $i[r])}var Ki=Object.freeze({__proto__:null,getBodyElement:function(){return x.body},createElement:function(t,e){return e?x.createElementNS(Ni,t):x.createElement(t)},createText:function(t){return x.createTextNode(t)},createComment:Vi,getAttr:function(t,e){var i=t.getAttribute(e);if(i!=d)return i},setAttr:function(t,e,i){i===u?t.removeAttribute(e):t.setAttribute(e,i)},removeAttr:function(t,e){t.removeAttribute(e)},setStyle:function(t,e,i){i!=d?t["float"===e?Pi:e]=i:t[e]=C},removeStyle:function(t,e){t[e]=C},before:function(t,e,i){t.insertBefore(e,i)},append:Gi,replace:function(t,e,i){t.replaceChild(e,i)},remove:function(t,e){t.removeChild(e)},parent:function(t){var e=t.parentNode;if(e)return e},next:function(t){var e=t.nextSibling;if(e)return e},find:Wi,tag:function(t){if(1===t.nodeType)return wt(t.tagName)},getNodeText:function(t){return t[Ti]},setNodeText:function(t,e){t[Ti]=e},getElementText:function(t){return t[Si]},setElementText:function(t,e){t[Si]=e},getHtml:Hi,setHtml:function(t,e){t[Ii]=e},addClass:ji,removeClass:Xi,on:qi,off:Yi,addSpecialEvent:function(t,e){zi[t]=e}});function Qi(t,e){return F(t)?+t:e!==u?e:0}function Zi(t,e){if(t==d||e===C)return t;var i=Gt(t,e);return i?i.value:void 0}function Ji(t,e,i,r,s,a){var n=function(e,i,n){if(i!==n){for(var o=Bt(t,e),l=0;l<s;l++){var c=r[l];Lt(o,c)!==u&&a(c,o,i,n)}Ji(o,i,n,r,s,a)}};(function(t,e,i){var r=L(t),s=L(e);if(r||s)return i(y,r?t.length:u,s?e.length:u),c})(e,i,n)||function(t,e,i){var r=D(t),s=D(e);if(r||s){var a=r?t.length:u,n=s?e.length:u;i(y,a,n);for(var o=0,l=Math.max(a||0,n||0);o<l;o++)i(C+o,r?t[o]:u,s?e[o]:u);return c}}(e,i,n)||function(t,e,i){var r=U(t),s=U(e);if(r||s){var a=nt(),n=r?t:_,o=s?e:_;if(r)for(var l in n){var h=n[l];h!==o[l]&&(a.set(l,c),i(l,h,o[l]))}if(s)for(var d in o){var f=o[d];a.get(d)===u&&f!==n[d]&&i(d,n[d],f)}}}(e,i,n)}function tr(t,e,i,r,s,a){var n;for(var o in r)if(Dt(o))Lt(t,o)!==u?a(o,t,e,i):s&&(n?n.push(o):n=[o]);else{var l=Ct(o,t);if(l>=0){var c=gt(o,l),h=Zi(e,c),d=Zi(i,c);h!==d&&a(o,o,h,d)}}n&&Ji(t,e,i,n,n.length,a)}var er={watcher:P};function ir(t,e){return B(t)?(er.watcher=t,er.immediate=e===c,er):t}var rr=0,sr=function(t,e,i){var r=this;r.id=rr++,r.data=t||{},r.context=e||r,r.nextTask=i||new ae,r.syncEmitter=new te,r.asyncEmitter=new te,r.asyncOldValues={},r.asyncKeypaths={},r.onComputedChange=function(t,e,i){r.diff(t,e,i)}};sr.prototype.get=function(t,e,i){var r=this.data,s=bi.current;if(t===C)return r;s&&!i&&s.addDynamicDep(this,t);var a=Gt(r,t);return a?a.value:e},sr.prototype.set=function(t,e){var i=this,r=i.data,s=function(t,e){var s,a=i.get(t);e!==a&&(Rt(t,(function(t,i,a){if(0!==i)s&&(i===a?s[t]=e:s=s[t]||(s[t]={}));else{var n=r[t];n&&n instanceof bi?0===a?n.set(e):s=n.get():0===a?r[t]=e:s=r[t]||(r[t]={})}})),i.diff(t,e,a))};if(L(t))s(t,e);else if(U(t))for(var a in t)s(a,t[a])},sr.prototype.diff=function(t,e,i){var r=this,s=r.syncEmitter,a=r.asyncEmitter,n=r.asyncOldValues,o=r.asyncKeypaths,l=36!==bt(t);tr(t,e,i,s.listeners,l,(function(t,e,i,r){s.fire({type:t,ns:C},[i,r,e])})),tr(t,e,i,a.listeners,l,(function(t,e,i,s){for(var l=a.listeners[t],h=0,d=l.length;h<d;h++)l[h].count++;o[e]||(n[e]=s,o[e]={}),o[e][t]=c,r.pending||(r.pending=c,r.nextTask.append((function(){r.pending&&r.diffAsync()})))}))},sr.prototype.diffAsync=function(){var t=this,e=t.asyncEmitter,i=t.asyncOldValues,r=t.asyncKeypaths;t.pending=u,t.asyncOldValues={},t.asyncKeypaths={};var s=function(s){var a=[t.get(s),i[s],s],n=r[s],o=a[0]!==a[1],l=function(t,e,i){if(i.count)return i.count--,o};for(var c in n)e.fire({type:c,ns:C},a,l)};for(var a in i)s(a)},sr.prototype.addComputed=function(t,e){var i,r,s,a,n,o=this,l=o.context,h=c,d=c;if(B(e))s=e.bind(l);else if(U(e)){var u=e;O(u.cache)&&(h=u.cache),O(u.sync)&&(d=u.sync),D(u.deps)&&(i=u.deps),it(u.input)||(r=u.input),B(u.output)&&(n=u.output),B(u.get)&&(s=u.get.bind(l)),B(u.set)&&(a=u.set.bind(l))}if(s){var f=new bi(t,h,d,r,n,s,a,o.onComputedChange);return h&&i&&f.addStaticDeps(o,i),o.data[t]=f}},sr.prototype.removeComputed=function(t){delete this.data[t]},sr.prototype.watch=function(t,e,i){var r=this,s=r.context,a=r.syncEmitter,n=r.asyncEmitter,o=function(t,e){var i=e.sync?a:n,o={ns:C,listener:e.watcher,ctx:s,count:0};e.once&&(o.max=1),i.on(t,o),e.immediate&&e.watcher.call(s,r.get(t),u,t)};if(L(t))o(t,ir(e,i));else for(var l in t)o(l,ir(t[l]))},sr.prototype.unwatch=function(t,e){this.syncEmitter.off(t,e),this.asyncEmitter.off(t,e)},sr.prototype.toggle=function(t){var e=!this.get(t);return this.set(t,e),e},sr.prototype.increase=function(t,e,i){var r=Qi(this.get(t),0)+(e||1);if(!N(i)||r<=i)return this.set(t,r),r},sr.prototype.decrease=function(t,e,i){var r=Qi(this.get(t),0)-(e||1);if(!N(i)||r>=i)return this.set(t,r),r},sr.prototype.insert=function(t,e,i){var r=this.get(t),s=(r=D(r)?r.slice():[]).length;if(i===c||i===s)r.push(e);else if(i===h||0===i)r.unshift(e);else{if(!(i>0&&i<s))return;r.splice(i,0,e)}return this.set(t,r),c},sr.prototype.append=function(t,e){return this.insert(t,e,c)},sr.prototype.prepend=function(t,e){return this.insert(t,e,h)},sr.prototype.removeAt=function(t,e){var i=this.get(t);if(D(i)&&e>=0&&e<i.length)return(i=i.slice()).splice(e,1),this.set(t,i),c},sr.prototype.remove=function(t,e){var i=this.get(t);if(D(i)&&Q(i=i.slice(),e))return this.set(t,i),c},sr.prototype.copy=function(t,e){return zt(t,e)},sr.prototype.destroy=function(){var t=this;t.syncEmitter.off(),t.asyncEmitter.off(),t.nextTask.clear(),t.data={}};var ar=function(){this.$emitter=new te};ar.prototype.fire=function(t,e,i){this.$emitter.fire(e,[t,i])},ar.prototype.on=function(t,e){return this.$emitter.on(t,e),this},ar.prototype.off=function(t,e){return this.$emitter.off(t,e),this};var nr={},or={},lr={},cr={},hr=/^[#.][-\w+]+$/,dr=new ar,ur="$$template",fr={watcher:function(t){this.update(t,this.$vnode)},sync:c},pr=function(t){return t?t.map(mi):t},mr=function(t){var r=this,s=t||_;r.$emitter=new te(c),s.events&&r.on(s.events),s.parent&&(r.$parent=s.parent);var a=s[e];a&&a.call(r,s),dr.fire(r,e,{options:s});var n=s.data,o=s.props,l=s.vnode,d=s.propTypes,f=s.computed,p=s.methods,m=s.watchers,y=s.extensions;r.$options=s,y&&$t(r,y);var A=o?zt(o):{};d&&Ft(d,(function(t,e){var i=A[e];i===u&&(i=t.value)!==u&&(A[e]=t.type===v?i:B(i)?i():i)}));var b=r.$observer=new sr(A,r,r.$nextTask=new ae);f&&Ft(f,(function(t,e){b.addComputed(e,t)}));var x=B(n)?n.call(r,t):n;U(x)&&Ft(x,(function(t,e){A[e]=t})),p&&Ft(p,(function(t,e){r[e]=t}));var w=u,k=s.el,T=s.root,S=s.model,I=s.context,P=s.replace,E=s.template,M=s.transitions,R=s.components,D=s.directives,N=s.filters,O=s.slots;if(S&&(r.$model=S),L(E)&&hr.test(E)&&(w=Wi(E))&&(E=Hi(w),w=u),k){if(L(k)){var F=k;hr.test(F)&&(w=Wi(F))}else w=k;P||Gi(w,w=Vi(C))}if(T&&(r.$root=T),I&&(r.$context=I),xr(r,"transition",M),xr(r,g,R),xr(r,"directive",D),xr(r,"filter",N),E){if(m&&b.watch(m),O)for(var $ in O)b.addComputed($,{get:O[$],input:[r],output:pr});b.addComputed(ur,{get:r.render,sync:h}),b.watch(ur,fr);var z=s[i];return z&&z.call(r),dr.fire(r,i),r.$template=L(E)?mr.compile(E):E,l||(l=function(t,e,i){var r={context:i,node:e,parentNode:t.parent(e)};switch(e.nodeType){case 1:r.data={},r.tag=t.tag(e),r.type=3,r.operator=Ke;break;case 3:r.isPure=c,r.text=e.nodeValue,r.type=1,r.operator=He;break;case 8:r.isPure=c,r.text=e.nodeValue,r.type=2,r.operator=je}return r}(Ki,w,r)),void r.update(r.get(ur),l)}m&&b.watch(m);var V=s[i];V&&V.call(r),dr.fire(r,i)};mr.define=function(t){return t},mr.use=function(t){t.install(mr)},mr.nextTick=function(t,e){ae.shared().append(t,e)},mr.compile=function(t,e){return t},mr.directive=function(t,e){if(L(t)&&!e)return yr(nr,t);br(nr,t,e)},mr.transition=function(t,e){if(L(t)&&!e)return yr(or,t);br(or,t,e)},mr.component=function(t,e){if(L(t)&&!e)return yr(lr,t);br(lr,t,e)},mr.filter=function(t,e){if(L(t)&&!e)return yr(cr,t);br(cr,t,e)},mr.method=function(t,e){if(L(t)&&!e)return gr[t];br(gr,t,e)},mr.prototype.get=function(t,e){return this.$observer.get(t,e)},mr.prototype.set=function(t,e){var i=this.$observer;i&&i.set(t,e)},mr.prototype.on=function(t,e){return kr(this,t,e),this},mr.prototype.once=function(t,e){return kr(this,t,e,c),this},mr.prototype.off=function(t,e){return this.$emitter.off(t,e),this},mr.prototype.fire=function(t,e,i){var r,s=this,a=s.$emitter,n=s.$parent,o=s.$children;if(V.is(t))r=t;else if(L(t))r=new V(t);else{var l=t;(r=new V(l.type)).ns=l.ns}if(r.ns===u){var h=a.toEvent(r.type);r.type=h.type,r.ns=h.ns}r.target||(r.target=s);var d,f=[r];return U(e)?X(f,e):e===c&&(i=c),(d=i&&r.target===s?c:a.fire(r,f))&&(i?o&&(r.phase=V.PHASE_DOWNWARD,G(o,(function(t){return d=t.fire(r,e,c)}))):n&&(r.phase=V.PHASE_UPWARD,d=n.fire(r,e))),d},mr.prototype.watch=function(t,e,i){return this.$observer.watch(t,e,i),this},mr.prototype.unwatch=function(t,e){return this.$observer.unwatch(t,e),this},mr.prototype.loadComponent=function(t,e){vr(this.$components,t,e)||vr(lr,t,e)},mr.prototype.createComponent=function(t,e){var i=this;(t=zt(t)).root=i.$root||i,t.parent=i,t.context=e.context,t.vnode=e,t.replace=c;var r=e.props,s=e.slots,a=e.model;if(a){r||(r={});var n=t.model||"value";r[n]=a.value,t.model=n}r&&(t.props=r),s&&(t.slots=s);var o=new mr(t);X(i.$children||(i.$children=[]),o);var l=o.$el;return l&&(e.node=l),o},mr.prototype.directive=function(t,e){var i=this.$directives;if(L(t)&&!e)return yr(i,t,mr.directive);br(i||(this.$directives={}),t,e)},mr.prototype.transition=function(t,e){var i=this.$transitions;if(L(t)&&!e)return yr(i,t,mr.transition);br(i||(this.$transitions={}),t,e)},mr.prototype.component=function(t,e){var i=this.$components;if(L(t)&&!e)return yr(i,t,mr.component);br(i||(this.$components={}),t,e)},mr.prototype.filter=function(t,e){var i=this.$filters;if(L(t)&&!e)return yr(i,t,mr.filter);br(i||(this.$filters={}),t,e)},mr.prototype.forceUpdate=function(t){var e=this,i=e.$options,r=e.$vnode,s=e.$nextTask;if(r){if(t){var a=i.beforePropsUpdate;a&&a.call(e,t),e.set(t)}s.run(),t||r!==e.$vnode||e.update(e.get(ur),r)}},mr.prototype.render=function(){var t=this,e=t.$options,i=t.$observer,a=i.data,n=e[r],o=e[s];n&&n.call(t,a),dr.fire(t,r,{props:a});var l=wi(t,t.$template,a,t.$filters,cr,t.$directives,nr,t.$transitions,or,(function(t){var e=bi.current;e&&e.addDynamicDep(i,t)}));return o&&o.call(t),dr.fire(t,s),l},mr.prototype.update=function(t,e){var i,r=this,s=r.$vnode,o=r.$options;if(s){var l=o[n];l&&l.call(r),dr.fire(r,n),pi(Ki,t,e),i="afterUpdate"}else{var c=o[a];c&&c.call(r),dr.fire(r,a),pi(Ki,t,e),r.$el=t.node,i="afterMount"}r.$vnode=t,mr.nextTick((function(){if(r.$vnode){var t=o[i];t&&t.call(r),dr.fire(r,i)}}))},mr.prototype.checkProp=function(t,e){},mr.prototype.destroy=function(){var t=this,e=t.$parent,i=t.$options,r=t.$emitter,s=t.$observer,a=i[o];a&&a.call(t),dr.fire(t,o),e&&e.$children&&Q(e.$children,t);var n,c,h,d=t.$vnode;d&&(h=!e,li(n=Ki,c=d),h&&ci(n,c)),s.destroy();var f=i[l];f&&f.call(t),dr.fire(t,l),r.off(),t.$el=u},mr.prototype.nextTick=function(t){this.$nextTask.append(t,this)},mr.prototype.toggle=function(t){return this.$observer.toggle(t)},mr.prototype.increase=function(t,e,i){return this.$observer.increase(t,e,i)},mr.prototype.decrease=function(t,e,i){return this.$observer.decrease(t,e,i)},mr.prototype.insert=function(t,e,i){return this.$observer.insert(t,e,i)},mr.prototype.append=function(t,e){return this.$observer.append(t,e)},mr.prototype.prepend=function(t,e){return this.$observer.prepend(t,e)},mr.prototype.removeAt=function(t,e){return this.$observer.removeAt(t,e)},mr.prototype.remove=function(t,e){return this.$observer.remove(t,e)},mr.prototype.copy=function(t,e){return this.$observer.copy(t,e)},mr.version="1.0.0-alpha.408",mr.is=$,mr.dom=Ki,mr.array=rt,mr.object=Ht,mr.string=It,mr.logger=Jt,mr.Event=V,mr.Emitter=te,mr.lifeCycle=dr,mr.config=R;var gr=mr.prototype;function vr(t,e,i){if(t&&t[e]){var r=t[e];if(B(r)){t[e]=[i];var s=function(i){var r=t[e],s=i.default||i;t[e]=s,G(r,(function(t){t(s)}))},a=r(s);a&&a.then(s)}else D(r)?X(r,i):i(r);return c}}function yr(t,e,i){return t&&t[e]?t[e]:i?i(e):void 0}function Ar(t,e,i,r){r&&r.format&&(i=r.format(i)),t[e]=i}function br(t,e,i,r){L(e)?Ar(t,e,i,r):Ft(e,(function(e,i){Ar(t,i,e,r)}))}function xr(t,e,i){B(i)?t[e](i.call(t)):U(i)&&t[e](i)}function wr(t,e,i){t.$emitter.on(e.type,{listener:e.listener,ns:e.ns,max:i?1:-1,ctx:t})}function kr(t,e,i,r){var s=t.$emitter;L(e)?wr(t,s.toFilter(e,i),r):D(e)?G(e,(function(e){wr(t,e,r)})):Ft(e,(function(e,i){wr(t,s.toFilter(i,e),r)}))}return tt(Ot(gr)),mr}()},5679:t=>{t.exports="AGFzbQEAAAABKQhgAn9/AGACf34AYAJ/fQBgAn98AGABfwF/YAF/AX5gAX8BfWABfwF8AhIBA2VudgZtZW1vcnkCAwGAgAQDDw4AAAABAgMEBAQEBAUGBweIAQ4Gd3JpdGU4AAAHd3JpdGUxNgABB3dyaXRlMzIAAgd3cml0ZTY0AAMId3JpdGVmMzIABAh3cml0ZWY2NAAFBXJlYWQ4AAYGcmVhZFU4AAcGcmVhZDE2AAgHcmVhZFUxNgAJBnJlYWQzMgAKBnJlYWQ2NAALB3JlYWRmMzIADAdyZWFkZjY0AA0KfQ4JACAAIAE6AAALCQAgACABOwEACwkAIAAgATYCAAsJACAAIAE3AwALCQAgACABOAIACwkAIAAgATkDAAsHACAALAAACwcAIAAtAAALBwAgAC4BAAsHACAALwEACwcAIAAoAgALBwAgACkDAAsHACAAKgIACwcAIAArAwAL"},19985:t=>{t.exports="AGFzbQEAAAABLAdgAX8Bf2ABfwF+YAJ/fwF/YAJ/fgF+YAN/f38Bf2ADf35+AX5gA39/fgF/AhIBA2VudgZtZW1vcnkCAwGAgAQDKCcAAAABAgICAwICAgMCAgIDAgICAwICAgMCAgIDAgICAwQEBAUCAgYHhgMnBWxvYWQ4AAAGbG9hZDE2AAEGbG9hZDMyAAIGbG9hZDY0AAMGc3RvcmU4AAQHc3RvcmUxNgAFB3N0b3JlMzIABgdzdG9yZTY0AAcEYWRkOAAIBWFkZDE2AAkFYWRkMzIACgVhZGQ2NAALBHN1YjgADAVzdWIxNgANBXN1YjMyAA4Fc3ViNjQADwRhbmQ4ABAFYW5kMTYAEQVhbmQzMgASBWFuZDY0ABMDb3I4ABQEb3IxNgAVBG9yMzIAFgRvcjY0ABcEeG9yOAAYBXhvcjE2ABkFeG9yMzIAGgV4b3I2NAAbCWV4Y2hhbmdlOAAcCmV4Y2hhbmdlMTYAHQpleGNoYW5nZTMyAB4KZXhjaGFuZ2U2NAAfEWNvbXBhcmVfZXhjaGFuZ2U4ACASY29tcGFyZV9leGNoYW5nZTE2ACESY29tcGFyZV9leGNoYW5nZTMyACISY29tcGFyZV9leGNoYW5nZTY0ACMGbm90aWZ5ACQEd2FpdAAlC3dhaXRUaW1lb3V0ACYKugMnCAAgAP4SAAALCAAgAP4TAQALCAAgAP4QAgALCAAgAP4RAwALDAAgACAB/hkAACABCwwAIAAgAf4aAQAgAQsMACAAIAH+FwIAIAELDAAgACAB/hgDACABCwoAIAAgAf4gAAALCgAgACAB/iEBAAsKACAAIAH+HgIACwoAIAAgAf4fAwALCgAgACAB/icAAAsKACAAIAH+KAEACwoAIAAgAf4lAgALCgAgACAB/iYDAAsKACAAIAH+LgAACwoAIAAgAf4vAQALCgAgACAB/iwCAAsKACAAIAH+LQMACwoAIAAgAf41AAALCgAgACAB/jYBAAsKACAAIAH+MwIACwoAIAAgAf40AwALCgAgACAB/jwAAAsKACAAIAH+PQEACwoAIAAgAf46AgALCgAgACAB/jsDAAsKACAAIAH+QwAACwoAIAAgAf5EAQALCgAgACAB/kECAAsKACAAIAH+QgMACwwAIAAgASAC/koAAAsMACAAIAEgAv5LAQALDAAgACABIAL+SAIACwwAIAAgASAC/kkDAAsKACAAIAH+AAIACwwAIAAgAUJ//gECAAsMACAAIAEgAv4BAgAL"},35112:t=>{t.exports="AGFzbQEAAAABEANgAX8Bf2ABfwBgAn9/AX8CWQYDZW52Bm1lbW9yeQIDAYCABANlbnYGbWFsbG9jAAADZW52BGZyZWUAAQNlbnYGY2FsbG9jAAIDZW52B3JlYWxsb2MAAgNlbnYNYWxpZ25lZF9hbGxvYwACAwYFAAECAgIHMwUGbWFsbG9jAAUEZnJlZQAGBmNhbGxvYwAHB3JlYWxsb2MACAxhbGlnbmVkQWxsb2MACQoqBQYAIAAQAAsGACAAEAELCAAgACABEAILCAAgACABEAMLCAAgACABEAML"},47844:t=>{t.exports="AGFzbQEAAAABEwNgAX8Bf2ACf38Bf2ADf39/AX8CEgEDZW52Bm1lbW9yeQIDAYCABAMIBwAAAAECAAAHQwcEbG9jawAAB3RyeWxvY2sAAQZ1bmxvY2sAAgR3YWl0AAMJdGltZWR3YWl0AAQGc2lnbmFsAAUJYnJvYWRjYXN0AAYKjgIHVgEBfyAAQQBBAf5IAgAhASABQQBHBEADQCABQQJGBH9BAQUgAEEBQQL+SAIAQQBHCwRAIABBAkJ//gECABoLIABBAEEC/kgCACEBIAFBAEcNAAsLQQALFwAgAEEAQQH+SAIAQQBGBH9BAAVBEAsLIwAgAEEB/iUCAEEBRwRAIABBAP4XAgAgAEEB/gACABoLQQALHQAgACAA/hACACABEAIaQn/+AQIAGiABEAAaQQALKQAgACAA/hACACABEAIaIAIpAwD+AQIAIAEQABpBAkYEf0HwAAVBAAsLFgAgAEEB/h4CABogAEEB/gACABpBAAsaACAAQQH+HgIAGiAAQYCAgIAE/gACABpBAAs="},68632:(t,e,i)=>{t.exports=i(37149)},45249:(t,e,i)=>{t.exports=i(87172)},73146:(t,e,i)=>{t.exports=i(85079)},80662:(t,e,i)=>{t.exports=i(92861)},43929:(t,e,i)=>{t.exports=i(63342)},7210:(t,e,i)=>{t.exports=i(11837)},99704:(t,e,i)=>{t.exports=i(19737)},17735:(t,e,i)=>{t.exports=i(58886)},66681:(t,e,i)=>{t.exports=i(92696)},7403:(t,e,i)=>{t.exports=i(22948)},75019:(t,e,i)=>{t.exports=i(62160)},69736:(t,e,i)=>{t.exports=i(47567)},11919:(t,e,i)=>{t.exports=i(21724)},88032:(t,e,i)=>{t.exports=i(27279)},29967:(t,e,i)=>{t.exports=i(25216)},54001:(t,e,i)=>{t.exports=i(34750)},64236:(t,e,i)=>{t.exports=i(31707)},75062:(t,e,i)=>{t.exports=i(16560)},20149:(t,e,i)=>{t.exports=i(48652)},134:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(92696),s=i(87361);function a(t,e,i){return(e=(0,s.A)(e))in t?r(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},91908:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(23509),s=i(39967);function a(t,e){if("object"!=(0,r.A)(t)||!t)return t;var i=t[s];if(void 0!==i){var a=i.call(t,e||"default");if("object"!=(0,r.A)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}},87361:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(23509),s=i(91908);function a(t){var e=(0,s.A)(t,"string");return"symbol"==(0,r.A)(e)?e:String(e)}},23509:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(16560),s=i(54220);function a(t){return a="function"==typeof r&&"symbol"==typeof s?function(t){return typeof t}:function(t){return t&&"function"==typeof r&&t.constructor===r&&t!==r.prototype?"symbol":typeof t},a(t)}},65749:(t,e,i)=>{"use strict";function r(t){var e=t.toLowerCase().trim().split(/\s*;\s*/);return"banner"===e[0]?{name:e[0],delay:1*e[1]||0,leftToRight:1*e[2]||0,fadeAwayWidth:1*e[3]||0}:/^scroll\s/.test(e[0])?{name:e[0],y1:Math.min(1*e[1],1*e[2]),y2:Math.max(1*e[1],1*e[2]),delay:1*e[3]||0,fadeAwayHeight:1*e[4]||0}:""!==t?{name:t}:null}function s(t){return t?t.toLowerCase().replace(/([+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?)/g," $1 ").replace(/([mnlbspc])/g," $1 ").trim().replace(/\s+/g," ").split(/\s(?=[mnlbspc])/).map((function(t){return t.split(" ").filter((function(t,e){return!(e&&isNaN(1*t))}))})):[]}i.d(e,{wE:()=>I});var a=["b","i","u","s","fsp","k","K","kf","ko","kt","fe","q","p","pbo","a","an","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"].map((function(t){return{name:t,regex:new RegExp("^"+t+"-?\\d")}}));function n(t){for(var e,i={},r=0;r<a.length;r++){var o=a[r],l=o.name;if(o.regex.test(t))return i[l]=1*t.slice(l.length),i}if(/^fn/.test(t))i.fn=t.slice(2);else if(/^r/.test(t))i.r=t.slice(1);else if(/^fs[\d+-]/.test(t))i.fs=t.slice(2);else if(/^\d?c&?H?[0-9a-fA-F]+|^\d?c$/.test(t)){var c=t.match(/^(\d?)c&?H?(\w*)/),h=c[1],d=c[2];i["c"+(h||1)]=d&&("000000"+d).slice(-6)}else if(/^\da&?H?[0-9a-fA-F]+/.test(t)){var u=t.match(/^(\d)a&?H?([0-9a-f]+)/i),f=u[1],p=u[2];i["a"+f]=("00"+p).slice(-2)}else if(/^alpha&?H?[0-9a-fA-F]+/.test(t))e=t.match(/^alpha&?H?([0-9a-f]+)/i),i.alpha=e[1],i.alpha=("00"+i.alpha).slice(-2);else if(/^(?:pos|org|move|fad|fade)\([^)]+/.test(t)){var m=t.match(/^(\w+)\((.*?)\)?$/),g=m[1],v=m[2];i[g]=v.trim().split(/\s*,\s*/).map(Number)}else if(/^i?clip\([^)]+/.test(t)){var y=t.match(/^i?clip\((.*?)\)?$/)[1].trim().split(/\s*,\s*/);i.clip={inverse:/iclip/.test(t),scale:1,drawing:null,dots:null},1===y.length&&(i.clip.drawing=s(y[0])),2===y.length&&(i.clip.scale=1*y[0],i.clip.drawing=s(y[1])),4===y.length&&(i.clip.dots=y.map(Number))}else if(/^t\(/.test(t)){var A=t.match(/^t\((.*?)\)?$/)[1].trim().replace(/\\.*/,(function(t){return t.replace(/,/g,"\n")})).split(/\s*,\s*/);if(!A[0])return i;i.t={t1:0,t2:0,accel:1,tags:A[A.length-1].replace(/\n/g,",").split("\\").slice(1).map(n)},2===A.length&&(i.t.accel=1*A[0]),3===A.length&&(i.t.t1=1*A[0],i.t.t2=1*A[1]),4===A.length&&(i.t.t1=1*A[0],i.t.t2=1*A[1],i.t.accel=1*A[2])}return i}function o(t){for(var e=[],i=0,r="",s=t.split("\\").slice(1).concat("").join("\\"),a=0;a<s.length;a++){var o=s[a];"("===o&&i++,")"===o&&i--,i<0&&(i=0),i||"\\"!==o?r+=o:(r&&e.push(r),r="")}return e.map(n)}function l(t){var e=t.split(/{([^{}]*?)}/),i=[];e[0].length&&i.push({tags:[],text:e[0],drawing:[]});for(var r=1;r<e.length;r+=2){var a=o(e[r]),n=a.reduce((function(t,e){return void 0===e.p?t:!!e.p}),!1);i.push({tags:a,text:n?"":e[r+1],drawing:n?s(e[r+1]):[]})}return{raw:t,combined:i.map((function(t){return t.text})).join(""),parsed:i}}function c(t,e){var i=t.split(",");if(i.length>e.length){var s=i.slice(e.length-1).join();(i=i.slice(0,e.length-1)).push(s)}for(var a,n={},o=0;o<i.length;o++){var c=e[o],h=i[o].trim();switch(c){case"Layer":case"MarginL":case"MarginR":case"MarginV":n[c]=1*h;break;case"Start":case"End":n[c]=(void 0,3600*(a=h.split(":"))[0]+60*a[1]+1*a[2]);break;case"Effect":n[c]=r(h);break;case"Text":n[c]=l(h);break;default:n[c]=h}}return n}var h=["Name","Fontname","Fontsize","PrimaryColour","SecondaryColour","OutlineColour","BackColour","Bold","Italic","Underline","StrikeOut","ScaleX","ScaleY","Spacing","Angle","BorderStyle","Outline","Shadow","Alignment","MarginL","MarginR","MarginV","Encoding"],d=["Layer","Start","End","Style","Name","MarginL","MarginR","MarginV","Effect","Text"];function u(t){var e=h.concat(d);return t.match(/Format\s*:\s*(.*)/i)[1].split(/\s*,\s*/).map((function(t){return e.find((function(e){return e.toLowerCase()===t.toLowerCase()}))||t}))}function f(t,e){var i=t.match(/Style\s*:\s*(.*)/i)[1].split(/\s*,\s*/);return Object.assign.apply(Object,[{}].concat(e.map((function(t,e){var r;return(r={})[t]=i[e],r}))))}function p(t){var e={type:null,prev:null,next:null,points:[]};/[mnlbs]/.test(t[0])&&(e.type=t[0].toUpperCase().replace("N","L").replace("B","C"));for(var i=t.length-!(1&t.length),r=1;r<i;r+=2)e.points.push({x:1*t[r],y:1*t[r+1]});return e}function m(t){return!(!t.points.length||!t.type||/C|S/.test(t.type)&&t.points.length<3)}function g(t){return t.map((function(t){return t.type+t.points.map((function(t){return t.x+","+t.y})).join(",")})).join("")}function v(t){for(var e,i=[],r=0;r<t.length;){var s=t[r],a=p(s);if(m(a)){if("S"===a.type){var n=(i[r-1]||{points:[{x:0,y:0}]}).points.slice(-1)[0],o=n.x,l=n.y;a.points.unshift({x:o,y:l})}r&&(a.prev=i[r-1].type,i[r-1].next=a.type),i.push(a),r++}else{if(r&&"S"===i[r-1].type){var c={p:a.points,c:i[r-1].points.slice(0,3)};i[r-1].points=i[r-1].points.concat((c[s[0]]||[]).map((function(t){return{x:t.x,y:t.y}})))}t.splice(r,1)}}var h=(e=[]).concat.apply(e,i.map((function(t){var e=t.type,i=t.points,r=t.prev,s=t.next;return"S"===e?function(t,e,i){var r=[],s=[0,2/3,1/3,0],a=[0,1/3,2/3,0],n=[0,1/6,2/3,1/6],o=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},l=[t[t.length-1].x,t[0].x,t[1].x,t[2].x],c=[t[t.length-1].y,t[0].y,t[1].y,t[2].y];r.push({type:"M"===e?"M":"L",points:[{x:o(n,l),y:o(n,c)}]});for(var h=3;h<t.length;h++)l=[t[h-3].x,t[h-2].x,t[h-1].x,t[h].x],c=[t[h-3].y,t[h-2].y,t[h-1].y,t[h].y],r.push({type:"C",points:[{x:o(s,l),y:o(s,c)},{x:o(a,l),y:o(a,c)},{x:o(n,l),y:o(n,c)}]});if("L"===i||"C"===i){var d=t[t.length-1];r.push({type:"L",points:[{x:d.x,y:d.y}]})}return r}(i,r,s):{type:e,points:i}})));return Object.assign({instructions:h,d:g(h)},function(t){var e,i=1/0,r=1/0,s=-1/0,a=-1/0;return(e=[]).concat.apply(e,t.map((function(t){return t.points}))).forEach((function(t){var e=t.x,n=t.y;i=Math.min(i,e),r=Math.min(r,n),s=Math.max(s,e),a=Math.max(a,n)})),{minX:i,minY:r,width:s-i,height:a-r}}(i))}var y=["fs","fsp","clip","c1","c2","c3","c4","a1","a2","a3","a4","alpha","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"];function A(t,e,i){var r,s,a;void 0===i&&(i={});var n=t[e];if(void 0===n)return null;if("pos"===e||"org"===e)return 2===n.length?((r={})[e]={x:n[0],y:n[1]},r):null;if("move"===e){var o=n[0],l=n[1],c=n[2],h=n[3],d=n[4];void 0===d&&(d=0);var u=n[5];return void 0===u&&(u=0),4===n.length||6===n.length?{move:{x1:o,y1:l,x2:c,y2:h,t1:d,t2:u}}:null}if("fad"===e||"fade"===e)return 2===n.length?{fade:{type:"fad",t1:n[0],t2:n[1]}}:7===n.length?{fade:{type:"fade",a1:n[0],a2:n[1],a3:n[2],t1:n[3],t2:n[4],t3:n[5],t4:n[6]}}:null;if("clip"===e){var f=n.inverse,p=n.scale,m=n.drawing,g=n.dots;return m?{clip:{inverse:f,scale:p,drawing:v(m),dots:g}}:g?{clip:{inverse:f,scale:p,drawing:m,dots:{x1:g[0],y1:g[1],x2:g[2],y2:g[3]}}}:null}if(/^[xy]?(bord|shad)$/.test(e)&&(n=Math.max(n,0)),"bord"===e)return{xbord:n,ybord:n};if("shad"===e)return{xshad:n,yshad:n};if(/^c\d$/.test(e))return(s={})[e]=n||i[e],s;if("alpha"===e)return{a1:n,a2:n,a3:n,a4:n};if("fr"===e)return{frz:n};if("fs"===e)return{fs:/^\+|-/.test(n)?(1*n>-10?1+n/10:1)*i.fs:1*n};if("K"===e)return{kf:n};if("t"===e){var b=n.t1,x=n.accel,w=n.tags,k=n.t2||1e3*(i.end-i.start),T={};return w.forEach((function(t){var e=Object.keys(t)[0];~y.indexOf(e)&&("clip"!==e||t[e].dots)&&Object.assign(T,A(t,e,i))})),{t:{t1:b,t2:k,accel:x,tag:T}}}return(a={})[e]=n,a}var b=[null,1,2,3,null,7,8,9,null,4,5,6],x=["r","a","an","pos","org","move","fade","fad","clip"];function w(t){for(var e,i,r,s,a,n,o,l=t.styles,c=t.style,h=t.parsed,d=t.start,u=t.end,f=[],p={style:c,fragments:[]},m={},g=0;g<h.length;g++){for(var y=h[g],w=y.tags,k=y.text,T=y.drawing,S=void 0,I=0;I<w.length;I++){var P=w[I];S=void 0===P.r?S:P.r}for(var _={tag:void 0===S?(o=m,JSON.parse(JSON.stringify(Object.assign({},o,{k:void 0,kf:void 0,ko:void 0,kt:void 0})))):{},text:k,drawing:T.length?v(T):null},E=0;E<w.length;E++){var C=w[E];e=e||b[C.a||0]||C.an,i=i||A(C,"pos"),r=r||A(C,"org"),s=s||A(C,"move"),a=a||A(C,"fade")||A(C,"fad"),n=A(C,"clip")||n;var M=Object.keys(C)[0];if(M&&!~x.indexOf(M)){var R=l[c].tag,B=A(C,M,{start:d,end:u,c1:R.c1,c2:R.c2,c3:R.c3,c4:R.c4,fs:m.fs||R.fs});"t"===M?(_.tag.t=_.tag.t||[],_.tag.t.push(B.t)):Object.assign(_.tag,B)}}if(m=_.tag,void 0!==S&&(f.push(p),p={style:l[S]?S:c,fragments:[]}),_.text||_.drawing){var D=p.fragments[p.fragments.length-1]||{};D.text&&_.text&&!Object.keys(_.tag).length?D.text+=_.text:p.fragments.push(_)}}return f.push(p),Object.assign({alignment:e,slices:f},i,r,s,a,n)}function k(t){for(var e=t.styles,i=t.dialogues,r=1/0,s=[],a=0;a<i.length;a++){var n=i[a];if(!(n.Start>=n.End)){e[n.Style]||(n.Style="Default");var o=e[n.Style].style,l=w({styles:e,style:n.Style,parsed:n.Text.parsed,start:n.Start,end:n.End}),c=l.alignment||o.Alignment;r=Math.min(r,n.Layer),s.push(Object.assign({layer:n.Layer,start:n.Start,end:n.End,style:n.Style,name:n.Name,margin:{left:n.MarginL||o.MarginL,right:n.MarginR||o.MarginR,vertical:n.MarginV||o.MarginV},effect:n.Effect},l,{alignment:c}))}}for(var h=0;h<s.length;h++)s[h].layer-=r;return s.sort((function(t,e){return t.start-e.start||t.end-e.end}))}var T={Name:"Default",Fontname:"Arial",Fontsize:"20",PrimaryColour:"&H00FFFFFF&",SecondaryColour:"&H000000FF&",OutlineColour:"&H00000000&",BackColour:"&H00000000&",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"2",Shadow:"2",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"1"};function S(t){if(/^(&|H|&H)[0-9a-f]{6,}/i.test(t)){var e=t.match(/&?H?([0-9a-f]{2})?([0-9a-f]{6})/i);return[e[1]||"00",e[2]]}var i=parseInt(t,10);if(!isNaN(i)){var r=-2147483648;if(i<r)return["00","000000"];var s=r<=i&&i<=2147483647?("00000000"+(i<0?i+4294967296:i).toString(16)).slice(-8):String(i).slice(0,8);return[s.slice(0,2),s.slice(2)]}return["00","000000"]}function I(t,e){void 0===e&&(e={});var i=function(t){for(var e={info:{},styles:{format:[],style:[]},events:{format:[],comment:[],dialogue:[]}},i=t.split(/\r?\n/),r=0,s=0;s<i.length;s++){var a=i[s].trim();if(!/^;/.test(a)&&(/^\[Script Info\]/i.test(a)?r=1:/^\[V4\+? Styles\]/i.test(a)?r=2:/^\[Events\]/i.test(a)?r=3:/^\[.*\]/.test(a)&&(r=0),0!==r)){if(1===r&&/:/.test(a)){var n=a.match(/(.*?)\s*:\s*(.*)/),o=n[1],l=n[2];e.info[o]=l}if(2===r&&(/^Format\s*:/i.test(a)&&(e.styles.format=u(a)),/^Style\s*:/i.test(a)&&e.styles.style.push(f(a,e.styles.format))),3===r&&(/^Format\s*:/i.test(a)&&(e.events.format=u(a)),/^(?:Comment|Dialogue)\s*:/i.test(a))){var h=a.match(/^(\w+?)\s*:\s*(.*)/i),d=h[1],p=h[2];e.events[d.toLowerCase()].push(c(p,e.events.format))}}}return e}(t),r=function(t){for(var e=t.info,i=t.style,r=t.defaultStyle,s={},a=[Object.assign({},r,{Name:"Default"})].concat(i),n=function(t){var i=Object.assign({},T,a[t]);/^(\*+)Default$/.test(i.Name)&&(i.Name="Default"),Object.keys(i).forEach((function(t){"Name"===t||"Fontname"===t||/Colour/.test(t)||(i[t]*=1)}));var r=S(i.PrimaryColour),n=r[0],o=r[1],l=S(i.SecondaryColour),c=l[0],h=l[1],d=S(i.OutlineColour),u=d[0],f=d[1],p=S(i.BackColour),m=p[0],g=p[1],v={fn:i.Fontname,fs:i.Fontsize,c1:o,a1:n,c2:h,a2:c,c3:f,a3:u,c4:g,a4:m,b:Math.abs(i.Bold),i:Math.abs(i.Italic),u:Math.abs(i.Underline),s:Math.abs(i.StrikeOut),fscx:i.ScaleX,fscy:i.ScaleY,fsp:i.Spacing,frz:i.Angle,xbord:i.Outline,ybord:i.Outline,xshad:i.Shadow,yshad:i.Shadow,fe:i.Encoding,q:/^[0-3]$/.test(e.WrapStyle)?1*e.WrapStyle:2};s[i.Name]={style:i,tag:v}},o=0;o<a.length;o++)n(o);return s}({info:i.info,style:i.styles.style,defaultStyle:e.defaultStyle||{}});return{info:i.info,width:1*i.info.PlayResX||null,height:1*i.info.PlayResY||null,collisions:i.info.Collisions||"Normal",styles:r,dialogues:k({styles:r,dialogues:i.events.dialogue})}}var P={M:"m",L:"l",C:"b"};var _=function(t){return function(e){return function(i){return""+e+t+"&H"+i+"&"}}},E=_("c"),C=_("a"),M={c1:E(1),c2:E(2),c3:E(3),c4:E(4),a1:C(1),a2:C(2),a3:C(3),a4:C(4),pos:function(t){return"pos("+[t.x,t.y]+")"},org:function(t){return"org("+[t.x,t.y]+")"},move:function(t){return"move("+[t.x1,t.y1,t.x2,t.y2,t.t1,t.t2]+")"},fade:function(t){return"fad"===t.type?"fad("+[t.t1,t.t2]+")":"fade("+[t.a1,t.a2,t.a3,t.t1,t.t2,t.t3,t.t4]+")"},clip:function(t){return(t.inverse?"i":"")+"clip("+(t.dots?""+[t.dots.x1,t.dots.y1,t.dots.x2,t.dots.y2]:(1===t.scale?"":t.scale+",")+t.drawing.instructions.map((function(t){var e,i=t.type,r=t.points;return(e=[P[i]]).concat.apply(e,r.map((function(t){return[t.x,t.y]}))).join(" ")})).join(" "))+")"},t:function(t){return t.map((function(t){return"t("+[t.t1,t.t2,t.accel,(e=t.tag,Object.keys(e).map((function(t){return"\\"+(M[t]||function(e){return""+t+e})(e[t])})).join(""))]+")";var e})).join("\\")}}},49963:(t,e,i)=>{"use strict";i.d(e,{b:()=>s});var r=i(32517);function s({styles:t,dialogues:e}){let i=1/0;const s=[];for(let a=0;a<e.length;a++){const n=e[a];if(n.Start>=n.End)continue;t[n.Style]||(n.Style="Default");const o=t[n.Style].style,l=(0,r.t)({styles:t,style:n.Style,parsed:n.Text.parsed,start:n.Start,end:n.End}),c=l.alignment||o.Alignment;i=Math.min(i,n.Layer),s.push(Object.assign({layer:n.Layer,start:n.Start,end:n.End,style:n.Style,name:n.Name,margin:{left:n.MarginL||o.MarginL,right:n.MarginR||o.MarginR,vertical:n.MarginV||o.MarginV},effect:n.Effect},l,{alignment:c}))}for(let t=0;t<s.length;t++)s[t].layer-=i;return s.sort(((t,e)=>t.start-e.start||t.end-e.end))}},98786:(t,e,i)=>{"use strict";function r(t){const e={type:null,prev:null,next:null,points:[]};/[mnlbs]/.test(t[0])&&(e.type=t[0].toUpperCase().replace("N","L").replace("B","C"));for(let i=t.length-!(1&t.length),r=1;r<i;r+=2)e.points.push({x:1*t[r],y:1*t[r+1]});return e}function s(t){return!(!t.points.length||!t.type||/C|S/.test(t.type)&&t.points.length<3)}function a(t){return t.map((({type:t,points:e})=>t+e.map((({x:t,y:e})=>`${t},${e}`)).join(","))).join("")}function n(t){const e=[];let i=0;for(;i<t.length;){const a=t[i],n=r(a);if(s(n)){if("S"===n.type){const{x:t,y:r}=(e[i-1]||{points:[{x:0,y:0}]}).points.slice(-1)[0];n.points.unshift({x:t,y:r})}i&&(n.prev=e[i-1].type,e[i-1].next=n.type),e.push(n),i++}else{if(i&&"S"===e[i-1].type){const t={p:n.points,c:e[i-1].points.slice(0,3)};e[i-1].points=e[i-1].points.concat((t[a[0]]||[]).map((({x:t,y:e})=>({x:t,y:e}))))}t.splice(i,1)}}const n=[].concat(...e.map((({type:t,points:e,prev:i,next:r})=>"S"===t?function(t,e,i){const r=[],s=[0,2/3,1/3,0],a=[0,1/3,2/3,0],n=[0,1/6,2/3,1/6],o=(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3];let l=[t[t.length-1].x,t[0].x,t[1].x,t[2].x],c=[t[t.length-1].y,t[0].y,t[1].y,t[2].y];r.push({type:"M"===e?"M":"L",points:[{x:o(n,l),y:o(n,c)}]});for(let e=3;e<t.length;e++)l=[t[e-3].x,t[e-2].x,t[e-1].x,t[e].x],c=[t[e-3].y,t[e-2].y,t[e-1].y,t[e].y],r.push({type:"C",points:[{x:o(s,l),y:o(s,c)},{x:o(a,l),y:o(a,c)},{x:o(n,l),y:o(n,c)}]});if("L"===i||"C"===i){const e=t[t.length-1];r.push({type:"L",points:[{x:e.x,y:e.y}]})}return r}(e,i,r):{type:t,points:e})));return Object.assign({instructions:n,d:a(n)},function(t){let e=1/0,i=1/0,r=-1/0,s=-1/0;return[].concat(...t.map((({points:t})=>t))).forEach((({x:t,y:a})=>{e=Math.min(e,t),i=Math.min(i,a),r=Math.max(r,t),s=Math.max(s,a)})),{minX:e,minY:i,width:r-e,height:s-i}}(e))}i.d(e,{EB:()=>n})},78040:(t,e,i)=>{"use strict";i.d(e,{W:()=>a});const r={Name:"Default",Fontname:"Arial",Fontsize:"20",PrimaryColour:"&H00FFFFFF&",SecondaryColour:"&H000000FF&",OutlineColour:"&H00000000&",BackColour:"&H00000000&",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"2",Shadow:"2",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"1"};function s(t){if(/^(&|H|&H)[0-9a-f]{6,}/i.test(t)){const[,e,i]=t.match(/&?H?([0-9a-f]{2})?([0-9a-f]{6})/i);return[e||"00",i]}const e=parseInt(t,10);if(!Number.isNaN(e)){const t=-2147483648;if(e<t)return["00","000000"];const i=t<=e&&e<=2147483647?`00000000${(e<0?e+4294967296:e).toString(16)}`.slice(-8):String(e).slice(0,8);return[i.slice(0,2),i.slice(2)]}return["00","000000"]}function a({info:t,style:e,defaultStyle:i}){const a={},n=[Object.assign({},i,{Name:"Default"})].concat(e);for(let e=0;e<n.length;e++){const i=Object.assign({},r,n[e]);/^(\*+)Default$/.test(i.Name)&&(i.Name="Default"),Object.keys(i).forEach((t=>{"Name"===t||"Fontname"===t||/Colour/.test(t)||(i[t]*=1)}));const[o,l]=s(i.PrimaryColour),[c,h]=s(i.SecondaryColour),[d,u]=s(i.OutlineColour),[f,p]=s(i.BackColour),m={fn:i.Fontname,fs:i.Fontsize,c1:l,a1:o,c2:h,a2:c,c3:u,a3:d,c4:p,a4:f,b:Math.abs(i.Bold),i:Math.abs(i.Italic),u:Math.abs(i.Underline),s:Math.abs(i.StrikeOut),fscx:i.ScaleX,fscy:i.ScaleY,fsp:i.Spacing,frz:i.Angle,xbord:i.Outline,ybord:i.Outline,xshad:i.Shadow,yshad:i.Shadow,fe:i.Encoding,q:/^[0-3]$/.test(t.WrapStyle)?1*t.WrapStyle:2};a[i.Name]={style:i,tag:m}}return a}},64484:(t,e,i)=>{"use strict";i.d(e,{k:()=>a});var r=i(98786);const s=["fs","fsp","clip","c1","c2","c3","c4","a1","a2","a3","a4","alpha","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"];function a(t,e,i={}){let n=t[e];if(void 0===n)return null;if("pos"===e||"org"===e)return 2===n.length?{[e]:{x:n[0],y:n[1]}}:null;if("move"===e){const[t,e,i,r,s=0,a=0]=n;return 4===n.length||6===n.length?{move:{x1:t,y1:e,x2:i,y2:r,t1:s,t2:a}}:null}if("fad"===e||"fade"===e){if(2===n.length){const[t,e]=n;return{fade:{type:"fad",t1:t,t2:e}}}if(7===n.length){const[t,e,i,r,s,a,o]=n;return{fade:{type:"fade",a1:t,a2:e,a3:i,t1:r,t2:s,t3:a,t4:o}}}return null}if("clip"===e){const{inverse:t,scale:e,drawing:i,dots:s}=n;if(i)return{clip:{inverse:t,scale:e,drawing:(0,r.EB)(i),dots:s}};if(s){const[r,a,n,o]=s;return{clip:{inverse:t,scale:e,drawing:i,dots:{x1:r,y1:a,x2:n,y2:o}}}}return null}if(/^[xy]?(bord|shad)$/.test(e)&&(n=Math.max(n,0)),"bord"===e)return{xbord:n,ybord:n};if("shad"===e)return{xshad:n,yshad:n};if(/^c\d$/.test(e))return{[e]:n||i[e]};if("alpha"===e)return{a1:n,a2:n,a3:n,a4:n};if("fr"===e)return{frz:n};if("fs"===e)return{fs:/^\+|-/.test(n)?(1*n>-10?1+n/10:1)*i.fs:1*n};if("K"===e)return{kf:n};if("t"===e){const{t1:t,accel:e,tags:r}=n,o=n.t2||1e3*(i.end-i.start),l={};return r.forEach((t=>{const e=Object.keys(t)[0];~s.indexOf(e)&&("clip"!==e||t[e].dots)&&Object.assign(l,a(t,e,i))})),{t:{t1:t,t2:o,accel:e,tag:l}}}return{[e]:n}}},32517:(t,e,i)=>{"use strict";i.d(e,{t:()=>o});var r=i(98786),s=i(64484);const a=[null,1,2,3,null,7,8,9,null,4,5,6],n=["r","a","an","pos","org","move","fade","fad","clip"];function o({styles:t,style:e,parsed:i,start:o,end:l}){let c,h,d,u,f,p;const m=[];let g={style:e,fragments:[]},v={};for(let A=0;A<i.length;A++){const{tags:b,text:x,drawing:w}=i[A];let k;for(let t=0;t<b.length;t++){const e=b[t];k=void 0===e.r?k:e.r}const T={tag:void 0===k?(y=v,JSON.parse(JSON.stringify(Object.assign({},y,{k:void 0,kf:void 0,ko:void 0,kt:void 0})))):{},text:x,drawing:w.length?(0,r.EB)(w):null};for(let i=0;i<b.length;i++){const r=b[i];c=c||a[r.a||0]||r.an,h=h||(0,s.k)(r,"pos"),d=d||(0,s.k)(r,"org"),u=u||(0,s.k)(r,"move"),f=f||(0,s.k)(r,"fade")||(0,s.k)(r,"fad"),p=(0,s.k)(r,"clip")||p;const m=Object.keys(r)[0];if(m&&!~n.indexOf(m)){const i=t[e].tag,{c1:a,c2:n,c3:c,c4:h}=i,d=v.fs||i.fs,u=(0,s.k)(r,m,{start:o,end:l,c1:a,c2:n,c3:c,c4:h,fs:d});"t"===m?(T.tag.t=T.tag.t||[],T.tag.t.push(u.t)):Object.assign(T.tag,u)}}if(v=T.tag,void 0!==k&&(m.push(g),g={style:t[k]?k:e,fragments:[]}),T.text||T.drawing){const t=g.fragments[g.fragments.length-1]||{};t.text&&T.text&&!Object.keys(T.tag).length?t.text+=T.text:g.fragments.push(T)}}var y;return m.push(g),Object.assign({alignment:c,slices:m},h,d,u,f,p)}},74672:(t,e,i)=>{"use strict";function r(t){return t?t.toLowerCase().replace(/([+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?)/g," $1 ").replace(/([mnlbspc])/g," $1 ").trim().replace(/\s+/g," ").split(/\s(?=[mnlbspc])/).map((t=>t.split(" ").filter(((t,e)=>!(e&&Number.isNaN(1*t)))))):[]}i.d(e,{O:()=>r})},44453:(t,e,i)=>{"use strict";function r(t){const e=t.toLowerCase().trim().split(/\s*;\s*/);return"banner"===e[0]?{name:e[0],delay:1*e[1]||0,leftToRight:1*e[2]||0,fadeAwayWidth:1*e[3]||0}:/^scroll\s/.test(e[0])?{name:e[0],y1:Math.min(1*e[1],1*e[2]),y2:Math.max(1*e[1],1*e[2]),delay:1*e[3]||0,fadeAwayHeight:1*e[4]||0}:""!==t?{name:t}:null}i.d(e,{d:()=>r})},53534:(t,e,i)=>{"use strict";i.d(e,{E:()=>a});var r=i(74672);const s=["b","i","u","s","fsp","k","K","kf","ko","kt","fe","q","p","pbo","a","an","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"].map((t=>({name:t,regex:new RegExp(`^${t}-?\\d`)})));function a(t){const e={};for(let i=0;i<s.length;i++){const{name:r,regex:a}=s[i];if(a.test(t))return e[r]=1*t.slice(r.length),e}if(/^fn/.test(t))e.fn=t.slice(2);else if(/^r/.test(t))e.r=t.slice(1);else if(/^fs[\d+-]/.test(t))e.fs=t.slice(2);else if(/^\d?c&?H?[0-9a-fA-F]+|^\d?c$/.test(t)){const[,i,r]=t.match(/^(\d?)c&?H?(\w*)/);e[`c${i||1}`]=r&&`000000${r}`.slice(-6)}else if(/^\da&?H?[0-9a-fA-F]+/.test(t)){const[,i,r]=t.match(/^(\d)a&?H?([0-9a-f]+)/i);e[`a${i}`]=`00${r}`.slice(-2)}else if(/^alpha&?H?[0-9a-fA-F]+/.test(t))[,e.alpha]=t.match(/^alpha&?H?([0-9a-f]+)/i),e.alpha=`00${e.alpha}`.slice(-2);else if(/^(?:pos|org|move|fad|fade)\([^)]+/.test(t)){const[,i,r]=t.match(/^(\w+)\((.*?)\)?$/);e[i]=r.trim().split(/\s*,\s*/).map(Number)}else if(/^i?clip\([^)]+/.test(t)){const i=t.match(/^i?clip\((.*?)\)?$/)[1].trim().split(/\s*,\s*/);e.clip={inverse:/iclip/.test(t),scale:1,drawing:null,dots:null},1===i.length&&(e.clip.drawing=(0,r.O)(i[0])),2===i.length&&(e.clip.scale=1*i[0],e.clip.drawing=(0,r.O)(i[1])),4===i.length&&(e.clip.dots=i.map(Number))}else if(/^t\(/.test(t)){const i=t.match(/^t\((.*?)\)?$/)[1].trim().replace(/\\.*/,(t=>t.replace(/,/g,"\n"))).split(/\s*,\s*/);if(!i[0])return e;e.t={t1:0,t2:0,accel:1,tags:i[i.length-1].replace(/\n/g,",").split("\\").slice(1).map(a)},2===i.length&&(e.t.accel=1*i[0]),3===i.length&&(e.t.t1=1*i[0],e.t.t2=1*i[1]),4===i.length&&(e.t.t1=1*i[0],e.t.t2=1*i[1],e.t.accel=1*i[2])}return e}},27637:(t,e,i)=>{"use strict";i.d(e,{r:()=>s});var r=i(53534);function s(t){const e=[];let i=0,s="";const a=t.split("\\").slice(1).concat("").join("\\");for(let t=0;t<a.length;t++){const r=a[t];"("===r&&i++,")"===r&&i--,i<0&&(i=0),i||"\\"!==r?s+=r:(s&&e.push(s),s="")}return e.map(r.E)}},93935:(t,e,i)=>{"use strict";i.d(e,{r:()=>a});var r=i(74672),s=i(27637);function a(t){const e=t.split(/{([^{}]*?)}/),i=[];e[0].length&&i.push({tags:[],text:e[0],drawing:[]});for(let t=1;t<e.length;t+=2){const a=(0,s.r)(e[t]),n=a.reduce(((t,e)=>void 0===e.p?t:!!e.p),!1);i.push({tags:a,text:n?"":e[t+1],drawing:n?(0,r.O)(e[t+1]):[]})}return{raw:t,combined:i.map((t=>t.text)).join(""),parsed:i}}},21194:(t,e,i)=>{"use strict";i.d(e,{By:()=>n,IU:()=>a});var r=i(47924),s=i(77334);function a(t){const{box:e}=t;for(;e.lastChild;)e.lastChild.remove();t.actives=[],t.space=[]}function n(t,e){const{video:i,box:n,svg:o,layoutRes:l}=e;return function(){const c=i.clientWidth,h=i.clientHeight,d=l.width||i.videoWidth||c,u=l.height||i.videoHeight||h,f=e.scriptRes.width,p=e.scriptRes.height;let m=f,g=p;const v=Math.min(c/d,h/u);"video_width"===t.resampling&&(g=f/d*u),"video_height"===t.resampling&&(m=p/u*d),e.scale=Math.min(c/m,h/g),"script_width"===t.resampling&&(e.scale=v*(d/m)),"script_height"===t.resampling&&(e.scale=v*(u/g));const y=e.scale*m,A=e.scale*g;e.width=y,e.height=A,e.resampledRes={width:m,height:g};const b=`width:${y}px;height:${A}px;top:${(h-A)/2}px;left:${(c-y)/2}px;`;n.style.cssText=b,n.style.setProperty("--ass-scale",e.scale),n.style.setProperty("--ass-scale-stroke",e.sbas?e.scale:1),o.style.cssText=b,function(t){return function(){a(t);const{video:e,dialogues:i}=t,n=e.currentTime-t.delay;t.index=(()=>{for(let t=0;t<i.length;t+=1)if(n<i[t].end)return t;return(i.length||1)-1})(),function(t){const{video:e,dialogues:i,actives:a}=t,n=e.currentTime-t.delay;for(let t=a.length-1;t>=0;t-=1){const e=a[t],{end:i}=e;i<n&&(e.$div.remove(),a.splice(t,1))}for(;t.index<i.length&&n>=i[t.index].start;){if(n<i[t.index].end){const n=(0,r.U)(i[t.index],t);e.paused||(0,s.MA)(n,"play"),a.push(n)}t.index+=1}}(t)}}(e)()}}},23873:(t,e,i)=>{"use strict";i.d(e,{nq:()=>d,w7:()=>u});var r=i(77334),s=i(77658),a=i(39923),n=i(57131);function o({effect:t,duration:e}){const{name:i,delay:r,leftToRight:s}=t;return"banner"===i?[0,`calc(var(--ass-scale) * ${e/(r||1)*(s?1:-1)}px)`].map(((t,e)=>({offset:e,transform:`translateX(${t})`}))):i.startsWith("scroll")?[{offset:0,transform:"translateY(-100%)"},{offset:1,transform:`translateY(calc(var(--ass-scale) * ${e/(r||1)*(/up/.test(i)?-1:1)}px))`}]:[]}function l({move:t,duration:e,dialogue:i}){const{x1:r,y1:s,x2:a,y2:n,t1:o,t2:l}=t,c=[o,l||e],h=i.pos||{x:0,y:0};return[[r,s],[a,n]].map((([t,e])=>[t-h.x,e-h.y])).map((([t,i],r)=>({offset:Math.min(c[r]/e,1),transform:`translate(calc(var(--ass-scale) * ${t}px), calc(var(--ass-scale) * ${i}px))`})))}function c(t,e){if("fad"===t.type){const{t1:i,t2:r}=t,s=[];return i&&s.push([0,0]),i<e?(r<=e&&s.push([i/e,1]),i+r<e&&s.push([(e-r)/e,1]),r>e?s.push([0,(r-e)/r]):i+r>e&&s.push([(i+.5)/e,1-(i+r-e)/r]),r&&s.push([1,0])):s.push([1,e/i]),s.map((([t,e])=>({offset:t,opacity:e})))}const{a1:i,a2:r,a3:s,t1:a,t2:n,t3:o,t4:l}=t,c=[i,r,s].map((t=>1-t/255));return[0,a,n,o,l,e].map((t=>t/e)).map(((t,e)=>({offset:t,opacity:c[e>>1]}))).filter((({offset:t})=>t<=1))}function h({fromTag:t,tag:e,fragment:i}){const r={...t,...e};return i.drawing&&(Object.assign(r,{p:0,fscx:(e.fscx||t.fscx)/t.fscx*100,fscy:(e.fscy||t.fscy)/t.fscy*100}),Object.assign(t,{fscx:100,fscy:100})),Object.fromEntries((0,n.l1)(r))}function d(t){return[["real-fs",(0,s.F)(t.fn,t.fs)],["tag-fs",t.fs],["tag-fsp",t.fsp],["fill-color",(0,r.qG)(t.a1+t.c1)]].filter((([,t])=>t)).map((([t,e])=>[`--ass-${t}`,e]))}function u(t,e){const{start:i,end:r,effect:s,move:n,fade:u,slices:f}=t,p=1e3*(r-i),m=[...s&&!n?o({effect:s,duration:p}):[],...n?l({move:n,duration:p,dialogue:t}):[],...u?c(u,p):[]].sort(((t,e)=>t.offset-e.offset));m.length>0&&Object.assign(t,{keyframes:m}),f.forEach((t=>{const i=e.styles[t.style].tag;t.fragments.forEach((t=>{if(!t.tag.t||0===t.tag.t.length)return;const r={...i,...t.tag},s=(n=t.tag.t,n.reduceRight(((t,e)=>{let i=!1;return t.map((t=>(i=e.t1===t.t1&&e.t2===t.t2&&e.accel===t.accel,{...t,...i?{tag:{...t.tag,...e.tag}}:{}}))).concat(i?[]:e)}),[])).sort(((t,e)=>t.t2-e.t2||t.t1-e.t1));var n;s[0].t1>0&&s.unshift({t1:0,t2:s[0].t1,tag:r}),s.reduce(((t,e)=>{const i={...t,...e.tag};return i.t=null,Object.assign(e.tag,i),i}),{});const o=Math.max(p,...s.map((({t2:t})=>t))),l=s.map((({t2:i,tag:s})=>({offset:i/o,...Object.fromEntries(d({...s,a1:s.a1||r.a1,c1:s.c1||r.c1})),...Object.fromEntries((0,a.K)({...r,...s},e.sbas?e.scale:1)),...h({fromTag:r,tag:s,fragment:t})}))).sort(((t,e)=>t.offset-e.offset));l.length>0&&Object.assign(t,{keyframes:l,duration:o})}))}))}window.CSS.registerProperty&&(["real-fs","tag-fs","tag-fsp"].forEach((t=>{window.CSS.registerProperty({name:`--ass-${t}`,syntax:"<number>",inherits:!0,initialValue:"0"})})),window.CSS.registerProperty({name:"--ass-fill-color",syntax:"<color>",inherits:!0,initialValue:"transparent"}))},60913:(t,e,i)=>{"use strict";i.d(e,{C:()=>s});var r=i(77334);function s(t,e){const{id:i,clip:s}=t;if(!s)return{};const{width:a,height:n}=e.scriptRes;!function(t,e,i,s,a){if(t.querySelector(`#${i}`))return;let n="";if(null!==e.dots){let{x1:t,y1:i,x2:r,y2:o}=e.dots;t/=s,i/=a,r/=s,o/=a,n=`M${t},${i}L${t},${o},${r},${o},${r},${i}Z`}null!==e.drawing&&(n=e.drawing.instructions.map((({type:t,points:e})=>t+e.map((({x:t,y:e})=>`${t/s},${e/a}`)).join(","))).join(""));const o=1/(1<<e.scale-1);e.inverse&&(n+=`M0,0L0,${o},${o},${o},${o},0,0,0Z`);const l=(0,r.An)("clipPath",[["id",i],["clipPathUnits","objectBoundingBox"]]);l.append((0,r.An)("path",[["d",n],["transform",`scale(${o})`],["clip-rule","evenodd"]])),t.append(l)}(e.defs,s,i,a,n);const o=document.createElement("div");return e.box.insertBefore(o,t.$div),o.append(t.$div),o.className="ASS-clip-area",o.style.clipPath=`url(#${i})`,{$div:o}}},21643:(t,e,i)=>{"use strict";i.d(e,{p:()=>l});var r=i(77334),s=i(82873),a=i(23873),n=i(39923),o=i(57131);function l(t,e){const{video:i,styles:l}=e,c=document.createElement("div");c.className="ASS-dialogue";const h=document.createDocumentFragment(),{align:d,slices:u,start:f,end:p}=t;[["--ass-align-h",["left","center","right"][d.h]],["--ass-align-v",["bottom","center","top"][d.v]]].forEach((([t,e])=>{c.style.setProperty(t,e)}));const m={duration:1e3*(p-f),delay:1e3*Math.min(0,f-(i.currentTime-e.delay)),fill:"forwards"},g=[];return u.forEach((t=>{const i=l[t.style].tag,c=l[t.style].style.BorderStyle;t.fragments.forEach((t=>{const{text:l,drawing:d}=t,u={...i,...t.tag};let f="";const p=[];if(!d){p.push(...(0,a.nq)(u));const t=e.sbas?e.scale:1;p.push(...(0,n.K)(u,t)),f+=`font-family:"${u.fn}";`,f+=u.b?`font-weight:${1===u.b?"bold":u.b};`:"",f+=u.i?"font-style:italic;":"",f+=u.u||u.s?`text-decoration:${u.u?"underline":""} ${u.s?"line-through":""};`:""}if(d&&u.pbo){const t=-u.pbo*(u.fscy||100)/100;f+=`vertical-align:calc(var(--ass-scale) * ${t}px);`}p.push(...(0,o.l1)(u));const v=[u,...(u.t||[]).map((t=>t.tag))],y=o.r8.some((t=>v.some((e=>e[t])))),A=o.IZ.some((t=>v.some((e=>void 0!==e[t]&&100!==e[t])))),b=o.ge.some((t=>v.some((e=>e[t]))));(function(t,e){return t.replace(/\\h/g," ").replace(/\\N/g,"\n").replace(/\\n/g,2===e?"\n":" ")})(l,u.q).split("\n").forEach(((a,n)=>{const o=document.createElement("span"),l=document.createElement("span");if(o.dataset.wrapStyle=u.q,o.dataset.borderStyle=c,(A||b)&&(A&&(l.dataset.scale=""),b&&(l.dataset.skew=""),l.textContent=a),y&&(o.dataset.rotate=""),d){o.dataset.drawing="";const r=(0,s.v)(t,i,e);if(!r)return;o.style.cssText=r.cssText,o.append(r.$svg)}else{if(o.dataset.text="",n&&h.append(document.createElement("br")),!a)return;A||b?o.append(l):o.textContent=a;const t=A||b?l:o;(u.xbord||u.ybord||u.xshad||u.yshad)&&(t.dataset.text=a)}if(o.style.cssText+=f,p.forEach((([t,e])=>{o.style.setProperty(t,e)})),t.keyframes){const e=(0,r.dT)(o,t.keyframes,{...m,duration:t.duration});g.push(e)}h.append(o)}))}))})),t.keyframes&&g.push((0,r.dT)(c,t.keyframes,m)),c.append(h),{$div:c,animations:g}}},82873:(t,e,i)=>{"use strict";i.d(e,{v:()=>a});var r=i(77334),s=i(39923);function a(t,e,i){if(!t.drawing.d)return null;const a={...e,...t.tag},{minX:n,minY:o,width:l,height:c}=t.drawing,h=i.scale/(1<<a.p-1),d=(a.fscx?a.fscx/100:1)*h,u=(a.fscy?a.fscy/100:1)*h,f=a.blur||a.be||0,p=a.xbord+(a.xshad<0?-a.xshad:0)+f,m=a.ybord+(a.yshad<0?-a.yshad:0)+f,g=l*d+2*a.xbord+Math.abs(a.xshad)+2*f,v=c*u+2*a.ybord+Math.abs(a.yshad)+2*f,y=(0,r.An)("svg",[["width",g],["height",v],["viewBox",`${-p} ${-m} ${g} ${v}`]]),A=i.sbas?i.scale:1,b=`ASS-${(0,r.uR)()}`,x=(0,r.An)("defs");x.append((0,s.h)(a,b,A)),y.append(x);const w=`ASS-${(0,r.uR)()}`,k=(0,r.An)("symbol",[["id",w],["viewBox",`${n} ${o} ${l} ${c}`]]);return k.append((0,r.An)("path",[["d",t.drawing.d]])),y.append(k),y.append((0,r.An)("use",[["width",l*d],["height",c*u],["xlink:href",`#${w}`],["filter",`url(#${b})`]])),y.style.cssText=`position:absolute;left:${n*d-p}px;top:${o*u-m}px;`,{$svg:y,cssText:`position:relative;width:${l*d}px;height:${c*u}px;`}}},77658:(t,e,i)=>{"use strict";i.d(e,{F:()=>o,Y:()=>r});const r=document.createElement("div");r.className="ASS-fix-font-size";const s=document.createElement("span");s.textContent="0",r.append(s);const a=2048,n=Object.create(null);function o(t,e){return n[t]||(s.style.fontFamily=t,n[t]=s.clientHeight),e*a/n[t]}},51776:(t,e,i)=>{"use strict";function r(t,e){const{scale:i}=e,{effect:r,move:s,align:a,width:n,height:o,margin:l,slices:c}=t;let h=0,d=0;if(r&&"banner"===r.name)h=r.lefttoright?-n:e.width,d=[e.height-o-l.vertical,(e.height-o)/2,l.vertical][a.v];else if(t.pos||s){const e=t.pos||{x:0,y:0},r=i*e.x,s=i*e.y;h=[r,r-n/2,r-n][a.h],d=[s-o,s-o/2,s][a.v]}else h=[0,(e.width-n)/2,e.width-n-i*l.right][a.h],d=c.some((t=>t.fragments.some((({keyframes:t})=>t?.length))))?[e.height-o-l.vertical,(e.height-o)/2,l.vertical][a.v]:function(t,e){const{video:i,space:r,scale:s}=e,{layer:a,margin:n,width:o,height:l,alignment:c,end:h}=t,d=e.width-Math.trunc(s*(n.left+n.right)),u=e.height,f=Math.trunc(s*n.vertical),p=100*i.currentTime;r[a]=r[a]||{left:{width:new Uint16Array(u+1),end:new Uint32Array(u+1)},center:{width:new Uint16Array(u+1),end:new Uint32Array(u+1)},right:{width:new Uint16Array(u+1),end:new Uint32Array(u+1)}};const m=r[a],g=["right","left","center"][c%3];let v=0,y=0;const A=t=>(v=(t=>{const e=m.left.width[t],i=m.center.width[t],r=m.right.width[t],s=m.left.end[t],a=m.center.end[t],n=m.right.end[t];return"left"===g&&(s>p&&e||a>p&&i&&2*o+i>d||n>p&&r&&o+r>d)||"center"===g&&(s>p&&e&&2*e+o>d||a>p&&i||n>p&&r&&2*r+o>d)||"right"===g&&(s>p&&e&&e+o>d||a>p&&i&&2*o+i>d||n>p&&r)})(t)?0:v+1,v>=l&&(y=t,!0));if(c<=3){y=u-f-1;for(let t=y;t>f&&!A(t);t-=1);}else if(c>=7){y=f+1;for(let t=y;t<u-f&&!A(t);t+=1);}else{y=u-l>>1;for(let t=y;t<u-f&&!A(t);t+=1);}c>3&&(y-=l-1);for(let t=y;t<y+l;t+=1)m[g].width[t]=o,m[g].end[t]=100*h;return y}(t,e);return{x:h,y:d}}i.d(e,{E:()=>r})},47924:(t,e,i)=>{"use strict";i.d(e,{U:()=>c});var r=i(60913),s=i(21643),a=i(51776),n=i(59950),o=i(57131),l=i(38298);function c(t,e){const{$div:i,animations:c}=(0,s.p)(t,e);Object.assign(t,{$div:i,animations:c}),e.box.append(i);const{width:h}=i.getBoundingClientRect();Object.assign(t,{width:h}),i.style.cssText+=(0,n._)(t);const{height:d}=i.getBoundingClientRect();Object.assign(t,{height:d});const{x:u,y:f}=(0,a.E)(t,e);return Object.assign(t,{x:u,y:f}),i.style.cssText+=`width:${h}px;height:${d}px;left:${u}px;top:${f}px;`,(0,o.Lu)(t,e.scale),Object.assign(t,(0,r.C)(t,e)),t.effect?.name?.startsWith("scroll")&&Object.assign(t,(0,l.j)(t,e)),t}},38298:(t,e,i)=>{"use strict";function r(t,e){const i=document.createElement("div");i.className="ASS-scroll-area",e.box.insertBefore(i,t.$div),i.append(t.$div);const{height:r}=e.scriptRes,{name:s,y1:a,y2:n}=t.effect,o=Math.min(a,n)/r*100,l=(r-Math.max(a,n))/r*100;i.style.cssText+=`top:${o}%;bottom:${l}%;`;const c=/up/.test(s);return t.$div.style.cssText+=c?"top:100%;":"top:0%;",{$div:i}}i.d(e,{j:()=>r})},39923:(t,e,i)=>{"use strict";i.d(e,{K:()=>n,h:()=>s});var r=i(77334);function s(t,e,i){const s=t.xbord||t.ybord,a=t.xshad||t.yshad,n="FF"!==t.a1,o=t.blur||t.be||0,l=(0,r.An)("filter",[["id",e]]);l.append((0,r.An)("feGaussianBlur",[["stdDeviation",s?0:o],["in","SourceGraphic"],["result","sg_b"]])),l.append((0,r.An)("feFlood",[["flood-color",(0,r.qG)(t.a1+t.c1)],["result","c1"]])),l.append((0,r.An)("feComposite",[["operator","in"],["in","c1"],["in2","sg_b"],["result","main"]])),s&&(l.append((0,r.An)("feMorphology",[["radius",`${t.xbord*i} ${t.ybord*i}`],["operator","dilate"],["in","SourceGraphic"],["result","dil"]])),l.append((0,r.An)("feGaussianBlur",[["stdDeviation",o],["in","dil"],["result","dil_b"]])),l.append((0,r.An)("feComposite",[["operator","out"],["in","dil_b"],["in2","SourceGraphic"],["result","dil_b_o"]])),l.append((0,r.An)("feFlood",[["flood-color",(0,r.qG)(t.a3+t.c3)],["result","c3"]])),l.append((0,r.An)("feComposite",[["operator","in"],["in","c3"],["in2","dil_b_o"],["result","border"]]))),a&&(s||n)&&(l.append((0,r.An)("feOffset",[["dx",t.xshad*i],["dy",t.yshad*i],["in",s?"dil":"SourceGraphic"],["result","off"]])),l.append((0,r.An)("feGaussianBlur",[["stdDeviation",o],["in","off"],["result","off_b"]])),n||(l.append((0,r.An)("feOffset",[["dx",t.xshad*i],["dy",t.yshad*i],["in","SourceGraphic"],["result","sg_off"]])),l.append((0,r.An)("feComposite",[["operator","out"],["in","off_b"],["in2","sg_off"],["result","off_b_o"]]))),l.append((0,r.An)("feFlood",[["flood-color",(0,r.qG)(t.a4+t.c4)],["result","c4"]])),l.append((0,r.An)("feComposite",[["operator","in"],["in","c4"],["in2",n?"off_b":"off_b_o"],["result","shadow"]])));const c=(0,r.An)("feMerge",[]);return a&&(s||n)&&c.append((0,r.An)("feMergeNode",[["in","shadow"]])),s&&c.append((0,r.An)("feMergeNode",[["in","border"]])),c.append((0,r.An)("feMergeNode",[["in","main"]])),l.append(c),l}function a([t,e]){return[[0,0],[0,1],[1,0],[1,1]].filter((([i,r])=>(i||t)&&(r||e))).map((([i,r])=>[(i||-1)*t,(r||-1)*e]))}function n(t,e){const i=(0,r.qG)(`00${t.c3}`),s=t.xbord*e,n=t.ybord*e,o=(0,r.qG)(`00${t.c4}`),l=t.blur||t.be||0,c=function(t,e){if(t===e)return[];const i=Math.min(t,e),r=Math.max(t,e);return Array.from({length:Math.ceil(r)-1},((t,e)=>e+1)).concat(r).map((t=>[(r-t)/r*i,t])).map((([i,r])=>t>e?[r,i]:[i,r])).flatMap(a)}(s,n);return[["border-width",2*Math.min(s,n)+"px"],["border-color",i],["border-opacity",(0,r.KA)(t.a3)],["border-delta",c.map((([t,e])=>`${t}px ${e}px ${i}`)).join(",")],["shadow-color",o],["shadow-opacity",(0,r.KA)(t.a4)],["shadow-delta",c.map((([t,e])=>`${t}px ${e}px ${o}`)).join(",")],["tag-blur",l],["tag-xbord",t.xbord],["tag-ybord",t.ybord],["tag-xshad",t.xshad],["tag-yshad",t.yshad]].map((([t,e])=>[`--ass-${t}`,e]))}window.CSS.registerProperty&&(window.CSS.registerProperty({name:"--ass-border-width",syntax:"<length>",inherits:!0,initialValue:"0px"}),["border-color","shadow-color"].forEach((t=>{window.CSS.registerProperty({name:`--ass-${t}`,syntax:"<color>",inherits:!0,initialValue:"transparent"})})),["border-opacity","shadow-opacity"].forEach((t=>{window.CSS.registerProperty({name:`--ass-${t}`,syntax:"<number>",inherits:!0,initialValue:"1"})})),["blur","xbord","ybord","xshad","yshad"].forEach((t=>{window.CSS.registerProperty({name:`--ass-tag-${t}`,syntax:"<number>",inherits:!0,initialValue:"0"})})))},59950:(t,e,i)=>{"use strict";function r(t){const{layer:e,align:i,effect:r,pos:s,margin:a}=t;let n="";return e&&(n+=`z-index:${e};`),n+=`text-align:${["left","center","right"][i.h]};`,r||(n+=`max-width:calc(100% - var(--ass-scale) * ${a.left+a.right}px);`,s||(0!==i.h&&(n+=`margin-right:calc(var(--ass-scale) * ${a.right}px);`),2!==i.h&&(n+=`margin-left:calc(var(--ass-scale) * ${a.left}px);`))),n}i.d(e,{_:()=>r})},57131:(t,e,i)=>{"use strict";i.d(e,{IZ:()=>s,Lu:()=>o,ge:()=>a,l1:()=>n,r8:()=>r});const r=["frx","fry","frz"],s=["fscx","fscy"],a=["fax","fay"];function n(t){return[...[...r,...a].map((e=>[`--ass-tag-${e}`,`${t[e]||0}`])),...s.map((e=>[`--ass-tag-${e}`,t.p?1:(t[e]||100)/100]))]}function o(t,e){const{align:i,width:r,height:s,x:a,y:n,$div:o}=t,l={};t.org?(l.x=t.org.x*e,l.y=t.org.y*e):(l.x=[a,a+r/2,a+r][i.h],l.y=[n+s,n+s/2,n][i.v]);for(let t=o.childNodes.length-1;t>=0;t-=1){const e=o.childNodes[t];if(""===e.dataset.rotate){const t=l.x-a-e.offsetLeft,i=l.y-n-e.offsetTop;e.style.cssText+=`transform-origin:${t}px ${i}px;`}}}window.CSS.registerProperty&&([...r,...a].forEach((t=>{window.CSS.registerProperty({name:`--ass-tag-${t}`,syntax:"<number>",inherits:!0,initialValue:0})})),s.forEach((t=>{window.CSS.registerProperty({name:`--ass-tag-${t}`,syntax:"<number>",inherits:!0,initialValue:1})})))},77334:(t,e,i)=>{"use strict";function r(t){return 1-`0x${t}`/255}function s(t){const e=t.match(/(\w\w)(\w\w)(\w\w)(\w\w)/),i=r(e[1]),s=+`0x${e[2]}`,a=+`0x${e[3]}`;return`rgba(${+`0x${e[4]}`},${a},${s},${i})`}function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=Math.trunc(16*Math.random());return("x"===t?e:3&e|8).toString(16)}))}function n(t,e=[]){const i=document.createElementNS("http://www.w3.org/2000/svg",t);for(let t=0;t<e.length;t+=1){const r=e[t];i.setAttributeNS("xlink:href"===r[0]?"http://www.w3.org/1999/xlink":null,r[0],r[1])}return i}function o(t,e,i){const r=t.animate(e,i);return r.pause(),r}function l(t,e){(t.animations||[]).forEach((t=>{t[e]()}))}i.d(e,{An:()=>n,KA:()=>r,MA:()=>l,dT:()=>o,qG:()=>s,uR:()=>a})}},r={};function s(t){var e=r[t];if(void 0!==e)return e.exports;var a=r[t]={exports:{}};return i[t].call(a.exports,a,a.exports,s),a.exports}s.m=i,s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce(((e,i)=>(s.f[i](t,e),e)),[])),s.u=t=>t+".avplayer.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="AVPlayer:",s.l=(i,r,a,n)=>{if(t[i])t[i].push(r);else{var o,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),h=0;h<c.length;h++){var d=c[h];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==e+a){o=d;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",e+a),o.src=i),t[i]=[r];var u=(e,r)=>{o.onerror=o.onload=null,clearTimeout(f);var s=t[i];if(delete t[i],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach((t=>t(r))),e)return e(r)},f=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),l&&document.head.appendChild(o)}},s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=i[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t})(),(()=>{var t={792:0};s.f.j=(e,i)=>{var r=s.o(t,e)?t[e]:void 0;if(0!==r)if(r)i.push(r[2]);else{var a=new Promise(((i,s)=>r=t[e]=[i,s]));i.push(r[2]=a);var n=s.p+s.u(e),o=new Error;s.l(n,(i=>{if(s.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var a=i&&("load"===i.type?"missing":i.type),n=i&&i.target&&i.target.src;o.message="Loading chunk "+e+" failed.\n("+a+": "+n+")",o.name="ChunkLoadError",o.type=a,o.request=n,r[1](o)}}),"chunk-"+e,e)}};var e=(e,i)=>{var r,a,[n,o,l]=i,c=0;if(n.some((e=>0!==t[e]))){for(r in o)s.o(o,r)&&(s.m[r]=o[r]);l&&l(s)}for(e&&e(i);c<n.length;c++)a=n[c],s.o(t,a)&&t[a]&&t[a][0](),t[a]=0},i=self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var a=s(72631);return a.default})()));