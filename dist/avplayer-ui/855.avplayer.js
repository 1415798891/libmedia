"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[855],{64436:(e,t,i)=>{i.d(t,{A:()=>o});var r=i(134),s=i(63939),n=i(37837),a=i(71766);class o{constructor(){(0,r.A)(this,"inCodecpar",void 0),(0,r.A)(this,"inTimeBase",void 0),(0,r.A)(this,"outCodecpar",void 0)}init(e,t){return this.inCodecpar=(0,n.Gy)(168),(0,a.Yi)(this.inCodecpar,e),this.inTimeBase={den:s.f[15](t+4),num:s.f[15](t)},0}destroy(){this.inCodecpar&&((0,a.dn)(this.inCodecpar),this.inCodecpar=0)}}},51113:(e,t,i)=>{i.d(t,{A:()=>U});var r=i(134),s=i(63939),n=i(50932),a=i(64436),o=i(14686),c=i(4624),h=i(9705),d=i(77231),l=i(44328),f=i(37837),u=i(71517),p=i(87771),g=i(92647),b=i(67672);class U extends a.A{constructor(...e){super(...e),(0,r.A)(this,"caches",void 0),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"lastDts",void 0)}init(e,t){return super.init(e,t),this.caches=[],0}sendAVPacket(e){let t=0,i=this.lastDts||s.f[17](e+16)||s.f[17](e+8),r=(0,o.s3)(s.f[20](e+24),s.f[15](e+28)).slice(),n=!1,a=!!this.cache;for(a&&(r=(0,g.A)(Uint8Array,[this.cache,r]),this.cache=null);t<r.length;){const o=p.R(r.subarray(t));if(b.ai(o))return c.z3("parse ac3 header failed","src/avformat/bsf/ac3/Ac32RawFilter.ts",78),h.LR;const f={dts:i,buffer:null,duration:d.N_};let u=o.frameSize;if(f.buffer=r.subarray(t,t+u),t+u>r.length){this.cache=r.subarray(t),this.lastDts=i;break}const g=(0,l.k)(BigInt(1536/o.sampleRate*d.SF),d.KR,this.inTimeBase);f.duration=Number(g),this.caches.push(f),t+=u,i+=g,!n&&a&&(n=!0,i=s.f[17](e+16)||s.f[17](e+8))}return this.lastDts=BigInt(0),0}receiveAVPacket(e){if(this.caches.length){(0,u.Up)(e);const t=this.caches.shift(),i=(0,f.sY)(t.buffer.length);return(0,o.lW)(i,t.buffer.length,t.buffer),(0,u.NX)(e,i,t.buffer.length),n.M[17](e+16,t.dts),n.M[17](e+8,t.dts),n.M[17](e+48,BigInt(Math.floor(t.duration))),n.M[15](e+36,1|s.f[15](e+36)),0}return h.LT}reset(){return this.cache=null,this.lastDts=BigInt(0),0}}},7309:(e,t,i)=>{i.d(t,{A:()=>U});var r=i(134),s=i(63939),n=i(50932),a=i(64436),o=i(14686),c=i(4624),h=i(9705),d=i(77231),l=i(44328),f=i(37837),u=i(71517),p=i(29347),g=i(92647),b=i(67672);class U extends a.A{constructor(...e){super(...e),(0,r.A)(this,"caches",void 0),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"lastDts",void 0)}init(e,t){return super.init(e,t),this.caches=[],0}sendAVPacket(e){let t=0,i=this.lastDts||s.f[17](e+16)||s.f[17](e+8),r=(0,o.s3)(s.f[20](e+24),s.f[15](e+28)).slice(),n=!1,a=!!this.cache;for(a&&(r=(0,g.A)(Uint8Array,[this.cache,r]),this.cache=null);t<r.length;){const o=p.R(r.subarray(t));if(b.ai(o))return c.z3("parse dts header failed","src/avformat/bsf/dts/Dts2RawFilter.ts",78),h.LR;const f={dts:i,buffer:null,duration:d.N_};let u=o.frameSize;if(f.buffer=r.subarray(t,t+u),t+u>r.length){this.cache=r.subarray(t),this.lastDts=i;break}const g=(0,l.k)(BigInt(1536/o.sampleRate*d.SF),d.KR,this.inTimeBase);f.duration=Number(g),this.caches.push(f),t+=u,i+=g,!n&&a&&(n=!0,i=s.f[17](e+16)||s.f[17](e+8))}return this.lastDts=BigInt(0),0}receiveAVPacket(e){if(this.caches.length){(0,u.Up)(e);const t=this.caches.shift(),i=(0,f.sY)(t.buffer.length);return(0,o.lW)(i,t.buffer.length,t.buffer),(0,u.NX)(e,i,t.buffer.length),n.M[17](e+16,t.dts),n.M[17](e+8,t.dts),n.M[17](e+48,BigInt(Math.floor(t.duration))),n.M[15](e+36,1|s.f[15](e+36)),0}return h.LT}reset(){return this.cache=null,this.lastDts=BigInt(0),0}}},56397:(e,t,i)=>{i.d(t,{A:()=>U});var r=i(134),s=i(63939),n=i(50932),a=i(64436),o=i(14686),c=i(4624),h=i(9705),d=i(77231),l=i(44328),f=i(37837),u=i(71517),p=i(75294),g=i(89088),b=i(92647);class U extends a.A{constructor(...e){super(...e),(0,r.A)(this,"frameHeader",void 0),(0,r.A)(this,"caches",void 0),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"lastDts",void 0)}init(e,t){return super.init(e,t),this.caches=[],this.frameHeader=new p.Vz,0}sendAVPacket(e){let t=0,i=this.lastDts||s.f[17](e+16)||s.f[17](e+8),r=(0,o.s3)(s.f[20](e+24),s.f[15](e+28)).slice(),n=!1,a=!!this.cache;for(a&&(r=(0,b.A)(Uint8Array,[this.cache,r]),this.cache=null);t<r.length;){const o=r[t]<<4|r[t+1]>>4&14;if(4094!==o)return c.z3(`found syncWord not 0xFFE, got: 0x${o.toString(16)}`,"src/avformat/bsf/mp3/Mp32RawFilter.ts",83),h.LR;const f=r[1]>>>3&3,u=(12&r[2])>>>2,b={dts:i,buffer:null,extradata:null,duration:d.N_},U=g.Y2(f,u);p.qg(this.frameHeader,r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]);let m=p.CM(this.frameHeader,U);if(b.buffer=r.subarray(t,t+m),t+m>r.length){this.cache=r.subarray(t),this.lastDts=i;break}const w=(0,l.k)(BigInt(Math.floor(m/U*d.SF)),d.KR,this.inTimeBase);b.duration=Number(w),this.caches.push(b),t+=m,i+=w,!n&&a&&(n=!0,i=s.f[17](e+16)||s.f[17](e+8))}return this.lastDts=BigInt(0),0}receiveAVPacket(e){if(this.caches.length){(0,u.Up)(e);const t=this.caches.shift(),i=(0,f.sY)(t.buffer.length);return(0,o.lW)(i,t.buffer.length,t.buffer),(0,u.NX)(e,i,t.buffer.length),n.M[17](e+16,t.dts),n.M[17](e+8,t.dts),n.M[17](e+48,BigInt(Math.floor(t.duration))),n.M[15](e+36,1|s.f[15](e+36)),0}return h.LT}reset(){return this.cache=null,this.lastDts=BigInt(0),0}}},58469:(e,t,i)=>{i.d(t,{Bq:()=>l,Ij:()=>d,XC:()=>h,f7:()=>f,uF:()=>n});var r=i(77231),s=i(37246);const n={1:"Main",2:"LC",3:"LC",4:"LC",5:"HE",6:"HE"},a={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,r.N_,r.N_,r.N_],c=[r.N_,1,2,3,4,5,6,7];function h(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){const{profile:i,sampleRate:s,channels:n}=function(e){let t=r.N_,i=r.N_,s=r.N_;var n,a;return e.length>=2&&(t=e[0]>>3&31,i=null!==(n=o[(7&e[0])<<1|e[1]>>7])&&void 0!==n?n:48e3,s=null!==(a=c[e[1]>>3&15])&&void 0!==a?a:2),{profile:t,sampleRate:i,channels:s}}(t);e.codecpar.profile=i,e.codecpar.sampleRate=s,e.codecpar.chLayout.nbChannels=n}}function d(e){const t=a[e.sampleRate],i=e.chLayout.nbChannels,r=new Uint8Array(2);return r[0]=(31&e.profile)<<3|(14&t)>>1,r[1]=(1&t)<<7|(15&i)<<3,r}function l(e){if(e.length<7)return-1;const t=e[0]<<4|e[1]>>4;if(4095!==t)return-1;const i=1&e[1],r=(192&e[2])>>>6,s=(60&e[2])>>>2,n=(1&e[2])<<2|(192&e[3])>>>6,a=(3&e[3])<<11|e[4]<<3|(224&e[5])>>>5,h=3&e[6];let d=1===i?7:9,l=a-d;return{syncWord:t,profile:r+1,sampleRate:o[s],channels:c[n],aacFrameLength:a,numberOfRawDataBlocksInFrame:h,headerLength:d,framePayloadLength:l}}function f(e,t){function i(){const e=t.readU(2);let i=0;for(let r=0;r<=e;r++)i<<=8,i|=t.readU(8);return i}t||(t=new s.A).appendBuffer(e);const r=t.getPointer(),n={syncWord:0,profile:0,sampleRate:0,channels:0,useSameStreamMux:!1,headerLength:0,framePayloadLength:0,muxLengthBytes:0},a=t.readU(11);if(695!==a)return-1;n.syncWord=a,n.muxLengthBytes=t.readU(13);const h=1===t.readU1();if(n.useSameStreamMux=h,!h){const e=1===t.readU1();if(e&&1===t.readU1())return-1;if(e&&i(),1!==t.readU1())return-1;if(0!==t.readU(6))return-1;if(0!==t.readU(4))return-1;if(0!==t.readU(3))return-1;let r=e?i():0;const s=t.readU(5);r-=5;const a=t.readU(4);r-=4;const h=t.readU(4);if(r-=4,t.readU(3),r-=3,r>0&&t.readU(r),0!==t.readU(3))return-1;if(t.readU(8),1===t.readU1())if(e)i();else{let e=0;for(;;){e<<=8;const i=1===t.readU1();if(e+=t.readU(8),!i)break}}1===t.readU1()&&t.readU(8),n.profile=s+1,n.sampleRate=o[a],n.channels=c[h]}let d=0;for(;;){const e=t.readU(8);if(d+=e,255!==e)break}return n.framePayloadLength=d,n.headerLength=t.getPointer()-r+(8===t.getBitLeft()?0:1),n}},87771:(e,t,i)=>{i.d(t,{R:()=>u,j:()=>s});var r=i(37246);const s=[3,4,3,7,259,263,1539,1543],n=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],a=[4,5,6,5],o=[4,6,7,6],c=[48e3,44100,32e3,0],h=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],d=[2,1,2,3,3,4,4,5],l=[1,2,3,6],f=7;function u(e){const t=new r.A(size);t.appendBuffer(e);const i={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitrate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(i.syncWord=t.readU(16),2935!==i.syncWord)return-1;if(i.bitstreamId=31&t.readU(29),i.bitstreamId>16)return-2;if(i.numBlocks=6,i.ac3BitrateCode=-1,i.centerMixLevel=5,i.surroundMixLevel=6,i.dolbySurroundMode=0,i.bitstreamId<=10){if(i.crc1=t.readU(16),i.srCode=t.readU(2),3===i.srCode)return-3;const e=t.readU(6);if(e>37)return-4;i.ac3BitrateCode=e>>1,t.readU(5),i.bitstreamMode=t.readU(3),i.channelMode=t.readU(3),2==i.channelMode?i.dolbySurroundMode=t.readU(2):(1&i.channelMode&&1!=i.channelMode&&(i.centerMixLevel=a[t.readU(2)]),4&i.channelMode&&(i.surroundMixLevel=o[t.readU(2)])),i.lfeOn=t.readU(1),i.srShift=Math.max(i.bitstreamId,8)-8,i.sampleRate=c[i.srCode]>>i.srShift,i.bitrate=1e3*h[i.ac3BitrateCode]>>i.srShift,i.channels=d[i.channelMode]+i.lfeOn,i.frameSize=2*n[e][i.srCode],i.frameType=2,i.substreamId=0}else{if(i.crc1=0,i.frameType=t.readU(2),3==i.frameType)return-5;if(i.substreamId=t.readU(3),i.frameSize=t.readU(11)+1<<1,i.frameSize<f)return-6;if(i.srCode=t.readU(2),3==i.srCode){const e=t.readU(2);if(3==e)return-7;i.sampleRate=c[e]/2,i.srShift=1}else i.numBlocks=l[t.readU(2)],i.sampleRate=c[i.srCode],i.srShift=0;i.channelMode=t.readU(3),i.lfeOn=t.readU(1),i.bitrate=8*i.frameSize*i.sampleRate/(256*i.numBlocks),i.channels=d[i.channelMode]+i.lfeOn}return i.channelLayout=BigInt.asUintN(64,s[i.channelMode]),i.lfeOn&&(i.channelLayout|=BigInt(8)),i}},29347:(e,t,i)=>{i.d(t,{R:()=>o});var r=i(37246);const s=[1,2,2,2,2,3,3,4,4,5,6,6,6,7,8,8],n=[0,8e3,16e3,32e3,0,0,11025,22050,44100,0,0,12e3,24e3,48e3,0,0],a=[32e3,56e3,64e3,96e3,112e3,128e3,192e3,224e3,256e3,32e4,384e3,448e3,512e3,576e3,64e4,768e3,96e4,1024e3,1152e3,128e4,1344e3,1408e3,1411200,1472e3,1536e3,192e4,2048e3,3072e3,384e4,0,0,0];function o(e){const t=new r.A(size);t.appendBuffer(e);const i={syncWord:0,frameType:0,sampleCount:0,crcFlag:0,sampleBlock:0,frameSize:0,channelIndex:0,sampleRateIndex:0,bitrateIndex:0,channels:0,sampleRate:0,bitrate:0};return i.syncWord=t.readU(32),2147385345!==i.syncWord?-1:(i.frameType=t.readU1(),i.sampleCount=t.readU(5),i.crcFlag=t.readU1(),i.sampleBlock=t.readU(7),i.frameSize=t.readU(14),i.channelIndex=t.readU(6),i.sampleRateIndex=t.readU(4),i.bitrateIndex=t.readU(5),i.channels=s[i.channelIndex],i.sampleRate=n[i.sampleRateIndex],i.bitrate=a[i.bitrateIndex],i)}},20620:(e,t,i)=>{i.d(t,{Jk:()=>I,KD:()=>B,MB:()=>w,S1:()=>x,XC:()=>k,ci:()=>_,oT:()=>A,tZ:()=>m,wf:()=>v});var r=i(63939),s=i(50932),n=i(72739),a=i(729),o=i(31865),c=i(37246),h=i(4624),d=i(14686),l=i(71517),f=i(60264),u=i(37837),p=i(23991),g=i(39381),b="src/avformat/codecs/h264.ts";const U=3,m={66:"Constrained Baseline",77:"Main",100:"High",110:"High10",122:"High422",244:"High444"};function w(e){const t=new o.A(e);t.skip(5);const i=[],r=[],s=[],n=31&t.readUint8();for(let e=0;e<n;e++){const e=t.readUint16();i.push(t.readBuffer(e))}const a=t.readUint8();for(let e=0;e<a;e++){const e=t.readUint16();r.push(t.readBuffer(e))}if(t.remainingSize()>4){t.skip(3);const e=t.readUint8();if(e>0)for(let i=0;i<e;i++){const e=t.readUint16();s.push(t.readBuffer(e))}}return{spss:i,ppss:r,spsExts:s}}function y(e,t,i=[]){e.length>32&&(h.R8(`h264 metadata's sps max length is 32, but get ${e.length}`,b,210),e=e.slice(0,32)),e.length>256&&(h.R8(`h264 metadata's pps max length is 256, but get ${e.length}`,b,214),e=e.slice(0,256));let r=7;r=e.reduce(((e,t)=>e+2+t.length),r),r=t.reduce(((e,t)=>e+2+t.length),r);const s=e[0],o=v(s);66!==o.profile&&77!==o.profile&&88!==o.profile&&(r+=4,i.length&&(r=i.reduce(((e,t)=>e+2+t.length),r)));const c=new Uint8Array(r),d=new a.A(c);return d.writeUint8(1),d.writeUint8(s[1]),d.writeUint8(s[2]),d.writeUint8(s[3]),d.writeUint8(252|U),d.writeUint8(224|31&e.length),n.__(e,(e=>{d.writeUint16(e.length),d.writeBuffer(e)})),d.writeUint8(t.length),n.__(t,(e=>{d.writeUint16(e.length),d.writeBuffer(e)})),66!==o.profile&&77!==o.profile&&88!==o.profile&&(d.writeUint8(252|o.chromaFormatIdc),d.writeUint8(248|o.bitDepthLumaMinus8),d.writeUint8(248|o.bitDepthChromaMinus8),i.length&&n.__(i,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),c}function x(e){let t=(0,f.py)(e);if(t.length>1){const e=[],i=[],r=[];if(t.forEach((t=>{const s=31&t[0];7===s?e.push(t):8===s?i.push(t):13===s&&r.push(t)})),e.length&&i.length)return y(e,i,r)}}function A(e){let t,i=(0,f.py)(e),r=!1;if(i.length>1){const e=[],r=[],s=[];i.forEach((t=>{const i=31&t[0];7===i?e.push(t):8===i?r.push(t):13===i&&s.push(t)})),e.length&&r.length&&(t=y(e,r,s)),i=i.filter((e=>{const t=31&e[0];return 9!==t&&8!==t&&7!==t&&13!==t}))}const s=i.reduce(((e,t)=>e+U+1+t.length),0),o=(0,u.sY)(s),c=(0,d.s3)(o,s),h=new a.A(c);return n.__(i,(e=>{3===U?h.writeUint32(e.length):2===U?h.writeUint24(e.length):1===U?h.writeUint16(e.length):h.writeUint8(e.length),h.writeBuffer(e.subarray(0)),5==(31&e[0])&&(r=!0)})),{bufferPointer:o,length:s,key:r,extradata:t}}function I(e,t){var i;if(!(1&r.f[15](e+36)))return;const s=(0,l.iI)(e);if((0,f.Bs)(s))return;const n=null!==(i=t.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:U;let a=[],c=[],h=[],p=[];const g=new o.A(s);for(;g.remainingSize()>0;){let e=0;e=3===n?g.readUint32():2===n?g.readUint24():1===n?g.readUint16():g.readUint8();const t=s.subarray(Number(BigInt.asIntN(32,g.getPos())),Number(BigInt.asIntN(32,g.getPos()))+e);g.skip(e);const i=31&t[0];7===i?a.push(t):8===i?c.push(t):13===i?h.push(t):p.push(t)}if(a.length||c.length){const t=y(a,c,h),i=(0,u.sY)(t.length);(0,d.lW)(i,t.length,t),(0,l.Ow)(e,1,i,t.length)}}function _(e,t=!1){if(!(1&r.f[15](e+36)||t))return;const i=(0,l.iI)(e);if(!(0,f.Bs)(i))return;let n=(0,f.py)(i);if(n.length>1){const t=[],i=[],a=[];if(n.forEach((e=>{const r=31&e[0];7===r?t.push(e):8===r?i.push(e):13===r&&a.push(e)})),t.length&&i.length){const n=y(t,i,a),o=(0,u.sY)(n.length);(0,d.lW)(o,n.length,n),(0,l.Ow)(e,1,o,n.length),s.M[15](e+36,1|r.f[15](e+36))}}}function k(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[4];const{spss:i}=w(t);if(i.length){const{profile:t,level:r,width:s,height:n}=v(i[0]);e.codecpar.profile=t,e.codecpar.level=r,e.codecpar.width=s,e.codecpar.height=n}}}function B(e,t=4){if(2===r.f[15](e+80))return(0,f.py)((0,d.s3)(r.f[20](e+24),r.f[15](e+28))).some((e=>5==(31&e[0])));{const i=r.f[15](e+28);let s=0;for(;s<i-t;){if(5==(31&g.r8(r.f[20](e+24)+(s+t))))return!0;s+=4===t?g.Sg(r.f[20](e+24)+s):3===t?g.ht(r.f[20](e+24)+s):2===t?g.yd(r.f[20](e+24)+s):g.r8(r.f[20](e+24)+s),s+=t}return!1}}function v(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);const i=(0,f.BN)(e.subarray(t)),r=new c.A(i.length);r.appendBuffer(i),r.readU1(),r.readU(2),r.readU(5);const s=r.readU(8);r.readU1(),r.readU1(),r.readU1(),r.readU1(),r.readU1(),r.readU1(),r.readU(2);const n=r.readU(8);p.xb(r);let a=1,o=0,h=0;if((100==s||110==s||122==s||244==s||44==s||83==s||86==s||118==s||128==s||138==s||139==s||134==s||135==s)&&(a=p.xb(r),3===a&&r.readU1(),o=p.xb(r),h=p.xb(r),r.readU1(),r.readU1())){const e=new Array(8);for(let t=0;t<(3!=a?8:12);t++)e[t]=r.readU1()}const d=p.xb(r),l=p.xb(r);let u=0,g=0;if(0===l)u=p.xb(r);else if(1===l){g=r.readU1(),p.$x(r),p.$x(r);const e=p.xb(r);for(let t=0;t<e;t++)p.$x(r)}p.xb(r),r.readU1();const b=p.xb(r),U=p.xb(r),m=r.readU1();let w=16*(b+1),y=(2-m)*(U+1)*16;m||r.readU1(),r.readU1();const x=r.readU1();if(x){let e=1,t=2-x;1===a?(e=2,t=2*(2-x)):2===x&&(e=2,t=2-x),w-=e*(p.xb(r)+p.xb(r)),y-=t*(p.xb(r)+p.xb(r))}return{profile:s,level:n,width:w,height:y,chromaFormatIdc:a,bitDepthLumaMinus8:o,bitDepthChromaMinus8:h,frameMbsOnlyFlag:m,picOrderCntType:l,log2MaxPicOrderCntLsbMinus4:u,deltaPicOrderAlwaysZeroFlag:g,log2MaxFrameNumMinus4:d}}},53e3:(e,t,i)=>{i.d(t,{HL:()=>U,Jk:()=>x,KD:()=>_,S1:()=>w,XC:()=>I,ZU:()=>B,ci:()=>A,dT:()=>g,oT:()=>y,wf:()=>k});var r=i(63939),s=i(50932),n=i(72739),a=i(729),o=i(31865),c=i(37246),h=i(14686),d=i(60264),l=i(71517),f=i(37837),u=i(23991),p=i(39381);const g={1:"Main",2:"Main10",3:"MainStillPicture",4:"Main444"},b=3;function U(e){const t=new o.A(e,!0);t.skip(22);let i=[],r=[],s=[];const n=t.readUint8();for(let e=0;e<n;e++){const e=63&t.readUint8(),n=t.readUint16(),a=[];for(let e=0;e<n;e++){const e=t.readUint16();a.push(t.readBuffer(e))}32===e?i=a:33===e?r=a:34===e&&(s=a)}return{vpss:i,spss:r,ppss:s}}function m(e,t,i){const r=t[0];let s=23;e.length&&(s+=3,s=e.reduce(((e,t)=>e+2+t.length),s)),t.length&&(s+=3,s=t.reduce(((e,t)=>e+2+t.length),s)),i.length&&(s+=3,s=i.reduce(((e,t)=>e+2+t.length),s));const o=new Uint8Array(s),c=new a.A(o,!0),h=k(r);c.writeUint8(1),c.writeUint8(r[1]),c.writeUint8(r[2]),c.writeUint8(r[3]),c.writeUint8(r[4]),c.writeUint8(r[5]),c.writeUint8(r[6]),c.writeUint8(r[7]),c.writeUint8(r[8]),c.writeUint8(r[9]),c.writeUint8(r[10]),c.writeUint8(r[11]),c.writeUint8(h.level),c.writeUint8(1020),c.writeUint8(0),c.writeUint8(16320),c.writeUint8(16320|h.chroma_format_idc),c.writeUint8(8160|h.bit_depth_luma_minus8),c.writeUint8(8160|h.bit_depth_chroma_minus8),c.writeUint16(0),c.writeUint8(8|(1&r[0])<<2|b);let d=0;return e.length&&d++,t.length&&d++,i.length&&d++,c.writeUint8(d),e.length&&(c.writeUint8(160),c.writeUint16(e.length),n.__(e,(e=>{c.writeUint16(e.length),c.writeBuffer(e)}))),t.length&&(c.writeUint8(161),c.writeUint16(t.length),n.__(t,(e=>{c.writeUint16(e.length),c.writeBuffer(e)}))),i.length&&(c.writeUint8(162),c.writeUint16(i.length),n.__(i,(e=>{c.writeUint16(e.length),c.writeBuffer(e)}))),o}function w(e){let t=(0,d.py)(e);if(t.length>=2){const e=[],i=[],r=[];if(t.forEach((t=>{const s=t[0]>>>1&63;32===s?e.push(t):33===s?i.push(t):34===s&&r.push(t)})),i.length&&r.length)return m(e,i,r)}}function y(e){let t,i=!1,r=(0,d.py)(e);if(r.length>=2){const e=[],i=[],s=[];r.forEach((t=>{const r=t[0]>>>1&63;32===r?e.push(t):33===r?i.push(t):34===r&&s.push(t)})),i.length&&s.length&&(t=m(e,i,s),r=r.filter((e=>{const t=e[0]>>>1&63;return 32!==t&&33!==t&&34!==t&&35!==t})))}const s=r.reduce(((e,t)=>e+b+1+t.length),0),o=(0,f.sY)(s),c=(0,h.s3)(o,s),l=new a.A(c);return n.__(r,(e=>{3===b?l.writeUint32(e.length):2===b?l.writeUint24(e.length):1===b?l.writeUint16(e.length):l.writeUint8(e.length),l.writeBuffer(e.subarray(0));const t=e[0]>>>1&63;19!==t&&20!==t&&21!==t||(i=!0)})),{bufferPointer:o,length:s,extradata:t,key:i}}function x(e,t){var i;if(!(1&r.f[15](e+36)))return;const s=(0,l.iI)(e);if((0,d.Bs)(s))return;const n=null!==(i=t.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:b;let a=[],c=[],u=[];const p=new o.A(s);for(;p.remainingSize()>0;){let e=0;e=3===n?p.readUint32():2===n?p.readUint24():1===n?p.readUint16():p.readUint8();const t=s.subarray(Number(BigInt.asIntN(32,p.getPos())),Number(BigInt.asIntN(32,p.getPos()))+e);p.skip(e);const i=t[0]>>>1&63;33===i?c.push(t):34===i?u.push(t):32===i&&a.push(t)}if(c.length||u.length||a.length){const t=m(a,c,u),i=(0,f.sY)(t.length);(0,h.lW)(i,t.length,t),(0,l.Ow)(e,1,i,t.length)}}function A(e,t=!1){if(!(1&r.f[15](e+36)||t))return;const i=(0,l.iI)(e);if(!(0,d.Bs)(i))return;let n=(0,d.py)(i);if(n.length>2){const t=[],i=[],a=[];if(n.forEach((e=>{const r=e[0]>>>1&63;32===r?t.push(e):33===r?i.push(e):34===r&&a.push(e)})),t.length&&i.length&&a.length){const n=m(t,i,a),o=(0,f.sY)(n.length);(0,h.lW)(o,n.length,n),(0,l.Ow)(e,1,o,n.length),s.M[15](e+36,1|r.f[15](e+36))}}}function I(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[21];const{spss:i}=U(t);if(i.length){const{profile:t,level:r,width:s,height:n}=k(i[0]);e.codecpar.profile=t,e.codecpar.level=r,e.codecpar.width=s,e.codecpar.height=n}}}function _(e,t=4){if(2===r.f[15](e+80))return(0,d.py)((0,h.s3)(r.f[20](e+24),r.f[15](e+28))).some((e=>{const t=e[0]>>>1&63;return 20===t||19===t}));{const i=r.f[15](e+28);let s=0;for(;s<i-t;){const i=p.r8(r.f[20](e+24)+(s+t))>>>1&63;if(20===i||19===i)return!0;s+=4===t?p.Sg(r.f[20](e+24)+s):3===t?p.ht(r.f[20](e+24)+s):2===t?p.yd(r.f[20](e+24)+s):p.r8(r.f[20](e+24)+s),s+=t}return!1}}function k(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);let i=0,r=0,s=0,n=0,a=0,o=0,h=1,l=0,f=0,p=0,g=0;const b=(0,d.BN)(e.subarray(t)),U=new c.A(b.length);U.appendBuffer(b),U.readU1(),U.readU(6),U.readU(6),U.readU(3),U.readU(4);const m=U.readU(3);U.readU1();let w=0;if(m<=6){l=U.readU(2),f=U.readU1(),i=U.readU(5),p=U.readU(32),g=U.readU(48),r=U.readU(8);const e=new Array(6),t=new Array(6);for(let i=0;i<m;i++)e[i]=U.readU1(),t[i]=U.readU1();if(m>0)for(let e=m;e<8;e++)U.readU(2);for(let i=0;i<m;i++)e[i]&&(U.readU(2),U.readU(1),U.readU(5),U.readU(32),U.readU(1),U.readU(1),U.readU(1),U.readU(1),U.readU(44)),t[i]&&U.readU(8);u.xb(U),h=u.xb(U),3===h&&(w=U.readU(1)),s=u.xb(U),n=u.xb(U);let c=0,d=0,b=0,y=0;U.readU1()&&(c=u.xb(U),d=u.xb(U),b=u.xb(U),y=u.xb(U)),a=u.xb(U),o=u.xb(U);let x=2,A=2;0===h?x=A=0:2===h?(x=2,A=1):3===h&&(x=A=1),s-=x*(1<<a+1)*(c+d),n-=A*(1<<a+1)*(b+y)}const y=u.xb(U)+4;for(let e=U.readU1()?0:m;e<m+1;e++)u.xb(U),u.xb(U),u.xb(U);const x=u.xb(U)+3,A=u.xb(U),I=u.xb(U)+2,_=u.xb(U),k=x+A,B=x-1,v=s+(1<<k)-1>>k,P=n+(1<<k)-1>>k;return{profile:i,level:r,width:s,height:n,chroma_format_idc:h,bit_depth_luma_minus8:a,bit_depth_chroma_minus8:o,general_profile_space:l,general_tier_flag:f,general_profile_compatibility_flags:p,constraint_flags:g,separate_colour_plane_flag:w,log2_min_cb_size:x,log2_diff_max_min_coding_block_size:A,log2_min_tb_size:I,log2_diff_max_min_transform_block_size:_,log2_max_trafo_size:_+I,log2_ctb_size:k,log2_min_pu_size:B,ctb_width:v,ctb_height:P,ctb_size:v*P,min_cb_width:s>>x,min_cb_height:n>>x,min_tb_width:s>>I,min_tb_height:n>>I,min_pu_width:s>>B,min_pu_height:n>>B,log2_max_poc_lsb:y}}function B(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);const i=(0,d.BN)(e.subarray(t)),r=new c.A(i.length);return r.appendBuffer(i),{pps_pic_parameter_set_id:u.xb(r),pps_seq_parameter_set_id:u.xb(r),dependent_slice_segment_flag:r.readU1(),output_flag_present_flag:r.readU1(),num_extra_slice_header_bits:r.readU(3)}}},89088:(e,t,i)=>{i.d(t,{Au:()=>m,He:()=>w,XC:()=>y,Y2:()=>g,hG:()=>b,oz:()=>U});var r=i(77231);const s=[44100,48e3,32e3,0],n=[22050,24e3,16e3,0],a=[11025,12e3,8e3,0],o=[0,1152,1152,384],c=[0,576,1152,384],h=[0,576,1152,384],d=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],l=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],f=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],u=[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],p=[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1];function g(e,t){switch(e){case 0:return a[t];case 2:return n[t];case 3:return s[t]}return r.N_}function b(e,t){switch(e){case 0:return h[t];case 2:return c[t];case 3:return o[t]}return r.N_}function U(e,t,i){switch(t){case 1:switch(e){case 0:case 2:return p[i];case 3:return f[i]}break;case 2:switch(e){case 0:case 2:return p[i];case 3:return l[i]}case 3:switch(e){case 0:case 2:return u[i];case 3:return d[i]}}return r.N_}function m(e){switch(e){case 1:return 34;case 2:return 33;case 3:return 32}return r.N_}const w={32:"Layer1",33:"Layer2",34:"Layer3"};function y(e,t){if(t&&t.length>=4){const i=t[1]>>>3&3,r=(6&t[1])>>1,s=(12&t[2])>>>2,n=3&~(t[3]>>>6)?2:1,a=m(r),o=g(i,s);e.codecpar.profile=a,e.codecpar.sampleRate=o,e.codecpar.chLayout.nbChannels=n}}},25906:(e,t,i)=>{i.d(t,{K:()=>s});var r=i(71517);function s(e){const t=(0,r.iI)(e);for(let e=0;e<t.length-6;e++)if(0===t[e]&&0===t[e+1]&&1===t[e+2]&&0===t[e+3])return 1==(t[e+5]>>3&7);return!1}},65451:(e,t,i)=>{i.d(t,{Ij:()=>h,XC:()=>c,kt:()=>o});var r=i(31865),s=i(729),n=i(44328);const a=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(e){let t=0,i=0,r=0;if(e.length<1)return 0;switch(t=e[0],i=a[t>>3],3&t){case 0:r=1;break;case 1:case 2:r=2;break;case 3:if(e.length<2)return 0;r=63&e[1]}return r*i}function c(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=19){const i=new r.A(t,!1);i.skip(9),e.codecpar.chLayout.nbChannels=i.readUint8(),e.codecpar.initialPadding=i.readUint16(),e.codecpar.sampleRate=i.readUint32(),e.codecpar.seekPreroll=Number((0,n.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function h(e){const t=new Uint8Array(19),i=new s.A(t,!1);return i.writeString("OpusHead"),i.writeUint8(1),i.writeUint8(e.chLayout.nbChannels),i.writeUint16(e.initialPadding),i.writeUint32(e.sampleRate),t}},55611:(e,t,i)=>{i.d(t,{Jk:()=>y,KD:()=>_,QA:()=>A,Ui:()=>B,XC:()=>I,ci:()=>x,oT:()=>w,wf:()=>k});var r=i(63939),s=i(50932),n=i(72739),a=i(729),o=i(31865),c=i(37246),h=i(14686),d=i(60264),l=i(71517),f=i(37837),u=i(23991),p=i(83314),g=i(39381);const b=3;function U(e){const t=e.readU(9),i=e.readU(3),r=e.readU(2),s=e.readU(2),n=e.readU(3);e.readU(5),e.readU(2);const a=e.readU(6),o=e.readU(7),c=e.readU(1),h=e.readU(8),d=e.readU(1),l=e.readU(1),f=[],u=[];if(a){for(let t=0;t<a-1;t++)f[t]=e.readU(8);f[a-1]=e.readU(6)}else e.readU(6);if(i>1){let t=0;for(let r=i-2;r>=0;--r)t|=e.readU(1)<<r;for(let t=i;t<=8&&i>1;++t)e.readU(1);for(let r=i-2;r>=0;--r)t&1<<r&&(u[r]=e.readU(8))}const p=e.readU(8),g=[];if(p)for(let t=0;t<p;t++)g.push(e.readU(8));return{olsIdx:t,numSublayers:i,bitDepthMinus8:n,chromaFormatIdc:s,constantFrameRate:r,generalProfileIdc:o,generalTierFlag:c,generalLevelIdc:h,ptlFrameOnlyConstraintFlag:d,ptlMultilayerEnabledFlag:l,generalConstraintInfo:f,sublayerLevelIdc:u,generalSubProfileIdc:g,maxPictureWidth:e.readU(16),maxPictureHeight:e.readU(16),avgFramerate:e.readU(16)}}function m(e,t,i){const r=t[0];let s;if(r){const e=k(r);let t=e.generalConstraintInfo;t.length||(t=new Array(12).fill(0));const i=new p.A;if(i.writeU(9,0),i.writeU(3,e.spsMaxSublayersMinus1+1),i.writeU(2,1),i.writeU(2,e.chromaFormatIdc),i.writeU(3,e.bitDepthMinus8),i.writeU(5,31),i.writeU(2,0),i.writeU(6,t.length),i.writeU(7,e.profile),i.writeU1(e.tierFlag),i.writeU(8,e.level),i.writeU1(e.ptlFrameOnlyConstraintFlag),i.writeU1(e.ptlMultilayerEnabledFlag),t.length){for(let e=0;e<t.length-1;e++)i.writeU(8,t[e]);i.writeU(6,t[t.length-1])}else i.writeU(6,63);if(e.spsMaxSublayersMinus1+1>1){let t=0;for(let i=e.spsMaxSublayersMinus1-1;i>=0;i--)t=t<<1|e.ptlSublayerLevelPresentFlag[i];i.writeU(e.spsMaxSublayersMinus1,t);for(let t=e.spsMaxSublayersMinus1+1;t<=8&&e.spsMaxSublayersMinus1>0;++t)i.writeU1(0);for(let t=e.spsMaxSublayersMinus1-1;t>=0;t--)e.ptlSublayerLevelPresentFlag[t]&&i.writeU(8,e.sublayerLevelIdc[t])}i.writeU(8,e.generalSubProfileIdc.length);for(let t=0;t<e.generalSubProfileIdc.length;t++)i.writeU(8,e.sublayerLevelIdc[t]);i.writeU(16,e.width),i.writeU(16,e.height),i.writeU(16,0),i.padding(),s=i.getBuffer().subarray(0,i.getPointer())}let o=2+(s?s.length:0);e.length&&(o+=3,o=e.reduce(((e,t)=>e+2+t.length),o)),t.length&&(o+=3,o=t.reduce(((e,t)=>e+2+t.length),o)),i.length&&(o+=3,o=i.reduce(((e,t)=>e+2+t.length),o));const c=new Uint8Array(o),h=new a.A(c,!0);h.writeUint8(b<<1|(s?1:0)|248),s&&h.writeBuffer(s);let d=0;return e.length&&d++,t.length&&d++,i.length&&d++,h.writeUint8(d),e.length&&(h.writeUint8(142),h.writeUint16(e.length),n.__(e,(e=>{h.writeUint16(e.length),h.writeBuffer(e)}))),t.length&&(h.writeUint8(143),h.writeUint16(t.length),n.__(t,(e=>{h.writeUint16(e.length),h.writeBuffer(e)}))),i.length&&(h.writeUint8(144),h.writeUint16(i.length),n.__(i,(e=>{h.writeUint16(e.length),h.writeBuffer(e)}))),c}function w(e){let t,i=!1,r=(0,d.py)(e);if(r.length>=2){const e=[],i=[],s=[];r.forEach((t=>{const r=t[1]>>>3&31;14===r?e.push(t):15===r?i.push(t):16===r&&s.push(t)})),i.length&&s.length&&(t=m(e,i,s),r=r.filter((e=>{const t=e[1]>>>3&31;return 14!==t&&15!==t&&16!==t&&20!==t})))}const s=r.reduce(((e,t)=>e+b+1+t.length),0),o=(0,f.sY)(s),c=(0,h.s3)(o,s),l=new a.A(c);return n.__(r,(e=>{3===b?l.writeUint32(e.length):2===b?l.writeUint24(e.length):1===b?l.writeUint16(e.length):l.writeUint8(e.length),l.writeBuffer(e.subarray(0));const t=e[1]>>>3&31;8!==t&&7!==t&&9!==t&&10!==t||(i=!0)})),{bufferPointer:o,length:s,extradata:t,key:i}}function y(e,t){var i;if(!(1&r.f[15](e+36)))return;const s=(0,l.iI)(e);if((0,d.Bs)(s))return;const n=null!==(i=t.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:b;let a=[],c=[],u=[];const p=new o.A(s);for(;p.remainingSize()>0;){let e=0;e=3===n?p.readUint32():2===n?p.readUint24():1===n?p.readUint16():p.readUint8();const t=s.subarray(Number(BigInt.asIntN(32,p.getPos())),Number(BigInt.asIntN(32,p.getPos()))+e);p.skip(e);const i=t[1]>>>3&31;15===i?c.push(t):16===i?u.push(t):14===i&&a.push(t)}if(c.length||u.length||a.length){const t=m(a,c,u),i=(0,f.sY)(t.length);(0,h.lW)(i,t.length,t),(0,l.Ow)(e,1,i,t.length)}}function x(e,t=!1){if(!(1&r.f[15](e+36)||t))return;const i=(0,l.iI)(e);if(!(0,d.Bs)(i))return;let n=(0,d.py)(i);if(n.length>2){const t=[],i=[],a=[];if(n.forEach((e=>{const r=e[1]>>>3&31;14===r?t.push(e):15===r?i.push(e):16===r&&a.push(e)})),t.length&&i.length&&a.length){const n=m(t,i,a),o=(0,f.sY)(n.length);(0,h.lW)(o,n.length,n),(0,l.Ow)(e,1,o,n.length),s.M[15](e+36,1|r.f[15](e+36))}}}function A(e,t){const{profile:i,level:r,width:s,height:n}=k(t);e.codecpar.profile=i,e.codecpar.level=r,e.codecpar.width=s,e.codecpar.height=n}function I(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=t[0]>>>1&3;const{spss:i}=function(e){const t=new o.A(e,!0);if(1&t.readUint8()){const i=new c.A;i.appendBuffer(e.subarray(1)),U(i),t.skip(i.getPointer())}let i=[],r=[],s=[];const n=t.readUint8();for(let e=0;e<n;e++){const e=31&t.readUint8();let n=1;13!==e&&12!==e&&(n=t.readUint16());const a=[];for(let e=0;e<n;e++){const e=t.readUint16();a.push(t.readBuffer(e))}14===e?i=a:15===e?r=a:16===e&&(s=a)}return{vpss:i,spss:r,ppss:s}}(t);i.length&&A(e,i[0])}}function _(e,t=4){if(2===r.f[15](e+80))return(0,d.py)((0,h.s3)(r.f[20](e+24),r.f[15](e+28))).some((e=>{const t=e[1]>>>3&31;return 8===t||7===t}));{const i=r.f[15](e+28);let s=0;for(;s<i-t;){const i=g.r8(r.f[20](e+24)+(s+t+1))>>>3&31;if(8===i||7===i)return!0;s+=4===t?g.Sg(r.f[20](e+24)+s):3===t?g.ht(r.f[20](e+24)+s):2===t?g.yd(r.f[20](e+24)+s):g.r8(r.f[20](e+24)+s),s+=t}return!1}}function k(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);let i=0,r=0,s=0,n=0,a=0,o=1,h=0,l=0,f=0;const p=[],g=[],b=[],U=[],m=(0,d.BN)(e.subarray(t)),w=new c.A(m.length);w.appendBuffer(m),w.readU1(),w.readU1(),w.readU(6),w.readU(5),w.readU(3),w.readU(8);const y=w.readU(3);o=w.readU(2);const x=w.readU(2);if(w.readU(1)){if(i=w.readU(7),h=w.readU(1),r=w.readU(8),l=w.readU(1),f=w.readU(1),w.readU(1)){for(let e=0;e<8;e++)p[e]=w.readU(8);p[8]=w.readU(7);const e=w.readU(8);w.readU(e)}w.skipPadding();for(let e=y-1;e>=0;e--)g[e]=w.readU(1);w.skipPadding();for(let e=y-1;e>=0;e--)g[e]&&(b[e]=w.readU(8));const e=w.readU(8);if(e)for(let t=0;t<e;t++)U[t]=w.readU(32)}w.readU1(),w.readU1()&&w.readU1();const A=s=u.xb(w),I=n=u.xb(w);if(w.readU1()&&(u.xb(w),u.xb(w),u.xb(w),u.xb(w)),w.readU1()){const e=u.xb(w),t=x+5,i=1<<t,r=A/(1<<t),s=I/(1<<t),n=Math.ceil(Math.log2(r)),a=Math.ceil(Math.log2(s));let o=0,c=0,h=0;e>0&&(h=w.readU1(),c=w.readU1());for(let t=0;e>0&&t<=e;t++)c&&0!=t||(t>0&&A>i&&w.readU(n),t>0&&I>i&&w.readU(a),t<e&&A>i&&w.readU(n),t<e&&I>i&&w.readU(a)),h||w.readU(2);if(o=u.xb(w)+1,w.readU(1)&&w.readU(1))for(let t=0;t<=e;t++)w.readU(o)}a=u.xb(w),w.readU(1),w.readU(1);const _=w.readU(4),k=w.readU(1);let B=0;k&&(B=u.xb(w));const v=[],P=w.readU(2);for(let e=0;e<8*P;e++)v[e]=w.readU(1);return{profile:i,level:r,width:s,height:n,chromaFormatIdc:o,bitDepthMinus8:a,generalProfileSpace:0,tierFlag:h,generalConstraintInfo:p,generalSubProfileIdc:U,ptlFrameOnlyConstraintFlag:l,ptlMultilayerEnabledFlag:f,spsMaxSublayersMinus1:y,ptlSublayerLevelPresentFlag:g,sublayerLevelIdc:b,sps_log2_max_pic_order_cnt_lsb_minus4:_,sps_poc_msb_cycle_flag:k,sps_poc_msb_cycle_len_minus1:B,sps_num_extra_ph_bytes:P,sps_extra_ph_bit_present_flag:v}}function B(e){0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(e=function(e){let t=(0,d.py)(e);if(t.length>=2){const e=[],i=[],r=[];if(t.forEach((t=>{const s=t[1]>>>3&31;14===s?e.push(t):15===s?i.push(t):16===s&&r.push(t)})),i.length&&r.length)return m(e,i,r)}}(e));const t=new c.A;return t.appendBuffer(e),1&t.readU(8)?U(t):{}}},85947:(e,t,i)=>{i.d(t,{A:()=>s});var r=i(134);class s{constructor(){(0,r.A)(this,"type",-1),(0,r.A)(this,"onStreamAdd",void 0)}destroy(e){}}},83855:(e,t,i)=>{i.r(t),i.d(t,{default:()=>T});var r=i(134),s=i(80662),n=i.n(s),a=i(61499),o=i(63939),c=i(50932),h=i(4624),d=i(9705),l=i(51660),f=i(6403),u=i(85947),p=i(71517),g=i(77231),b=i(52071),U=i(44328),m=i(72739),w=i(89088),y=i(20620),x=i(53e3),A=i(55611),I=i(58469),_=i(65451),k=i(25906),B=i(37837),v=i(14686),P=i(10662),M=i(92647),S=i(60264),R=i(56397),L=i(75294),z=i(87771),C=i(29347),D=i(67672),E=i(51113),F=i(7309),N="src/avformat/formats/IMpegpsFormat.ts";class T extends u.A{constructor(){super(),(0,r.A)(this,"type",3),(0,r.A)(this,"context",void 0),(0,r.A)(this,"cacheAVPacket",void 0),this.context={headerState:255,psmType:new(n()),pes:new f.xf,slices:new(n()),lastPtsMap:new(n()),imkhCctv:!1,sofdec:!1,ioEnded:!1}}init(e){e.ioReader&&e.ioReader.setEndian(!0),this.cacheAVPacket=0}destroy(e){super.destroy(e),this.cacheAVPacket&&((0,p.Qe)(this.cacheAVPacket),this.cacheAVPacket=0),m.__(e.streams,(e=>{const t=e.privData;t.filter&&(t.filter.destroy(),t.filter=null)}))}async findNextStartCode(e){let t=255,i=0;for(;i<P.V;){const r=await e.ioReader.readUint8();if(1===t){t=16777215&(t<<8|r);break}t=16777215&(t<<8|r),i++}return i===P.V&&(t=-1),this.context.headerState=t,t}async parsePSM(e){const t=await e.ioReader.readUint16();await e.ioReader.skip(2);const i=await e.ioReader.readUint16();await e.ioReader.skip(i),await e.ioReader.readUint16();let r=t-i-10;for(;r>=4;){const t=await e.ioReader.readUint8(),i=await e.ioReader.readUint8(),s=await e.ioReader.readUint16();this.context.psmType.set(i,t),await e.ioReader.skip(s),r-=s+4}await e.ioReader.readUint32()}async readPES(e){for(;;){const t=await this.findNextStartCode(e);if(t<0)return d.LR;if(442===t||443===t)continue;if(446===t||447===t){const t=await e.ioReader.readUint16();await e.ioReader.skip(t);continue}if(444===t){await this.parsePSM(e);continue}if(!(t>=448&&t<=479||t>=480&&t<=495||445==t||447==t||509==t))continue;const i=await e.ioReader.readUint16();this.context.pes.pos=e.ioReader.getPos()-BigInt(6),this.context.pes.streamId=255&t,this.context.pes.streamType=this.context.psmType[this.context.pes.streamId];const r=new Uint8Array(i+6);return r[0]=0,r[1]=0,r[2]=1,r[3]=this.context.pes.streamId,r[4]=i>>8,r[5]=255&i,await e.ioReader.readBuffer(i,r.subarray(6)),this.context.pes.data=r,t}}createStream(e,t,i,r){let s=0,n=-1;switch(i){case 226:n=0,s=27;break;case 128:n=1,s=86019;break;case 136:n=1,s=86020;break;case 160:n=1,s=65537;break;case 32:n=3,s=94208;break;default:switch(t){case 1:case 2:n=0,s=2;break;case 3:case 4:n=1,s=86017;break;case 15:n=1,s=86018;break;case 16:n=0,s=12;break;case 27:n=0,s=27;break;case 36:n=0,s=173;break;case 51:n=0,s=196;break;case 129:n=1,s=86019;break;case 144:n=1,s=65543;break;case 145:n=1,s=65542;break;case 447:n=2,s=98312;break;default:if(r>=480&&r<=495)n=0,s=87;else if(r>=448&&r<=479)n=1,s=86017;else if(r>=128&&r<=135)n=1,s=86019;else if(r>=136&&r<=143||r>=152&&r<=159)n=1,s=86020;else if(r>=176&&r<=191)n=1,s=86060;else if(r>=192&&r<=207)n=1,s=86019;else if(r>=32&&r<=63)n=3,s=94208;else{if(!(r>=64853&&r<=64863))return;n=0,s=70}}}const o=e.createStream();o.codecpar.codecType=n,o.codecpar.codecId=s,o.timeBase.den=9e4,o.timeBase.num=1;const c=o.privData={streamId:i,streamType:t,filter:null};return 65543!==s&&65542!==s||(o.codecpar.chLayout.nbChannels=1,o.codecpar.sampleRate=8e3,o.codecpar.chLayout.order=1,o.codecpar.chLayout.u.mask=BigInt(4)),86017===o.codecpar.codecId?c.filter=new R.A:86019===o.codecpar.codecId?c.filter=new E.A:86020===o.codecpar.codecId&&(c.filter=new F.A),c.filter&&c.filter.init(o.codecpar[a.o9],o.timeBase[a.o9]),o}async readHeader(e){const t=await e.ioReader.peekString(6);if("IMKH"===t.substring(0,4)?(this.context.imkhCctv=!0,await e.ioReader.skip(4)):"Sofdec"===t&&(this.context.sofdec=!0,await e.ioReader.skip(6)),442!==await e.ioReader.peekUint32())return h.z3("the file format is not mpegps",N,379),d.LR;if(1&e.ioReader.flags){const t=e.ioReader.getPos(),i=BigInt(500)*BigInt(1e3);let r=await e.ioReader.fileSize()-i;r<t&&(r=t),await e.ioReader.seek(r);try{for(this.context.pes.pts=g.Dh;;)await this.readPES(e),(0,l.A)(this.context.pes),this.context.pes.pts!==g.Dh&&this.context.lastPtsMap.set(this.context.pes.streamId,this.context.pes.pts)}catch(i){await e.ioReader.seek(t)}}return this.context.ioEnded=!1,0}checkExtradata(e,t){if(86017===t.codecpar.codecId&&t.codecpar.sampleRate===g.N_){const i=(0,p.iI)(e),r=i[1]>>>3&3,s=(6&i[1])>>1,n=(12&i[2])>>>2,a=3&~(i[3]>>>6)?2:1,o=w.Au(s),c=w.Y2(r,n);t.codecpar.profile=o,t.codecpar.sampleRate=c,t.codecpar.chLayout.nbChannels=a}else if(86019===t.codecpar.codecId&&t.codecpar.sampleRate===g.N_){const i=(0,p.iI)(e),r=z.R(i);D.ai(r)||(t.codecpar.sampleRate=r.sampleRate,t.codecpar.chLayout.nbChannels=r.channels,t.codecpar.bitrate=BigInt(r.bitrate))}else if(86020===t.codecpar.codecId&&t.codecpar.sampleRate===g.N_){const i=(0,p.iI)(e),r=C.R(i);D.ai(r)||(t.codecpar.sampleRate=r.sampleRate,t.codecpar.chLayout.nbChannels=r.channels,t.codecpar.bitrate=BigInt(0|r.bitrate))}else if(!t.codecpar.extradata){let i=(0,p.rU)(e,1);i&&(t.codecpar.extradata=(0,B.sY)(o.f[15](i+4)),(0,v.Mr)(t.codecpar.extradata,o.f[20](i),o.f[15](i+4)),t.codecpar.extradataSize=o.f[15](i+4),(0,p.Is)(e,1),27===t.codecpar.codecId?y.XC(t,(0,v.JW)(t.codecpar.extradata,t.codecpar.extradataSize)):173===t.codecpar.codecId?x.XC(t,(0,v.JW)(t.codecpar.extradata,t.codecpar.extradataSize)):196===t.codecpar.codecId?A.XC(t,(0,v.JW)(t.codecpar.extradata,t.codecpar.extradataSize)):86018===t.codecpar.codecId?I.XC(t,(0,v.JW)(t.codecpar.extradata,t.codecpar.extradataSize)):86076===t.codecpar.codecId&&_.XC(t,(0,v.JW)(t.codecpar.extradata,t.codecpar.extradataSize)))}}parseSlice(e,t,i,r){const s=(0,M.A)(Uint8Array,e.buffers),n=r.privData;1===r.codecpar.codecType&&c.M[15](i+36,1|o.f[15](i+36));const a=r.codecpar.codecId;27!==a&&173!==a&&196!==a||c.M[15](i+80,2),c.M[15](i+32,r.index),c.M[17](i+16,e.dts),c.M[17](i+8,e.pts),c.M[17](i+56,e.pos),c.M[15](i+76,9e4),c.M[15](i+72,1),r.startTime===g.Dh&&(r.startTime=o.f[17](i+8)||o.f[17](i+16),this.context.lastPtsMap.has(n.streamId)&&(r.duration=this.context.lastPtsMap.get(n.streamId)-r.startTime));const l=(0,B.sY)(s.length);if((0,v.lW)(l,s.length,s),(0,p.NX)(i,l,s.length),n.filter){let e=0;if(e=n.filter.sendAVPacket(i),e<0)return h.z3("send avpacket to bsf failed",N,527),d.LR;if(e=n.filter.receiveAVPacket(i),e<0)return h.z3("receive avpacket from bsf failed",N,534),d.LR;for(c.M[15](i+76,9e4),c.M[15](i+72,1),c.M[15](i+32,r.index),this.checkExtradata(i,r);;){const i=this.cacheAVPacket||(0,p._5)();if(e=n.filter.receiveAVPacket(i),0!==e){this.cacheAVPacket=i;break}c.M[15](i+76,9e4),c.M[15](i+72,1),c.M[15](i+32,r.index),this.checkExtradata(i,r),t.interval.packetBuffer.push(i),this.cacheAVPacket=0}}else 2===r.codecpar.codecId?k.K(i)&&c.M[15](i+36,1|o.f[15](i+36)):27===r.codecpar.codecId?(r.codecpar.extradata||(y.ci(i,!0),this.checkExtradata(i,r),r.codecpar.bitFormat=2),y.KD(i)&&c.M[15](i+36,1|o.f[15](i+36))):173===r.codecpar.codecId?(r.codecpar.extradata||(x.ci(i,!0),this.checkExtradata(i,r),r.codecpar.bitFormat=2),x.KD(i)&&c.M[15](i+36,1|o.f[15](i+36))):196===r.codecpar.codecId&&(r.codecpar.extradata||(A.ci(i,!0),this.checkExtradata(i,r),r.codecpar.bitFormat=2),A.KD(i)&&c.M[15](i+36,1|o.f[15](i+36)))}async readAVPacket_(e,t){for(;;){const i=await this.readPES(e);let r=e.streams.find((e=>e.privData.streamId===this.context.pes.streamId));if(!r){const t=255&i;r=this.createStream(e,this.context.psmType.get(t),t,i)}if(r){const i=r.privData;if((0,l.A)(this.context.pes),!this.context.pes.payload)continue;let s=this.context.slices.get(i.streamId);if(s||(s={pts:-BigInt(1),dts:-BigInt(1),pos:-BigInt(1),buffers:[]},this.context.slices.set(i.streamId,s)),this.context.pes.dts!==g.Dh&&s.buffers.length){if(0===r.codecpar.codecType){const e=S.Ky(this.context.pes.payload,0);e.offset>3&&(s.buffers.push(this.context.pes.payload.subarray(0,e.offset)),this.context.pes.payload=this.context.pes.payload.subarray(e.offset))}return this.parseSlice(s,e,t,r),s.buffers.length=0,s.buffers.push(this.context.pes.payload),s.dts=this.context.pes.dts,s.pts=this.context.pes.pts,s.pos=this.context.pes.pos,0}if(this.context.pes.dts!==g.Dh)if(s.dts=this.context.pes.dts,s.pts=this.context.pes.pts,s.pos=this.context.pes.pos,0===r.codecpar.codecType){const e=S.Ky(this.context.pes.payload,0);e.offset>3&&(this.context.pes.payload=this.context.pes.payload.subarray(e.offset))}else if(86019===r.codecpar.codecId||86020===r.codecpar.codecId||86017===r.codecpar.codecId){let e=0,t=2;86019===r.codecpar.codecId?e=11:86017===r.codecpar.codecId?e=255:(e=127,t=4);for(let i=0;i<this.context.pes.payload.length-t;i++)if(this.context.pes.payload[i]===e){const e=this.context.pes.payload[i+1],t=2;if(!(86017!==r.codecpar.codecId||224&~e)){if(0!==i){let e=0,r=0;for(;;){const s=new L.Vz;L.qg(s,this.context.pes.payload[i+r]<<24|this.context.pes.payload[i+r+1]<<16|this.context.pes.payload[i+r+2]<<8|this.context.pes.payload[i+r+3]);const n=this.context.pes.payload[i+r+1]>>>3&3,a=(12&this.context.pes.payload[i+r+2])>>>2,o=w.Y2(n,a);let c=L.CM(s,o);if(!(c&&i+r+c<this.context.pes.payload.length-2&&255===this.context.pes.payload[i+r+c])||224&~this.context.pes.payload[i+r+c+1])break;if(e++,r+=c,e===t)break}if(e!==t)continue;this.context.pes.payload=this.context.pes.payload.subarray(i)}break}if(86019===r.codecpar.codecId&&119===e){if(0!==i){let e=0,r=0;for(;;){const s=z.R(this.context.pes.payload.subarray(i+r));if(D.ai(s)||!(i+r+s.frameSize<this.context.pes.payload.length-2)||11!==this.context.pes.payload[i+r+s.frameSize]||119!==this.context.pes.payload[i+r+s.frameSize+1])break;if(e++,r+=s.frameSize,e===t)break}if(e!==t)continue;this.context.pes.payload=this.context.pes.payload.subarray(i)}break}if(86020===r.codecpar.codecId&&254===e&&128===this.context.pes.payload[i+2]&&129===this.context.pes.payload[i+3]){if(0!==i){let e=0,r=0;for(;;){const s=C.R(this.context.pes.payload.subarray(i+r));if(D.ai(s)||!(i+r+s.frameSize<this.context.pes.payload.length-4)||127!==this.context.pes.payload[i+r+s.frameSize]||254!==this.context.pes.payload[i+r+s.frameSize+1]||128!==this.context.pes.payload[i+r+s.frameSize+2]||129!==this.context.pes.payload[i+r+s.frameSize+3])break;if(e++,r+=s.frameSize,e===t)break}if(e!==t)continue;this.context.pes.payload=this.context.pes.payload.subarray(i)}break}}}s.buffers.push(this.context.pes.payload)}}}async readAVPacket(e,t){try{if(this.context.ioEnded){if(this.context.slices.size){let i,r;if(this.context.slices.forEach(((t,s)=>{t.buffers.length&&(r=e.streams.find((e=>e.privData.streamId===s)),r&&(i=t))})),i)return this.parseSlice(i,e,t,r),i.buffers.length=0,i.pts=i.dts=i.pos=-BigInt(1),0}return-1048576}return await this.readAVPacket_(e,t)}catch(i){return-1048576!==e.ioReader.error?(h.z3(`read packet error, ${i}`,N,848),d.LR):(this.context.ioEnded=!0,this.readAVPacket(e,t))}}async syncPSPacket(e){let t=g.Dh;try{for(this.context.pes.pts=g.Dh;this.context.pes.pts===g.Dh;)await this.readPES(e),(0,l.A)(this.context.pes),t=this.context.pes.pos}catch(e){t=g.Dh}t!==g.Dh&&await e.ioReader.seek(t)}async seek(e,t,i,r){let s=e.ioReader.getPos();if(this.context.slices.forEach((e=>{e.buffers.length&&e.pos<s&&(s=e.pos),e.buffers.length=0,e.pts=e.dts=e.pos=-BigInt(1)})),e.streams.forEach((e=>{const t=e.privData;t.filter&&t.filter.reset()})),2&r){const t=await e.ioReader.fileSize();return t<=BigInt(0)?BigInt(d.E$):(i<BigInt(0)?i=BigInt(0):i>t&&(i=t),await e.ioReader.seek(i),4&r||await this.syncPSPacket(e),this.context.ioEnded=!1,s)}{if(t&&t.sampleIndexes.length){let r=m.El(t.sampleIndexes,(e=>e.pts>i?-1:1));if(r>0&&(0,U.k)(i-t.sampleIndexes[r-1].pts,t.timeBase,g.i0)<BigInt(1e4))return h.Yz(`seek in sampleIndexes, found index: ${r}, pts: ${t.sampleIndexes[r-1].pts}, pos: ${t.sampleIndexes[r-1].pos}`,N,933),await e.ioReader.seek(t.sampleIndexes[r-1].pos),this.context.ioEnded=!1,s}h.Yz("not found any keyframe index, try to seek in bytes",N,940);let r=await(0,b.A)(e,t,i,BigInt(0),this.readAVPacket.bind(this),this.syncPSPacket.bind(this));return r>=0&&(this.context.ioEnded=!1),r}}getAnalyzeStreamsCount(){return 1}}},75294:(e,t,i)=>{i.d(t,{CM:()=>o,Vz:()=>n,qg:()=>a});var r=i(134),s=i(89088);class n{constructor(){(0,r.A)(this,"version",void 0),(0,r.A)(this,"layer",void 0),(0,r.A)(this,"protection",void 0),(0,r.A)(this,"bitrateIndex",void 0),(0,r.A)(this,"samplingFrequency",void 0),(0,r.A)(this,"padding",void 0),(0,r.A)(this,"private",void 0),(0,r.A)(this,"mode",void 0),(0,r.A)(this,"modeExtension",void 0),(0,r.A)(this,"copyright",void 0),(0,r.A)(this,"original",void 0),(0,r.A)(this,"emphasis",void 0)}}function a(e,t){e.version=t>>19&3,e.layer=t>>17&3,e.protection=t>>16&1,e.bitrateIndex=t>>12&15,e.samplingFrequency=t>>10&3,e.padding=t>>9&1,e.mode=t>>6&3,e.modeExtension=t>>4&3,e.copyright=t>>3&1,e.original=t>>2&1,e.emphasis=3&t}function o(e,t){let i=s.oz(e.version,e.layer,e.bitrateIndex);switch(e.layer){case 1:default:i=144e3*i/(t<<(3===e.version?0:1))>>>0,i+=e.padding;break;case 2:i=144e3*i/t>>>0,i+=e.padding;break;case 3:i=12e3*i/t>>>0,i=4*(i+e.padding)}return i}},51660:(e,t,i)=>{i.d(t,{A:()=>o});var r=i(77231),s=i(4624),n=i(9705),a="src/avformat/formats/mpegts/function/parsePES.ts";function o(e){const t=e.data,i=t[3],o=t[4]<<8|t[5];let c=0,h=0,d=0;if(188!==i&&190!==i&&191!==i&&240!==i&&241!==i&&255!==i&&242!==i&&248!==i){let i=r.Dh,l=r.Dh;for(;;){if(6+h>=t.length)return;if(d=t[6+h],255!==d)break;h++}if(64==(192&d)&&(h+=2,d=t[6+h]),32==(224&d))c+=5,i=i=BigInt(Math.floor(536870912*(14&t[6+h])+4194304*(255&t[7+h])+16384*(254&t[8+h])+128*(255&t[9+h])+(254&t[10+h])/2)),16&d?(l=BigInt(Math.floor(536870912*(14&t[11+h])+4194304*(255&t[12+h])+16384*(254&t[13+h])+128*(255&t[14+h])+(254&t[15+h])/2)),c+=5):l=i;else if(128==(192&d)){const e=(192&t[7+h])>>>6;c=3+t[8+h],2!==e&&3!==e||(i=BigInt(Math.floor(536870912*(14&t[9+h])+4194304*(255&t[10+h])+16384*(254&t[11+h])+128*(255&t[12+h])+(254&t[13+h])/2)),l=3===e?BigInt(Math.floor(536870912*(14&t[14+h])+4194304*(255&t[15+h])+16384*(254&t[16+h])+128*(255&t[17+h])+(254&t[18+h])/2)):i)}else{if(15!==d)return s.z3("invalid data",a,121),n.LR;c=1}e.dts=l,e.pts=i;const f=6+h+c;let u=0;if(0!==o){if(o<h+c)return void s.z3("Malformed PES: PES_packet_length < 3 + PES_header_data_length",a,133);u=o-(h+c)}else u=t.byteLength-f;e.payload=t.subarray(f,f+u)}else if((188===i||191===i||240===i||241===i||255===i||242===i||248===i)&&6===e.streamId){const i=6;let r=0;r=0!==o?o:t.byteLength-i,e.payload=t.subarray(i,i+r)}return 0}},10662:(e,t,i)=>{i.d(t,{V:()=>r});const r=1e5},6403:(e,t,i)=>{i.d(t,{Cd:()=>d,I4:()=>f,am:()=>c,kJ:()=>l,pi:()=>h,xf:()=>u});var r=i(134),s=i(80662),n=i.n(s),a=i(77231);class o{constructor(){(0,r.A)(this,"discontinuityIndicator",0),(0,r.A)(this,"randomAccessIndicator",0),(0,r.A)(this,"elementaryStreamPriorityIndicator",0),(0,r.A)(this,"pcrFlag",0),(0,r.A)(this,"opcrFlag",0),(0,r.A)(this,"splicingPointFlag",0),(0,r.A)(this,"transportPrivateDataFlag",0),(0,r.A)(this,"adaptationFieldExtensionFlag",0),(0,r.A)(this,"pcr",BigInt(0)),(0,r.A)(this,"opcr",BigInt(0)),(0,r.A)(this,"spliceCountDown",0),(0,r.A)(this,"transportPrivateData",null),(0,r.A)(this,"extension",null)}}class c{constructor(){(0,r.A)(this,"pos",a.Dh),(0,r.A)(this,"payloadUnitStartIndicator",0),(0,r.A)(this,"transportPriority",0),(0,r.A)(this,"pid",a.N_),(0,r.A)(this,"adaptationFieldControl",0),(0,r.A)(this,"continuityCounter",0),(0,r.A)(this,"transportScramblingControl",0),(0,r.A)(this,"adaptationFieldInfo",new o),(0,r.A)(this,"payload",null)}}class h{constructor(){(0,r.A)(this,"slices",[]),(0,r.A)(this,"totalLength",0),(0,r.A)(this,"expectedLength",a.N_),(0,r.A)(this,"randomAccessIndicator",0),(0,r.A)(this,"pid",a.N_),(0,r.A)(this,"streamType",0),(0,r.A)(this,"pos",a.Dh)}}class d{constructor(){(0,r.A)(this,"versionNumber",0),(0,r.A)(this,"networkPid",a.N_),(0,r.A)(this,"program2PmtPid",new(n()))}}class l{constructor(){(0,r.A)(this,"tag",void 0),(0,r.A)(this,"buffer",void 0)}}class f{constructor(){(0,r.A)(this,"versionNumber",0),(0,r.A)(this,"programNumber",0),(0,r.A)(this,"pcrPid",0),(0,r.A)(this,"pid2StreamType",new(n())),(0,r.A)(this,"pid2ESDescriptor",new(n()))}}class u{constructor(){(0,r.A)(this,"pid",a.N_),(0,r.A)(this,"streamType",0),(0,r.A)(this,"streamId",a.N_),(0,r.A)(this,"dts",a.Dh),(0,r.A)(this,"pts",a.Dh),(0,r.A)(this,"pos",a.Dh),(0,r.A)(this,"payload",null),(0,r.A)(this,"data",null),(0,r.A)(this,"randomAccessIndicator",0)}}},2187:(e,t,i)=>{i.d(t,{d:()=>a});var r=i(72739),s=i(44328),n=i(77231);function a(e,t,i){let a=BigInt(0);return r.__(e,(e=>{a+=e.codecpar.bitrate*(0,s.k)(t,i,n.i0)/BigInt(8e3)})),a}},52071:(e,t,i)=>{i.d(t,{A:()=>u});var r=i(63939),s=i(9599),n=i(29170),a=i(77231),o=i(44328),c=i(2187),h=i(71517),d=i(9705),l=i(4624),f="src/avformat/function/seekInBytes.ts";async function u(e,t,i,u,p,g){const b=e.ioReader.getPos(),U=await e.ioReader.fileSize();let m=a.Dh,w=i;t.startTime!==a.Dh?w-=t.startTime:w-=t.firstDTS;const y=(0,o.k)(i,t.timeBase,a.i0);if(y<BigInt(1e4))return l.Yz(`seek pts is earlier then 10s, seek to first packet pos(${u}) directly`,f,63),await e.ioReader.seek(u),b;let x=(0,c.d)(e.streams,w,t.timeBase);const A=U-(0,c.d)(e.streams,BigInt(1e4),a.i0),I=(0,c.d)(e.streams,BigInt(1e4),a.i0);if(x>A&&(x=A),x<u)return await e.ioReader.seek(u),b;const _=(0,h._5)();let k=U,B=BigInt(0);for(;;){if(k-B<I){m=B;break}await e.ioReader.seek(x),await g(e);const t=e.ioReader.getPos();if(!(await p(e,_)>=0)){m=a.Dh;break}{const e=(0,o.k)(r.f[17](_+8),(0,n.A)(_+72,s.P),a.i0),i=e-y;if(l.Yz(`try to seek to pos: ${x}, got packet pts: ${r.f[17](_+8)}(${e}ms), diff: ${i}ms`,f,98),i<=BigInt(0)&&-i<BigInt(1e4)){m=t;break}i>BigInt(0)?(k=x,x=B+k>>BigInt(1)):(B=x,x=B+k>>BigInt(1))}}return(0,h.Qe)(_),m!==a.Dh?(l.Yz(`finally seek to pos ${m}`,f,126),await e.ioReader.seek(m),await g(e),b):(await e.ioReader.seek(b),BigInt(d.E$))}},23991:(e,t,i)=>{function r(e){let t=0,i=0;for(;i<32&&0===e.readU1();)i++;return t=e.readU(i),t+=(1<<i)-1,t}function s(e){let t=r(e);return t=1&t?(t+1)/2:-t/2,t}i.d(t,{$x:()=>s,xb:()=>r})},39381:(e,t,i)=>{i.d(t,{E3:()=>n,Sg:()=>h,Y0:()=>c,ht:()=>o,r8:()=>s,yd:()=>a});var r=i(63939);function s(e){return r.f[2](e)}function n(e){return s(e+1)<<8|s(e)}function a(e){return s(e)<<8|s(e+1)}function o(e){return s(e)<<16|s(e+1)<<8|s(e+2)}function c(e){return n(e+2)<<16|n(e)}function h(e){return a(e)<<16|a(e+2)}},60264:(e,t,i)=>{function r(e){return e.length>4&&0===e[0]&&0===e[1]&&(1===e[2]||0===e[2]&&1===e[3])}function s(e,t){let i=0;for(let r=t;r<e.length;r++)switch(e[r]){case 0:i++;break;case 1:if(i>=2)return{offset:r-Math.min(i,3),startCode:Math.min(i+1,4)};i=0;break;default:i=0}return{offset:-1,startCode:0}}function n(e){const t=[];let i=s(e,0),r={offset:-1,startCode:0};for(;r=s(e,i.offset+i.startCode),r.offset>-1;)t.push(e.subarray(i.offset+i.startCode,r.offset,!0)),i=r;return t.push(e.subarray(i.offset+i.startCode,void 0,!0)),t}function a(e,t=0,i){i||(i=e.length);const r=new Uint8Array(e.length);let s=0,n=0;for(let a=0;a<e.length;a++){if(a>=t&&a<i)if(0===e[a])s++;else if(3===e[a]&&2===s&&a+1<e.length&&e[a+1]<=3){if(a++,a===e.length)break;s=0===e[a]?1:0}else s=0;r[n++]=e[a]}return r.slice(0,n)}i.d(t,{BN:()=>a,Bs:()=>r,Ky:()=>s,py:()=>n})},37246:(e,t,i)=>{i.d(t,{A:()=>n});var r=i(134),s=i(4624);class n{constructor(e=1048576){(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"bitsLeft",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"endPointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.pos=BigInt(0),this.size=e,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}peekU1(){let e=0;(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();let t=this.pointer,i=this.bitsLeft;return 0===i&&(t++,i=8),e=this.buffer[t]>>i-1&1,e}readU1(){let e=0;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,e=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8,this.pos++),e}readU(e){let t=0;for(let i=0;i<e;i++)t|=this.readU1()<<e-i-1;return t}remainingLength(){return this.endPointer-this.pointer}getBitLeft(){return this.bitsLeft}getPointer(){return this.pointer}setPointer(e){this.pointer=e}getPos(){return this.pos}skip(e){const t=(e-e%8)/8;this.pointer+=t,this.pos+=BigInt(t);const i=e%8;this.bitsLeft<=i?(this.pointer++,this.pos++,this.bitsLeft=8-(i-this.bitsLeft)):this.bitsLeft-=i}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&(this.pointer++,this.pos++),!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);const e=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(e<0)throw this.error=e,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+e,this.pointer=0}else{const e=this.onFlush(this.buffer);if(this.endPointer=e,this.pointer=0,this.bitsLeft=8,e<0)throw this.error=e,Error("IOReader error, flush failed")}}getBuffer(){return this.buffer}appendBuffer(e){if(this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else{const t=Math.min(this.size-this.endPointer,e.length);this.buffer.set(e.subarray(0,t),this.endPointer),this.endPointer+=t,s.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src/common/io/BitReader.ts",241)}}reset(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0,this.pos=BigInt(0)}skipPadding(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++,this.pos++)}}},83314:(e,t,i)=>{i.d(t,{A:()=>s});var r=i(134);class s{constructor(e=1048576){(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"pointer",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"bitPointer",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"error",void 0),(0,r.A)(this,"onFlush",void 0),this.pointer=0,this.bitPointer=0,this.size=e,this.error=0,this.pos=BigInt(0),this.buffer=new Uint8Array(this.size)}writeU1(e){(this.remainingLength()<1||1===this.remainingLength()&&this.bitPointer>=8)&&this.flush(),1&e?this.buffer[this.pointer]|=1<<7-this.bitPointer:this.buffer[this.pointer]&=~(1<<7-this.bitPointer),this.bitPointer++,8===this.bitPointer&&(this.pointer++,this.pos++,this.bitPointer=0)}writeU(e,t){for(let i=0;i<e;i++)this.writeU1(t>>e-i-1&1)}remainingLength(){return this.size-this.pointer}flush(){if(!this.onFlush)throw this.error=-1048574,Error("BSWriter error, flush failed because of no flush callback");if(this.pointer)if(this.bitPointer&&this.pointer>1){const e=this.onFlush(this.buffer.subarray(0,this.pointer-1));if(0!==e)throw this.error=e,Error("BSWriter error, flush failed");this.buffer[0]=this.buffer[this.pointer]}else if(0===this.bitPointer){const e=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==e)throw this.error=e,Error("BSWriter error, flush failed")}this.pointer=0}padding(){for(;0!==this.bitPointer;)this.writeU1(0)}reset(){this.pointer=0,this.bitPointer=0,this.error=0,this.pos=BigInt(0)}getBuffer(){return this.buffer}getPointer(){return this.pointer}getPos(){return this.pos}}},729:(e,t,i)=>{i.d(t,{A:()=>a});var r=i(134),s=i(4624),n=i(50011);class a{constructor(e,t=!0){(0,r.A)(this,"data",void 0),(0,r.A)(this,"buffer",void 0),(0,r.A)(this,"byteStart",void 0),(0,r.A)(this,"pos",void 0),(0,r.A)(this,"size",void 0),(0,r.A)(this,"littleEndian",void 0),this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}writeUint8(e){this.data.setUint8(this.pos+++this.byteStart,e)}writeUint16(e){this.data.setUint16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}writeUint24(e){const t=3840&e,i=240&e,r=15&e;this.littleEndian?(this.writeUint8(r),this.writeUint8(i),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(i),this.writeUint8(r))}writeUint32(e){this.data.setUint32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeUint64(e){const t=e&BigInt(4294967295),i=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeUint32(Number(t)),this.writeUint32(Number(i))):(this.writeUint32(Number(i)),this.writeUint32(Number(t)))}writeInt8(e){this.data.setInt8(this.pos+++this.byteStart,e)}writeInt16(e){this.data.setInt16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}writeInt24(e){this.writeUint24(e<0?e+16777216:e)}writeInt32(e){this.data.setInt32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeInt64(e){const t=e&BigInt(4294967295),i=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeInt32(Number(t)),this.writeInt32(Number(i))):(this.writeInt32(Number(i)),this.writeInt32(Number(t)))}writeFloat(e){this.data.setFloat32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeDouble(e){this.data.setFloat64(this.pos+this.byteStart,e,this.littleEndian),this.pos+=8}getPos(){return this.pos}seek(e){e>this.size&&(e=this.size),this.pos=Math.max(0,e)}skip(e){this.seek(this.pos+e)}back(e){this.seek(this.pos-e)}remainingSize(){return this.size-this.pos}writeBuffer(e){let t=e.length;this.remainingSize()<t&&(t=this.remainingSize(),s.R8(`the remaining buffer size is smaller then the wrote buffer, hope set ${e.length}, but set ${t}`,"src/common/io/BufferWriter.ts",218)),this.buffer.set(e,this.pos),this.pos+=e.length}writeString(e){const t=n.encode(e);return this.writeBuffer(t),t.length}getWroteBuffer(){return this.buffer.subarray(0,this.pos)}resetBuffer(e,t=!0){this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}}}}]);