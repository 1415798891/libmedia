"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[171],{58121:(t,e,i)=>{i.d(e,{A:()=>s});var a=i(134);class s{constructor(){(0,a.A)(this,"signature",void 0),(0,a.A)(this,"version",void 0),(0,a.A)(this,"flags",void 0),(0,a.A)(this,"dataOffset",void 0),(0,a.A)(this,"hasVideo",void 0),(0,a.A)(this,"hasAudio",void 0),this.signature="FLV",this.version=1,this.flags=0,this.dataOffset=9,this.hasAudio=!1,this.hasVideo=!1}async read(t){this.signature=await t.readString(3),this.version=await t.readUint8(),this.flags=await t.readUint8(),this.dataOffset=await t.readUint32(),this.hasAudio=!!(4&this.flags),this.hasVideo=!!(1&this.flags)}write(t){this.flags=0,this.hasAudio&&(this.flags|=4),this.hasVideo&&(this.flags|=1),t.writeString(this.signature),t.writeUint8(this.version),t.writeUint8(this.flags),t.writeUint32(this.dataOffset)}}},68243:(t,e,i)=>{i.d(e,{A:()=>w});var a=i(134),s=i(35336),r=i(92647),n=i(4624),o=i(94889),c=i(9705),d=i(89179),h=i(12049);class w{constructor(){(0,a.A)(this,"onMetaData",void 0),this.onMetaData={audiocodecid:10,canSeekToEnd:!1,width:0,height:0,stereo:!0,videocodecid:7}}async read(t,e){const i=t.getPos(),a=i+BigInt(Math.floor(e)),s=await(0,d.$)(t,a),r=await(0,d.$)(t,a);this[s]=r;const o=Number(t.getPos()-i),h=await t.readUint32();return o+11!==h?(n.R8(`script size not match, size: ${o+11}, previousTagSize: ${h}`,"src/avformat/formats/flv/FlvScriptTag.ts",66),c.LR):0}computeSize(){const t=[],e=new s.A;return e.onFlush=e=>(t.push(e.slice()),0),(0,h.b)(e,"onMetaData"),(0,h.b)(e,this.onMetaData),e.flush(),(0,r.A)(Uint8Array,t).length}write(t){if(this.onMetaData){const e=[],i=new s.A;i.onFlush=t=>(e.push(t.slice()),0),(0,h.b)(i,"onMetaData"),(0,h.b)(i,this.onMetaData),i.flush();const a=(0,r.A)(Uint8Array,e),n=t.getPos();o.xk(t,18,a.length,BigInt(0)),t.writeBuffer(a),t.writeUint32(Number(t.getPos()-n))}}dts2Position(t){if(this.canSeek()){let e=-1;const i=this.onMetaData.keyframes.times,a=this.onMetaData.keyframes.filepositions;let s;for(s=0;s<i.length;s++){if(i[s]===t){e=s;break}if(i[s]>t){e=Math.max(s-1,0);break}}return s&&s===i.length&&(e=i.length-1),{pos:a[e],dts:i[e]}}return{pos:-1,dts:-1}}position2DTS(t){if(this.canSeek()){let i=-1;const a=this.onMetaData.keyframes.times,s=this.onMetaData.keyframes.filepositions;let r=0;for(r=0;r<s.length;r++)if(s[r]>t){i=r;break}var e;return r===s.length?null!==(e=this.onMetaData.duration)&&void 0!==e?e:a[a.length-1]:a[i]}return-1}canSeek(){return!!(this.onMetaData.keyframes&&this.onMetaData.keyframes.filepositions&&this.onMetaData.keyframes.filepositions.length)}}},35028:(t,e,i)=>{i.d(e,{FJ:()=>s,FV:()=>a,IO:()=>n,U5:()=>r});const a={86018:10,86017:2,86051:11,69645:1,86049:6,65543:7,65542:8,27:7,173:12,196:13,12:9,4:2,86:3,92:4,106:5,131:6},s={10:86018,2:86017,11:86051,1:69645,4:86049,5:86049,6:86049,7:65543,8:65542},r={7:27,12:173,13:196,9:12,2:4,3:86,4:92,5:106,6:131},n={86018:1,86017:0,86051:0,65543:0,65542:0,69645:0,86049:0,27:4,12:4,173:4,196:4,167:4,225:4,4:0,86:0,92:0,106:0,131:0}},89179:(t,e,i)=>{async function a(t,e){return{key:await t.readString(await t.readUint16()),value:await s(t,e)}}async function s(t,e){let i;switch(await t.readUint8()){case 0:i=await t.readDouble();break;case 1:i=!!await t.readUint8();break;case 2:i=await t.readString(await t.readUint16());break;case 3:for(i={};t.getPos()<e;){const{key:s,value:r}=await a(t,e);if(i[s]=r,9==(16777215&await t.peekUint24())){await t.skip(3);break}}break;case 8:for(i={},await t.skip(4);t.getPos()<e;){const{key:s,value:r}=await a(t,e);if(i[s]=r,9==(16777215&await t.peekUint24())){await t.skip(3);break}}break;case 9:case 5:i=null;break;case 10:i=[];const r=await t.readUint32();for(let a=0;a<r;a++)i.push(await s(t,e));break;case 11:const n=await t.readDouble(),o=await t.readInt16();i=new Date(n+60*o*1e3);break;case 12:i=await t.readString(await t.readUint32())}return i}i.d(e,{$:()=>s})},12049:(t,e,i)=>{i.d(e,{b:()=>n});var a=i(67672),s=i(72739),r=i(95335);function n(t,e){a.ai(e)?(t.writeUint8(0),t.writeDouble(e)):a.o(e)?(t.writeUint8(0),t.writeDouble(Number(e))):a.zM(e)?(t.writeUint8(1),t.writeUint8(e?1:0)):a.Yj(e)?e.length>=65536?(t.writeUint8(12),t.writeUint32(e.length),t.writeString(e)):(t.writeUint8(2),t.writeUint16(e.length),t.writeString(e)):a.YO(e)?(t.writeUint8(10),t.writeUint32(e.length),s.__(e,(e=>{n(t,e)}))):a.Ik(e)?(t.writeUint8(3),r.__(e,((e,i)=>{t.writeUint16(i.length),t.writeString(i),n(t,e)})),t.writeUint24(9)):e instanceof Date?(t.writeUint8(11),t.writeDouble(e.getTime()),t.writeInt16(0)):null==e&&t.writeUint8(5)}},94889:(t,e,i)=>{i.d(e,{BV:()=>r,VU:()=>o,ii:()=>n,xk:()=>s});var a=i(35028);function s(t,e,i,a){t.writeUint8(e),t.writeUint24(i),t.writeUint24(Number(a&BigInt(16777215))),t.writeUint8(Number(a>>BigInt(24)&BigInt(255))),t.writeUint24(0)}function r(t,e){let i=2;(86018===e.codecpar.codecId||e.codecpar.chLayout.nbChannels>1)&&(i|=1),86018===e.codecpar.codecId||e.codecpar.sampleRate>=44e3?i|=12:e.codecpar.sampleRate>=22e3?i|=8:e.codecpar.sampleRate>=11e3&&(i|=4),i|=a.FV[e.codecpar.codecId]<<4,t.writeUint8(i)}function n(t,e,i){let s=15&a.FV[e.codecpar.codecId];27!==e.codecpar.codecId&&12!==e.codecpar.codecId&&173!==e.codecpar.codecId&&196!==e.codecpar.codecId||(s|=1&i?16:32),t.writeUint8(s)}function o(t,e,i,a){let s=15&i|128;27!==e.codecpar.codecId&&173!==e.codecpar.codecId&&196!==e.codecpar.codecId&&167!==e.codecpar.codecId&&225!==e.codecpar.codecId||(s|=1&a?16:32),t.writeUint8(s)}}}]);