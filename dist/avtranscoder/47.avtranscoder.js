"use strict";(self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[]).push([[47],{58469:(e,t,a)=>{a.d(t,{En:()=>o,Hm:()=>n,Ij:()=>c,XC:()=>l,_5:()=>d,hY:()=>s,uF:()=>r});var i=a(77231);const r={1:"Main",2:"LC",3:"LC",4:"LC",5:"HE",6:"HE"},n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,i.N_,i.N_,i.N_],o=[i.N_,1,2,3,4,5,6,7];function d(e){let t=i.N_,a=i.N_,r=i.N_;var n,d;return e.length>=2&&(t=e[0]>>3&31,a=null!==(n=s[(7&e[0])<<1|e[1]>>7])&&void 0!==n?n:48e3,r=null!==(d=o[e[1]>>3&15])&&void 0!==d?d:2),{profile:t,sampleRate:a,channels:r}}function l(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){const{profile:a,sampleRate:i,channels:r}=d(t);e.codecpar.profile=a,e.codecpar.sampleRate=i,e.codecpar.chLayout.nbChannels=r}}function c(e){const t=n[e.sampleRate],a=e.chLayout.nbChannels,i=new Uint8Array(2);return i[0]=(31&e.profile)<<3|(14&t)>>1,i[1]=(1&t)<<7|(15&a)<<3,i}},87771:(e,t,a)=>{a.d(t,{R:()=>p,j:()=>n});var i=a(14686),r=a(37246);const n=[3,4,3,7,259,263,1539,1543],s=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],o=[4,5,6,5],d=[4,6,7,6],l=[48e3,44100,32e3,0],c=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],f=[2,1,2,3,3,4,4,5],u=[1,2,3,6],h=7;function p(e,t){const a=new r.A(t);a.appendBuffer((0,i.s3)(e,t));const p={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitRate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(p.syncWord=a.readU(16),2935!==p.syncWord)return-1;if(p.bitstreamId=31&a.readU(29),p.bitstreamId>16)return-2;if(p.numBlocks=6,p.ac3BitrateCode=-1,p.centerMixLevel=5,p.surroundMixLevel=6,p.dolbySurroundMode=0,p.bitstreamId<=10){if(p.crc1=a.readU(16),p.srCode=a.readU(2),3===p.srCode)return-3;const e=a.readU(6);if(e>37)return-4;p.ac3BitrateCode=e>>1,a.readU(5),p.bitstreamMode=a.readU(3),p.channelMode=a.readU(3),2==p.channelMode?p.dolbySurroundMode=a.readU(2):(1&p.channelMode&&1!=p.channelMode&&(p.centerMixLevel=o[a.readU(2)]),4&p.channelMode&&(p.surroundMixLevel=d[a.readU(2)])),p.lfeOn=a.readU(1),p.srShift=Math.max(p.bitstreamId,8)-8,p.sampleRate=l[p.srCode]>>p.srShift,p.bitRate=1e3*c[p.ac3BitrateCode]>>p.srShift,p.channels=f[p.channelMode]+p.lfeOn,p.frameSize=2*s[e][p.srCode],p.frameType=2,p.substreamId=0}else{if(p.crc1=0,p.frameType=a.readU(2),3==p.frameType)return-5;if(p.substreamId=a.readU(3),p.frameSize=a.readU(11)+1<<1,p.frameSize<h)return-6;if(p.srCode=a.readU(2),3==p.srCode){const e=a.readU(2);if(3==e)return-7;p.sampleRate=l[e]/2,p.srShift=1}else p.numBlocks=u[a.readU(2)],p.sampleRate=l[p.srCode],p.srShift=0;p.channelMode=a.readU(3),p.lfeOn=a.readU(1),p.bitRate=8*p.frameSize*p.sampleRate/(256*p.numBlocks),p.channels=f[p.channelMode]+p.lfeOn}return p.channelLayout=BigInt.asUintN(64,n[p.channelMode]),p.lfeOn&&(p.channelLayout|=BigInt(8)),p}},90412:(e,t,a)=>{a.d(t,{Ui:()=>h,XC:()=>u,Yj:()=>p,k9:()=>f,zk:()=>d});var i=a(63939),r=a(37246),n=a(11573),s=a(83314),o=a(97317);const d={0:"Main",1:"High",2:"Professional"},l=[{level:20,maxResolution:2359296},{level:21,maxResolution:4460544},{level:30,maxResolution:10653696},{level:31,maxResolution:17040384},{level:40,maxResolution:21233664},{level:41,maxResolution:21233664},{level:50,maxResolution:35651584},{level:51,maxResolution:35651584},{level:52,maxResolution:35651584},{level:53,maxResolution:35651584},{level:60,maxResolution:142606336},{level:61,maxResolution:142606336},{level:62,maxResolution:142606336},{level:63,maxResolution:142606336}],c=[20,21,22,23,30,31,32,33,40,41,42,43,50,51,52,53,60,61,62,63,70,71,72,73];function f(e,t,a){const i=e*t;for(const e of l)if(i<=e.maxResolution)return e.level}function u(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=4){const a=h(t);e.codecpar.profile=a.profile,e.codecpar.level=a.level}}function h(e){const t=new r.A(e.length);t.appendBuffer(e),t.readU1(),t.readU(7);const a=t.readU(3),i=t.readU(5),n=t.readU1();let s=t.readU1()?10:8;return t.readU1()&&(s=12),{profile:a,level:i,tier:n,bitDepth:s,monochrome:t.readU1(),chromaSubsamplingX:t.readU1(),chromaSubsamplingY:t.readU1(),chromaSamplePosition:t.readU(2)}}function p(e,t){const a=new s.A(4);a.writeU1(1),a.writeU(7,1);const d=function(e){const t=new r.A;t.appendBuffer(e);const a=[];for(;t.remainingLength();){const i=t.getPos();t.readU1(),t.readU(4);const r=t.readU1(),s=t.readU1();t.readU1(),r&&t.readU(8);const o=s?n.v(t):e.length-1-r,d=t.getPos()-i;a.push(e.subarray(i,i+d+o)),t.skip(8*o)}return a}(t).find((e=>1==(e[0]>>>3&15)));if(d){const e=function(e){const t=new r.A(e.length);t.appendBuffer(e),t.readU1(),t.readU(4);const a=t.readU1(),i=t.readU1();t.readU1(),a&&t.readU(8),i&&n.v(t);const s=n.f(t,3),o=(n.f(t,1),n.f(t,1));let d=0,l=0,f=[0],u=[0],h=[0],p=[0],m=[0],w=[0],g=0,U=[0],b=[0],v=[0];if(o)u[0]=n.f(t,5);else{d=n.f(t,1),d?(n.f(t,32),n.f(t,32),n.f(t,1)&&n.d(t),n.f(t,1)&&(g=n.f(t,5),n.f(t,32),n.f(t,5),n.f(t,5))):l=0;let e=n.f(t,1),a=n.f(t,5);for(let i=0;i<=a;i++){if(f[i]=n.f(t,12),u[i]=n.f(t,5),u[i]>7?h[i]=n.f(t,1):h[i]=0,l){if(p[i]=n.f(t,1),p[i]){let e=g+1;U[i]=n.f(t,e),b[i]=n.f(t,e),v[i]=n.f(t,1)}}else p[i]=0;e&&(m[i]=n.f(t,1),m[i]&&(w[i]=n.f(t,4)))}}let z=n.f(t,4),x=n.f(t,4),k=z+1,A=n.f(t,k);k=x+1;let P=n.f(t,k),y=0,S=0,I=0;y=o?0:n.f(t,1),y&&(n.f(t,4),n.f(t,3)),n.f(t,1),n.f(t,1),n.f(t,1);let B=0,_=0,R=0,M=0,F=0,D=0,C=2,L=2,N=0;o||(n.f(t,1),n.f(t,1),n.f(t,1),n.f(t,1),M=n.f(t,1),M?(F=n.f(t,1),D=n.f(t,1)):(F=0,D=0),C=n.f(t,1)?2:n.f(t,1),C>0?n.f(t,1)?2:n.f(t,1):2,M&&n.f(t,3)),n.f(t,1),n.f(t,1),n.f(t,1);let $=n.f(t,1),E=0,O=0,T=0;2==s&&$?(E=n.f(t,1),O=E?12:10):s<=2&&(O=$?10:8),T=1==s?0:n.f(t,1);let W=0,Y=0,X=0;n.f(t,1)?(W=n.f(t,8),Y=n.f(t,8),X=n.f(t,8)):(W=2,Y=2,X=2);let H=0,J=0,j=0,V=0,G=0;return T?(H=n.f(t,1),J=1,j=1,V=0,G=0):1==W&&13==Y&&0==X?(H=1,J=0,j=0,G=n.f(t,1)):(H=n.f(t,1),0==s?(J=1,j=1):1==s?(J=0,j=0):12==O?(J=n.f(t,1),j=J?n.f(t,1):0):(J=1,j=0),J&&j&&(V=n.f(t,2)),G=n.f(t,1)),n.f(t,1),{width:A+1,height:P+1,profile:s,level:c[u[0]],tier:h[0],bitDepth:O,monoChrome:T,colorRange:H,colorPrimaries:W,transferCharacteristics:Y,matrixCoefficients:X,subsamplingX:J,subsamplingY:j,chromaSamplePosition:V}}(d);a.writeU(3,e.profile),a.writeU(5,e.level),a.writeU(1,e.tier),a.writeU(1,e.bitDepth>8?1:0),a.writeU(1,12===e.bitDepth?1:0),a.writeU(1,e.monoChrome),a.writeU(1,e.subsamplingX),a.writeU(1,e.subsamplingY),a.writeU(1,e.chromaSamplePosition)}else{const t=o.g[i.f[15](e+28)];a.writeU(3,i.f[15](e+48)),a.writeU(5,i.f[15](e+52)),a.writeU(1,0),a.writeU(1,t.comp[0].depth>8?1:0),a.writeU(1,12===t.comp[0].depth?1:0),a.writeU(1,0),a.writeU(1,1),a.writeU(1,1),a.writeU(1,0)}return a.writeU(8,0),a.getBuffer()}},20620:(e,t,a)=>{a.d(t,{Jk:()=>P,MB:()=>v,OD:()=>A,S1:()=>x,XC:()=>S,ci:()=>y,k9:()=>b,oT:()=>k,tZ:()=>g,wf:()=>I});var i=a(63939),r=a(50932),n=a(72739),s=a(729),o=a(31865),d=a(37246),l=a(4624),c=a(14686),f=a(71517),u=a(60264),h=a(37837),p=a(23991),m="src/avformat/codecs/h264.ts";const w=3,g={66:"Constrained Baseline",77:"Main",100:"High",110:"High10",122:"High422",244:"High444"},U=[{level:10,maxResolution:25344,maxFrameRate:15},{level:11,maxResolution:25344,maxFrameRate:30},{level:12,maxResolution:101376,maxFrameRate:30},{level:13,maxResolution:101376,maxFrameRate:30},{level:20,maxResolution:101376,maxFrameRate:30},{level:21,maxResolution:202752,maxFrameRate:30},{level:22,maxResolution:414720,maxFrameRate:30},{level:30,maxResolution:414720,maxFrameRate:30},{level:31,maxResolution:921600,maxFrameRate:30},{level:32,maxResolution:1310720,maxFrameRate:60},{level:40,maxResolution:2097152,maxFrameRate:30},{level:41,maxResolution:2097152,maxFrameRate:60},{level:42,maxResolution:2228224,maxFrameRate:60},{level:50,maxResolution:8912896,maxFrameRate:30},{level:51,maxResolution:8912896,maxFrameRate:60},{level:52,maxResolution:8912896,maxFrameRate:120},{level:60,maxResolution:35651584,maxFrameRate:30},{level:61,maxResolution:35651584,maxFrameRate:60},{level:62,maxResolution:35651584,maxFrameRate:120}];function b(e,t,a){const i=e*t;for(const e of U)if(i<=e.maxResolution&&a<=e.maxFrameRate)return e.level}function v(e){const t=new o.A(e);t.skip(5);const a=[],i=[],r=[],n=31&t.readUint8();for(let e=0;e<n;e++){const e=t.readUint16();a.push(t.readBuffer(e))}const s=t.readUint8();for(let e=0;e<s;e++){const e=t.readUint16();i.push(t.readBuffer(e))}if(t.remainingSize()>4){t.skip(3);const e=t.readUint8();if(e>0)for(let a=0;a<e;a++){const e=t.readUint16();r.push(t.readBuffer(e))}}return{spss:a,ppss:i,spsExts:r}}function z(e,t,a=[]){e.length>32&&(l.R8(`h264 metadata's sps max length is 32, but get ${e.length}`,m,210),e=e.slice(0,32)),e.length>256&&(l.R8(`h264 metadata's pps max length is 256, but get ${e.length}`,m,214),e=e.slice(0,256));let i=7;i=e.reduce(((e,t)=>e+2+t.length),i),i=t.reduce(((e,t)=>e+2+t.length),i);const r=e[0],o=I(r);66!==o.profile&&77!==o.profile&&88!==o.profile&&(i+=4,a.length&&(i=a.reduce(((e,t)=>e+2+t.length),i)));const d=new Uint8Array(i),c=new s.A(d);return c.writeUint8(1),c.writeUint8(r[1]),c.writeUint8(r[2]),c.writeUint8(r[3]),c.writeUint8(252|w),c.writeUint8(224|31&e.length),n.__(e,(e=>{c.writeUint16(e.length),c.writeBuffer(e)})),c.writeUint8(t.length),n.__(t,(e=>{c.writeUint16(e.length),c.writeBuffer(e)})),66!==o.profile&&77!==o.profile&&88!==o.profile&&(c.writeUint8(252|o.chromaFormatIdc),c.writeUint8(248|o.bitDepthLumaMinus8),c.writeUint8(248|o.bitDepthChromaMinus8),a.length&&n.__(a,(e=>{c.writeUint16(e.length),c.writeBuffer(e)}))),d}function x(e){let t=(0,u.py)(e);if(t.length>1){const e=[],a=[],i=[];if(t.forEach((t=>{const r=31&t[0];7===r?e.push(t):8===r?a.push(t):13===r&&i.push(t)})),e.length&&a.length)return z(e,a,i)}}function k(e){let t,a=(0,u.py)(e),i=!1;if(a.length>1){const e=[],i=[],r=[];a.forEach((t=>{const a=31&t[0];7===a?e.push(t):8===a?i.push(t):13===a&&r.push(t)})),e.length&&i.length&&(t=z(e,i,r)),a=a.filter((e=>{const t=31&e[0];return 9!==t&&8!==t&&7!==t&&13!==t}))}const r=a.reduce(((e,t)=>e+w+1+t.length),0),o=(0,h.sY)(r),d=(0,c.s3)(o,r),l=new s.A(d);return n.__(a,(e=>{3===w?l.writeUint32(e.length):2===w?l.writeUint24(e.length):1===w?l.writeUint16(e.length):l.writeUint8(e.length),l.writeBuffer(e.subarray(0)),5==(31&e[0])&&(i=!0)})),{bufferPointer:o,length:r,key:i,extradata:t}}function A(e,t){const a=t?3&t[4]:w;let i=[],r=[],d=[],l=!1;if(t){const e=v(t);i=e.spss,r=e.ppss,d=e.spsExts,l=!0}const f=[],u=[],p=new o.A(e);for(;p.remainingSize()>0;){let t=0;t=3===a?p.readUint32():2===a?p.readUint24():1===a?p.readUint16():p.readUint8();const i=e.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+t);p.skip(t);const r=31&i[0];6===r?u.push(i):9!==r&&f.push(i)}let m=i.reduce(((e,t)=>e+4+t.length),0);m=r.reduce(((e,t)=>e+4+t.length),m),m=d.reduce(((e,t)=>e+4+t.length),m),m=u.reduce(((e,t)=>e+4+t.length),m),m=f.reduce(((e,t,a)=>e+(a?3:4)+t.length),m);const g=(0,h.sY)(m+6),U=new s.A((0,c.s3)(g,m+6));return U.writeUint8(0),U.writeUint8(0),U.writeUint8(0),U.writeUint8(1),U.writeUint8(9),U.writeUint8(240),n.__(u,(e=>{U.writeUint8(0),U.writeUint8(0),U.writeUint8(0),U.writeUint8(1),U.writeBuffer(e)})),n.__(i,(e=>{U.writeUint8(0),U.writeUint8(0),U.writeUint8(0),U.writeUint8(1),U.writeBuffer(e)})),n.__(r,(e=>{U.writeUint8(0),U.writeUint8(0),U.writeUint8(0),U.writeUint8(1),U.writeBuffer(e)})),n.__(d,(e=>{U.writeUint8(0),U.writeUint8(0),U.writeUint8(0),U.writeUint8(1),U.writeBuffer(e)})),n.__(f,((e,t)=>{U.writeUint8(0),U.writeUint8(0),t||U.writeUint8(0),U.writeUint8(1),U.writeBuffer(e),5==(31&e[0])&&(l=!0)})),{bufferPointer:g,length:m+6,key:l}}function P(e,t){var a;if(!(1&i.f[15](e+36)))return;const r=(0,f.iI)(e);if((0,u.Bs)(r))return;const n=null!==(a=t.metadata.naluLengthSizeMinusOne)&&void 0!==a?a:w;let s=[],d=[],l=[],p=[];const m=new o.A(r);for(;m.remainingSize()>0;){let e=0;e=3===n?m.readUint32():2===n?m.readUint24():1===n?m.readUint16():m.readUint8();const t=r.subarray(0|Number(0xffffffffn&m.getPos()),(0|Number(0xffffffffn&m.getPos()))+e);m.skip(e);const a=31&t[0];7===a?s.push(t):8===a?d.push(t):13===a?l.push(t):p.push(t)}if(s.length||d.length){const t=z(s,d,l),a=(0,h.sY)(t.length);(0,c.lW)(a,t.length,t),(0,f.Ow)(e,1,a,t.length)}}function y(e,t=!1){if(!(1&i.f[15](e+36)||t))return;const a=(0,f.iI)(e);if(!(0,u.Bs)(a))return;let n=(0,u.py)(a);if(n.length>1){const t=[],a=[],s=[];if(n.forEach((e=>{const i=31&e[0];7===i?t.push(e):8===i?a.push(e):13===i&&s.push(e)})),t.length&&a.length){const n=z(t,a,s),o=(0,h.sY)(n.length);(0,c.lW)(o,n.length,n),(0,f.Ow)(e,1,o,n.length),r.M[15](e+36,1|i.f[15](e+36))}}}function S(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[4];const{spss:a}=v(t);if(a.length){const{profile:t,level:i,width:r,height:n}=I(a[0]);e.codecpar.profile=t,e.codecpar.level=i,e.codecpar.width=r,e.codecpar.height=n}}}function I(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);const a=(0,u.BN)(e.subarray(t)),i=new d.A(a.length);i.appendBuffer(a),i.readU1(),i.readU(2),i.readU(5);const r=i.readU(8);i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU(2);const n=i.readU(8);p.xb(i);let s=1,o=0,l=0;if((100==r||110==r||122==r||244==r||44==r||83==r||86==r||118==r||128==r||138==r||139==r||134==r||135==r)&&(s=p.xb(i),3===s&&i.readU1(),o=p.xb(i),l=p.xb(i),i.readU1(),i.readU1())){const e=new Array(8);for(let t=0;t<(3!=s?8:12);t++)e[t]=i.readU1()}const c=p.xb(i),f=p.xb(i);let h=0,m=0;if(0===f)h=p.xb(i);else if(1===f){m=i.readU1(),p.$x(i),p.$x(i);const e=p.xb(i);for(let t=0;t<e;t++)p.$x(i)}p.xb(i),i.readU1();const w=p.xb(i),g=p.xb(i),U=i.readU1();let b=16*(w+1),v=(2-U)*(g+1)*16;U||i.readU1(),i.readU1();const z=i.readU1();if(z){let e=1,t=2-z;1===s?(e=2,t=2*(2-z)):2===z&&(e=2,t=2-z),b-=e*(p.xb(i)+p.xb(i)),v-=t*(p.xb(i)+p.xb(i))}return{profile:r,level:n,width:b,height:v,chromaFormatIdc:s,bitDepthLumaMinus8:o,bitDepthChromaMinus8:l,frameMbsOnlyFlag:U,picOrderCntType:f,log2MaxPicOrderCntLsbMinus4:h,deltaPicOrderAlwaysZeroFlag:m,log2MaxFrameNumMinus4:c}}},53e3:(e,t,a)=>{a.d(t,{HL:()=>U,Jk:()=>k,OD:()=>x,S1:()=>v,XC:()=>P,ZU:()=>S,ci:()=>A,dT:()=>p,k9:()=>w,oT:()=>z,wf:()=>y});var i=a(63939),r=a(50932),n=a(72739),s=a(729),o=a(31865),d=a(37246),l=a(14686),c=a(60264),f=a(71517),u=a(37837),h=a(23991);const p={1:"Main",2:"Main10",3:"MainStillPicture",4:"Main444"},m=[{level:10,maxLumaSamplesPerSecond:552960,maxLumaPictureSize:36864,maxBitRate:{main:128,main10:150}},{level:20,maxLumaSamplesPerSecond:3686400,maxLumaPictureSize:122880,maxBitRate:{main:1500,main10:1875}},{level:21,maxLumaSamplesPerSecond:7372800,maxLumaPictureSize:245760,maxBitRate:{main:3e3,main10:3750}},{level:30,maxLumaSamplesPerSecond:16588800,maxLumaPictureSize:552960,maxBitRate:{main:6e3,main10:7500}},{level:31,maxLumaSamplesPerSecond:33177600,maxLumaPictureSize:983040,maxBitRate:{main:1e4,main10:12500}},{level:40,maxLumaSamplesPerSecond:66846720,maxLumaPictureSize:2228224,maxBitRate:{main:12e3,main10:15e3}},{level:41,maxLumaSamplesPerSecond:133693440,maxLumaPictureSize:2228224,maxBitRate:{main:2e4,main10:25e3}},{level:50,maxLumaSamplesPerSecond:267386880,maxLumaPictureSize:8912896,maxBitRate:{main:25e3,main10:4e4}},{level:51,maxLumaSamplesPerSecond:534773760,maxLumaPictureSize:8912896,maxBitRate:{main:4e4,main10:6e4}},{level:52,maxLumaSamplesPerSecond:1069547520,maxLumaPictureSize:35651584,maxBitRate:{main:6e4,main10:1e5}},{level:60,maxLumaSamplesPerSecond:1069547520,maxLumaPictureSize:35651584,maxBitRate:{main:6e4,main10:1e5}},{level:61,maxLumaSamplesPerSecond:2139095040,maxLumaPictureSize:89128960,maxBitRate:{main:12e4,main10:24e4}},{level:62,maxLumaSamplesPerSecond:4278190080,maxLumaPictureSize:356515840,maxBitRate:{main:24e4,main10:48e4}}];function w(e,t,a,i,r){r/=1e3;const n=1===e?"main":"main10",s=t*a*i;for(const e of m)if(s<=e.maxLumaSamplesPerSecond&&t*a<=e.maxLumaPictureSize&&r<=e.maxBitRate[n])return e.level}const g=3;function U(e){const t=new o.A(e,!0);t.skip(22);let a=[],i=[],r=[];const n=t.readUint8();for(let e=0;e<n;e++){const e=63&t.readUint8(),n=t.readUint16(),s=[];for(let e=0;e<n;e++){const e=t.readUint16();s.push(t.readBuffer(e))}32===e?a=s:33===e?i=s:34===e&&(r=s)}return{vpss:a,spss:i,ppss:r}}function b(e,t,a){const i=t[0];let r=23;e.length&&(r+=3,r=e.reduce(((e,t)=>e+2+t.length),r)),t.length&&(r+=3,r=t.reduce(((e,t)=>e+2+t.length),r)),a.length&&(r+=3,r=a.reduce(((e,t)=>e+2+t.length),r));const o=new Uint8Array(r),d=new s.A(o,!0),l=y(i);d.writeUint8(1),d.writeUint8(i[1]),d.writeUint8(i[2]),d.writeUint8(i[3]),d.writeUint8(i[4]),d.writeUint8(i[5]),d.writeUint8(i[6]),d.writeUint8(i[7]),d.writeUint8(i[8]),d.writeUint8(i[9]),d.writeUint8(i[10]),d.writeUint8(i[11]),d.writeUint8(l.level),d.writeUint8(1020),d.writeUint8(0),d.writeUint8(16320),d.writeUint8(16320|l.chroma_format_idc),d.writeUint8(8160|l.bit_depth_luma_minus8),d.writeUint8(8160|l.bit_depth_chroma_minus8),d.writeUint16(0),d.writeUint8(8|(1&i[0])<<2|g);let c=0;return e.length&&c++,t.length&&c++,a.length&&c++,d.writeUint8(c),e.length&&(d.writeUint8(160),d.writeUint16(e.length),n.__(e,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),t.length&&(d.writeUint8(161),d.writeUint16(t.length),n.__(t,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),a.length&&(d.writeUint8(162),d.writeUint16(a.length),n.__(a,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),o}function v(e){let t=(0,c.py)(e);if(t.length>=2){const e=[],a=[],i=[];if(t.forEach((t=>{const r=t[0]>>>1&63;32===r?e.push(t):33===r?a.push(t):34===r&&i.push(t)})),a.length&&i.length)return b(e,a,i)}}function z(e){let t,a=!1,i=(0,c.py)(e);if(i.length>=2){const e=[],a=[],r=[];i.forEach((t=>{const i=t[0]>>>1&63;32===i?e.push(t):33===i?a.push(t):34===i&&r.push(t)})),a.length&&r.length&&(t=b(e,a,r),i=i.filter((e=>{const t=e[0]>>>1&63;return 32!==t&&33!==t&&34!==t&&35!==t})))}const r=i.reduce(((e,t)=>e+g+1+t.length),0),o=(0,u.sY)(r),d=(0,l.s3)(o,r),f=new s.A(d);return n.__(i,(e=>{3===g?f.writeUint32(e.length):2===g?f.writeUint24(e.length):1===g?f.writeUint16(e.length):f.writeUint8(e.length),f.writeBuffer(e.subarray(0));const t=e[0]>>>1&63;19!==t&&20!==t&&21!==t||(a=!0)})),{bufferPointer:o,length:r,extradata:t,key:a}}function x(e,t){const a=t?3&t[21]:g;let i=[],r=[],d=[],c=!1;if(t){const e=U(t);i=e.vpss,r=e.spss,d=e.ppss,c=!0}const f=[],h=new o.A(e);for(;h.remainingSize()>0;){let e=0;e=3===a?h.readUint32():2===a?h.readUint24():1===a?h.readUint16():h.readUint8(),f.push(h.readBuffer(e))}let p=i.reduce(((e,t)=>e+4+t.length),0);p=r.reduce(((e,t)=>e+4+t.length),p),p=d.reduce(((e,t)=>e+4+t.length),p),p=f.reduce(((e,t,a)=>e+(a?3:4)+t.length),p);const m=(0,u.sY)(p+7),w=(0,l.s3)(m,p+7),b=new s.A(w);return b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeUint8(70),b.writeUint8(0),b.writeUint8(240),n.__(i,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),n.__(r,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),n.__(d,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),n.__(f,((e,t)=>{b.writeUint8(0),b.writeUint8(0),t||b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e);const a=e[0]>>>1&63;19!==a&&20!==a&&21!==a||(c=!0)})),{bufferPointer:m,length:p+7,key:c}}function k(e,t){var a;if(!(1&i.f[15](e+36)))return;const r=(0,f.iI)(e);if((0,c.Bs)(r))return;const n=null!==(a=t.metadata.naluLengthSizeMinusOne)&&void 0!==a?a:g;let s=[],d=[],h=[];const p=new o.A(r);for(;p.remainingSize()>0;){let e=0;e=3===n?p.readUint32():2===n?p.readUint24():1===n?p.readUint16():p.readUint8();const t=r.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+e);p.skip(e);const a=t[0]>>>1&63;33===a?d.push(t):34===a?h.push(t):32===a&&s.push(t)}if(d.length||h.length||s.length){const t=b(s,d,h),a=(0,u.sY)(t.length);(0,l.lW)(a,t.length,t),(0,f.Ow)(e,1,a,t.length)}}function A(e,t=!1){if(!(1&i.f[15](e+36)||t))return;const a=(0,f.iI)(e);if(!(0,c.Bs)(a))return;let n=(0,c.py)(a);if(n.length>2){const t=[],a=[],s=[];if(n.forEach((e=>{const i=e[0]>>>1&63;32===i?t.push(e):33===i?a.push(e):34===i&&s.push(e)})),t.length&&a.length&&s.length){const n=b(t,a,s),o=(0,u.sY)(n.length);(0,l.lW)(o,n.length,n),(0,f.Ow)(e,1,o,n.length),r.M[15](e+36,1|i.f[15](e+36))}}}function P(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[21];const{spss:a}=U(t);if(a.length){const{profile:t,level:i,width:r,height:n}=y(a[0]);e.codecpar.profile=t,e.codecpar.level=i,e.codecpar.width=r,e.codecpar.height=n}}}function y(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);let a=0,i=0,r=0,n=0,s=0,o=0,l=1,f=0,u=0,p=0,m=0;const w=(0,c.BN)(e.subarray(t)),g=new d.A(w.length);g.appendBuffer(w),g.readU1(),g.readU(6),g.readU(6),g.readU(3),g.readU(4);const U=g.readU(3);g.readU1();let b=0;if(U<=6){f=g.readU(2),u=g.readU1(),a=g.readU(5),p=g.readU(32),m=g.readU(48),i=g.readU(8);const e=new Array(6),t=new Array(6);for(let a=0;a<U;a++)e[a]=g.readU1(),t[a]=g.readU1();if(U>0)for(let e=U;e<8;e++)g.readU(2);for(let a=0;a<U;a++)e[a]&&(g.readU(2),g.readU(1),g.readU(5),g.readU(32),g.readU(1),g.readU(1),g.readU(1),g.readU(1),g.readU(44)),t[a]&&g.readU(8);h.xb(g),l=h.xb(g),3===l&&(b=g.readU(1)),r=h.xb(g),n=h.xb(g);let d=0,c=0,w=0,v=0;g.readU1()&&(d=h.xb(g),c=h.xb(g),w=h.xb(g),v=h.xb(g)),s=h.xb(g),o=h.xb(g);let z=2,x=2;0===l?z=x=0:2===l?(z=2,x=1):3===l&&(z=x=1),r-=z*(1<<s+1)*(d+c),n-=x*(1<<s+1)*(w+v)}const v=h.xb(g)+4;for(let e=g.readU1()?0:U;e<U+1;e++)h.xb(g),h.xb(g),h.xb(g);const z=h.xb(g)+3,x=h.xb(g),k=h.xb(g)+2,A=h.xb(g),P=z+x,y=z-1,S=r+(1<<P)-1>>P,I=n+(1<<P)-1>>P;return{profile:a,level:i,width:r,height:n,chroma_format_idc:l,bit_depth_luma_minus8:s,bit_depth_chroma_minus8:o,general_profile_space:f,general_tier_flag:u,general_profile_compatibility_flags:p,constraint_flags:m,separate_colour_plane_flag:b,log2_min_cb_size:z,log2_diff_max_min_coding_block_size:x,log2_min_tb_size:k,log2_diff_max_min_transform_block_size:A,log2_max_trafo_size:A+k,log2_ctb_size:P,log2_min_pu_size:y,ctb_width:S,ctb_height:I,ctb_size:S*I,min_cb_width:r>>z,min_cb_height:n>>z,min_tb_width:r>>k,min_tb_height:n>>k,min_pu_width:r>>y,min_pu_height:n>>y,log2_max_poc_lsb:v}}function S(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);const a=(0,c.BN)(e.subarray(t)),i=new d.A(a.length);return i.appendBuffer(a),{pps_pic_parameter_set_id:h.xb(i),pps_seq_parameter_set_id:h.xb(i),dependent_slice_segment_flag:i.readU1(),output_flag_present_flag:i.readU1(),num_extra_slice_header_bits:i.readU(3)}}},65451:(e,t,a)=>{a.d(t,{Ij:()=>l,XC:()=>d,kt:()=>o});var i=a(31865),r=a(729),n=a(44328);const s=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(e){let t=0,a=0,i=0;if(e.length<1)return 0;switch(t=e[0],a=s[t>>3],3&t){case 0:i=1;break;case 1:case 2:i=2;break;case 3:if(e.length<2)return 0;i=63&e[1]}return i*a}function d(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=19){const a=new i.A(t,!1);a.skip(9),e.codecpar.chLayout.nbChannels=a.readUint8(),e.codecpar.initialPadding=a.readUint16(),e.codecpar.sampleRate=a.readUint32(),e.codecpar.seekPreroll=Number((0,n.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function l(e){const t=new Uint8Array(19),a=new r.A(t,!1);return a.writeString("OpusHead"),a.writeUint8(1),a.writeUint8(e.chLayout.nbChannels),a.writeUint16(e.initialPadding),a.writeUint32(e.sampleRate),t}},58919:(e,t,a)=>{a.d(t,{Ui:()=>m,XC:()=>p,Yj:()=>w,k9:()=>h,wN:()=>f});var i=a(63939),r=a(9599),n=a(29170),s=a(37246),o=a(77231),d=a(97317),l=a(44328),c=a(729);const f={0:"Profile0",1:"Profile1",2:"Profile2",3:"Profile3"},u=[{level:10,maxResolution:196608,maxFrameRate:30},{level:11,maxResolution:196608,maxFrameRate:60},{level:20,maxResolution:518400,maxFrameRate:30},{level:21,maxResolution:518400,maxFrameRate:60},{level:30,maxResolution:2073600,maxFrameRate:30},{level:31,maxResolution:2073600,maxFrameRate:60},{level:40,maxResolution:3686400,maxFrameRate:30},{level:41,maxResolution:3686400,maxFrameRate:60},{level:50,maxResolution:8294400,maxFrameRate:30},{level:51,maxResolution:8294400,maxFrameRate:60},{level:60,maxResolution:8847360,maxFrameRate:30},{level:61,maxResolution:8847360,maxFrameRate:60},{level:70,maxResolution:35389440,maxFrameRate:30},{level:71,maxResolution:35389440,maxFrameRate:60}];function h(e,t,a){const i=e*t;for(const e of u)if(i<=e.maxResolution&&a<=e.maxFrameRate)return e.level}function p(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){const a=m(t);e.codecpar.profile=a.profile,e.codecpar.level=a.level}}function m(e){const t=new s.A(e.length);return t.appendBuffer(e),{profile:t.readU(8),level:t.readU(8),bitDepth:t.readU(4),chromaSubsampling:t.readU(3),fullRangeFlag:t.readU1(),colorPrimaries:t.readU(8),colorTrc:t.readU(8),colorSpace:t.readU(8)}}function w(e){const t=new c.A(new Uint8Array(8)),a=function(e){let t=i.f[15](e+48),a=i.f[15](e+52);a===o.N_&&(a=h(i.f[15](e+56),i.f[15](e+60),(0,l.lb)((0,n.A)(e+72,r.P))));const s=d.g[i.f[15](e+28)];let c=i.f[15](e+40),f=1;s&&(c=s.comp[0].depth,1===s.log2ChromaW&&1===s.log2ChromaH?1===i.f[15](e+100)&&(f=0):1===s.log2ChromaW&&0===s.log2ChromaH?f=2:0===s.log2ChromaW&&0===s.log2ChromaH&&(f=3));const u=2===i.f[15](e+84)?1:0;return t===o.N_&&c&&(t=0==f||1==f?8==c?0:2:8==c?1:3),{profile:t,level:a,bitDepth:c,chromaSubsampling:f,fullRange:u}}(e);return t.writeUint8(a.profile),t.writeUint8(a.level),t.writeUint8(a.bitDepth<<4|a.chromaSubsampling<<1|a.fullRange),t.writeUint8(i.f[15](e+88)),t.writeUint8(i.f[15](e+92)),t.writeUint8(i.f[15](e+96)),t.writeUint16(0),t.getWroteBuffer()}},55611:(e,t,a)=>{a.d(t,{Jk:()=>z,OD:()=>v,QA:()=>k,Ui:()=>y,XC:()=>A,ci:()=>x,oT:()=>b,wf:()=>P});var i=a(63939),r=a(50932),n=a(72739),s=a(729),o=a(31865),d=a(37246),l=a(14686),c=a(60264),f=a(71517),u=a(37837),h=a(23991),p=a(83314);const m=3;function w(e){const t=e.readU(9),a=e.readU(3),i=e.readU(2),r=e.readU(2),n=e.readU(3);e.readU(5),e.readU(2);const s=e.readU(6),o=e.readU(7),d=e.readU(1),l=e.readU(8),c=e.readU(1),f=e.readU(1),u=[],h=[];if(s){for(let t=0;t<s-1;t++)u[t]=e.readU(8);u[s-1]=e.readU(6)}else e.readU(6);if(a>1){let t=0;for(let i=a-2;i>=0;--i)t|=e.readU(1)<<i;for(let t=a;t<=8&&a>1;++t)e.readU(1);for(let i=a-2;i>=0;--i)t&1<<i&&(h[i]=e.readU(8))}const p=e.readU(8),m=[];if(p)for(let t=0;t<p;t++)m.push(e.readU(8));return{olsIdx:t,numSublayers:a,bitDepthMinus8:n,chromaFormatIdc:r,constantFrameRate:i,generalProfileIdc:o,generalTierFlag:d,generalLevelIdc:l,ptlFrameOnlyConstraintFlag:c,ptlMultilayerEnabledFlag:f,generalConstraintInfo:u,sublayerLevelIdc:h,generalSubProfileIdc:m,maxPictureWidth:e.readU(16),maxPictureHeight:e.readU(16),avgFramerate:e.readU(16)}}function g(e){const t=new o.A(e,!0);if(1&t.readUint8()){const a=new d.A;a.appendBuffer(e.subarray(1)),w(a),t.skip(a.getPos())}let a=[],i=[],r=[];const n=t.readUint8();for(let e=0;e<n;e++){const e=31&t.readUint8();let n=1;13!==e&&12!==e&&(n=t.readUint16());const s=[];for(let e=0;e<n;e++){const e=t.readUint16();s.push(t.readBuffer(e))}14===e?a=s:15===e?i=s:16===e&&(r=s)}return{vpss:a,spss:i,ppss:r}}function U(e,t,a){const i=t[0];let r;if(i){const e=P(i);let t=e.generalConstraintInfo;t.length||(t=new Array(12).fill(0));const a=new p.A;if(a.writeU(9,0),a.writeU(3,e.spsMaxSublayersMinus1+1),a.writeU(2,1),a.writeU(2,e.chromaFormatIdc),a.writeU(3,e.bitDepthMinus8),a.writeU(5,31),a.writeU(2,0),a.writeU(6,t.length),a.writeU(7,e.profile),a.writeU1(e.tierFlag),a.writeU(8,e.level),a.writeU1(e.ptlFrameOnlyConstraintFlag),a.writeU1(e.ptlMultilayerEnabledFlag),t.length){for(let e=0;e<t.length-1;e++)a.writeU(8,t[e]);a.writeU(6,t[t.length-1])}else a.writeU(6,63);if(e.spsMaxSublayersMinus1+1>1){let t=0;for(let a=e.spsMaxSublayersMinus1-1;a>=0;a--)t=t<<1|e.ptlSublayerLevelPresentFlag[a];a.writeU(e.spsMaxSublayersMinus1,t);for(let t=e.spsMaxSublayersMinus1+1;t<=8&&e.spsMaxSublayersMinus1>0;++t)a.writeU1(0);for(let t=e.spsMaxSublayersMinus1-1;t>=0;t--)e.ptlSublayerLevelPresentFlag[t]&&a.writeU(8,e.sublayerLevelIdc[t])}a.writeU(8,e.generalSubProfileIdc.length);for(let t=0;t<e.generalSubProfileIdc.length;t++)a.writeU(8,e.sublayerLevelIdc[t]);a.writeU(16,e.width),a.writeU(16,e.height),a.writeU(16,0),a.padding(),r=a.getBuffer().subarray(0,a.getPointer())}let o=2+(r?r.length:0);e.length&&(o+=3,o=e.reduce(((e,t)=>e+2+t.length),o)),t.length&&(o+=3,o=t.reduce(((e,t)=>e+2+t.length),o)),a.length&&(o+=3,o=a.reduce(((e,t)=>e+2+t.length),o));const d=new Uint8Array(o),l=new s.A(d,!0);l.writeUint8(m<<1|(r?1:0)|248),r&&l.writeBuffer(r);let c=0;return e.length&&c++,t.length&&c++,a.length&&c++,l.writeUint8(c),e.length&&(l.writeUint8(142),l.writeUint16(e.length),n.__(e,(e=>{l.writeUint16(e.length),l.writeBuffer(e)}))),t.length&&(l.writeUint8(143),l.writeUint16(t.length),n.__(t,(e=>{l.writeUint16(e.length),l.writeBuffer(e)}))),a.length&&(l.writeUint8(144),l.writeUint16(a.length),n.__(a,(e=>{l.writeUint16(e.length),l.writeBuffer(e)}))),d}function b(e){let t,a=!1,i=(0,c.py)(e);if(i.length>=2){const e=[],a=[],r=[];i.forEach((t=>{const i=t[1]>>>3&31;14===i?e.push(t):15===i?a.push(t):16===i&&r.push(t)})),a.length&&r.length&&(t=U(e,a,r),i=i.filter((e=>{const t=e[1]>>>3&31;return 14!==t&&15!==t&&16!==t&&20!==t})))}const r=i.reduce(((e,t)=>e+m+1+t.length),0),o=(0,u.sY)(r),d=(0,l.s3)(o,r),f=new s.A(d);return n.__(i,(e=>{3===m?f.writeUint32(e.length):2===m?f.writeUint24(e.length):1===m?f.writeUint16(e.length):f.writeUint8(e.length),f.writeBuffer(e.subarray(0));const t=e[1]>>>3&31;8!==t&&7!==t&&9!==t&&10!==t||(a=!0)})),{bufferPointer:o,length:r,extradata:t,key:a}}function v(e,t){const a=t?t[0]>>>1&3:m;let i=[],r=[],d=[],c=!1;if(t){const e=g(t);i=e.vpss,r=e.spss,d=e.ppss,c=!0}const f=[],h=new o.A(e);for(;h.remainingSize()>0;){let e=0;e=3===a?h.readUint32():2===a?h.readUint24():1===a?h.readUint16():h.readUint8(),f.push(h.readBuffer(e))}let p=i.reduce(((e,t)=>e+4+t.length),0);p=r.reduce(((e,t)=>e+4+t.length),p),p=d.reduce(((e,t)=>e+4+t.length),p),p=f.reduce(((e,t,a)=>e+(a?3:4)+t.length),p);const w=(0,u.sY)(p+7),U=(0,l.s3)(w,p+7),b=new s.A(U);return b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeUint8(0),b.writeUint8(160),b.writeUint8(240),n.__(i,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),n.__(r,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),n.__(d,(e=>{b.writeUint8(0),b.writeUint8(0),b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e)})),n.__(f,((e,t)=>{b.writeUint8(0),b.writeUint8(0),t||b.writeUint8(0),b.writeUint8(1),b.writeBuffer(e);const a=e[1]>>>3&31;8!==a&&7!==a&&9!==a&&10!==a||(c=!0)})),{bufferPointer:w,length:p+7,key:c}}function z(e,t){var a;if(!(1&i.f[15](e+36)))return;const r=(0,f.iI)(e);if((0,c.Bs)(r))return;const n=null!==(a=t.metadata.naluLengthSizeMinusOne)&&void 0!==a?a:m;let s=[],d=[],h=[];const p=new o.A(r);for(;p.remainingSize()>0;){let e=0;e=3===n?p.readUint32():2===n?p.readUint24():1===n?p.readUint16():p.readUint8();const t=r.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+e);p.skip(e);const a=t[1]>>>3&31;15===a?d.push(t):16===a?h.push(t):14===a&&s.push(t)}if(d.length||h.length||s.length){const t=U(s,d,h),a=(0,u.sY)(t.length);(0,l.lW)(a,t.length,t),(0,f.Ow)(e,1,a,t.length)}}function x(e,t=!1){if(!(1&i.f[15](e+36)||t))return;const a=(0,f.iI)(e);if(!(0,c.Bs)(a))return;let n=(0,c.py)(a);if(n.length>2){const t=[],a=[],s=[];if(n.forEach((e=>{const i=e[1]>>>3&31;14===i?t.push(e):15===i?a.push(e):16===i&&s.push(e)})),t.length&&a.length&&s.length){const n=U(t,a,s),o=(0,u.sY)(n.length);(0,l.lW)(o,n.length,n),(0,f.Ow)(e,1,o,n.length),r.M[15](e+36,1|i.f[15](e+36))}}}function k(e,t){const{profile:a,level:i,width:r,height:n}=P(t);e.codecpar.profile=a,e.codecpar.level=i,e.codecpar.width=r,e.codecpar.height=n}function A(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=t[0]>>>1&3;const{spss:a}=g(t);a.length&&k(e,a[0])}}function P(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);let a=0,i=0,r=0,n=0,s=0,o=1,l=0,f=0,u=0;const p=[],m=[],w=[],g=[],U=(0,c.BN)(e.subarray(t)),b=new d.A(U.length);b.appendBuffer(U),b.readU1(),b.readU1(),b.readU(6),b.readU(5),b.readU(3),b.readU(8);const v=b.readU(3);o=b.readU(2);const z=b.readU(2);if(b.readU(1)){if(a=b.readU(7),l=b.readU(1),i=b.readU(8),f=b.readU(1),u=b.readU(1),b.readU(1)){for(let e=0;e<8;e++)p[e]=b.readU(8);p[8]=b.readU(7);const e=b.readU(8);b.readU(e)}b.skipPadding();for(let e=v-1;e>=0;e--)m[e]=b.readU(1);b.skipPadding();for(let e=v-1;e>=0;e--)m[e]&&(w[e]=b.readU(8));const e=b.readU(8);if(e)for(let t=0;t<e;t++)g[t]=b.readU(32)}b.readU1(),b.readU1()&&b.readU1();const x=r=h.xb(b),k=n=h.xb(b);if(b.readU1()&&(h.xb(b),h.xb(b),h.xb(b),h.xb(b)),b.readU1()){const e=h.xb(b),t=z+5,a=1<<t,i=x/(1<<t),r=k/(1<<t),n=Math.ceil(Math.log2(i)),s=Math.ceil(Math.log2(r));let o=0,d=0,l=0;e>0&&(l=b.readU1(),d=b.readU1());for(let t=0;e>0&&t<=e;t++)d&&0!=t||(t>0&&x>a&&b.readU(n),t>0&&k>a&&b.readU(s),t<e&&x>a&&b.readU(n),t<e&&k>a&&b.readU(s)),l||b.readU(2);if(o=h.xb(b)+1,b.readU(1)&&b.readU(1))for(let t=0;t<=e;t++)b.readU(o)}s=h.xb(b),b.readU(1),b.readU(1);const A=b.readU(4),P=b.readU(1);let y=0;P&&(y=h.xb(b));const S=[],I=b.readU(2);for(let e=0;e<8*I;e++)S[e]=b.readU(1);return{profile:a,level:i,width:r,height:n,chromaFormatIdc:o,bitDepthMinus8:s,generalProfileSpace:0,tierFlag:l,generalConstraintInfo:p,generalSubProfileIdc:g,ptlFrameOnlyConstraintFlag:f,ptlMultilayerEnabledFlag:u,spsMaxSublayersMinus1:v,ptlSublayerLevelPresentFlag:m,sublayerLevelIdc:w,sps_log2_max_pic_order_cnt_lsb_minus4:A,sps_poc_msb_cycle_flag:P,sps_poc_msb_cycle_len_minus1:y,sps_num_extra_ph_bytes:I,sps_extra_ph_bit_present_flag:S}}function y(e){0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(e=function(e){let t=(0,c.py)(e);if(t.length>=2){const e=[],a=[],i=[];if(t.forEach((t=>{const r=t[1]>>>3&31;14===r?e.push(t):15===r?a.push(t):16===r&&i.push(t)})),a.length&&i.length)return U(e,a,i)}}(e));const t=new d.A;return t.appendBuffer(e),1&t.readU(8)?w(t):{}}},85947:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(134);class r{constructor(){(0,i.A)(this,"type",-1),(0,i.A)(this,"onStreamAdd",void 0)}destroy(e){}}},92047:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var i=a(134),r=a(63939),n=a(50932),s=a(4624),o=a(9705),d=a(65977),l=a(74963),c=a(85947),f=a(85428),u=a(9690),h=a(72739),p=a(14686),m=a(37837),w=a(71517),g=a(44328),U=a(77231),b=a(39381),v="src/avformat/formats/IMovFormat.ts";class z extends c.A{constructor(e={}){super(),(0,i.A)(this,"type",1),(0,i.A)(this,"context",void 0),(0,i.A)(this,"options",void 0),this.options=e,this.context=(0,u.A)()}init(e){e.ioReader&&e.ioReader.setEndian(!0)}async readHeader(e){try{let t=0,a=await e.ioReader.readUint32(),i=await e.ioReader.readUint32();if(i!==(0,d.A)("ftyp"))return s.z3("the file format is not mp4",v,83),o.LR;await l.E6(e.ioReader,this.context,{type:i,size:a-8});let r=BigInt(0);for(;!this.context.foundMoov;){const t=e.ioReader.getPos();if(a=await e.ioReader.readUint32(),i=await e.ioReader.readUint32(),a<8)return s.z3(`invalid box size ${a}`,v,100),o.LR;i===(0,d.A)("mdat")?(this.context.foundMdat||(r=t),this.context.foundMdat=!0,await e.ioReader.seek(t+BigInt(Math.floor(a)))):i===(0,d.A)("moov")?(await l.wB(e.ioReader,e,this.context,{size:a-8,type:i}),this.context.foundMoov=!0):await e.ioReader.seek(t+BigInt(Math.floor(a)))}if(!this.context.fragment&&!this.context.foundMdat){const t=await e.ioReader.peekUint64()>>BigInt(32);Number(t)===(0,d.A)("moof")&&(this.context.fragment=!0)}if(this.context.fragment&&1&e.ioReader.flags){const t=e.ioReader.getPos(),a=await e.ioReader.fileSize();if(a>BigInt(16)){await e.ioReader.seek(a-BigInt(12));let i=await e.ioReader.readUint32();if(i===(0,d.A)("mfro")){await e.ioReader.skip(4);const t=await e.ioReader.readUint32();await e.ioReader.seek(a-BigInt(Math.floor(t)));const r=await e.ioReader.readUint32();i=await e.ioReader.readUint32(),i===(0,d.A)("mfra")&&await l.t9(e.ioReader,e,this.context,{size:r-8,type:i})}await e.ioReader.seek(t)}}return!this.context.fragment&&this.context.foundMdat&&await e.ioReader.seek(r),t}catch(t){return s.z3(t.message,v,162),this.context.foundMoov||s.z3("moov not found",v,165),e.ioReader.error}}async readAVPacket_(e,t){const{sample:a,stream:i}=(0,f.G)(e,this.context);if(!a)return-1048576;{n.M[15](t+32,i.index),n.M[17](t+16,a.dts),n.M[17](t+8,a.pts),n.M[17](t+48,BigInt(Math.floor(a.duration))),n.M[15](t+36,r.f[15](t+36)|a.flags),n.M[17](t+56,a.pos),n.M[15](t+76,i.timeBase.den),n.M[15](t+72,i.timeBase.num),i.startTime===U.Dh&&(i.startTime=r.f[17](t+8)||r.f[17](t+16)),await e.ioReader.seek(r.f[17](t+56));const s=a.size,o=(0,m.sY)(s);if((0,w.NX)(t,o,s),await e.ioReader.readBuffer(s,(0,p.JW)(o,s)),27!==i.codecpar.codecId&&173!==i.codecpar.codecId&&196!==i.codecpar.codecId||n.M[15](t+80,1),94226===i.codecpar.codecId&&r.f[15](t+28)>=8){const e=b.Sg(r.f[20](t+24)+4)>>>0,a=r.f[15](t+28);if(e===(0,d.A)("vtte")&&8===a){const e=(0,m.Gy)(1);(0,w.NX)(t,e,1),n.M[15](t+28,1)}if(a>8&&(e===(0,d.A)("vtte")||e===(0,d.A)("vttc"))){let e=r.f[20](t+24)+8;const i=r.f[20](t+24)+a;for(;e<i;){const a=b.Sg(e);if(b.Sg(e+4)>>>0===(0,d.A)("payl")&&a>8){const i=(0,m.sY)(a-8);(0,p.Mr)(i,e+8,a-8),(0,w.NX)(t,i,a-8);break}e+=a}}}if(i.sideData[1]){const e=i.sideData[1].length,a=(0,m.sY)(e);(0,w.Ow)(t,1,a,e),(0,p.lW)(a,e,i.sideData[1]),delete i.sideData[1]}}return 0}async readAVPacket(e,t){try{if(this.context.fragment&&!this.context.currentFragment)for(;!this.context.currentFragment;){const t=e.ioReader.getPos(),a=await e.ioReader.readUint32(),i=await e.ioReader.readUint32();i===(0,d.A)("moof")?(this.context.currentFragment={pos:t,size:a,sequence:0,tracks:[],currentTrack:null},await l.wZ(e.ioReader,e,this.context,{type:i,size:a-8})):i===(0,d.A)("moov")?await l.wB(e.ioReader,e,this.context,{size:a-8,type:i}):await e.ioReader.skip(a-8)}return await this.readAVPacket_(e,t)}catch(t){return-1048576!==e.ioReader.error&&s.z3(t.message,v,294),e.ioReader.error}}async seek(e,t,a,i){const r=a,n=t.privData;if(16&i&&this.context.fragment){const i=(0,g.k)(a,t.timeBase,U.i0);return await e.ioReader.seek(i,!0),this.context.currentFragment=null,BigInt(0)}if(this.context.fragment){if(n.fragIndexes.length){let t=h.El(n.fragIndexes,(e=>e.time>r?-1:e.time===r?0:1));if(t>-1)return await e.ioReader.seek(n.fragIndexes[t].pos,!0),this.context.currentFragment=null,BigInt(0)}return BigInt(o.E$)}let s=h.El(n.samplesIndex,(e=>e.pts>r?-1:e.pts===r?0:1));if(s>-1&&0===t.codecpar.codecType){let e=s;for(;e>=0;e--)if(1&n.samplesIndex[e].flags){s=e;break}e<0&&(s=-1)}return s>-1?(n.currentSample=s,n.sampleEnd=!1,h.__(e.streams,(e=>{if(e!==t){const a=e.privData;let i=!1,r=(0,g.k)(n.samplesIndex[n.currentSample].pts,t.timeBase,e.timeBase);h.__(a.samplesIndex,((e,t)=>{if(e.pts>=r)return a.currentSample=t,i=!0,!1})),i?a.sampleEnd=!1:(a.sampleEnd=!0,a.currentSample=a.samplesIndex.length)}})),BigInt(0)):BigInt(o.LR)}getAnalyzeStreamsCount(){return 0}}},21071:(e,t,a)=>{a.d(t,{_l:()=>i,gQ:()=>r});const i=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],r=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco"]},61179:(e,t,a)=>{function i(e,t,a,i=0){const r=e.privData,n=a.trexs.find((e=>e.trackId===t.trackId));let s=t.baseDataOffset+BigInt(Math.floor(t.dataOffset));t.baseIsMoof&&(s+=a.currentFragment.pos);let o=t.baseMediaDecodeTime;const d=t.sampleSizes,l=t.sampleDurations,c=t.sampleFlags,f=t.sampleCompositionTimeOffset;if(!d.length)for(let e=0;e<t.sampleCount;e++)d.push(t.defaultSampleSize||n.size);if(!l.length)for(let e=0;e<t.sampleCount;e++)l.push(t.defaultSampleDuration||n.duration);if(!c.length)for(let e=0;e<t.sampleCount;e++)c.push(t.defaultSampleFlags||n.flags);if(!f.length)for(let e=0;e<t.sampleCount;e++)f.push(0);const u=[];for(let e=0;e<t.sampleCount;e++){const a={dts:o,pts:o+BigInt(Math.floor(f[e])),pos:s,size:d[e],duration:l[e],flags:0};o+=BigInt(Math.floor(a.duration)),s+=BigInt(Math.floor(a.size));let r=c[e];0===e&&t.firstSampleFlags&&(r=t.firstSampleFlags),16842752&r||(a.flags|=1),0===e&&d.length>1&&2&i&&(a.flags|=1),u.push(a)}r.samplesIndex=u}a.d(t,{p:()=>i})},98859:(e,t,a)=>{function i(e){const t=e.privData,a=t.chunkOffsets,i=t.sampleSizes,r=t.cttsSampleCounts,n=t.cttsSampleOffsets,s=t.stscFirstChunk,o=t.stscSamplesPerChunk,d=t.stssSampleNumbersMap,l=t.sttsSampleCounts,c=t.sttsSampleDeltas;if(!a.length)return;let f=0,u=0,h=0,p=0,m=0,w=0,g=BigInt(0),U=0,b=BigInt(0);const v=[];for(let t=0;t<a.length;t++)for(g=a[t],f<s.length-1&&s[f+1]===t+1&&f++,w=o[f];w>0;){const t={dts:b,pts:b,pos:g,size:i[U],duration:0,flags:0};(d&&d.has(U+1)||1===e.codecpar.codecType)&&(t.flags|=1),n&&(t.pts=t.dts+BigInt(Math.floor(n[p])),m++,m===r[p]&&(p++,m=0)),U&&(v[U-1].duration=Number(t.dts-v[U-1].dts)),g+=BigInt(Math.floor(t.size)),b+=BigInt(Math.floor(c[u])),h++,h===l[u]&&(u++,h=0),U++,v.push(t),w--}v.length>1&&(v[U-1].duration=v[U-2].duration),t.samplesIndex=v}a.d(t,{X:()=>i})},3384:(e,t,a)=>{function i(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[]}}a.d(t,{A:()=>i})},9690:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(77231);function r(){return{isom:!1,timescale:i.N_,duration:i.Dh,foundMoov:!1,foundMdat:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:i.N_,volume:i.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},38106:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(77231);function r(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,timescale:0,duration:BigInt(0),trackId:i.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],fragIndexes:[],lastPts:BigInt(0),lastDts:BigInt(0),startDts:BigInt(0),startCT:0,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},85428:(e,t,a)=>{a.d(t,{G:()=>n});var i=a(77231),r=a(44328);function n(e,t){let a,n,s,o,d,l,c=BigInt(0);if(e.streams.forEach((e=>{const t=e.privData;if(!t.samplesIndex||!t.samplesIndex.length)return t.sampleEnd=!0,!0;t.sampleEnd||s&&!(t.samplesIndex[t.currentSample].pos<s.pos)||(s=t.samplesIndex[t.currentSample],o=e),t.sampleEnd||d&&!((0,r.k)(t.samplesIndex[t.currentSample].dts,e.timeBase,i.KR)<c)||(d=t.samplesIndex[t.currentSample],c=(0,r.k)(d.dts,e.timeBase,i.KR),l=e)})),s&&d){const t=(0,r.k)(s.dts,o.timeBase,i.KR),c=(0,r.k)(d.dts,l.timeBase,i.KR);Math.abs(Number(t-c))<1e6||2&e.ioReader.flags?(a=s,n=o):(a=d,n=l)}else s?(a=s,n=o):d&&(a=d,n=l);if(n&&(n.privData.currentSample++,n.privData.currentSample>=n.privData.samplesIndex.length&&(n.privData.sampleEnd=!0)),t.fragment){const a=!!e.streams.find((e=>!1===e.privData.sampleEnd));a||(t.currentFragment=null)}return{sample:a,stream:n}}},74963:(e,t,a)=>{a.d(t,{E6:()=>m,t9:()=>b,wB:()=>g,wZ:()=>U});var i=a(65977),r=a(21071),n=a(68361),s=a(4624),o=a(61179),d=a(98859),l=a(3384),c=a(38106),f=a(37837),u=a(14686),h=a(77231),p="src/avformat/formats/mov/imov.ts";async function m(e,t,a){const r=e.getPos()+BigInt(Math.floor(a.size));for(t.majorBrand=await e.readUint32(),t.minorVersion=await e.readUint32(),t.majorBrand===(0,i.A)("qt  ")&&(t.isom=!0);e.getPos()<r;)t.compatibleBrand.push(await e.readUint32())}async function w(e,t,a,o){const d=e.getPos()+BigInt(Math.floor(a.size));for(;e.getPos()<d;){const a=await e.readUint32(),d=await e.readUint32();if(a<8)return void s.z3(`invalid box size ${a}`,p,76);n.A[d]?await n.A[d](e,t,{type:d,size:a-8},o):r.gQ.some((e=>(0,i.A)(e)===d))?await w(e,t,{type:d,size:a-8},o):await e.skip(a-8)}}async function g(e,t,a,r){const o=e.getPos()+BigInt(Math.floor(r.size));for(;e.getPos()<o;){const r=await e.readUint32(),o=await e.readUint32();if(r<8)return void s.z3(`invalid box, type: ${o}, size ${r}`,p,124);if(n.A[o])await n.A[o](e,null,{type:o,size:r-8},a);else if(o===(0,i.A)("trak"))if(!a.foundMoov||a.fragment){const i=t.createStream();if(i.privData=(0,c.A)(),await w(e,i,{type:o,size:r-8},a),a.fragment){const e=i.privData,a=t.streams.find((t=>{const a=t.privData;if(t.index!==i.index&&a.trackId===e.trackId)return!0}));a?(i.sideData[1]&&(a.sideData[1]=i.sideData[1],a.codecpar.extradata&&(0,f.Eb)(a.codecpar.extradata),a.codecpar.extradataSize=a.sideData[1].length,a.codecpar.extradata=(0,f.sY)(a.codecpar.extradataSize),(0,u.lW)(a.codecpar.extradata,a.codecpar.extradataSize,a.sideData[1]),i.codecpar.width===h.N_&&e.width>0&&(a.codecpar.width=e.width),i.codecpar.width===h.N_&&e.height>0&&(a.codecpar.height=e.height)),t.removeStream(i),t.streamIndex--):(i.codecpar.width===h.N_&&e.width>0&&(i.codecpar.width=e.width),i.codecpar.width===h.N_&&e.height>0&&(i.codecpar.height=e.height))}else(0,d.X)(i)}else await e.skip(r-8);else o===(0,i.A)("mvex")?(a.fragment=!0,await w(e,null,{type:o,size:r-8},a)):await e.skip(r-8)}}async function U(e,t,a,r){const d=e.getPos()+BigInt(Math.floor(r.size));for(;e.getPos()<d;){const r=await e.readUint32(),d=await e.readUint32();if(r<8)return void s.z3(`invalid box, type: ${d}, size ${r}`,p,229);if(n.A[d])await n.A[d](e,null,{type:d,size:r-8},a);else if(d===(0,i.A)("traf")){const i=(0,l.A)();a.currentFragment.currentTrack=i,await w(e,null,{type:d,size:r-8},a),a.currentFragment.tracks.push(i),a.currentFragment.currentTrack=null;const n=t.streams.find((e=>e.privData.trackId===i.trackId));if(n){const e=n.privData;i.streamIndex=n.index,(0,o.p)(n,i,a,t.ioReader.flags),e.currentSample=0,e.sampleEnd=!1}}else await e.skip(r-8)}}async function b(e,t,a,r){const n=e.getPos()+BigInt(Math.floor(r.size));for(;e.getPos()<n;){const r=await e.fileSize(),n=await e.readUint32();if(await e.readUint32()!==(0,i.A)("tfra"))return void s.z3("invalid tfra box data",p,293);const o=await e.readUint8();await e.skip(3);const d=await e.readUint32(),l=await e.readUint32(),c=await e.readUint32(),f=t.streams.find((e=>e.privData.trackId===d));if(f){const r=f.privData;let n,s;for(let t=0;t<c;t++){1===o?(n=await e.readUint64(),s=await e.readUint64()):(n=BigInt(Math.floor(await e.readUint32())),s=BigInt(Math.floor(await e.readUint32()))),r.fragIndexes.push({pos:s,time:n});for(let t=0;t<1+(l>>4&3);t++)await e.skip(1);for(let t=0;t<1+(l>>2&3);t++)await e.skip(1);for(let t=0;t<1+(3&l);t++)await e.skip(1)}if(r.fragIndexes.length){await e.seek(r.fragIndexes[r.fragIndexes.length-1].pos);const n=await e.readUint32(),s=await e.readUint32();if(s===(0,i.A)("moof")&&(a.currentFragment={pos:BigInt(0),size:n,sequence:0,tracks:[],currentTrack:null},await U(e,t,a,{size:n,type:s}),r.samplesIndex.length)){const e=r.samplesIndex[r.samplesIndex.length-1];f.duration=e.pts+BigInt(Math.floor(e.duration))}}}await e.seek(r+BigInt(Math.floor(n)),!1,!1)}a.currentFragment=null}},6660:(e,t,a)=>{a.d(t,{Q9:()=>n,f3:()=>s,uf:()=>o,zs:()=>r});var i=a(65977);const r={86018:64,86017:105,86076:173,86028:193,86021:221,12:32,27:33,173:35,196:51,167:177,0:0},n={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},s={vide:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},o={[(0,i.A)("mp4a")]:86018,1836253269:86017,[(0,i.A)("Opus")]:86076,[(0,i.A)("fLaC")]:86028,[(0,i.A)("spex")]:86051,[(0,i.A)("SPXN")]:86051,[(0,i.A)("ac-3")]:86019,[(0,i.A)("sac3")]:86019,[i.A.mp4v]:12,[(0,i.A)("av01")]:225,[(0,i.A)("vp08")]:139,[(0,i.A)("vp09")]:167,[(0,i.A)("avc1")]:27,[(0,i.A)("hev1")]:173,[(0,i.A)("hvc1")]:173,[(0,i.A)("vvc1")]:196,[(0,i.A)("vvi1")]:196,[(0,i.A)("text")]:94213,[(0,i.A)("tx3g")]:94213}},38582:(e,t,a)=>{a.d(t,{A:()=>d});var i=a(4624),r=a(14686),n=a(37837),s=a(90412),o="src/avformat/formats/mov/parsing/av1c.ts";async function d(e,t,a,d){const l=e.getPos();if(t.codecpar.codecId=225,a.size<=0)return;const c=(0,n.sY)(a.size),f=await e.readBuffer(a.size,(0,r.JW)(c,a.size));d.foundMoov?(t.sideData[1]=f.slice(),(0,n.Eb)(c)):(t.codecpar.extradata=c,t.codecpar.extradataSize=a.size,t.sideData[1]=f.slice()),s.XC(t,t.sideData[1]);const u=a.size-Number(e.getPos()-l);u>0?await e.skip(u):u<0&&i.z3(`read avcc error, size: ${a.size}, read: ${a.size-u}`,o,67)}},73840:(e,t,a)=>{a.d(t,{A:()=>d});var i=a(37837),r=a(14686),n=a(4624),s=a(20620),o="src/avformat/formats/mov/parsing/avcc.ts";async function d(e,t,a,d){const l=e.getPos();if(t.codecpar.codecId=27,a.size<=0)return;const c=(0,i.sY)(a.size),f=await e.readBuffer(a.size,(0,r.JW)(c,a.size));d.foundMoov?(t.sideData[1]=f.slice(),(0,i.Eb)(c)):(t.codecpar.extradata=c,t.codecpar.extradataSize=a.size,t.sideData[1]=f.slice()),s.XC(t,t.sideData[1]);const u=a.size-Number(e.getPos()-l);u>0?await e.skip(u):u<0&&n.z3(`read avcc error, size: ${a.size}, read: ${a.size-u}`,o,67)}},37213:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/co64.ts";async function n(e,t,a,n){const s=e.getPos(),o=await e.readUint8();await e.skip(3);const d=[],l=await e.readUint32();if(0===o)for(let t=0;t<l;t++)d.push(await e.readUint64());t.privData.chunkOffsets=d;const c=a.size-Number(e.getPos()-s);c>0?await e.skip(c):c<0&&i.z3(`read co64 error, size: ${a.size}, read: ${a.size-c}`,r,56)}},12869:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/colr.ts";async function n(e,t,a,n){const s=e.getPos();let o=await e.readString(4);if("nclx"===o||"nclc"===o||"prof"===o)if("prof"===o){const i=await e.readBuffer(a.size-4);t.sideData[28]=i}else{let a=await e.readUint16(),i=await e.readUint16(),r=await e.readUint16();if("nclx"===o){const a=await e.readUint8()>>7;t.codecpar.colorRange=a?2:1}a>=23&&(a=2),i>=19&&(i=2),r>=15&&(r=2),t.codecpar.colorPrimaries=a,t.codecpar.colorTrc=i,t.codecpar.colorSpace=r}else i.R8(`unsupported color_parameter_type: ${o}`,r,79);const d=a.size-Number(e.getPos()-s);d>0?await e.skip(d):d<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-d}`,r,87)}},59299:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/ctts.ts";async function n(e,t,a,n){const s=e.getPos(),o=t.privData;await e.skip(4);const d=[],l=[],c=await e.readUint32();for(let t=0;t<c;t++)d.push(await e.readUint32()),l.push(await e.readInt32());o.cttsSampleCounts=d,o.cttsSampleOffsets=l;const f=a.size-Number(e.getPos()-s);f>0?await e.skip(f):f<0&&i.z3(`read ctts error, size: ${a.size}, read: ${a.size-f}`,r,59)}},7320:(e,t,a)=>{a.d(t,{A:()=>f});var i=a(61499),r=a(63939),n=a(50932),s=a(4624),o=a(71517),d=a(87771),l=a(99991),c="src/avformat/formats/mov/parsing/dac3.ts";async function f(e,t,a,f){const u=e.getPos();if(t.codecpar.codecId=86019,a.size<=0)return;const h=(0,o.E4)(t.codecpar[i.o9]+20,t.codecpar[i.o9]+24,7,4),p=r.f[20](h),m=await e.readUint24(),w=m>>14&7,g=m>>11&7,U=m>>10&1;let b=d.j[g];U&&(b|=8),l.bl(t.codecpar[i.o9]+112),l.ML(t.codecpar[i.o9]+112,b),n.M[15](p,w);const v=a.size-Number(e.getPos()-u);v>0?await e.skip(v):v<0&&s.z3(`read avcc error, size: ${a.size}, read: ${a.size-v}`,c,77)}},36868:(e,t,a)=>{a.d(t,{A:()=>f});var i=a(61499),r=a(63939),n=a(50932),s=a(4624),o=a(71517),d=a(87771),l=a(99991),c="src/avformat/formats/mov/parsing/dec3.ts";async function f(e,t,a,f){const u=e.getPos();if(t.codecpar.codecId=86056,a.size<=0)return;const h=(0,o.E4)(t.codecpar[i.o9]+20,t.codecpar[i.o9]+24,7,4),p=r.f[20](h);await e.skip(2);const m=await e.readUint24(),w=m>>12&31,g=m>>9&7,U=m>>8&1;let b=d.j[g];U&&(b|=8),l.bl(t.codecpar[i.o9]+112),l.ML(t.codecpar[i.o9]+112,b),n.M[15](p,w),t.codecpar.chLayout.nbChannels>1&&7==w&&n.M[15](p,8);const v=a.size-Number(e.getPos()-u);v>0?await e.skip(v):v<0&&s.z3(`read avcc error, size: ${a.size}, read: ${a.size-v}`,c,82)}},86528:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(4624),r=a(37837),n=a(14686),s="src/avformat/formats/mov/parsing/dfla.ts";async function o(e,t,a,o){const d=e.getPos();t.codecpar.codecId=86028,await e.skip(1),await e.skip(3);const l=await e.readUint8(),c=128&l,f=127&l,u=await e.readUint24();if(0===f&&34===u){const a=(0,r.sY)(u),i=await e.readBuffer(u,(0,n.JW)(a,u));o.foundMoov?(t.sideData[1]=i.slice(),(0,r.Eb)(a)):(t.codecpar.extradata=a,t.codecpar.extradataSize=u)}else i.z3("streaminfo must be first FLACMetadataBlock",s,67);c||i.R8("non streaminfo FLACMetadataBlock(s) ignored",s,71);const h=a.size-Number(e.getPos()-d);h>0?await e.skip(h):h<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-h}`,s,79)}},41781:(e,t,a)=>{a.d(t,{A:()=>c});var i=a(4624),r=a(37837),n=a(14686),s=a(65451),o=a(31865),d=a(729),l="src/avformat/formats/mov/parsing/dops.ts";async function c(e,t,a,c){const f=e.getPos();t.codecpar.codecId=86076,await e.skip(1);const u=(0,r.sY)(a.size+8),h=(0,n.JW)(u,a.size+8),p=new o.A(h),m=new d.A(h,!1);m.writeString("OpusHead"),m.writeUint8(1),await e.readBuffer(a.size-1,(0,n.JW)(u+9,a.size-1)),p.seek(10),m.seek(10),m.writeUint16(p.readUint16()),m.writeUint32(p.readUint32()),m.writeUint16(p.readUint16()),c.foundMoov?(t.sideData[1]=h.slice(),(0,r.Eb)(u)):(t.codecpar.extradata=u,t.codecpar.extradataSize=h.length,s.XC(t,h.slice()));const w=a.size-Number(e.getPos()-f);w>0?await e.skip(w):w<0&&i.z3(`read dops error, size: ${a.size}, read: ${a.size-w}`,l,81)}},28412:(e,t,a)=>{a.d(t,{A:()=>f});var i=a(4624),r=a(6660),n=a(37837),s=a(14686),o=a(58469),d=a(65451),l="src/avformat/formats/mov/parsing/esds.ts";async function c(e){let t=0;for(let a=0;a<4;a++){const a=await e.readUint8();if(t=t<<7|127&a,!(128&a))break}return t}async function f(e,t,a,f){const u=e.getPos();await e.skip(4);let h=e.getPos()+BigInt(Math.floor(a.size-4));for(;e.getPos()<h;){let a=await e.readUint8(),u=await c(e);if(0!==u)if(3===a){let h=e.getPos()+BigInt(Math.floor(u));if(await e.skip(2),await e.skip(1),a=await e.readUint8(),u=await c(e),0===u){i.R8("esds invalid ES descriptor size 0, skip",l,85),await e.skip(Number(h-e.getPos()));continue}if(4===a)if(t.codecpar.codecId=r.Q9[await e.readUint8()],await e.skip(1),await e.skip(3),await e.skip(4),await e.skip(4),e.getPos()<h-BigInt(5))if(a=await e.readUint8(),u=await c(e),5===a){const a=(0,n.sY)(u),i=await e.readBuffer(u,(0,s.JW)(a,u));f.foundMoov?(t.sideData[1]=i.slice(),(0,n.Eb)(a)):(t.codecpar.extradata=a,t.codecpar.extradataSize=u,86018===t.codecpar.codecId?o.XC(t,i.slice()):86076===t.codecpar.codecId&&d.XC(t,i.slice()))}else await e.skip(Number(h-e.getPos()));else await e.skip(Number(h-e.getPos()));else await e.skip(Math.min(u,Number(h-e.getPos())))}else await e.skip(Math.min(u,Number(h-e.getPos())));else i.R8("esds invalid descriptor size 0, skip",l,68),await e.skip(Number(h-e.getPos()))}const p=a.size-Number(e.getPos()-u);p>0?await e.skip(p):p<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-p}`,l,153)}},40179:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(4624),r=a(34677),n=a(6660),s="src/avformat/formats/mov/parsing/hdlr.ts";async function o(e,t,a,o){const d=e.getPos(),l=await e.readUint8();if(await e.skip(3),0===l){await e.skip(4);const i=await e.readString(4),s=n.f3[i];(0,r.A)(s)&&(t.codecpar.codecType=s),await e.skip(4),await e.skip(4),await e.skip(4);const d=a.size-24;if(d>0){const a=!o.isom&&await e.peekUint8()===d-1;a&&await e.skip(1),t.metadata.handlerName=await e.readString(d-(a?1:0))}}const c=a.size-Number(e.getPos()-d);c>0?await e.skip(c):c<0&&i.z3(`read hdlr error, size: ${a.size}, read: ${a.size-c}`,s,77)}},31421:(e,t,a)=>{a.d(t,{A:()=>d});var i=a(37837),r=a(14686),n=a(4624),s=a(53e3),o="src/avformat/formats/mov/parsing/hvcc.ts";async function d(e,t,a,d){const l=e.getPos();if(t.codecpar.codecId=173,a.size<=0)return;const c=(0,i.sY)(a.size),f=await e.readBuffer(a.size,(0,r.JW)(c,a.size));d.foundMoov?(t.sideData[1]=f.slice(),(0,i.Eb)(c)):(t.codecpar.extradata=c,t.codecpar.extradataSize=a.size,t.sideData[1]=f.slice()),s.XC(t,t.sideData[1]);const u=a.size-Number(e.getPos()-l);u>0?await e.skip(u):u<0&&n.z3(`read hevc error, size: ${a.size}, read: ${a.size-u}`,o,67)}},45248:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/mdhd.ts";async function n(e,t,a,n){const s=e.getPos(),o=await e.readUint8();await e.skip(3);let d=BigInt(0),l=BigInt(0),c=0,f=BigInt(0);1===o?(d=await e.readUint64(),l=await e.readUint64(),c=await e.readUint32(),f=await e.readUint64()):(d=BigInt(Math.floor(await e.readUint32())),l=BigInt(Math.floor(await e.readUint32())),c=await e.readUint32(),f=BigInt(Math.floor(await e.readUint32()))),t.duration=f,t.timeBase.den=c,t.timeBase.num=1,t.metadata.creationTime=d,t.metadata.modificationTime=l;const u=await e.readUint16(),h=[];h[0]=u>>10&31,h[1]=u>>5&31,h[2]=31&u;const p=String.fromCharCode(h[0]+96,h[1]+96,h[2]+96);t.metadata.language=u,t.metadata.languageString=p,await e.skip(2);const m=a.size-Number(e.getPos()-s);m>0?await e.skip(m):m<0&&i.z3(`read mdhd error, size: ${a.size}, read: ${a.size-m}`,r,83)}},7018:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/mfhd.ts";async function n(e,t,a,n){const s=e.getPos();await e.readUint8(),await e.skip(3),n.currentFragment.sequence=await e.readUint32();const o=a.size-Number(e.getPos()-s);o>0?await e.skip(o):o<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-o}`,r,49)}},19354:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/mvhd.ts";async function n(e,t,a,n){const s=e.getPos(),o=await e.readUint8();await e.skip(3),1===o?(n.creationTime=await e.readUint64(),n.modificationTime=await e.readUint64(),n.timescale=await e.readUint32(),n.duration=await e.readUint64()):(n.creationTime=BigInt(Math.floor(await e.readUint32())),n.modificationTime=BigInt(Math.floor(await e.readUint32())),n.timescale=await e.readUint32(),n.duration=BigInt(Math.floor(await e.readUint32()))),n.rate=await e.readUint32(),n.volume=await e.readUint16()>>>8,await e.skip(10),n.matrix=new Uint32Array(9);for(let t=0;t<9;t++)n.matrix[t]=await e.readUint32();await e.skip(24),n.nextTrackId=await e.readUint32();const d=a.size-Number(e.getPos()-s);d>0?await e.skip(d):d<0&&i.z3(`read mvhd error, size: ${a.size}, read: ${a.size-d}`,r,70)}},68361:(e,t,a)=>{a.d(t,{A:()=>x});var i=a(91635),r=a(59299),n=a(63080),s=a(62831),o=a(6570),d=a(34136),l=a(15692),c=a(37213),f=a(45248),u=a(19354),h=a(27436),p=a(40179),m=a(35173),w=a(25778),g=a(7018),U=a(61807),b=a(67523),v=a(58996),z=a(65977);const x={[(0,z.A)("stts")]:i.A,[(0,z.A)("ctts")]:r.A,[(0,z.A)("stss")]:n.A,[(0,z.A)("stsz")]:s.A,[(0,z.A)("stz2")]:o.A,[(0,z.A)("stsc")]:d.A,[(0,z.A)("stco")]:l.A,[(0,z.A)("co64")]:c.A,[(0,z.A)("mdhd")]:f.A,[(0,z.A)("mvhd")]:u.A,[(0,z.A)("tkhd")]:h.A,[(0,z.A)("hdlr")]:p.A,[(0,z.A)("stsd")]:m.A,[(0,z.A)("trex")]:w.A,[(0,z.A)("mfhd")]:g.A,[(0,z.A)("tfhd")]:U.A,[(0,z.A)("tfdt")]:b.A,[(0,z.A)("trun")]:v.A}},15692:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/stco.ts";async function n(e,t,a,n){const s=e.getPos(),o=await e.readUint8();await e.skip(3);const d=[],l=await e.readUint32();if(0===o)for(let t=0;t<l;t++)d.push(BigInt(Math.floor(await e.readUint32())));t.privData.chunkOffsets=d;const c=a.size-Number(e.getPos()-s);c>0?await e.skip(c):c<0&&i.z3(`read stco error, size: ${a.size}, read: ${a.size-c}`,r,56)}},34136:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/stsc.ts";async function n(e,t,a,n){const s=e.getPos(),o=await e.readUint8();await e.skip(3);const d=t.privData,l=[],c=[],f=[],u=await e.readUint32();if(0===o)for(let t=0;t<u;t++)l.push(await e.readUint32()),c.push(await e.readUint32()),f.push(await e.readUint32());d.stscFirstChunk=l,d.stscSamplesPerChunk=c,d.stscSampleDescriptionIndex=f;const h=a.size-Number(e.getPos()-s);h>0?await e.skip(h):h<0&&i.z3(`read stsc error, size: ${a.size}, read: ${a.size-h}`,r,65)}},35173:(e,t,a)=>{a.d(t,{A:()=>b});var i=a(4624),r=a(65977),n=a(6660),s=a(73840),o=a(31421),d=a(60703),l=a(83561),c=a(38582),f=a(28412),u=a(28460),h=a(86528),p=a(41781),m=a(12869),w=a(7320),g=a(36868),U="src/avformat/formats/mov/parsing/stsd.ts";async function b(e,t,a,b){const v=e.getPos(),z=await e.readUint8();await e.skip(3);const x=t.privData,k=await e.readUint32();for(let a=0;a<k;a++){const a=await e.readUint32(),v=await e.readUint32(),k=e.getPos()+BigInt(Math.floor(a-8));if(n.uf[v]&&(t.codecpar.codecId=n.uf[v]),0===a){i.R8("stsd entry invalid box size 0, skip",U,73),await e.skip(Number(k-e.getPos()));break}if(a>=16?(await e.skip(6),await e.skip(2)):a<=7&&i.h2(`invalid size: ${a} in stsd`,U,86),0===t.codecpar.codecType){await e.skip(2),await e.skip(2),t.metadata.vendorId=await e.readString(4),await e.skip(4),await e.skip(4),t.codecpar.width=await e.readUint16(),t.codecpar.height=await e.readUint16(),await e.skip(4),await e.skip(4),await e.skip(4),await e.skip(2);let a=await e.readUint8();for(a>31&&(a=31),t.metadata.encoder=await e.readString(a),a<31&&await e.skip(31-a),await e.skip(2),await e.skip(2);e.getPos()<k;){const a=await e.readUint32(),n=await e.readUint32();0!==a?n===(0,r.A)("avcC")?await(0,s.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("hvcC")?await(0,o.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("vvcC")?await(0,d.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("av1C")?await(0,c.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("vpcC")?await(0,l.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("esds")?await(0,f.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("wave")?await(0,u.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("colr")?await(0,m.A)(e,t,{type:n,size:a-8},b):await e.skip(Math.min(a-8,Number(k-e.getPos()))):(i.R8("stsd video invalid box size 0, skip",U,135),await e.skip(Number(k-e.getPos())))}}else if(1===t.codecpar.codecType){const a=await e.readUint16();for(await e.skip(2),t.metadata.vendorId=await e.readString(4),t.codecpar.chLayout.nbChannels=await e.readUint16(),t.codecpar.bitsPerCodedSample=await e.readUint16(),x.audioCid=await e.readUint16(),await e.skip(2),t.codecpar.sampleRate=await e.readUint32()>>>16,(!b.isom||0===z&&a>0)&&(1===a?(x.samplesPerFrame=await e.readUint32(),await e.skip(4),x.bytesPerFrame=await e.readUint32(),await e.skip(4)):2===a&&(await e.skip(4),t.codecpar.sampleRate=Number(await e.readUint64()),t.codecpar.chLayout.nbChannels=await e.readUint32(),await e.skip(4),t.codecpar.bitsPerCodedSample=await e.readUint32(),await e.skip(4),x.bytesPerFrame=await e.readUint32(),x.samplesPerFrame=await e.readUint32()));e.getPos()<k;){const a=await e.readUint32(),n=await e.readUint32();0!==a?n===(0,r.A)("esds")?await(0,f.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("dfLa")?await(0,h.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("dOps")?await(0,p.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("wave")?await(0,u.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("dac3")?await(0,w.A)(e,t,{type:n,size:a-8},b):n===(0,r.A)("dec3")?await(0,g.A)(e,t,{type:n,size:a-8},b):await e.skip(Math.min(a-8,Number(k-e.getPos()))):(i.R8("stsd audio invalid box size 0, skip",U,282),await e.skip(Number(k-e.getPos())))}}else 3===t.codecpar.codecType?(v===(0,r.A)("stpp")?t.codecpar.codecId=94232:v===(0,r.A)("wvtt")?t.codecpar.codecId=94226:v===(0,r.A)("tx3g")||v===(0,r.A)("text")?t.codecpar.codecId=94213:v===(0,r.A)("c608")&&(t.codecpar.codecId=94218),await e.skip(Math.min(a-8,Number(k-e.getPos())))):await e.skip(Math.min(a-8,Number(k-e.getPos())))}const A=a.size-Number(e.getPos()-v);A>0?await e.skip(A):A<0&&i.z3(`read stsd error, size: ${a.size}, read: ${a.size-A}`,U,383)}},63080:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(80662),r=a.n(i),n=a(4624),s="src/avformat/formats/mov/parsing/stss.ts";async function o(e,t,a,i){const o=e.getPos(),d=await e.readUint8();await e.skip(3);const l=new(r()),c=await e.readUint32();if(0===d)for(let t=0;t<c;t++)l.set(await e.readUint32(),!0);t.privData.stssSampleNumbersMap=l;const f=a.size-Number(e.getPos()-o);f>0?await e.skip(f):f<0&&n.z3(`read stss error, size: ${a.size}, read: ${a.size-f}`,s,57)}},62831:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/stsz.ts";async function n(e,t,a,n){const s=e.getPos(),o=await e.readUint8();await e.skip(3);const d=[];let l=0,c=0;if(0===o){l=await e.readUint32(),c=await e.readUint32();for(let t=0;t<c;t++)0===l?d.push(await e.readUint32()):d[t]=l}t.privData.sampleSizes=d;const f=a.size-Number(e.getPos()-s);f>0?await e.skip(f):f<0&&i.z3(`read stsz error, size: ${a.size}, read: ${a.size-f}`,r,65)}},91635:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/stts.ts";async function n(e,t,a,n){const s=e.getPos(),o=await e.readUint8();await e.skip(3);const d=t.privData,l=[],c=[],f=await e.readUint32();let u=1;if(0===o)for(let t=0;t<f;t++)l.push(await e.readUint32()),u=await e.readInt32(),u<0&&i.R8("File uses negative stts sample delta, using value 1 instead, sync may be lost!",r,53),c.push(u);d.sttsSampleCounts=l,d.sttsSampleDeltas=c;const h=a.size-Number(e.getPos()-s);h>0?await e.skip(h):h<0&&i.z3(`read stts error, size: ${a.size}, read: ${a.size-h}`,r,67)}},6570:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/stz2.ts";async function n(e,t,a,n){const s=e.getPos(),o=await e.readUint8();await e.skip(3);const d=[];let l=0,c=0;if(0===o)if(await e.skip(3),c=await e.readUint8(),l=await e.readUint32(),4===c)for(let t=0;t<l;t+=2){const a=await e.readUint8();d[t]=a>>4&15,d[t+1]=15&a}else if(8===c)for(let t=0;t<l;t++)d[t]=await e.readUint8();else if(16===c)for(let t=0;t<l;t++)d[t]=await e.readUint16();else i.z3("Error in length field in stz2 box",r,67);t.privData.sampleSizes=d;const f=a.size-Number(e.getPos()-s);f>0?await e.skip(f):f<0&&i.z3(`read stz2 error, size: ${a.size}, read: ${a.size-f}`,r,78)}},67523:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/tfdt.ts";async function n(e,t,a,n){const s=e.getPos(),o=await e.readUint8();await e.skip(3);const d=n.currentFragment.currentTrack;d&&(d.baseMediaDecodeTime=1===o?await e.readUint64():BigInt(Math.floor(await e.readUint32())));const l=a.size-Number(e.getPos()-s);l>0?await e.skip(l):l<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-l}`,r,57)}},61807:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/tfhd.ts";async function n(e,t,a,n){const s=e.getPos(),o=(await e.readUint8(),await e.readUint24()),d=await e.readUint32(),l=n.currentFragment.currentTrack;l.trackId=d,l&&(1&o&&(l.baseDataOffset=await e.readUint64()),2&o&&await e.skip(4),8&o&&(l.defaultSampleDuration=await e.readUint32()),16&o&&(l.defaultSampleSize=await e.readUint32()),32&o&&(l.defaultSampleFlags=await e.readUint32()),131072&o&&(l.baseIsMoof=!0));const c=a.size-Number(e.getPos()-s);c>0?await e.skip(c):c<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-c}`,r,75)}},27436:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/tkhd.ts";async function n(e,t,a,n){const s=t.privData,o=e.getPos(),d=await e.readUint8();s.flags=await e.readUint24(),1&s.flags&&(t.disposition|=1),1===d?(t.metadata.creationTime=await e.readUint64(),t.metadata.modificationTime=await e.readUint64(),s.trackId=await e.readUint32(),await e.skip(4),s.duration=await e.readUint64()):(t.metadata.creationTime=BigInt(Math.floor(await e.readUint32())),t.metadata.modificationTime=BigInt(Math.floor(await e.readUint32())),s.trackId=await e.readUint32(),await e.skip(4),s.duration=BigInt(Math.floor(await e.readUint32()))),await e.skip(8),s.layer=await e.readInt16(),s.alternateGroup=await e.readInt16(),s.volume=await e.readInt16()>>8,await e.skip(2),s.matrix=new Uint32Array(9);for(let t=0;t<9;t++)s.matrix[t]=await e.readUint32();s.width=await e.readUint32()>>16,s.height=await e.readUint32()>>16;const l=a.size-Number(e.getPos()-o);l>0?await e.skip(l):l<0&&i.z3(`read tkhd error, size: ${a.size}, read: ${a.size-l}`,r,82)}},25778:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/trex.ts";async function n(e,t,a,n){const s=e.getPos();await e.readUint8(),await e.skip(3);const o=await e.readUint32();await e.skip(4);const d=await e.readUint32(),l=await e.readUint32(),c=await e.readUint32();n.trexs.push({trackId:o,duration:d,size:l,flags:c});const f=a.size-Number(e.getPos()-s);f>0?await e.skip(f):f<0&&i.z3(`read trex error, size: ${a.size}, read: ${a.size-f}`,r,61)}},58996:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/formats/mov/parsing/trun.ts";async function n(e,t,a,n){const s=e.getPos(),o=await e.readUint8(),d=await e.readUint24(),l=n.currentFragment.currentTrack;if(l){l.sampleCount=await e.readUint32(),1&d&&(l.dataOffset=await e.readInt32()),4&d&&(l.firstSampleFlags=await e.readUint32());for(let t=0;t<l.sampleCount;t++)256&d&&l.sampleDurations.push(await e.readUint32()),512&d&&l.sampleSizes.push(await e.readUint32()),1024&d&&l.sampleFlags.push(await e.readUint32()),2048&d&&(0===o?l.sampleCompositionTimeOffset.push(await e.readUint32()):l.sampleCompositionTimeOffset.push(await e.readInt32()))}const c=a.size-Number(e.getPos()-s);c>0?await e.skip(c):c<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-c}`,r,79)}},83561:(e,t,a)=>{a.d(t,{A:()=>d});var i=a(37837),r=a(14686),n=a(4624),s=a(58919),o="src/avformat/formats/mov/parsing/vpcc.ts";async function d(e,t,a,d){const l=e.getPos();if(await e.readUint8(),await e.skip(3),t.codecpar.codecId=167,a.size-4<=0)return;const c=(0,i.sY)(a.size-4),f=await e.readBuffer(a.size-4,(0,r.JW)(c,a.size-4));d.foundMoov?(t.sideData[1]=f.slice(),(0,i.Eb)(c)):(t.codecpar.extradata=c,t.codecpar.extradataSize=a.size-4,t.sideData[1]=f.slice()),s.XC(t,t.sideData[1]);const u=a.size-Number(e.getPos()-l);u>0?await e.skip(u):u<0&&n.z3(`read vpcc error, size: ${a.size}, read: ${a.size-u}`,o,71)}},60703:(e,t,a)=>{a.d(t,{A:()=>d});var i=a(37837),r=a(14686),n=a(4624),s=a(55611),o="src/avformat/formats/mov/parsing/vvcc.ts";async function d(e,t,a,d){const l=e.getPos();if(await e.readUint8(),await e.skip(3),t.codecpar.codecId=196,a.size-4<=0)return;const c=(0,i.sY)(a.size-4),f=await e.readBuffer(a.size-4,(0,r.JW)(c,a.size-4));d.foundMoov?(t.sideData[1]=f.slice(),(0,i.Eb)(c)):(t.codecpar.extradata=c,t.codecpar.extradataSize=a.size-4,t.sideData[1]=f.slice()),s.XC(t,t.sideData[1]);const u=a.size-Number(e.getPos()-l);u>0?await e.skip(u):u<0&&n.z3(`read vvcc error, size: ${a.size}, read: ${a.size-u}`,o,71)}},28460:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(4624),r=a(65977),n=a(28412),s="src/avformat/formats/mov/parsing/wave.ts";async function o(e,t,a,o){const d=e.getPos(),l=d+BigInt(Math.floor(a.size));for(;e.getPos()<l;){const a=await e.readUint32(),d=await e.readUint32();0!==a?d===(0,r.A)("esds")?await(0,n.A)(e,t,{type:d,size:a-8},o):await e.skip(Math.min(a-8,Number(l-e.getPos()))):(i.R8("wave invalid box size 0, skip",s,47),await e.skip(Number(l-e.getPos())))}const c=a.size-Number(e.getPos()-d);c>0?await e.skip(c):c<0&&i.z3(`read vpcc error, size: ${a.size}, read: ${a.size-c}`,s,73)}},65977:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(4624),r="src/avformat/function/mktag.ts";function n(e){4!==e.length&&i.R8(`tag length is not 4, tag: ${e}`,r,30);let t=0;for(let a=0;a<4;a++)t=t<<8|e.charCodeAt(a);return t}},11573:(e,t,a)=>{function i(e,t){let a=0;for(let i=0;i<t;i++)a=2*a+e.readU1();return a}function r(e){let t=0;for(;!i(e,1);)t++;return t>=32?0:i(e,t)+(1<<t)-1}function n(e){let t=0,a=0;for(let r=0;r<8;r++){let n=i(e,8);if(t|=(127&n)<<7*r,a+=1,!(128&n))break}return t}a.d(t,{d:()=>r,f:()=>i,v:()=>n})},23991:(e,t,a)=>{function i(e){let t=0,a=0;for(;a<32&&0===e.readU1();)a++;return t=e.readU(a),t+=(1<<a)-1,t}function r(e){let t=i(e);return t=1&t?(t+1)/2:-t/2,t}a.d(t,{$x:()=>r,xb:()=>i})},39381:(e,t,a)=>{a.d(t,{E3:()=>n,Sg:()=>d,Y0:()=>o});var i=a(63939);function r(e){return i.f[2](e)}function n(e){return r(e+1)<<8|r(e)}function s(e){return r(e)<<8|r(e+1)}function o(e){return n(e+2)<<16|n(e)}function d(e){return s(e)<<16|s(e+2)}},60264:(e,t,a)=>{function i(e){return e.length>4&&0===e[0]&&0===e[1]&&(1===e[2]||0===e[2]&&1===e[3])}function r(e,t){let a=0;for(let i=t;i<e.length;i++)switch(e[i]){case 0:a++;break;case 1:if(a>=2)return{offset:i-Math.min(a,3),startCode:Math.min(a+1,4)};a=0;break;default:a=0}return{offset:-1,startCode:0}}function n(e){const t=[];let a=r(e,0),i={offset:-1,startCode:0};for(;i=r(e,a.offset+a.startCode),i.offset>-1;)t.push(e.subarray(a.offset+a.startCode,i.offset,!0)),a=i;return t.push(e.subarray(a.offset+a.startCode,void 0,!0)),t}function s(e,t=0,a){a||(a=e.length);const i=new Uint8Array(e.length);let r=0,n=0;for(let s=0;s<e.length;s++){if(s>=t&&s<a)if(0===e[s])r++;else if(3===e[s]&&2===r&&s+1<e.length&&e[s+1]<=3){if(s++,s===e.length)break;r=0===e[s]?1:0}else r=0;i[n++]=e[s]}return i.slice(0,n)}a.d(t,{BN:()=>s,Bs:()=>i,Ky:()=>r,py:()=>n})},37246:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(134),r=a(4624);class n{constructor(e=1048576){(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"bitsLeft",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"endPointer",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.size=e,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}peekU1(){let e=0;(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();let t=this.pointer,a=this.bitsLeft;return 0===a&&(t++,a=8),e=this.buffer[t]>>a-1&1,e}readU1(){let e=0;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,e=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8),e}readU(e){let t=0;for(let a=0;a<e;a++)t|=this.readU1()<<e-a-1;return t}remainingLength(){return this.endPointer-this.pointer}getPos(){return this.pointer}skip(e){const t=(e-e%8)/8;this.pointer+=t;const a=e%8;this.bitsLeft<=a?(this.pointer++,this.bitsLeft=8-(a-this.bitsLeft)):this.bitsLeft-=a}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&this.pointer++,!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);const e=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(e<0)throw this.error=e,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+e,this.pointer=0}else{const e=this.onFlush(this.buffer);if(this.endPointer=e,this.pointer=0,this.bitsLeft=8,e<0)throw this.error=e,Error("IOReader error, flush failed")}}getBuffer(){return this.buffer}appendBuffer(e){if(this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else{const t=Math.min(this.size-this.endPointer,e.length);this.buffer.set(e.subarray(0,t),this.endPointer),this.endPointer+=t,r.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src/common/io/BitReader.ts",190)}}clear(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0}skipPadding(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++)}}},83314:(e,t,a)=>{a.d(t,{A:()=>r});var i=a(134);class r{constructor(e=1048576){(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"bitPointer",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),this.pointer=0,this.bitPointer=0,this.size=e,this.error=0,this.buffer=new Uint8Array(this.size)}writeU1(e){(this.remainingLength()<1||1===this.remainingLength()&&this.bitPointer>=8)&&this.flush(),1&e?this.buffer[this.pointer]|=1<<7-this.bitPointer:this.buffer[this.pointer]&=~(1<<7-this.bitPointer),this.bitPointer++,8===this.bitPointer&&(this.pointer++,this.bitPointer=0)}writeU(e,t){for(let a=0;a<e;a++)this.writeU1(t>>e-a-1&1)}remainingLength(){return this.size-this.pointer}flush(){if(!this.onFlush)throw this.error=-1048574,Error("BSWriter error, flush failed because of no flush callback");if(this.pointer)if(this.bitPointer&&this.pointer>1){const e=this.onFlush(this.buffer.subarray(0,this.pointer-1));if(0!==e)throw this.error=e,Error("BSWriter error, flush failed");this.buffer[0]=this.buffer[this.pointer]}else if(0===this.bitPointer){const e=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==e)throw this.error=e,Error("BSWriter error, flush failed")}this.pointer=0}padding(){for(;0!==this.bitPointer;)this.writeU1(0)}clear(){this.pointer=0,this.bitPointer=0,this.error=0}getBuffer(){return this.buffer}getPointer(){return this.pointer}}},729:(e,t,a)=>{a.d(t,{A:()=>s});var i=a(134),r=a(4624),n=a(50011);class s{constructor(e,t=!0){(0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"byteStart",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}writeUint8(e){this.data.setUint8(this.pos+++this.byteStart,e)}writeUint16(e){this.data.setUint16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}writeUint24(e){const t=3840&e,a=240&e,i=15&e;this.littleEndian?(this.writeUint8(i),this.writeUint8(a),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(a),this.writeUint8(i))}writeUint32(e){this.data.setUint32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeUint64(e){const t=e&BigInt(4294967295),a=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeUint32(Number(t)),this.writeUint32(Number(a))):(this.writeUint32(Number(a)),this.writeUint32(Number(t)))}writeInt8(e){this.data.setInt8(this.pos+++this.byteStart,e)}writeInt16(e){this.data.setInt16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}writeInt32(e){this.data.setInt32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeInt64(e){const t=e&BigInt(4294967295),a=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeInt32(Number(t)),this.writeInt32(Number(a))):(this.writeInt32(Number(a)),this.writeInt32(Number(t)))}writeFloat(e){this.data.setFloat32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeDouble(e){this.data.setFloat64(this.pos+this.byteStart,e,this.littleEndian),this.pos+=8}getPos(){return this.pos}seek(e){e>this.size&&(e=this.size),this.pos=Math.max(0,e)}skip(e){this.seek(this.pos+e)}back(e){this.seek(this.pos-e)}remainingSize(){return this.size-this.pos}writeBuffer(e){let t=e.length;this.remainingSize()<t&&(t=this.remainingSize(),r.R8(`the remaining buffer size is smaller then the wrote buffer, hope set ${e.length}, but set ${t}`,"src/common/io/BufferWriter.ts",211)),this.buffer.set(e,this.pos),this.pos+=e.length}writeString(e){const t=n.encode(e);return this.writeBuffer(t),t.length}getWroteBuffer(){return this.buffer.subarray(0,this.pos)}resetBuffer(e,t=!0){this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}}}}]);