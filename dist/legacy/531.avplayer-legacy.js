(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[531],{58469:(e,t,r)=>{"use strict";r.d(t,{En:()=>s,Ij:()=>u,XC:()=>o,hY:()=>a});var i=r(77231),n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},a=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,i.N_,i.N_,i.N_],s=[i.N_,1,2,3,4,5,6,7];function o(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){var r=function(e){var t,r,n=i.N_,o=i.N_,u=i.N_;return e.length>=2&&(n=e[0]>>3&31,o=null!==(t=a[(7&e[0])<<1|e[1]>>7])&&void 0!==t?t:48e3,u=null!==(r=s[e[1]>>3&15])&&void 0!==r?r:2),{profile:n,sampleRate:o,channels:u}}(t),n=r.profile,o=r.sampleRate,u=r.channels;e.codecpar.profile=n,e.codecpar.sampleRate=o,e.codecpar.chLayout.nbChannels=u,e.codecpar.channels=u}}function u(e){var t=n[e.sampleRate],r=e.chLayout.nbChannels,i=new Uint8Array(2);return i[0]=(31&e.profile)<<3|(14&t)>>1,i[1]=(1&t)<<7|(15&r)<<3,i}},90412:(e,t,r)=>{"use strict";r.d(t,{Ui:()=>a,XC:()=>n});var i=r(37246);function n(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=4){var r=a(t);e.codecpar.profile=r.profile,e.codecpar.level=r.level}}function a(e){var t=new i.A(e.length);t.appendBuffer(e),t.readU1(),t.readU(7);var r=t.readU(3),n=t.readU(5),a=t.readU1(),s=t.readU1()?10:8;return t.readU1()&&(s=12),{profile:r,level:n,tier:a,bitDepth:s,monochrome:t.readU1(),chromaSubsamplingX:t.readU1(),chromaSubsamplingY:t.readU1(),chromaSamplePosition:t.readU(2)}}},20620:(e,t,r)=>{"use strict";r.d(t,{Jk:()=>x,XC:()=>w,ci:()=>U,oT:()=>k});var i=r(63939),n=r(50932),a=r(72739),s=r(729),o=r(31865),u=r(37246),h=r(4624),c=r(14686),f=r(71517),d=r(60264),l=r(37837),p=r(23991),g="src/avformat/codecs/h264.ts",v=3;function b(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e.length>32&&(h.R8("h264 metadata's sps max length is 32, but get ".concat(e.length),g,159),e=e.slice(0,32)),e.length>256&&(h.R8("h264 metadata's pps max length is 256, but get ".concat(e.length),g,163),e=e.slice(0,256));var i=7;i=e.reduce((function(e,t){return e+2+t.length}),i),i=t.reduce((function(e,t){return e+2+t.length}),i);var n=e[0],o=y(n);66!==o.profile&&77!==o.profile&&88!==o.profile&&(i+=4,r.length&&(i=r.reduce((function(e,t){return e+2+t.length}),i)));var u=new Uint8Array(i),c=new s.A(u);return c.writeUint8(1),c.writeUint8(n[1]),c.writeUint8(n[2]),c.writeUint8(n[3]),c.writeUint8(252|v),c.writeUint8(224|31&e.length),a.__(e,(function(e){c.writeUint16(e.length),c.writeBuffer(e)})),c.writeUint8(t.length),a.__(t,(function(e){c.writeUint16(e.length),c.writeBuffer(e)})),66!==o.profile&&77!==o.profile&&88!==o.profile&&(c.writeUint8(252|o.chromaFormatIdc),c.writeUint8(248|o.bitDepthLumaMinus8),c.writeUint8(248|o.bitDepthChromaMinus8),r.length&&a.__(r,(function(e){c.writeUint16(e.length),c.writeBuffer(e)}))),u}function k(e){var t,r=(0,d.py)(e),i=!1;if(r.length>1){var n=[],o=[],u=[];r.forEach((function(e){var t=31&e[0];7===t?n.push(e):8===t?o.push(e):13===t&&u.push(e)})),n.length&&o.length&&(t=b(n,o,u)),r=r.filter((function(e){var t=31&e[0];return 9!==t&&8!==t&&7!==t&&13!==t}))}var h=r.reduce((function(e,t){return e+v+1+t.length}),0),f=(0,l.sY)(h),p=(0,c.s3)(f,h),g=new s.A(p);return a.__(r,(function(e){3===v?g.writeUint32(e.length):2===v?g.writeUint24(e.length):1===v?g.writeUint16(e.length):g.writeUint8(e.length),g.writeBuffer(e.subarray(0)),5==(31&e[0])&&(i=!0)})),{bufferPointer:f,length:h,key:i,extradata:t}}function x(e,t){var r;if(1&i.f[15](e+36)){var n=(0,f.iI)(e);if(!(0,d.Bs)(n)){for(var a=null!==(r=t.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:v,s=[],u=[],h=[],p=[],g=new o.A(n);g.remainingSize()>0;){var k;k=3===a?g.readUint32():2===a?g.readUint24():1===a?g.readUint16():g.readUint8();var x=n.subarray(0|Number(0xffffffffn&g.getPos()),(0|Number(0xffffffffn&g.getPos()))+k);g.skip(k);var U=31&x[0];7===U?s.push(x):8===U?u.push(x):13===U?h.push(x):p.push(x)}if(s.length||u.length){var w=b(s,u,h),y=(0,l.sY)(w.length);(0,c.lW)(y,w.length,w),(0,f.Ow)(e,1,y,w.length)}}}}function U(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(1&i.f[15](e+36)||t){var r=(0,f.iI)(e);if((0,d.Bs)(r)){var a=(0,d.py)(r);if(a.length>1){var s=[],o=[],u=[];if(a.forEach((function(e){var t=31&e[0];7===t?s.push(e):8===t?o.push(e):13===t&&u.push(e)})),s.length&&o.length){var h=b(s,o,u),p=(0,l.sY)(h.length);(0,c.lW)(p,h.length,h),(0,f.Ow)(e,1,p,h.length),n.M[15](e+36,1|i.f[15](e+36))}}}}}function w(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[4];var r=function(e){var t=new o.A(e);t.skip(5);for(var r=[],i=[],n=[],a=31&t.readUint8(),s=0;s<a;s++){var u=t.readUint16();r.push(t.readBuffer(u))}for(var h=t.readUint8(),c=0;c<h;c++){var f=t.readUint16();i.push(t.readBuffer(f))}if(t.remainingSize()>4){t.skip(3);var d=t.readUint8();if(d>0)for(var l=0;l<d;l++){var p=t.readUint16();n.push(t.readBuffer(p))}}return{spss:r,ppss:i,spsExts:n}}(t).spss;if(r.length){var i=y(r[0]),n=i.profile,a=i.level,s=i.width,u=i.height;e.codecpar.profile=n,e.codecpar.level=a,e.codecpar.width=s,e.codecpar.height=u}}}function y(e){if(e&&!(e.length<3)){var t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);var r=(0,d.BN)(e.subarray(t)),i=new u.A(r.length);i.appendBuffer(r),i.readU1(),i.readU(2),i.readU(5);var n=i.readU(8);i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU(2);var a=i.readU(8);p.xb(i);var s=1,o=0,h=0;if((100==n||110==n||122==n||244==n||44==n||83==n||86==n||118==n||128==n||138==n||139==n||134==n||135==n)&&(3===(s=p.xb(i))&&i.readU1(),o=p.xb(i),h=p.xb(i),i.readU1(),i.readU1()))for(var c=new Array(8),f=0;f<(3!=s?8:12);f++)c[f]=i.readU1();p.xb(i);var l=p.xb(i);if(0===l)p.xb(i);else if(1===l){i.readU1(),p.$x(i),p.$x(i);for(var g=p.xb(i),v=0;v<g;v++)p.$x(i)}p.xb(i),i.readU1();var b=p.xb(i),k=p.xb(i),x=i.readU1(),U=16*(b+1),w=(2-x)*(k+1)*16;x||i.readU1(),i.readU1();var y=i.readU1();if(y){var m=1,A=2-y;1===s?(m=2,A=2*(2-y)):2===y&&(m=2,A=2-y),U-=m*(p.xb(i)+p.xb(i)),w-=A*(p.xb(i)+p.xb(i))}return{profile:n,level:a,width:U,height:w,chromaFormatIdc:s,bitDepthLumaMinus8:o,bitDepthChromaMinus8:h}}}},53e3:(e,t,r)=>{"use strict";r.d(t,{Jk:()=>b,XC:()=>x,ci:()=>k,oT:()=>v});var i=r(63939),n=r(50932),a=r(72739),s=r(729),o=r(31865),u=r(37246),h=r(14686),c=r(60264),f=r(71517),d=r(37837),l=r(23991),p=3;function g(e,t,r){var i=t[0],n=23;e.length&&(n+=3,n=e.reduce((function(e,t){return e+2+t.length}),n)),t.length&&(n+=3,n=t.reduce((function(e,t){return e+2+t.length}),n)),r.length&&(n+=3,n=r.reduce((function(e,t){return e+2+t.length}),n));var o=new Uint8Array(n),u=new s.A(o,!0),h=U(i);u.writeUint8(1),u.writeUint8(i[1]),u.writeUint8(i[2]),u.writeUint8(i[3]),u.writeUint8(i[4]),u.writeUint8(i[5]),u.writeUint8(i[6]),u.writeUint8(i[7]),u.writeUint8(i[8]),u.writeUint8(i[9]),u.writeUint8(i[10]),u.writeUint8(i[11]),u.writeUint8(h.level),u.writeUint8(1020),u.writeUint8(0),u.writeUint8(16320),u.writeUint8(16320|h.chromaFormatIdc),u.writeUint8(8160|h.bitDepthLumaMinus8),u.writeUint8(8160|h.bitDepthChromaMinus8),u.writeUint16(0),u.writeUint8(8|(1&i[0])<<2|p);var c=0;return e.length&&c++,t.length&&c++,r.length&&c++,u.writeUint8(c),e.length&&(u.writeUint8(160),u.writeUint16(e.length),a.__(e,(function(e){u.writeUint16(e.length),u.writeBuffer(e)}))),t.length&&(u.writeUint8(161),u.writeUint16(t.length),a.__(t,(function(e){u.writeUint16(e.length),u.writeBuffer(e)}))),r.length&&(u.writeUint8(162),u.writeUint16(r.length),a.__(r,(function(e){u.writeUint16(e.length),u.writeBuffer(e)}))),o}function v(e){var t,r=!1,i=(0,c.py)(e);if(i.length>2){var n=[],o=[],u=[];i.forEach((function(e){var t=e[0]>>>1&63;32===t?n.push(e):33===t?o.push(e):34===t&&u.push(e)})),n.length&&o.length&&u.length&&(t=g(n,o,u),i=i.filter((function(e){var t=e[0]>>>1&63;return 32!==t&&33!==t&&34!==t&&35!==t})))}var f=i.reduce((function(e,t){return e+p+1+t.length}),0),l=(0,d.sY)(f),v=(0,h.s3)(l,f),b=new s.A(v);return a.__(i,(function(e){3===p?b.writeUint32(e.length):2===p?b.writeUint24(e.length):1===p?b.writeUint16(e.length):b.writeUint8(e.length),b.writeBuffer(e.subarray(0));var t=e[0]>>>1&63;19!==t&&20!==t&&21!==t||(r=!0)})),{bufferPointer:l,length:f,extradata:t,key:r}}function b(e,t){var r;if(1&i.f[15](e+36)){var n=(0,f.iI)(e);if(!(0,c.Bs)(n)){for(var a=null!==(r=t.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:p,s=[],u=[],l=[],v=new o.A(n);v.remainingSize()>0;){var b;b=3===a?v.readUint32():2===a?v.readUint24():1===a?v.readUint16():v.readUint8();var k=n.subarray(0|Number(0xffffffffn&v.getPos()),(0|Number(0xffffffffn&v.getPos()))+b);v.skip(b);var x=k[0]>>>1&63;33===x?u.push(k):34===x?l.push(k):32===x&&s.push(k)}if(u.length||l.length||s.length){var U=g(s,u,l),w=(0,d.sY)(U.length);(0,h.lW)(w,U.length,U),(0,f.Ow)(e,1,w,U.length)}}}}function k(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(1&i.f[15](e+36)||t){var r=(0,f.iI)(e);if((0,c.Bs)(r)){var a=(0,c.py)(r);if(a.length>2){var s=[],o=[],u=[];if(a.forEach((function(e){var t=e[0]>>>1&63;32===t?s.push(e):33===t?o.push(e):34===t&&u.push(e)})),s.length&&o.length&&u.length){var l=g(s,o,u),p=(0,d.sY)(l.length);(0,h.lW)(p,l.length,l),(0,f.Ow)(e,1,p,l.length),n.M[15](e+36,1|i.f[15](e+36))}}}}}function x(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[21];var r=function(e){var t=new o.A(e,!0);t.skip(22);for(var r=[],i=[],n=[],a=t.readUint8(),s=0;s<a;s++){for(var u=63&t.readUint8(),h=t.readUint16(),c=[],f=0;f<h;f++){var d=t.readUint16();c.push(t.readBuffer(d))}32===u?r=c:33===u?i=c:34===u&&(n=c)}return{vpss:r,spss:i,ppss:n}}(t).spss;if(r.length){var i=U(r[0]),n=i.profile,a=i.level,s=i.width,u=i.height;e.codecpar.profile=n,e.codecpar.level=a,e.codecpar.width=s,e.codecpar.height=u}}}function U(e){if(e&&!(e.length<3)){var t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);var r=0,i=0,n=0,a=0,s=0,o=0,h=1,f=0,d=0,p=0,g=0,v=(0,c.BN)(e.subarray(t)),b=new u.A(v.length);b.appendBuffer(v),b.readU1(),b.readU(6),b.readU(6),b.readU(3),b.readU(4);var k=b.readU(3);if(b.readU1(),k<=6){f=b.readU(2),d=b.readU1(),r=b.readU(5),p=b.readU(32),g=b.readU(48),i=b.readU(8);for(var x=new Array(6),U=new Array(6),w=0;w<k;w++)x[w]=b.readU1(),U[w]=b.readU1();if(k>0)for(var y=k;y<8;y++)b.readU(2);for(var m=0;m<k;m++)x[m]&&(b.readU(2),b.readU(1),b.readU(5),b.readU(32),b.readU(1),b.readU(1),b.readU(1),b.readU(1),b.readU(44)),U[m]&&b.readU(8);l.xb(b),3===(h=l.xb(b))&&b.readU(1),n=l.xb(b),a=l.xb(b);var A=0,I=0,B=0,R=0;b.readU1()&&(A=l.xb(b),I=l.xb(b),B=l.xb(b),R=l.xb(b)),s=l.xb(b),o=l.xb(b);var M=2,P=2;0===h?M=P=0:2===h?(M=2,P=1):3===h&&(M=P=1),n-=M*(1<<s+1)*(A+I),a-=P*(1<<s+1)*(B+R)}return{profile:r,level:i,width:n,height:a,chromaFormatIdc:h,bitDepthLumaMinus8:s,bitDepthChromaMinus8:o,generalProfileSpace:f,generalTierFlag:d,generalProfileCompatibilityFlag:p,constraintFlags:g}}}},58919:(e,t,r)=>{"use strict";r.d(t,{U:()=>a,X:()=>n});var i=r(37246);function n(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){var r=a(t);e.codecpar.profile=r.profile,e.codecpar.level=r.level}}function a(e){var t=new i.A(e.length);return t.appendBuffer(e.subarray(4)),{profile:t.readU(8),level:t.readU(8),bitDepth:t.readU(4),chromaSubsampling:t.readU(3),fullRangeFlag:t.readU1(),colorPrimaries:t.readU(8),colorTrc:t.readU(8),colorSpace:t.readU(8)}}},28773:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>O});var i=r(88435),n=r.n(i),a=r(25182),s=r(78716),o=r(81570),u=r(77193),h=r(25767),c=r(43070),f=r(31060),d=r(134),l=r(36443),p=r.n(l),g=r(63939),v=r(50932),b=r(58121),k=r(68243),x=r(4624),U=r(35028),w=r(20620),y=r(58469),m=r(53e3),A=r(90412),I=r(58919),B=r(9705),R=r(85947),M=r(14686),P=r(37837),D=r(71517),S=r(65977),z=r(44328),L=r(77231),E=r(72739),V=r(52071);function _(e,t,r){return t=(0,h.A)(t),(0,u.A)(e,C()?n()(t,r||[],(0,h.A)(e).constructor):t.apply(e,r))}function C(){try{var e=!Boolean.prototype.valueOf.call(n()(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}var F="src/avformat/formats/IFlvFormat.ts",O=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.A)(this,t),e=_(this,t),(0,d.A)((0,c.A)(e),"type",0),(0,d.A)((0,c.A)(e),"header",void 0),(0,d.A)((0,c.A)(e),"script",void 0),(0,d.A)((0,c.A)(e),"options",void 0),(0,d.A)((0,c.A)(e),"firstTagPos",void 0),e.header=new b.A,e.script=new k.A,e.options=r,e}var r,i,n,u,h,l,R;return(0,f.A)(t,e),(0,o.A)(t,[{key:"init",value:function(e){e.ioReader&&e.ioReader.setEndian(!0)}},{key:"readHeader",value:(R=(0,a.A)(p().mark((function e(t){var r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.ioReader.peekString(3);case 3:if("FLV"===e.sent){e.next=7;break}return x.z3("the file format is not flv",F,98),e.abrupt("return",B.LR);case 7:return e.next=9,this.header.read(t.ioReader);case 9:return e.next=11,t.ioReader.readUint32();case 11:return 0!==e.sent&&x.R8("the previousTagSize0 is not 0",F,105),r=0,e.next=16,t.ioReader.peekUint8();case 16:if(18!==e.sent){e.next=28;break}return e.next=20,t.ioReader.skip(1);case 20:return e.next=22,t.ioReader.readUint24();case 22:return i=e.sent,e.next=25,t.ioReader.skip(7);case 25:return e.next=27,this.script.read(t.ioReader,i);case 27:r=e.sent;case 28:return r>=0&&(this.firstTagPos=t.ioReader.getPos()),e.abrupt("return",r);case 32:return e.prev=32,e.t0=e.catch(0),x.z3(e.t0.message,F,123),e.abrupt("return",t.ioReader.error);case 36:case"end":return e.stop()}}),e,this,[[0,32]])}))),function(e){return R.apply(this,arguments)})},{key:"readCodecConfigurationRecord",value:(l=(0,a.A)(p().mark((function e(t,r,i){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,P.sY)(i),r.codecpar.extradata=n,r.codecpar.extradataSize=i,e.next=5,t.ioReader.readBuffer(i,(0,M.JW)(n,i));case 5:r.sideData[1]=(0,M.s3)(n,i).slice(),27===r.codecpar.codecId||12===r.codecpar.codecId?w.XC(r):173===r.codecpar.codecId?m.XC(r):226===r.codecpar.codecId?A.XC(r):167===r.codecpar.codecId&&I.X(r);case 7:case"end":return e.stop()}}),e)}))),function(e,t,r){return l.apply(this,arguments)})},{key:"readAVPacketData",value:(h=(0,a.A)(p().mark((function e(t,r,i,n){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(0,P.sY)(n),(0,D.NX)(i,a,n),e.next=4,t.ioReader.readBuffer(n,(0,M.JW)(a,n));case 4:27===r.codecpar.codecId?(w.Jk(i,r),v.M[15](i+80,1)):173===r.codecpar.codecId&&(m.Jk(i,r),v.M[15](i+80,1));case 5:case"end":return e.stop()}}),e)}))),function(e,t,r,i){return h.apply(this,arguments)})},{key:"readAVPacket_",value:(u=(0,a.A)(p().mark((function e(t,r){var i,n,a,s,o,u,h,c,f,d,l,b,k,w,m,A,I,R,z,L,E,V,_,C,O,N,T,Y,W;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.ioReader.getPos(),v.M[17](r+56,i),e.next=4,t.ioReader.readUint8();case 4:return n=e.sent,e.next=7,t.ioReader.readUint24();case 7:return a=e.sent,e.next=10,t.ioReader.readUint24();case 10:return s=e.sent,e.next=13,t.ioReader.readUint8();case 13:return(o=e.sent)&&(s|=o<<24),v.M[17](r+16,BigInt(Math.floor(s))),v.M[17](r+8,BigInt(Math.floor(s))),e.next=18,t.ioReader.skip(3);case 18:if(8!==n){e.next=91;break}return(u=t.getStreamByMediaType(1))&&v.M[15](r+32,u.index),e.next=23,t.ioReader.readUint8();case 23:if(h=e.sent,!u){e.next=46;break}if(86018!==u.codecpar.codecId){e.next=42;break}return e.next=28,t.ioReader.readUint8();case 28:if(0!==e.sent){e.next=37;break}return c=a-2,f=(0,P.sY)(c),(0,D.Ow)(r,1,f,c),e.next=35,t.ioReader.readBuffer(c,(0,M.JW)(f,c));case 35:e.next=39;break;case 37:return e.next=39,this.readAVPacketData(t,u,r,a-2);case 39:v.M[15](r+36,1|g.f[15](r+36)),e.next=44;break;case 42:return e.next=44,this.readAVPacketData(t,u,r,a-1);case 44:e.next=89;break;case 46:if(u=t.createStream(),v.M[15](r+32,u.index),u.codecpar.codecType=1,u.timeBase.den=1e3,u.timeBase.num=1,u.startTime=g.f[17](r+8)||g.f[17](r+16),this.script.onMetaData.duration&&(u.duration=BigInt(Math.floor(1e3*this.script.onMetaData.duration))),u.codecpar.chLayout.nbChannels=1&~h?1:2,u.codecpar.channels=1&~h?1:2,u.codecpar.sampleRate=44100<<((12&h)>>>2)>>3,u.codecpar.bitsPerCodedSample=2&h?16:8,u.codecpar.codecId=U.FJ[(240&h)>>4],86018!==u.codecpar.codecId){e.next=78;break}return e.next=61,t.ioReader.readUint8();case 61:if(0!==e.sent){e.next=73;break}return d=a-2,l=(0,P.sY)(d),u.codecpar.extradata=l,u.codecpar.extradataSize=d,e.next=69,t.ioReader.readBuffer(d,(0,M.JW)(l,d));case 69:u.sideData[1]=(0,M.s3)(l,d).slice(),y.XC(u),e.next=75;break;case 73:return e.next=75,this.readAVPacketData(t,u,r,a-2);case 75:v.M[15](r+36,1|g.f[15](r+36)),e.next=88;break;case 78:if(86051!==u.codecpar.codecId){e.next=86;break}return u.codecpar.sampleRate=16e3,u.codecpar.chLayout.nbChannels=1,u.codecpar.channels=1,e.next=84,this.readAVPacketData(t,u,r,a-1);case 84:e.next=88;break;case 86:return e.next=88,this.readAVPacketData(t,u,r,a-1);case 88:this.onStreamAdd&&this.onStreamAdd(u);case 89:e.next=235;break;case 91:if(9!==n){e.next=226;break}return(b=t.getStreamByMediaType(0))&&v.M[15](r+32,b.index),e.next=96,t.ioReader.readUint8();case 96:if(k=e.sent,!b){e.next=159;break}if((112&k)>>4==1&&v.M[15](r+36,1|g.f[15](r+36)),!(128&k)){e.next=130;break}return e.next=102,t.ioReader.skip(4);case 102:if(w=15&k,173===b.codecpar.codecId&&v.M[15](r+80,1),0!==w){e.next=112;break}return m=a-5,A=(0,P.sY)(m),(0,D.Ow)(r,1,A,m),e.next=110,t.ioReader.readBuffer(m,(0,M.JW)(A,m));case 110:e.next=128;break;case 112:if(2!==w){e.next=116;break}v.M[15](r+36,32|g.f[15](r+36)),e.next=128;break;case 116:if(1!==w&&3!==w){e.next=128;break}if(1!==w||173!==b.codecpar.codecId){e.next=126;break}return e.next=120,t.ioReader.readUint24();case 120:return I=e.sent,v.M[17](r+8,g.f[17](r+16)+BigInt(Math.floor(I))),e.next=124,this.readAVPacketData(t,b,r,a-8);case 124:e.next=128;break;case 126:return e.next=128,this.readAVPacketData(t,b,r,a-5);case 128:e.next=157;break;case 130:if(27!==b.codecpar.codecId&&173!==b.codecpar.codecId&&12!==b.codecpar.codecId){e.next=155;break}return v.M[15](r+80,1),e.next=134,t.ioReader.readUint8();case 134:return R=e.sent,e.next=137,t.ioReader.readUint24();case 137:if(z=e.sent,v.M[17](r+8,g.f[17](r+16)+BigInt(Math.floor(z))),0!==R){e.next=147;break}return L=a-5,E=(0,P.sY)(L),(0,D.Ow)(r,1,E,L),e.next=145,t.ioReader.readBuffer(L,(0,M.JW)(E,L));case 145:e.next=153;break;case 147:if(2!==R){e.next=151;break}v.M[15](r+36,32|g.f[15](r+36)),e.next=153;break;case 151:return e.next=153,this.readAVPacketData(t,b,r,a-5);case 153:e.next=157;break;case 155:return e.next=157,this.readAVPacketData(t,b,r,a-1);case 157:e.next=224;break;case 159:if(b=t.createStream(),v.M[15](r+32,b.index),b.codecpar.codecType=0,b.timeBase.den=1e3,b.timeBase.num=1,b.startTime=g.f[17](r+8)||g.f[17](r+16),this.script.onMetaData.duration&&(b.duration=BigInt(Math.floor(1e3*this.script.onMetaData.duration))),this.script.onMetaData.width>0&&(b.codecpar.width=this.script.onMetaData.width),this.script.onMetaData.height>0&&(b.codecpar.height=this.script.onMetaData.height),(112&k)>>4==1&&v.M[15](r+36,1|g.f[15](r+36)),!(128&k)){e.next=198;break}return e.next=172,t.ioReader.readUint32();case 172:if((V=e.sent)===(0,S.A)("hvc1")?(b.codecpar.codecId=173,v.M[15](r+80,1)):V===(0,S.A)("av01")?b.codecpar.codecId=226:V===(0,S.A)("vp09")&&(b.codecpar.codecId=167),0!=(_=15&k)){e.next=180;break}return e.next=178,this.readCodecConfigurationRecord(t,b,a-5);case 178:e.next=196;break;case 180:if(2!==_){e.next=184;break}v.M[15](r+36,32|g.f[15](r+36)),e.next=196;break;case 184:if(1!==_&&3!==_){e.next=196;break}if(1!==_||173!==b.codecpar.codecId){e.next=194;break}return e.next=188,t.ioReader.readUint24();case 188:return C=e.sent,v.M[17](r+8,g.f[17](r+16)+BigInt(Math.floor(C))),e.next=192,this.readAVPacketData(t,b,r,a-8);case 192:e.next=196;break;case 194:return e.next=196,this.readAVPacketData(t,b,r,a-5);case 196:e.next=223;break;case 198:if(b.codecpar.codecId=U.U5[15&k],27!==b.codecpar.codecId&&173!==b.codecpar.codecId&&12!==b.codecpar.codecId){e.next=221;break}return v.M[15](r+80,1),e.next=203,t.ioReader.readUint8();case 203:return O=e.sent,e.next=206,t.ioReader.readUint24();case 206:if(N=e.sent,v.M[17](r+8,g.f[17](r+16)+BigInt(Math.floor(N))),0!==O){e.next=213;break}return e.next=211,this.readCodecConfigurationRecord(t,b,a-5);case 211:e.next=219;break;case 213:if(2!==O){e.next=217;break}v.M[15](r+36,32|g.f[15](r+36)),e.next=219;break;case 217:return e.next=219,this.readAVPacketData(t,b,r,a-5);case 219:e.next=223;break;case 221:return e.next=223,this.readAVPacketData(t,b,r,a-1);case 223:this.onStreamAdd&&this.onStreamAdd(b);case 224:e.next=235;break;case 226:if(18!==n){e.next=235;break}return e.next=229,this.script.read(t.ioReader,a);case 229:if(!((T=e.sent)<0)){e.next=232;break}return e.abrupt("return",T);case 232:return e.next=234,this.readAVPacket_(t,r);case 234:return e.abrupt("return",e.sent);case 235:return Y=t.ioReader.getPos()-i,e.t0=BigInt,e.t1=Math,e.next=240,t.ioReader.readUint32();case 240:if(e.t2=e.sent,e.t3=e.t1.floor.call(e.t1,e.t2),W=(0,e.t0)(e.t3),Y===W){e.next=246;break}return x.R8("tag ".concat(n," size not match, size: ").concat(Y,", previousTagSize: ").concat(W),F,435),e.abrupt("return",B.LR);case 246:return e.abrupt("return",0);case 247:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"readAVPacket",value:(n=(0,a.A)(p().mark((function e(t,r){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.M[15](r+76,1e3),v.M[15](r+72,1),e.next=5,this.readAVPacket_(t,r);case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(0),-1048576!==t.ioReader.error&&x.z3(e.t0.message,F,451),e.abrupt("return",t.ioReader.error);case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(e,t){return n.apply(this,arguments)})},{key:"syncTag",value:(i=(0,a.A)(p().mark((function e(t){var r,i,n,a,s,o,u,h,c,f,d,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=L.Dh,i=3;case 2:return e.prev=3,e.next=6,t.ioReader.readUint8();case 6:if(8!==(n=e.sent)&&9!==n){e.next=70;break}return r=t.ioReader.getPos()-BigInt(1),e.next=11,t.ioReader.readUint24();case 11:if(!((a=e.sent)>10485760)){e.next=16;break}return e.next=15,t.ioReader.seek(r+BigInt(1));case 15:return e.abrupt("continue",2);case 16:return e.next=18,t.ioReader.skip(7+a);case 18:return s=t.ioReader.getPos()-r,e.t0=BigInt,e.t1=Math,e.next=23,t.ioReader.readUint32();case 23:if(e.t2=e.sent,e.t3=e.t1.floor.call(e.t1,e.t2),o=(0,e.t0)(e.t3),s!==o){e.next=66;break}u=0;case 28:if(!(u<=i)){e.next=57;break}return h=t.ioReader.getPos(),e.next=32,t.ioReader.readUint8();case 32:if(8!==(c=e.sent)&&9!==c&&18!==c){e.next=54;break}return e.next=36,t.ioReader.readUint24();case 36:return f=e.sent,e.next=39,t.ioReader.skip(7+f);case 39:return d=t.ioReader.getPos()-h,e.t4=BigInt,e.t5=Math,e.next=44,t.ioReader.readUint32();case 44:if(e.t6=e.sent,e.t7=e.t5.floor.call(e.t5,e.t6),l=(0,e.t4)(e.t7),d!==l){e.next=51;break}u++,e.next=52;break;case 51:return e.abrupt("break",57);case 52:e.next=55;break;case 54:return e.abrupt("break",57);case 55:e.next=28;break;case 57:if(!(u<i)){e.next=63;break}return e.next=60,t.ioReader.seek(r+BigInt(1));case 60:r=L.Dh,e.next=64;break;case 63:return e.abrupt("break",77);case 64:e.next=70;break;case 66:return e.next=68,t.ioReader.seek(r+BigInt(1));case 68:return r=L.Dh,e.abrupt("continue",2);case 70:e.next=75;break;case 72:return e.prev=72,e.t8=e.catch(3),e.abrupt("break",77);case 75:e.next=2;break;case 77:if(r===L.Dh){e.next=80;break}return e.next=80,t.ioReader.seek(r);case 80:case"end":return e.stop()}}),e,null,[[3,72]])}))),function(e){return i.apply(this,arguments)})},{key:"seek",value:(r=(0,a.A)(p().mark((function e(t,r,i,n){var a,s,o,u,h;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.ioReader.getPos(),!r||!r.sampleIndexes.length){e.next=8;break}if(!((s=E.El(r.sampleIndexes,(function(e){return e.pts>i?-1:1})))>0&&(0,z.k)(i-r.sampleIndexes[s-1].pts,r.timeBase,L.i0)<BigInt(1e4))){e.next=8;break}return x.Yz("seek in sampleIndexes, found index: ".concat(s,", pts: ").concat(r.sampleIndexes[s-1].pts,", pos: ").concat(r.sampleIndexes[s-1].pos),F,541),e.next=7,t.ioReader.seek(r.sampleIndexes[s-1].pos);case 7:case 14:case 21:return e.abrupt("return",a);case 8:if(!this.script.canSeek()){e.next=15;break}if(o=this.script.dts2Position(Number((0,z.k)(i,r.timeBase,L.i0)/BigInt(1e3))),u=o.pos,h=o.dts,!(u>0)){e.next=15;break}return x.Yz("seek in filepositions, found pts: ".concat(h,", pos: ").concat(u),F,550),e.next=14,t.ioReader.seek(BigInt(Math.floor(u)));case 15:if(!(2&n)){e.next=24;break}return e.next=18,t.ioReader.seek(i);case 18:if(4&n){e.next=21;break}return e.next=21,this.syncTag(t);case 24:return x.Yz("not found any keyframe index, try to seek in bytes",F,563),e.abrupt("return",(0,V.A)(t,r,i,this.firstTagPos,this.readAVPacket.bind(this),this.syncTag.bind(this)));case 26:case"end":return e.stop()}}),e,this)}))),function(e,t,i,n){return r.apply(this,arguments)})},{key:"getAnalyzeStreamsCount",value:function(){var e=0;return this.header.hasAudio&&e++,this.header.hasVideo&&e++,e}}]),t}(R.A)},85947:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var i=r(78716),n=r(81570),a=r(134),s=function(){function e(){(0,i.A)(this,e),(0,a.A)(this,"type",-1),(0,a.A)(this,"onStreamAdd",void 0)}return(0,n.A)(e,[{key:"destroy",value:function(e){}}]),e}()},58121:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var i=r(25182),n=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),h=function(){function e(){(0,n.A)(this,e),(0,s.A)(this,"signature",void 0),(0,s.A)(this,"version",void 0),(0,s.A)(this,"flags",void 0),(0,s.A)(this,"dataOffset",void 0),(0,s.A)(this,"hasVideo",void 0),(0,s.A)(this,"hasAudio",void 0),this.signature="FLV",this.version=1,this.flags=0,this.dataOffset=9,this.hasAudio=!1,this.hasVideo=!1}var t;return(0,a.A)(e,[{key:"read",value:(t=(0,i.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.readString(3);case 2:return this.signature=e.sent,e.next=5,t.readUint8();case 5:return this.version=e.sent,e.next=8,t.readUint8();case 8:return this.flags=e.sent,e.next=11,t.readUint32();case 11:this.dataOffset=e.sent,this.hasAudio=!!(4&this.flags),this.hasVideo=!!(1&this.flags);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"write",value:function(e){this.flags=0,this.hasAudio&&(this.flags|=4),this.hasVideo&&(this.flags|=1),e.writeString(this.signature),e.writeUint8(this.version),e.writeUint8(this.flags),e.writeUint32(this.dataOffset)}}]),e}()},68243:(e,t,r)=>{"use strict";r.d(t,{A:()=>b});var i=r(25182),n=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),h=r(35336),c=r(67672),f=r(72739),d=r(95335),l=r(92647),p=r(4624),g=r(94889),v=r(9705),b=function(){function e(){(0,n.A)(this,e),(0,s.A)(this,"onMetaData",void 0),this.onMetaData={audiocodecid:10,canSeekToEnd:!1,width:0,height:0,stereo:!0,videocodecid:7}}var t,r,o;return(0,a.A)(e,[{key:"parseObject",value:(o=(0,i.A)(u().mark((function e(t,r){var i,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,t.readUint16();case 3:return e.t1=e.sent,e.next=6,e.t0.readString.call(e.t0,e.t1);case 6:return i=e.sent,e.next=9,this.parseValue(t,r);case 9:return n=e.sent,e.abrupt("return",{key:i,value:n});case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"parseValue",value:(r=(0,i.A)(u().mark((function e(t,r){var i,n,a,s,o,h,c,f,d,l,p,g;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.readUint8();case 2:i=e.sent,e.t0=i,e.next=0===e.t0?6:1===e.t0?10:2===e.t0?19:3===e.t0?27:8===e.t0?46:9===e.t0?65:10===e.t0?67:11===e.t0?82:12===e.t0?90:98;break;case 6:return e.next=8,t.readDouble();case 8:return n=e.sent,e.abrupt("break",98);case 10:return e.next=12,t.readUint8();case 12:if(!e.sent){e.next=16;break}e.t1=!0,e.next=17;break;case 16:e.t1=!1;case 17:return n=e.t1,e.abrupt("break",98);case 19:return e.t2=t,e.next=22,t.readUint16();case 22:return e.t3=e.sent,e.next=25,e.t2.readString.call(e.t2,e.t3);case 25:return n=e.sent,e.abrupt("break",98);case 27:n={};case 28:if(!(t.getPos()<r)){e.next=45;break}return e.next=31,this.parseObject(t,r);case 31:return a=e.sent,s=a.key,o=a.value,n[s]=o,e.next=37,t.peekUint24();case 37:if(e.t4=e.sent,e.t5=16777215&e.t4,9!==e.t5){e.next=43;break}return e.next=42,t.skip(3);case 42:return e.abrupt("break",45);case 43:e.next=28;break;case 45:return e.abrupt("break",98);case 46:n={},t.skip(4);case 48:if(!(t.getPos()<r)){e.next=64;break}return e.next=51,this.parseObject(t,r);case 51:return h=e.sent,c=h.key,f=h.value,n[c]=f,e.next=57,t.peekUint24();case 57:if(e.t6=e.sent,e.t7=16777215&e.t6,9!==e.t7){e.next=62;break}return t.skip(3),e.abrupt("break",64);case 62:e.next=48;break;case 64:return e.abrupt("break",98);case 65:return n=null,e.abrupt("break",98);case 67:return n=[],e.next=70,t.readUint32();case 70:d=e.sent,l=0;case 72:if(!(l<d)){e.next=81;break}return e.t8=n,e.next=76,this.parseValue(t,r);case 76:e.t9=e.sent,e.t8.push.call(e.t8,e.t9);case 78:l++,e.next=72;break;case 81:return e.abrupt("break",98);case 82:return e.next=84,t.readDouble();case 84:return p=e.sent,e.next=87,t.readInt16();case 87:return g=e.sent,n=new Date(p+60*g*1e3),e.abrupt("break",98);case 90:return e.t10=t,e.next=93,t.readUint32();case 93:return e.t11=e.sent,e.next=96,e.t10.readString.call(e.t10,e.t11);case 96:return n=e.sent,e.abrupt("break",98);case 98:return e.abrupt("return",n);case 99:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"read",value:(t=(0,i.A)(u().mark((function e(t,r){var i,n,a,s,o,h;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.getPos(),n=i+BigInt(Math.floor(r)),e.next=4,this.parseValue(t,n);case 4:return a=e.sent,e.next=7,this.parseValue(t,n);case 7:return s=e.sent,this[a]=s,o=Number(t.getPos()-i),e.next=12,t.readUint32();case 12:if(h=e.sent,o+11===h){e.next=16;break}return p.R8("script size not match, size: ".concat(o+11,", previousTagSize: ").concat(h),"src/avformat/formats/flv/FlvScriptTag.ts",150),e.abrupt("return",v.LR);case 16:return e.abrupt("return",0);case 17:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"writeValue",value:function(e,t){var r=this;c.ai(t)?(e.writeUint8(0),e.writeDouble(t)):c.o(t)?(e.writeUint8(0),e.writeDouble(Number(t))):c.zM(t)?(e.writeUint8(1),e.writeUint8(t?1:0)):c.Yj(t)?t.length>=65536?(e.writeUint8(12),e.writeUint32(t.length),e.writeString(t)):(e.writeUint8(2),e.writeUint16(t.length),e.writeString(t)):c.YO(t)?(e.writeUint8(10),e.writeUint32(t.length),f.__(t,(function(t){r.writeValue(e,t)}))):c.Ik(t)?(e.writeUint8(3),d.__(t,(function(t,i){e.writeUint16(i.length),e.writeString(i),r.writeValue(e,t)})),e.writeUint24(9)):t instanceof Date&&(e.writeUint8(11),e.writeDouble(t.getTime()),e.writeInt16(0))}},{key:"computeSize",value:function(){var e=[],t=new h.A;return t.onFlush=function(t){return e.push(t.slice()),0},this.writeValue(t,"onMetaData"),this.writeValue(t,this.onMetaData),t.flush(),(0,l.A)(Uint8Array,e).length}},{key:"write",value:function(e){if(this.onMetaData){var t=[],r=new h.A;r.onFlush=function(e){return t.push(e.slice()),0},this.writeValue(r,"onMetaData"),this.writeValue(r,this.onMetaData),r.flush();var i=(0,l.A)(Uint8Array,t),n=e.getPos();g.xk(e,18,i.length,BigInt(0)),e.writeBuffer(i),e.writeUint32(Number(e.getPos()-n))}}},{key:"dts2Position",value:function(e){if(this.canSeek()){var t,r=-1,i=this.onMetaData.keyframes.times,n=this.onMetaData.keyframes.filepositions;for(t=0;t<i.length;t++){if(i[t]===e){r=t;break}if(i[t]>e){r=Math.max(t-1,0);break}}return t&&t===i.length&&(r=i.length-1),{pos:n[r],dts:i[r]}}return{pos:-1,dts:-1}}},{key:"position2DTS",value:function(e){if(this.canSeek()){var t,r=-1,i=this.onMetaData.keyframes.times,n=this.onMetaData.keyframes.filepositions,a=0;for(a=0;a<n.length;a++)if(n[a]>e){r=a;break}return a===n.length?null!==(t=this.onMetaData.duration)&&void 0!==t?t:i[i.length-1]:i[r]}return-1}},{key:"canSeek",value:function(){return!!(this.onMetaData.keyframes&&this.onMetaData.keyframes.filepositions&&this.onMetaData.keyframes.filepositions.length)}}]),e}()},35028:(e,t,r)=>{"use strict";r.d(t,{FJ:()=>n,U5:()=>a});var i=r(134),n=((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({},86018,10),86017,2),86051,11),27,7),173,12),12,9),{10:86018,2:86017,11:86051}),a={7:27,12:173,9:12};(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({},86018,1),86017,1),86051,1),27,4),173,4),12,4)},94889:(e,t,r)=>{"use strict";function i(e,t,r,i){e.writeUint8(t),e.writeUint24(r),e.writeUint24(Number(i&BigInt(16777215))),e.writeUint8(Number(i>>BigInt(24)&BigInt(255))),e.writeUint24(0)}r.d(t,{xk:()=>i})},2187:(e,t,r)=>{"use strict";r.d(t,{d:()=>s});var i=r(72739),n=r(44328),a=r(77231);function s(e,t,r){var s=BigInt(0);return i.__(e,(function(e){s+=e.codecpar.bitRate*(0,n.k)(t,r,a.i0)/BigInt(8e3)})),s}},65977:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var i=r(4624),n="src/avformat/function/mktag.ts";function a(e){4!==e.length&&i.R8("tag length is not 4, tag: ".concat(e),n,30);for(var t=0,r=0;r<4;r++)t=t<<8|e.charCodeAt(r);return t}},52071:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var i=r(25182),n=r(36443),a=r.n(n),s=r(63939),o=r(9599),u=r(29170),h=r(77231),c=r(44328),f=r(2187),d=r(71517),l=r(9705),p=r(4624),g="src/avformat/function/seekInBytes.ts";function v(e,t,r,i,n,a){return b.apply(this,arguments)}function b(){return(b=(0,i.A)(a().mark((function e(t,r,i,n,v,b){var k,x,U,w,y,m,A,I,B,R,M,P,D,S;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k=t.ioReader.getPos(),e.next=3,t.ioReader.fileSize();case 3:if(x=e.sent,U=h.Dh,w=i,r.startTime!==h.Dh?w-=r.startTime:w-=r.firstDTS,!((y=(0,c.k)(i,r.timeBase,h.i0))<BigInt(1e4))){e.next=13;break}return p.Yz("seek pts is earlier then 10s, seek to first packet pos(".concat(n,") directly"),g,63),e.next=12,t.ioReader.seek(n);case 12:return e.abrupt("return",k);case 13:if(m=(0,f.d)(t.streams,w,r.timeBase),A=x-(0,f.d)(t.streams,BigInt(5e3),h.i0),I=(0,f.d)(t.streams,BigInt(1e4),h.i0),m>A&&(m=A),!(m<n)){e.next=21;break}return e.next=20,t.ioReader.seek(n);case 20:return e.abrupt("return",k);case 21:B=(0,d._5)(),R=x,M=BigInt(0);case 24:if(!(R-M<I)){e.next=28;break}return U=M,e.abrupt("break",51);case 28:return e.next=30,t.ioReader.seek(m);case 30:return e.next=32,b(t);case 32:return P=t.ioReader.getPos(),e.next=35,v(t,B);case 35:if(!(e.sent>=0)){e.next=48;break}if(D=(0,c.k)(s.f[17](B+8),(0,u.A)(B+72,o.P),h.i0),S=D-y,p.Yz("try to seek to pos: ".concat(m,", got packet pts: ").concat(s.f[17](B+8),"(").concat(D,"ms), diff: ").concat(S,"ms"),g,98),!(S<=BigInt(0)&&-S<BigInt(1e4))){e.next=45;break}return U=P,e.abrupt("break",51);case 45:m=S>BigInt(0)?M+(R=m)>>BigInt(1):(M=m)+R>>BigInt(1);case 46:e.next=49;break;case 48:return e.abrupt("break",51);case 49:e.next=24;break;case 51:if((0,d.Qe)(B),U===h.Dh){e.next=61;break}return p.Yz("finally seek to pos ".concat(U),g,124),e.next=56,t.ioReader.seek(U);case 56:return e.next=58,b(t);case 58:return e.abrupt("return",k);case 61:return e.next=63,t.ioReader.seek(k);case 63:return e.abrupt("return",BigInt(l.E$));case 64:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},null:()=>{},23991:(e,t,r)=>{"use strict";function i(e){for(var t=0;t<32&&0===e.readU1();)t++;return e.readU(t)+((1<<t)-1)}function n(e){var t=i(e);return 1&t?(t+1)/2:-t/2}r.d(t,{$x:()=>n,xb:()=>i})},60264:(e,t,r)=>{"use strict";function i(e){return e.length>4&&0===e[0]&&0===e[1]&&(1===e[2]||0===e[2]&&1===e[3])}function n(e,t){for(var r=0,i=t;i<e.length;i++)switch(e[i]){case 0:r++;break;case 1:if(r>=2)return{offset:i-Math.min(r,3),startCode:Math.min(r+1,4)};r=0;break;default:r=0}return{offset:-1,startCode:0}}function a(e){for(var t=[],r=n(e,0),i={offset:-1,startCode:0};(i=n(e,r.offset+r.startCode)).offset>-1;)t.push(e.subarray(r.offset+r.startCode,i.offset,!0)),r=i;return t.push(e.subarray(r.offset+r.startCode,void 0,!0)),t}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;r||(r=e.length);for(var i=new Uint8Array(e.length),n=0,a=0,s=0;s<e.length;s++){if(s>=t&&s<r)if(0===e[s])n++;else if(3===e[s]&&2===n&&s+1<e.length&&e[s+1]<=3){if(++s===e.length)break;n=0===e[s]?1:0}else n=0;i[a++]=e[s]}return i.slice(0,a)}r.d(t,{BN:()=>s,Bs:()=>i,py:()=>a})},37246:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var i=r(78716),n=r(81570),a=r(134),s=r(4624),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1048576;(0,i.A)(this,e),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"pointer",void 0),(0,a.A)(this,"bitsLeft",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"endPointer",void 0),(0,a.A)(this,"error",void 0),(0,a.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.size=t,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}return(0,n.A)(e,[{key:"peekU1",value:function(){(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();var e=this.pointer,t=this.bitsLeft;return 0===t&&(e++,t=8),this.buffer[e]>>t-1&1}},{key:"readU1",value:function(){var e;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,e=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8),e}},{key:"readU",value:function(e){for(var t=0,r=0;r<e;r++)t|=this.readU1()<<e-r-1;return t}},{key:"remainingLength",value:function(){return this.endPointer-this.pointer}},{key:"flush",value:function(){if(!this.onFlush)throw this.error=-1048574,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&this.pointer++,!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);var e=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(e<0)throw this.error=e,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+e,this.pointer=0}else{var t=this.onFlush(this.buffer);if(this.endPointer=t,this.pointer=0,this.bitsLeft=8,t<0)throw this.error=t,Error("IOReader error, flush failed")}}},{key:"getBuffer",value:function(){return this.buffer}},{key:"appendBuffer",value:function(e){if(this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else{var t=Math.min(this.size-this.endPointer,e.length);this.buffer.set(e.subarray(0,t),this.endPointer),this.endPointer+=t,s.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src/common/io/BitReader.ts",170)}}},{key:"clear",value:function(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0}},{key:"skipPadding",value:function(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++)}}]),e}()},729:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var i=r(78716),n=r(81570),a=r(134),s=r(4624),o=r(50011),u=function(){function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,i.A)(this,e),(0,a.A)(this,"data",void 0),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"byteStart",void 0),(0,a.A)(this,"pos",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"littleEndian",void 0),this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!r}return(0,n.A)(e,[{key:"writeUint8",value:function(e){this.data.setUint8(this.pos+++this.byteStart,e)}},{key:"writeUint16",value:function(e){this.data.setUint16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}},{key:"writeUint24",value:function(e){var t=3840&e,r=240&e,i=15&e;this.littleEndian?(this.writeUint8(i),this.writeUint8(r),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(r),this.writeUint8(i))}},{key:"writeUint32",value:function(e){this.data.setUint32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}},{key:"writeUint64",value:function(e){var t=e&BigInt(4294967295),r=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeUint32(Number(t)),this.writeUint32(Number(r))):(this.writeUint32(Number(r)),this.writeUint32(Number(t)))}},{key:"writeInt8",value:function(e){this.data.setInt8(this.pos+++this.byteStart,e)}},{key:"writeInt16",value:function(e){this.data.setInt16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}},{key:"writeInt32",value:function(e){this.data.setInt32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}},{key:"writeInt64",value:function(e){var t=e&BigInt(4294967295),r=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeInt32(Number(t)),this.writeInt32(Number(r))):(this.writeInt32(Number(r)),this.writeInt32(Number(t)))}},{key:"writeFloat",value:function(e){this.data.setFloat32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}},{key:"writeDouble",value:function(e){this.data.setFloat64(this.pos+this.byteStart,e,this.littleEndian),this.pos+=8}},{key:"getPos",value:function(){return this.pos}},{key:"seek",value:function(e){e>this.size&&(e=this.size),this.pos=Math.max(0,e)}},{key:"skip",value:function(e){this.seek(this.pos+e)}},{key:"back",value:function(e){this.seek(this.pos-e)}},{key:"remainingSize",value:function(){return this.size-this.pos}},{key:"writeBuffer",value:function(e){var t=e.length;this.remainingSize()<t&&(t=this.remainingSize(),s.R8("the remaining buffer size is smaller then the wrote buffer, hope set ".concat(e.length,", but set ").concat(t),"src/common/io/BufferWriter.ts",211)),this.buffer.set(e,this.pos),this.pos+=e.length}},{key:"writeString",value:function(e){var t=o.l(e);return this.writeBuffer(t),t.length}},{key:"getWroteBuffer",value:function(){return this.buffer.subarray(0,this.pos)}},{key:"resetBuffer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}}]),e}()},35336:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var i=r(78716),n=r(81570),a=r(134),s=r(50011),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1048576,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;(0,i.A)(this,e),(0,a.A)(this,"data",void 0),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"pointer",void 0),(0,a.A)(this,"pos",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"littleEndian",void 0),(0,a.A)(this,"error",void 0),(0,a.A)(this,"onFlush",void 0),(0,a.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=t,this.littleEndian=!r,this.error=0,n?(this.buffer=n,this.data=n.view):(this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer))}return(0,n.A)(e,[{key:"writeUint8",value:function(e){this.remainingLength()<1&&this.flush(),this.data.setUint8(this.pointer,e),this.pointer++,this.pos++}},{key:"writeUint16",value:function(e){this.remainingLength()<2&&this.flush(),this.data.setUint16(this.pointer,e,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}},{key:"writeUint24",value:function(e){this.remainingLength()<3&&this.flush();var t=(16711680&e)>>16,r=(65280&e)>>8,i=255&e;this.littleEndian?(this.writeUint8(i),this.writeUint8(r),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(r),this.writeUint8(i))}},{key:"writeUint32",value:function(e){this.remainingLength()<4&&this.flush(),this.data.setUint32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}},{key:"writeUint64",value:function(e){this.remainingLength()<8&&this.flush(),this.data.setBigUint64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}},{key:"writeInt8",value:function(e){this.remainingLength()<1&&this.flush(),this.data.setInt8(this.pointer,e),this.pointer++,this.pos++}},{key:"writeInt16",value:function(e){this.remainingLength()<2&&this.flush(),this.data.setInt16(this.pointer,e,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}},{key:"writeInt32",value:function(e){this.remainingLength()<4&&this.flush(),this.data.setInt32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}},{key:"writeInt64",value:function(e){this.remainingLength()<8&&this.flush(),this.data.setBigInt64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}},{key:"writeFloat",value:function(e){this.remainingLength()<4&&this.flush(),this.data.setFloat32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}},{key:"writeDouble",value:function(e){this.remainingLength()<8&&this.flush(),this.data.setFloat64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}},{key:"getPointer",value:function(){return this.pointer}},{key:"getPos",value:function(){return this.pos}},{key:"remainingLength",value:function(){return this.size-this.pointer}},{key:"writeBuffer",value:function(e){if(e.length){var t=e.length;if(this.remainingLength()<t)for(var r=0;t>0;){this.flush();var i=Math.min(this.size,t);this.buffer.set(e.subarray(r,r+i),this.pointer),this.pointer+=i,this.pos+=BigInt(i),r+=i,t-=i}else this.buffer.set(e,this.pointer),this.pointer+=t,this.pos+=BigInt(t)}}},{key:"writeString",value:function(e){var t=s.l(e);return this.writeBuffer(t),t.length}},{key:"encodeString",value:function(e){return s.l(e)}},{key:"flush",value:function(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){var e=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}},{key:"flushToPos",value:function(e){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){var t=this.onFlush(this.buffer.subarray(0,this.pointer),e);if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}},{key:"seek",value:function(e){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");this.flush();var t=this.onSeek(e);if(0!==t)throw this.error=t,Error("IOWriter error, seek failed");this.pos=e}},{key:"seekInline",value:function(e){var t=this.pointer;this.pointer=Math.max(0,Math.min(this.size,e)),this.pos+=BigInt(this.pointer-t)}},{key:"skip",value:function(e){var t=this.pointer;this.pointer=Math.min(this.size,this.pointer+e),this.pos+=BigInt(this.pointer-t)}},{key:"back",value:function(e){var t=this.pointer;this.pointer=Math.max(0,this.pointer-e),this.pos+=BigInt(this.pointer-t)}},{key:"getBuffer",value:function(){return this.buffer.subarray(0,this.pointer)}},{key:"setEndian",value:function(e){this.littleEndian=!e}},{key:"reset",value:function(){this.pointer=0,this.pos=BigInt(0),this.error=0}},{key:"getBufferSize",value:function(){return this.size}}]),e}()},803:(e,t,r)=>{var i=r(16560),n=r(54220);function a(t){return e.exports=a="function"==typeof i&&"symbol"==typeof n?function(e){return typeof e}:function(e){return e&&"function"==typeof i&&e.constructor===i&&e!==i.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,a(t)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports}}]);