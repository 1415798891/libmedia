(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[905],{64436:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var a=r(78716),i=r(81570),n=r(134),s=r(63939),o=r(37837),c=r(71766),u=function(){function e(){(0,a.A)(this,e),(0,n.A)(this,"inCodecpar",void 0),(0,n.A)(this,"inTimeBase",void 0),(0,n.A)(this,"outCodecpar",void 0)}return(0,i.A)(e,[{key:"init",value:function(e,t){return this.inCodecpar=(0,o.Gy)(184),(0,c.Yi)(this.inCodecpar,e),this.inTimeBase={den:s.f[15](t+4),num:s.f[15](t)},0}},{key:"destroy",value:function(){this.inCodecpar&&((0,c.dn)(this.inCodecpar),this.inCodecpar=0)}}]),e}()},50848:(e,t,r)=>{"use strict";r.d(t,{A:()=>M});var a=r(88435),i=r.n(a),n=r(78716),s=r(81570),o=r(77193),c=r(43070),u=r(60394),d=r(25767),h=r(31060),f=r(134),p=r(63939),l=r(50932),v=r(77162),g=r(29170),b=r(64436),A=r(14686),m=r(4624),x=r(9705),y=r(77231),k=r(58469),U=r(44328),w=r(37837),P=r(71517);function I(e,t,r){return t=(0,d.A)(t),(0,o.A)(e,R()?i()(t,r||[],(0,d.A)(e).constructor):t.apply(e,r))}function R(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(R=function(){return!!e})()}var M=function(e){function t(){var e;(0,n.A)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=I(this,t,[].concat(a)),(0,f.A)((0,c.A)(e),"streamMuxConfig",void 0),(0,f.A)((0,c.A)(e),"caches",void 0),e}return(0,h.A)(t,e),(0,s.A)(t,[{key:"init",value:function(e,r){return(0,u.A)((0,d.A)(t.prototype),"init",this).call(this,e,r),this.caches=[],this.streamMuxConfig={profile:y.N_,sampleRate:y.N_,channels:y.N_},0}},{key:"sendAVPacket",value:function(e){for(var t=0,r=p.f[17](e+16)||p.f[17](e+8),a=(0,A.s3)(p.f[20](e+24),p.f[15](e+28)).slice();t<a.length;){var i=a[t]<<4|a[t+1]>>4;if(4095!==i)return m.z3("found syncWord not 0xFFF, got: 0x".concat(i.toString(16)),"src/avformat/bsf/aac/ADTS2RawFilter.ts",103),x.LR;var n=1&a[t+1],s=(192&a[t+2])>>>6,o=(60&a[t+2])>>>2,c=(1&a[t+2])<<2|(192&a[t+3])>>>6,u=(3&a[t+3])<<11|a[t+4]<<3|(224&a[t+5])>>>5,d=3&a[6],h=1===n?7:9,f=u-h,b={dts:r,buffer:null,extradata:null,duration:y.N_};b.buffer=a.subarray(t+h,t+h+f),this.streamMuxConfig.profile=s+1,this.streamMuxConfig.sampleRate=k.hY[o],this.streamMuxConfig.channels=k.En[c];var P=p.f[15](this.inCodecpar+40)!==this.streamMuxConfig.profile||p.f[15](this.inCodecpar+108)!==this.streamMuxConfig.sampleRate||p.f[15](this.inCodecpar+140)!==this.streamMuxConfig.channels,I=(0,U.k)(BigInt(Math.floor(1024*(d+1)/this.streamMuxConfig.sampleRate*y.SF)),y.KR,this.inTimeBase);if(b.duration=Number(I),P){l.M[15](this.inCodecpar+40,this.streamMuxConfig.profile),l.M[15](this.inCodecpar+108,this.streamMuxConfig.sampleRate),l.M[15](this.inCodecpar+140,this.streamMuxConfig.channels),l.M[15](this.inCodecpar+104,this.streamMuxConfig.channels);var R=(0,k.Ij)((0,g.A)(this.inCodecpar,v.A));p.f[20](this.inCodecpar+12)&&(0,w.Eb)(p.f[20](this.inCodecpar+12)),l.M[20](this.inCodecpar+12,(0,w.sY)(R.length)),(0,A.lW)(p.f[20](this.inCodecpar+12),R.length,R),l.M[15](this.inCodecpar+16,R.length),b.extradata=R}this.caches.push(b),t+=u,r+=I}}},{key:"receiveAVPacket",value:function(e){if(this.caches.length){(0,P.Up)(e);var t=this.caches.shift(),r=(0,w.sY)(t.buffer.length);if((0,A.lW)(r,t.buffer.length,t.buffer),(0,P.NX)(e,r,t.buffer.length),l.M[17](e+16,t.dts),l.M[17](e+8,t.dts),l.M[17](e+48,BigInt(Math.floor(t.duration))),l.M[15](e+36,1|p.f[15](e+36)),t.extradata){var a=(0,w.sY)(t.extradata.length);(0,A.lW)(a,t.extradata.length,t.extradata),(0,P.Ow)(e,1,a,t.extradata.length)}return 0}return x.LR}}]),t}(b.A)},36488:(e,t,r)=>{"use strict";r.d(t,{A:()=>C});var a=r(88435),i=r.n(a),n=r(78716),s=r(81570),o=r(77193),c=r(43070),u=r(60394),d=r(25767),h=r(31060),f=r(134),p=r(63939),l=r(50932),v=r(77162),g=r(29170),b=r(64436),A=r(14686),m=r(4624),x=r(9705),y=r(77231),k=r(58469),U=r(44328),w=r(37837),P=r(71517),I=r(37246);function R(e,t,r){return t=(0,d.A)(t),(0,o.A)(e,M()?i()(t,r||[],(0,d.A)(e).constructor):t.apply(e,r))}function M(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(M=function(){return!!e})()}var S="src/avformat/bsf/aac/LATM2RawFilter.ts",C=function(e){function t(){var e;(0,n.A)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=R(this,t,[].concat(a)),(0,f.A)((0,c.A)(e),"bitReader",void 0),(0,f.A)((0,c.A)(e),"streamMuxConfig",void 0),(0,f.A)((0,c.A)(e),"caches",void 0),(0,f.A)((0,c.A)(e),"refSampleDuration",void 0),e}return(0,h.A)(t,e),(0,s.A)(t,[{key:"init",value:function(e,r){return(0,u.A)((0,d.A)(t.prototype),"init",this).call(this,e,r),this.caches=[],this.refSampleDuration=BigInt(0),this.bitReader=new I.A,this.streamMuxConfig={profile:y.N_,sampleRate:y.N_,channels:y.N_},0}},{key:"getLATMValue",value:function(){for(var e=this.bitReader.readU(2),t=0,r=0;r<=e;r++)t<<=8,t|=this.bitReader.readU(8);return t}},{key:"sendAVPacket",value:function(e){var t=(0,A.s3)(p.f[20](e+24),p.f[15](e+28));this.bitReader.clear(),this.bitReader.appendBuffer(t);for(var r=p.f[17](e+16)||p.f[17](e+8);this.bitReader.remainingLength()>3;){var a=this.bitReader.readU(11);if(695!==a)return m.z3("AACLATMParser found syncWord not 0x2B7, got: 0x".concat(a.toString(16)),S,103),this.bitReader.clear(),x.LR;if(this.bitReader.readU(13)>this.bitReader.remainingLength())break;if(1!==this.bitReader.readU1()){var i=1===this.bitReader.readU1();if(i&&1===this.bitReader.readU1())return m.z3("audioMuxVersionA is Not Supported",S,119),this.bitReader.clear(),x.LR;if(i&&this.getLATMValue(),1!==this.bitReader.readU1())return m.z3("allStreamsSameTimeFraming zero is Not Supported",S,128),this.bitReader.clear(),x.LR;if(0!==this.bitReader.readU(6))return m.z3("more than 2 numSubFrames Not Supported",S,134),this.bitReader.clear(),x.LR;if(0!==this.bitReader.readU(4))return m.z3("more than 2 numProgram Not Supported",S,141),this.bitReader.clear(),x.LR;if(0!==this.bitReader.readU(3))return m.z3("more than 2 numLayer Not Supported'",S,148),this.bitReader.clear(),x.LR;var n=i?this.getLATMValue():0,s=this.bitReader.readU(5);n-=5;var o=this.bitReader.readU(4);n-=4;var c=this.bitReader.readU(4);n-=4,this.bitReader.readU(3),(n-=3)>0&&this.bitReader.readU(n);var u=this.bitReader.readU(3);if(0!==u)return m.z3("frameLengthType = ".concat(u,", only frameLengthType = 0 supported"),S,176),this.bitReader.clear(),x.LR;if(this.bitReader.readU(8),1===this.bitReader.readU1())if(i)this.getLATMValue();else for(;;){var d=1===this.bitReader.readU1();if(this.bitReader.readU(8),!d)break}1===this.bitReader.readU1()&&this.bitReader.readU(8),this.streamMuxConfig.profile=s+1,this.streamMuxConfig.sampleRate=k.hY[o],this.streamMuxConfig.channels=k.En[c]}for(var h=0;;){var f=this.bitReader.readU(8);if(h+=f,255!==f)break}for(var b=new Uint8Array(h),P=0;P<h;P++)b[P]=this.bitReader.readU(8);var I={dts:r,buffer:b,extradata:null};if(p.f[15](this.inCodecpar+40)!==this.streamMuxConfig.profile||p.f[15](this.inCodecpar+108)!==this.streamMuxConfig.sampleRate||p.f[15](this.inCodecpar+140)!==this.streamMuxConfig.channels){this.refSampleDuration=(0,U.k)(BigInt(Math.floor(1024/this.streamMuxConfig.sampleRate*y.SF)),y.KR,this.inTimeBase),l.M[15](this.inCodecpar+40,this.streamMuxConfig.profile),l.M[15](this.inCodecpar+108,this.streamMuxConfig.sampleRate),l.M[15](this.inCodecpar+140,this.streamMuxConfig.channels),l.M[15](this.inCodecpar+104,this.streamMuxConfig.channels);var R=(0,k.Ij)((0,g.A)(this.inCodecpar,v.A));p.f[20](this.inCodecpar+12)&&(0,w.Eb)(p.f[20](this.inCodecpar+12)),l.M[20](this.inCodecpar+12,(0,w.sY)(R.length)),(0,A.lW)(p.f[20](this.inCodecpar+12),R.length,R),l.M[15](this.inCodecpar+16,R.length),I.extradata=R}this.caches.push(I),r+=this.refSampleDuration,this.bitReader.skipPadding()}}},{key:"receiveAVPacket",value:function(e){if(this.caches.length){(0,P.Up)(e);var t=this.caches.shift(),r=(0,w.sY)(t.buffer.length);if((0,A.lW)(r,t.buffer.length,t.buffer),(0,P.NX)(e,r,t.buffer.length),l.M[17](e+16,t.dts),l.M[17](e+8,t.dts),l.M[15](e+36,1|p.f[15](e+36)),t.extradata){var a=(0,w.sY)(t.extradata.length);(0,A.lW)(a,t.extradata.length,t.extradata),(0,P.Ow)(e,1,a,t.extradata.length)}return 0}return x.LR}}]),t}(b.A)},61702:(e,t,r)=>{"use strict";r.d(t,{A:()=>I});var a=r(88435),i=r.n(a),n=r(78716),s=r(81570),o=r(77193),c=r(43070),u=r(60394),d=r(25767),h=r(31060),f=r(134),p=r(63939),l=r(50932),v=r(64436),g=r(77231),b=r(44328),A=r(65451),m=r(4624),x=r(9705),y=r(71517),k=r(37837),U=r(14686);function w(e,t,r){return t=(0,d.A)(t),(0,o.A)(e,P()?i()(t,r||[],(0,d.A)(e).constructor):t.apply(e,r))}function P(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(P=function(){return!!e})()}var I=function(e){function t(){var e;(0,n.A)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=w(this,t,[].concat(a)),(0,f.A)((0,c.A)(e),"caches",void 0),e}return(0,h.A)(t,e),(0,s.A)(t,[{key:"init",value:function(e,r){return(0,u.A)((0,d.A)(t.prototype),"init",this).call(this,e,r),this.caches=[],0}},{key:"sendAVPacket",value:function(e){for(var t=0,r=p.f[17](e+16)||p.f[17](e+8),a=(0,y.iI)(e);t<a.length;){var i=a[t]<<3|a[t+1]>>5;if(1023!==i)return m.z3("MpegtsOpusParser found syncWord not 0x3ff, got: 0x".concat(i.toString(16)),"src/avformat/bsf/opus/Mpegts2RawFilter.ts",67),x.LR;for(var n=!!(16&a[t+1]),s=!!(8&a[t+1]),o=t+2,c=0;255===a[o];)c+=255,o++;c+=a[o],o++,o+=n?2:0,o+=s?2:0;var u=a.subarray(o,o+c),d=p.f[15](this.inCodecpar+108)>0?p.f[15](this.inCodecpar+108):48e3,h=(0,b.k)(BigInt(Math.floor(A.kt(u)/d*g.SF)),g.KR,this.inTimeBase);this.caches.push({dts:r,buffer:u.slice(),duration:Number(h)}),r+=h,t=o+c}}},{key:"receiveAVPacket",value:function(e){if(this.caches.length){(0,y.Up)(e);var t=this.caches.shift(),r=(0,k.sY)(t.buffer.length);return(0,U.lW)(r,t.buffer.length,t.buffer),(0,y.NX)(e,r,t.buffer.length),l.M[17](e+16,t.dts),l.M[17](e+8,t.dts),l.M[15](e+36,1|p.f[15](e+36)),l.M[17](e+48,BigInt(Math.floor(t.duration))),0}return x.LR}}]),t}(v.A)},58469:(e,t,r)=>{"use strict";r.d(t,{En:()=>s,Ij:()=>c,XC:()=>o,hY:()=>n});var a=r(77231),i={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,a.N_,a.N_,a.N_],s=[a.N_,1,2,3,4,5,6,7];function o(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){var r=function(e){var t,r,i=a.N_,o=a.N_,c=a.N_;return e.length>=2&&(i=e[0]>>3&31,o=null!==(t=n[(7&e[0])<<1|e[1]>>7])&&void 0!==t?t:48e3,c=null!==(r=s[e[1]>>3&15])&&void 0!==r?r:2),{profile:i,sampleRate:o,channels:c}}(t),i=r.profile,o=r.sampleRate,c=r.channels;e.codecpar.profile=i,e.codecpar.sampleRate=o,e.codecpar.chLayout.nbChannels=c,e.codecpar.channels=c}}function c(e){var t=i[e.sampleRate],r=e.chLayout.nbChannels,a=new Uint8Array(2);return a[0]=(31&e.profile)<<3|(14&t)>>1,a[1]=(1&t)<<7|(15&r)<<3,a}},20620:(e,t,r)=>{"use strict";r.d(t,{Jk:()=>A,XC:()=>x,ci:()=>m,oT:()=>b});var a=r(63939),i=r(72739),n=r(729),s=r(31865),o=r(37246),c=r(4624),u=r(14686),d=r(71517),h=r(60264),f=r(37837),p=r(23991),l="src/avformat/codecs/h264.ts",v=3;function g(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e.length>32&&(c.R8("h264 metadata's sps max length is 32, but get ".concat(e.length),l,159),e=e.slice(0,32)),e.length>256&&(c.R8("h264 metadata's pps max length is 256, but get ".concat(e.length),l,163),e=e.slice(0,256));var a=7;a=e.reduce((function(e,t){return e+2+t.length}),a),a=t.reduce((function(e,t){return e+2+t.length}),a);var s=e[0],o=y(s);66!==o.profile&&77!==o.profile&&88!==o.profile&&(a+=4,r.length&&(a=r.reduce((function(e,t){return e+2+t.length}),a)));var u=new Uint8Array(a),d=new n.A(u);return d.writeUint8(1),d.writeUint8(s[1]),d.writeUint8(s[2]),d.writeUint8(s[3]),d.writeUint8(252|v),d.writeUint8(224|31&e.length),i.__(e,(function(e){d.writeUint16(e.length),d.writeBuffer(e)})),d.writeUint8(t.length),i.__(t,(function(e){d.writeUint16(e.length),d.writeBuffer(e)})),66!==o.profile&&77!==o.profile&&88!==o.profile&&(d.writeUint8(252|o.chromaFormatIdc),d.writeUint8(248|o.bitDepthLumaMinus8),d.writeUint8(248|o.bitDepthChromaMinus8),r.length&&i.__(r,(function(e){d.writeUint16(e.length),d.writeBuffer(e)}))),u}function b(e){var t,r=(0,h.py)(e),a=!1;if(r.length>1){var s=[],o=[],c=[];r.forEach((function(e){var t=31&e[0];7===t?s.push(e):8===t?o.push(e):13===t&&c.push(e)})),s.length&&o.length&&(t=g(s,o,c)),r=r.filter((function(e){var t=31&e[0];return 9!==t&&8!==t&&7!==t&&13!==t}))}var d=r.reduce((function(e,t){return e+v+1+t.length}),0),p=(0,f.sY)(d),l=(0,u.s3)(p,d),b=new n.A(l);return i.__(r,(function(e){3===v?b.writeUint32(e.length):2===v?b.writeUint24(e.length):1===v?b.writeUint16(e.length):b.writeUint8(e.length),b.writeBuffer(e.subarray(0)),5==(31&e[0])&&(a=!0)})),{bufferPointer:p,length:d,key:a,extradata:t}}function A(e,t){var r;if(1&a.f[15](e+36)){var i=(0,d.iI)(e);if(!(0,h.Bs)(i)){for(var n=null!==(r=t.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:v,o=[],c=[],p=[],l=[],b=new s.A(i);b.remainingSize()>0;){var A;A=3===n?b.readUint32():2===n?b.readUint24():1===n?b.readUint16():b.readUint8();var m=i.subarray(0|Number(0xffffffffn&b.getPos()),(0|Number(0xffffffffn&b.getPos()))+A);b.skip(A);var x=31&m[0];7===x?o.push(m):8===x?c.push(m):13===x?p.push(m):l.push(m)}if(o.length||c.length){var y=g(o,c,p),k=(0,f.sY)(y.length);(0,u.lW)(k,y.length,y),(0,d.Ow)(e,1,k,y.length)}}}}function m(e){if(1&a.f[15](e+36)){var t=(0,d.iI)(e);if((0,h.Bs)(t)){var r=(0,h.py)(t);if(r.length>1){var i=[],n=[],s=[];if(r.forEach((function(e){var t=31&e[0];7===t?i.push(e):8===t?n.push(e):13===t&&s.push(e)})),i.length&&n.length){var o=g(i,n,s),c=(0,f.sY)(o.length);(0,u.lW)(c,o.length,o),(0,d.Ow)(e,1,c,o.length)}}}}}function x(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[4];var r=function(e){var t=new s.A(e);t.skip(5);for(var r=[],a=[],i=[],n=31&t.readUint8(),o=0;o<n;o++){var c=t.readUint16();r.push(t.readBuffer(c))}for(var u=t.readUint8(),d=0;d<u;d++){var h=t.readUint16();a.push(t.readBuffer(h))}if(t.remainingSize()>4){t.skip(3);var f=t.readUint8();if(f>0)for(var p=0;p<f;p++){var l=t.readUint16();i.push(t.readBuffer(l))}}return{spss:r,ppss:a,spsExts:i}}(t).spss;if(r.length){var a=y(r[0]),i=a.profile,n=a.level,o=a.width,c=a.height;e.codecpar.profile=i,e.codecpar.level=n,e.codecpar.width=o,e.codecpar.height=c}}}function y(e){if(e&&!(e.length<3)){var t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);var r=(0,h.BN)(e.subarray(t)),a=new o.A(r.length);a.appendBuffer(r),a.readU1(),a.readU(2),a.readU(5);var i=a.readU(8);a.readU1(),a.readU1(),a.readU1(),a.readU1(),a.readU1(),a.readU1(),a.readU(2);var n=a.readU(8);p.xb(a);var s=1,c=0,u=0;if((100==i||110==i||122==i||244==i||44==i||83==i||86==i||118==i||128==i||138==i||139==i||134==i||135==i)&&(3===(s=p.xb(a))&&a.readU1(),c=p.xb(a),u=p.xb(a),a.readU1(),a.readU1()))for(var d=new Array(8),f=0;f<(3!=s?8:12);f++)d[f]=a.readU1();p.xb(a);var l=p.xb(a);if(0===l)p.xb(a);else if(1===l){a.readU1(),p.$x(a),p.$x(a);for(var v=p.xb(a),g=0;g<v;g++)p.$x(a)}p.xb(a),a.readU1();var b=p.xb(a),A=p.xb(a),m=a.readU1(),x=16*(b+1),y=(2-m)*(A+1)*16;m||a.readU1(),a.readU1();var k=a.readU1();if(k){var U=1,w=2-k;1===s?(U=2,w=2*(2-k)):2===k&&(U=2,w=2-k),x-=U*(p.xb(a)+p.xb(a)),y-=w*(p.xb(a)+p.xb(a))}return{profile:i,level:n,width:x,height:y,chromaFormatIdc:s,bitDepthLumaMinus8:c,bitDepthChromaMinus8:u}}}},53e3:(e,t,r)=>{"use strict";r.d(t,{Jk:()=>g,XC:()=>A,ci:()=>b,oT:()=>v});var a=r(63939),i=r(72739),n=r(729),s=r(31865),o=r(37246),c=r(14686),u=r(60264),d=r(71517),h=r(37837),f=r(23991),p=3;function l(e,t,r){var a=t[0],s=23;e.length&&(s+=3,s=e.reduce((function(e,t){return e+2+t.length}),s)),t.length&&(s+=3,s=t.reduce((function(e,t){return e+2+t.length}),s)),r.length&&(s+=3,s=r.reduce((function(e,t){return e+2+t.length}),s));var o=new Uint8Array(s),c=new n.A(o,!0),u=m(a);c.writeUint8(1),c.writeUint8(a[1]),c.writeUint8(a[2]),c.writeUint8(a[3]),c.writeUint8(a[4]),c.writeUint8(a[5]),c.writeUint8(a[6]),c.writeUint8(a[7]),c.writeUint8(a[8]),c.writeUint8(a[9]),c.writeUint8(a[10]),c.writeUint8(a[11]),c.writeUint8(u.level),c.writeUint8(1020),c.writeUint8(0),c.writeUint8(16320),c.writeUint8(16320|u.chromaFormatIdc),c.writeUint8(8160|u.bitDepthLumaMinus8),c.writeUint8(8160|u.bitDepthChromaMinus8),c.writeUint16(0),c.writeUint8(8|(1&a[0])<<2|p);var d=0;return e.length&&d++,t.length&&d++,r.length&&d++,c.writeUint8(d),e.length&&(c.writeUint8(160),c.writeUint16(e.length),i.__(e,(function(e){c.writeUint16(e.length),c.writeBuffer(e)}))),t.length&&(c.writeUint8(161),c.writeUint16(t.length),i.__(t,(function(e){c.writeUint16(e.length),c.writeBuffer(e)}))),r.length&&(c.writeUint8(162),c.writeUint16(r.length),i.__(r,(function(e){c.writeUint16(e.length),c.writeBuffer(e)}))),o}function v(e){var t,r=!1,a=(0,u.py)(e);if(a.length>2){var s=[],o=[],d=[];a.forEach((function(e){var t=e[0]>>>1&63;32===t?s.push(e):33===t?o.push(e):34===t&&d.push(e)})),s.length&&o.length&&d.length&&(t=l(s,o,d),a=a.filter((function(e){var t=e[0]>>>1&63;return 32!==t&&33!==t&&34!==t&&35!==t})))}var f=a.reduce((function(e,t){return e+p+1+t.length}),0),v=(0,h.sY)(f),g=(0,c.s3)(v,f),b=new n.A(g);return i.__(a,(function(e){3===p?b.writeUint32(e.length):2===p?b.writeUint24(e.length):1===p?b.writeUint16(e.length):b.writeUint8(e.length),b.writeBuffer(e.subarray(0));var t=e[0]>>>1&63;19!==t&&20!==t&&21!==t||(r=!0)})),{bufferPointer:v,length:f,extradata:t,key:r}}function g(e,t){var r;if(1&a.f[15](e+36)){var i=(0,d.iI)(e);if(!(0,u.Bs)(i)){for(var n=null!==(r=t.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:p,o=[],f=[],v=[],g=new s.A(i);g.remainingSize()>0;){var b;b=3===n?g.readUint32():2===n?g.readUint24():1===n?g.readUint16():g.readUint8();var A=i.subarray(0|Number(0xffffffffn&g.getPos()),(0|Number(0xffffffffn&g.getPos()))+b);g.skip(b);var m=A[0]>>>1&63;33===m?f.push(A):34===m?v.push(A):32===m&&o.push(A)}if(f.length||v.length||o.length){var x=l(o,f,v),y=(0,h.sY)(x.length);(0,c.lW)(y,x.length,x),(0,d.Ow)(e,1,y,x.length)}}}}function b(e){if(1&a.f[15](e+36)){var t=(0,d.iI)(e);if((0,u.Bs)(t)){var r=(0,u.py)(t);if(r.length>2){var i=[],n=[],s=[];if(r.forEach((function(e){var t=e[0]>>>1&63;32===t?i.push(e):33===t?n.push(e):34===t&&s.push(e)})),i.length&&n.length&&s.length){var o=l(i,n,s),f=(0,h.sY)(o.length);(0,c.lW)(f,o.length,o),(0,d.Ow)(e,1,f,o.length)}}}}}function A(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[21];var r=function(e){var t=new s.A(e,!0);t.skip(22);for(var r=[],a=[],i=[],n=t.readUint8(),o=0;o<n;o++){for(var c=63&t.readUint8(),u=t.readUint16(),d=[],h=0;h<u;h++){var f=t.readUint16();d.push(t.readBuffer(f))}32===c?r=d:33===c?a=d:34===c&&(i=d)}return{vpss:r,spss:a,ppss:i}}(t).spss;if(r.length){var a=m(r[0]),i=a.profile,n=a.level,o=a.width,c=a.height;e.codecpar.profile=i,e.codecpar.level=n,e.codecpar.width=o,e.codecpar.height=c}}}function m(e){if(e&&!(e.length<3)){var t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);var r=0,a=0,i=0,n=0,s=0,c=0,d=1,h=0,p=0,l=0,v=0,g=(0,u.BN)(e.subarray(t)),b=new o.A(g.length);b.appendBuffer(g),b.readU1(),b.readU(6),b.readU(6),b.readU(3),b.readU(4);var A=b.readU(3);if(b.readU1(),A<=6){h=b.readU(2),p=b.readU1(),r=b.readU(5),l=b.readU(32),v=b.readU(48),a=b.readU(8);for(var m=new Array(6),x=new Array(6),y=0;y<A;y++)m[y]=b.readU1(),x[y]=b.readU1();if(A>0)for(var k=A;k<8;k++)b.readU(2);for(var U=0;U<A;U++)m[U]&&(b.readU(2),b.readU(1),b.readU(5),b.readU(32),b.readU(1),b.readU(1),b.readU(1),b.readU(1),b.readU(44)),x[U]&&b.readU(8);f.xb(b),3===(d=f.xb(b))&&b.readU(1),i=f.xb(b),n=f.xb(b);var w=0,P=0,I=0,R=0;b.readU1()&&(w=f.xb(b),P=f.xb(b),I=f.xb(b),R=f.xb(b)),s=f.xb(b),c=f.xb(b);var M=2,S=2;0===d?M=S=0:2===d?(M=2,S=1):3===d&&(M=S=1),i-=M*(1<<s+1)*(w+P),n-=S*(1<<s+1)*(I+R)}return{profile:r,level:a,width:i,height:n,chromaFormatIdc:d,bitDepthLumaMinus8:s,bitDepthChromaMinus8:c,generalProfileSpace:h,generalTierFlag:p,generalProfileCompatibilityFlag:l,constraintFlags:v}}}},89088:(e,t,r)=>{"use strict";r.d(t,{Au:()=>A,XC:()=>m,Y2:()=>v,hG:()=>g,oz:()=>b});var a=r(77231),i=[44100,48e3,32e3,0],n=[22050,24e3,16e3,0],s=[11025,12e3,8e3,0],o=[0,1152,1152,384],c=[0,576,1152,384],u=[0,576,1152,384],d=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],h=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],f=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],p=[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],l=[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1];function v(e,t){switch(e){case 0:return s[t];case 2:return n[t];case 3:return i[t]}return a.N_}function g(e,t){switch(e){case 0:return u[t];case 2:return c[t];case 3:return o[t]}return a.N_}function b(e,t,r){switch(t){case 1:switch(e){case 0:case 2:return l[r];case 3:return f[r]}break;case 2:switch(e){case 0:case 2:return l[r];case 3:return h[r]}case 3:switch(e){case 0:case 2:return p[r];case 3:return d[r]}}return a.N_}function A(e){switch(e){case 1:return 34;case 2:return 33;case 3:return 32}return a.N_}function m(e,t){if(t&&t.length>=4){var r=t[1]>>>3&3,a=(6&t[1])>>1,i=(12&t[2])>>>2,n=3&~(t[3]>>>6)?2:1,s=A(a),o=v(r,i);e.codecpar.profile=s,e.codecpar.sampleRate=o,e.codecpar.chLayout.nbChannels=n,e.codecpar.channels=n}}},65451:(e,t,r)=>{"use strict";r.d(t,{Ij:()=>u,XC:()=>c,kt:()=>o});var a=r(31865),i=r(729),n=r(44328),s=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(e){var t,r,a=0;if(e.length<1)return 0;switch(t=e[0],r=s[t>>3],3&t){case 0:a=1;break;case 1:case 2:a=2;break;case 3:if(e.length<2)return 0;a=63&e[1]}return a*r}function c(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=19){var r=new a.A(t,!1);r.skip(9),e.codecpar.chLayout.nbChannels=r.readUint8(),e.codecpar.channels=e.codecpar.chLayout.nbChannels,e.codecpar.initialPadding=r.readUint16(),e.codecpar.sampleRate=r.readUint32(),e.codecpar.seekPreroll=Number((0,n.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function u(e){var t=new Uint8Array(19),r=new i.A(t,!1);return r.writeString("OpusHead"),r.writeUint8(1),r.writeUint8(e.chLayout.nbChannels),r.writeUint16(e.initialPadding),r.writeUint32(e.sampleRate),t}},85947:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(78716),i=r(81570),n=r(134),s=function(){function e(){(0,a.A)(this,e),(0,n.A)(this,"type",-1),(0,n.A)(this,"onStreamAdd",void 0)}return(0,i.A)(e,[{key:"destroy",value:function(e){}}]),e}()},59331:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>X});var a=r(88435),i=r.n(a),n=r(25182),s=r(78716),o=r(81570),c=r(77193),u=r(43070),d=r(60394),h=r(25767),f=r(31060),p=r(134),l=r(36443),v=r.n(l),g=r(63939),b=r(50932),A=r(4624),m=r(19770),x=r(53783),y=r(27274),k=r(39e3),U=r(9705),w=r(51660),P=r(39144),I=r(52088),R=r(6403),M=r(85947),S=r(86191),C=r(71517),B=r(77231),L=r(52071),T=r(44328),F=r(72739),z=r(89088),_=r(20620),N=r(53e3),E=r(58469),D=r(65451),V=r(37837),Y=r(14686);function O(e,t,r){return t=(0,h.A)(t),(0,c.A)(e,W()?i()(t,r||[],(0,h.A)(e).constructor):t.apply(e,r))}function W(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(W=function(){return!!e})()}var Q="src/avformat/formats/IMpegtsFormat.ts",X=function(e){function t(){var e;return(0,s.A)(this,t),e=O(this,t),(0,p.A)((0,u.A)(e),"type",2),(0,p.A)((0,u.A)(e),"context",void 0),(0,p.A)((0,u.A)(e),"firstTSPacketPos",void 0),(0,p.A)((0,u.A)(e),"cacheAVPacket",void 0),e.context=(0,m.A)(),e}var r,a,i,c,l;return(0,f.A)(t,e),(0,o.A)(t,[{key:"init",value:function(e){e.ioReader&&e.ioReader.setEndian(!0),this.cacheAVPacket=0}},{key:"destroy",value:function(e){(0,d.A)((0,h.A)(t.prototype),"destroy",this).call(this,e),this.cacheAVPacket&&((0,C.Qe)(this.cacheAVPacket),this.cacheAVPacket=0),F.__(e.streams,(function(e){var t=e.privData;t.filter&&(t.filter.destroy(),t.filter=null)}))}},{key:"readHeader",value:(l=(0,n.A)(v().mark((function e(t){var r,a,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=0,e.next=4,x.q(t.ioReader);case 4:(a=e.sent)||(a=y.ZT),this.context.tsPacketSize=a;case 7:if(this.context.hasPAT&&this.context.hasPMT){e.next=16;break}return e.next=10,x.n(t.ioReader,this.context);case 10:if((i=e.sent).payload){e.next=13;break}return e.abrupt("continue",7);case 13:0!==i.pid&&i.pid!==this.context.currentPmtPid&&134!==this.context.pmt.pid2StreamType.get(i.pid)||(0,k.A)(i,this.context),e.next=7;break;case 16:if(this.context.hasPAT&&this.context.hasPMT){e.next=20;break}return e.abrupt("return",U.LR);case 20:this.firstTSPacketPos=t.ioReader.getPos();case 21:return e.abrupt("return",r);case 24:return e.prev=24,e.t0=e.catch(0),A.z3(e.t0.message,Q,134),e.abrupt("return",t.ioReader.error);case 28:case"end":return e.stop()}}),e,this,[[0,24]])}))),function(e){return l.apply(this,arguments)})},{key:"checkExtradata",value:function(e,t){if(!t.codecpar.extradata){var r=(0,C.rU)(e,1);if(!r)return;t.codecpar.extradata=(0,V.sY)(g.f[15](r+4)),(0,Y.Mr)(t.codecpar.extradata,g.f[20](r),g.f[15](r+4)),t.codecpar.extradataSize=g.f[15](r+4),(0,C.Is)(e,1),27===t.codecpar.codecId||12===t.codecpar.codecId?_.XC(t,(0,Y.JW)(t.codecpar.extradata,t.codecpar.extradataSize)):173===t.codecpar.codecId?N.XC(t,(0,Y.JW)(t.codecpar.extradata,t.codecpar.extradataSize)):86018===t.codecpar.codecId?E.XC(t,(0,Y.JW)(t.codecpar.extradata,t.codecpar.extradataSize)):86076===t.codecpar.codecId&&D.XC(t,(0,Y.JW)(t.codecpar.extradata,t.codecpar.extradataSize))}}},{key:"parsePESSlice",value:function(e,t,r,a){var i=(0,P.A)(r);(0,w.A)(i,t,a),(0,I.A)(r);var n=a.privData;if(n.filter){if(n.filter.sendAVPacket(t)<0)return A.z3("send avpacket to bsf failed",Q,179),U.LR;if(n.filter.receiveAVPacket(t)<0)return A.z3("receive avpacket from bsf failed",Q,186),U.LR;for(b.M[15](t+76,9e4),b.M[15](t+72,1),b.M[15](t+32,a.index),this.checkExtradata(t,a);;){var s=this.cacheAVPacket||(0,C._5)();if(0!==n.filter.receiveAVPacket(s)){this.cacheAVPacket=s;break}b.M[15](s+76,9e4),b.M[15](s+72,1),b.M[15](s+32,a.index),this.checkExtradata(s,a),e.interval.packetBuffer.push(s),this.cacheAVPacket=0}}else{var o=this.context.pmt.pid2StreamType.get(n.pid);if(3===o||4===o){b.M[15](t+36,1|g.f[15](t+36));var c=(0,C.iI)(t),u=c[1]>>>3&3,d=(6&c[1])>>1,h=(12&c[2])>>>2,f=3&~(c[3]>>>6)?2:1,p=z.Au(d),l=z.Y2(u,h);(a.codecpar.profile!==p||a.codecpar.sampleRate!==l||a.codecpar.chLayout.nbChannels!==f)&&(a.codecpar.profile=p,a.codecpar.sampleRate=l,a.codecpar.chLayout.nbChannels=f,a.codecpar.channels=f)}else 27===a.codecpar.codecId?a.codecpar.extradata||(_.ci(t),this.checkExtradata(t,a),a.codecpar.bitFormat=2):173===a.codecpar.codecId&&(a.codecpar.extradata||(N.ci(t),this.checkExtradata(t,a),a.codecpar.bitFormat=2))}return 0}},{key:"readAVPacket_",value:(c=(0,n.A)(v().mark((function e(t,r){var a,i,n,s,o,c,u=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.context.ioEnd){e.next=24;break}if(this.context.tsSliceQueueMap.size){e.next=3;break}return e.abrupt("return",-1048576);case 3:a=this.context.tsSliceQueueMap.values();case 4:if(!(n=a.next()).value||!n.value.slices.length){e.next=9;break}return i=n.value,e.abrupt("break",13);case 9:if(!n.done){e.next=11;break}return e.abrupt("break",13);case 11:e.next=4;break;case 13:if(i){e.next=15;break}return e.abrupt("return",-1048576);case 15:if(!(s=t.streams.find((function(e){return e.privData.pid===i.pid})))){e.next=20;break}return e.abrupt("return",this.parsePESSlice(t,r,i,s));case 20:return(0,I.A)(i),e.abrupt("return",this.readAVPacket_(t,r));case 22:e.next=49;break;case 24:e.prev=24,o=v().mark((function e(){var a,i,n,s,o,c,d,h,f,p;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.n(t.ioReader,u.context);case 2:if((a=e.sent).payload){e.next=5;break}return e.abrupt("return",0);case 5:if(0!==a.pid&&a.pid!==u.context.currentPmtPid&&134!==u.context.pmt.pid2StreamType.get(a.pid)){e.next=8;break}return(0,k.A)(a,u.context),e.abrupt("return",0);case 8:if(i=u.context.pmt.pid2StreamType.get(a.pid)){e.next=11;break}return e.abrupt("return",0);case 11:if((n=t.streams.find((function(e){return e.privData.pid===a.pid})))||(n=t.createStream(),(0,S.A)(a.pid,n,u.context)),s=a.payload[4]<<8|a.payload[5],o=u.context.tsSliceQueueMap.get(a.pid),c=!1,!o){e.next=24;break}if(!(o.totalLength>0&&a.payloadUnitStartIndicator)){e.next=22;break}if(!((d=u.parsePESSlice(t,r,o,n))<0)){e.next=21;break}return e.abrupt("return",{v:d});case 21:c=!0;case 22:e.next=28;break;case 24:if(a.payloadUnitStartIndicator){e.next=26;break}return e.abrupt("return",0);case 26:o=new R.pi,u.context.tsSliceQueueMap.set(a.pid,o);case 28:if(a.payloadUnitStartIndicator&&(o.randomAccessIndicator=null!==(h=null===(f=a.adaptationFieldInfo)||void 0===f?void 0:f.randomAccessIndicator)&&void 0!==h?h:0,o.pos=a.pos,o.pid=a.pid,o.streamType=i,o.expectedLength=0===s?0:s+6),o.slices.push(a.payload),o.totalLength+=a.payload.length,!(o.expectedLength>0&&o.expectedLength===o.totalLength)){e.next=36;break}if(!((p=u.parsePESSlice(t,r,o,n))<0)){e.next=35;break}return e.abrupt("return",{v:p});case 35:c=!0;case 36:if(!c){e.next=38;break}return e.abrupt("return",{v:0});case 38:case"end":return e.stop()}}),e)}));case 26:return e.delegateYield(o(),"t0",28);case 28:if(0!==(c=e.t0)){e.next=31;break}return e.abrupt("continue",26);case 31:if(!c){e.next=33;break}return e.abrupt("return",c.v);case 33:e.next=26;break;case 35:e.next=49;break;case 37:if(e.prev=37,e.t1=e.catch(24),-1048576!==t.ioReader.error||this.context.ioEnd){e.next=44;break}return this.context.ioEnd=!0,e.abrupt("return",this.readAVPacket_(t,r));case 44:if(-1048576!==t.ioReader.error){e.next=48;break}return e.abrupt("return",-1048576);case 48:throw e.t1;case 49:case"end":return e.stop()}}),e,this,[[24,37]])}))),function(e,t){return c.apply(this,arguments)})},{key:"readAVPacket",value:(i=(0,n.A)(v().mark((function e(t,r){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.readAVPacket_(t,r));case 4:return e.prev=4,e.t0=e.catch(0),-1048576!==t.ioReader.error&&A.z3(e.t0.message,Q,406),e.abrupt("return",t.ioReader.error);case 8:case"end":return e.stop()}}),e,this,[[0,4]])}))),function(e,t){return i.apply(this,arguments)})},{key:"syncTSPacket",value:(a=(0,n.A)(v().mark((function e(t){var r,a,i,n,s=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=B.Dh,a=10;case 2:return e.prev=3,e.next=6,t.ioReader.readUint8();case 6:if(71!==e.sent){e.next=32;break}r=this.context.tsPacketSize===y.VG?t.ioReader.getPos()-BigInt(5):t.ioReader.getPos()-BigInt(1),i=0,n=t.ioReader.getPos();case 11:if(!(i<=a)){e.next=24;break}return e.next=14,t.ioReader.skip(this.context.tsPacketSize-1);case 14:return e.next=16,t.ioReader.readUint8();case 16:if(71!==e.sent){e.next=21;break}i++,e.next=22;break;case 21:return e.abrupt("break",24);case 22:e.next=11;break;case 24:if(!(i<a)){e.next=31;break}return r=B.Dh,e.next=28,t.ioReader.seek(n);case 28:return e.abrupt("continue",2);case 31:return e.abrupt("break",40);case 32:e.next=38;break;case 34:return e.prev=34,e.t0=e.catch(3),r=B.Dh,e.abrupt("break",40);case 38:e.next=2;break;case 40:if(r===B.Dh){e.next=55;break}return e.next=43,t.ioReader.seek(r);case 43:return e.next=46,x.n(t.ioReader,this.context);case 46:if(!e.sent.payloadUnitStartIndicator){e.next=52;break}return e.next=50,t.ioReader.seek(r);case 50:return t.streams.forEach((function(e){var t=s.context.tsSliceQueueMap.get(e.privData.pid);t&&(0,I.A)(t)})),e.abrupt("break",55);case 52:r=t.ioReader.getPos(),e.next=43;break;case 55:case"end":return e.stop()}}),e,this,[[3,34]])}))),function(e){return a.apply(this,arguments)})},{key:"seek",value:(r=(0,n.A)(v().mark((function e(t,r,a,i){var n,s,o,c,u,d=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ioReader.getPos(),this.context.tsSliceQueueMap.forEach((function(e){e.slices.length&&e.pos<n&&(n=e.pos),(0,I.A)(e)})),this.context.pmt.pid2StreamType.forEach((function(e,t){d.context.tsSliceQueueMap.delete(t)})),!(16&i)){e.next=9;break}return s=(0,T.k)(a,r.timeBase,B.i0),e.next=7,t.ioReader.seek(s,!0);case 7:return this.context.ioEnd=!1,e.abrupt("return",BigInt(0));case 9:if(!r||!r.sampleIndexes.length){e.next=17;break}if(!((o=F.El(r.sampleIndexes,(function(e){return e.pts>a?-1:1})))>0&&(0,T.k)(a-r.sampleIndexes[o-1].pts,r.timeBase,B.i0)<BigInt(1e4))){e.next=17;break}return A.Yz("seek in sampleIndexes, found index: ".concat(o,", pts: ").concat(r.sampleIndexes[o-1].pts,", pos: ").concat(r.sampleIndexes[o-1].pos),Q,516),e.next=15,t.ioReader.seek(r.sampleIndexes[o-1].pos);case 15:case 29:return this.context.ioEnd=!1,e.abrupt("return",n);case 17:if(!(2&i)){e.next=33;break}return e.next=20,t.ioReader.fileSize();case 20:if(!((c=e.sent)<=BigInt(0))){e.next=23;break}return e.abrupt("return",BigInt(U.E$));case 23:return a<BigInt(0)?a=BigInt(0):a>c&&(a=c),e.next=26,t.ioReader.seek(a);case 26:if(4&i){e.next=29;break}return e.next=29,this.syncTSPacket(t);case 33:return A.Yz("not found any keyframe index, try to seek in bytes",Q,548),e.next=36,(0,L.A)(t,r,a,this.firstTSPacketPos,this.readAVPacket.bind(this),this.syncTSPacket.bind(this));case 36:return(u=e.sent)>=0&&(this.context.ioEnd=!1),e.abrupt("return",u);case 39:case"end":return e.stop()}}),e,this)}))),function(e,t,a,i){return r.apply(this,arguments)})},{key:"getAnalyzeStreamsCount",value:function(){var e,t;return null!==(e=null===(t=this.context.pmt)||void 0===t?void 0:t.pid2StreamType.size)&&void 0!==e?e:0}}]),t}(M.A)},89564:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(27274);function i(e,t,r){for(var i=new Uint8Array(a.GV),n=0,s=0,o=0;o<e.length-3;o++)if(71===e[o]){var c=8191&(e[o+1]<<8|e[o+2]),u=48&e[o+3];if(!r||8191===c||u){var d=o%t;i[d]++,n++,i[d]>s&&(s=i[d])}}return s-Math.max(n-10*s,0)/10}},52088:(e,t,r)=>{"use strict";function a(e){e.slices=[],e.totalLength=0,e.expectedLength=-1}r.d(t,{A:()=>a})},19770:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(80662),i=r.n(a),n=r(77231),s=r(6403);function o(){return{currentProgram:n.N_,currentPmtPid:n.N_,tsPacketSize:n.N_,hasPAT:!1,hasPMT:!1,tsSliceQueueMap:new(i()),pat:new s.Cd,pmt:new s.I4,program2Pmt:new(i()),ioEnd:!1,startPid:256,delay:BigInt(0)}}},76538:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(77231);function i(){return{pid:a.N_,filter:null,tsPacket:null,pes:null,continuityCounter:0,pesSlices:{total:0,buffers:[]},latm:!1}}},39e3:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(6403),i=r(52088),n=r(63599);function s(e,t){var r=t.tsSliceQueueMap.get(e.pid);if(e.payloadUnitStartIndicator){var s=e.payload[0];if(r&&r.totalLength>0){var o=e.payload.slice(1,Math.min(1+s,e.payload.length));r.slices.push(o),r.totalLength+=o.length,r.totalLength===r.expectedLength?((0,n.A)(e.pid,r,t),(0,i.A)(r)):((0,i.A)(r),t.tsSliceQueueMap.delete(e.pid))}for(var c=1+s;c<e.payload.length;){var u,d;if(255===e.payload[c])break;var h=(15&e.payload[c+1])<<8|e.payload[c+2],f=new a.pi;f.pid=e.pid,f.expectedLength=h+3,f.randomAccessIndicator=null!==(u=null===(d=e.adaptationFieldInfo)||void 0===d?void 0:d.randomAccessIndicator)&&void 0!==u?u:0;var p=e.payload.slice(c,Math.min(c+f.expectedLength-f.totalLength,e.payload.length));f.slices.push(p),f.totalLength+=p.length,t.tsSliceQueueMap.set(e.pid,f),f.totalLength===f.expectedLength?((0,n.A)(e.pid,f,t),(0,i.A)(f)):((0,i.A)(f),t.tsSliceQueueMap.delete(e.pid)),c+=p.length}}else if(r&&0!==r.totalLength){var l=e.payload.slice(0,Math.min(r.expectedLength-r.totalLength,e.payload.length));r.slices.push(l),r.totalLength+=l.length,r.totalLength===r.expectedLength?((0,n.A)(e.pid,r,t),(0,i.A)(r)):((0,i.A)(r),t.tsSliceQueueMap.delete(e.pid))}}},86191:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var a=r(61499),i=r(76538),n=r(27274),s=r(50848),o=r(36488),c=r(61702),u=r(65451),d=r(37837),h=r(14686);function f(e,t,r){t.timeBase.den=9e4,t.timeBase.num=1;var f=(0,i.A)();f.pid=e,t.privData=f;var p,l=r.pmt.pid2StreamType.get(e);if(6===l){var v=r.pmt.pid2ESDescriptor.get(e);if(t.codecpar.codecType=2,v){var g,b=v.find((function(e){return 5===e.tag}));if(b&&(null===(g=b.buffer)||void 0===g?void 0:g.length)>=4&&("O"===String.fromCharCode(b.buffer[0])||"p"===String.fromCharCode(b.buffer[1])||"u"===String.fromCharCode(b.buffer[2])||"s"===String.fromCharCode(b.buffer[3]))){t.codecpar.codecType=1,t.codecpar.codecId=86076,t.codecpar.sampleRate=48e3;var A=v.find((function(e){return 127===e.tag}));if(A&&128===A.buffer[0]){t.codecpar.chLayout.nbChannels=15&A.buffer[1]?15&A.buffer[1]:2,t.codecpar.channels=t.codecpar.chLayout.nbChannels;var m=u.Ij(t.codecpar);m&&(t.codecpar.extradata=(0,d.sY)(m.length),(0,h.lW)(t.codecpar.extradata,m.length,m),t.codecpar.extradataSize=m.length)}}}}else{var x=n.$x[l];x?(t.codecpar.codecType=x[0],t.codecpar.codecId=x[1]):t.codecpar.codecType=2}switch(l){case 15:p=new s.A;break;case 17:p=new o.A;break;case 27:case 36:break;case 6:86076===t.codecpar.codecId&&(p=new c.A)}return p&&(t.privData.filter=p,p.init(t.codecpar[a.o9],t.timeBase[a.o9])),t}},52888:(e,t,r)=>{"use strict";function a(e,t,r){return e>t?r>t&&(t=r>e?e:r):t>r&&(t=r>e?r:e),t}r.d(t,{y:()=>a})},31239:(e,t,r)=>{"use strict";function a(e,t){var r=0,a=e[r++];if(t.adaptationFieldInfo.discontinuityIndicator=a>>7&1,t.adaptationFieldInfo.randomAccessIndicator=a>>6&1,t.adaptationFieldInfo.elementaryStreamPriorityIndicator=a>>5&1,t.adaptationFieldInfo.pcrFlag=a>>4&1,t.adaptationFieldInfo.opcrFlag=a>>3&1,t.adaptationFieldInfo.splicingPointFlag=a>>2&1,t.adaptationFieldInfo.transportPrivateDataFlag=a>>1&1,t.adaptationFieldInfo.adaptationFieldExtensionFlag=1&a,t.adaptationFieldInfo.pcrFlag){var i=BigInt(Math.floor(e[r++]<<25|e[r++]<<17|e[r++]<<9|e[r++]<<1|e[r]>>7)),n=BigInt(Math.floor((1&e[r++])<<8|e[r++]));t.adaptationFieldInfo.pcr=i*BigInt(300)+n}if(t.adaptationFieldInfo.opcrFlag){var s=BigInt(Math.floor(e[r++]<<25|e[r++]<<17|e[r++]<<9|e[r++]<<1|e[r]>>7)),o=BigInt(Math.floor((1&e[r++])<<8|e[r++]));t.adaptationFieldInfo.pcr=s*BigInt(300)+o}if(t.adaptationFieldInfo.splicingPointFlag&&(t.adaptationFieldInfo.spliceCountDown=e[r++]),t.adaptationFieldInfo.transportPrivateDataFlag){var c=e[r++];t.adaptationFieldInfo.transportPrivateData=e.subarray(r,r+c),r+=c}if(t.adaptationFieldInfo.adaptationFieldExtensionFlag){var u=e[r++];t.adaptationFieldInfo.extension=e.subarray(r,r+u),r+=u}}r.d(t,{A:()=>a})},20549:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(31865),i=r(6403),n=r(92647),s=r(4624),o="src/avformat/formats/mpegts/function/parsePAT.ts";function c(e,t){var r,c=new a.A((0,n.A)(Uint8Array,e.slices),!0),u=c.readUint8();0!==u&&s.z3("parsePAT: table_id ".concat(u," is not corresponded to PAT!"),o,40);var d,h=4095&c.readUint16(),f=(c.readUint16(),(r=c.readUint8())>>1&31),p=1&r,l=c.readUint8();if(c.readUint8(),1===p&&0===l)(d=new i.Cd).versionNumber=f;else if(!(d=t.pat))return void s.z3("can not found PAT in mpegts context",o,64);for(var v=h-5-4,g=(0|Number(0xffffffffn&c.getPos()))+v,b=-1,A=-1;c.getPos()<g;){var m=c.readUint16(),x=8191&c.readUint16();0===m?d.networkPid=x:(d.program2PmtPid.set(m,x),-1===b&&(b=m),-1===A&&(A=x))}1===p&&0===l&&(t.pat||s.pq("parsed first PAT",o,100),t.pat=d,t.currentProgram=b,t.currentPmtPid=A,t.hasPAT=!0)}},51660:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var a=r(63939),i=r(50932),n=r(71517),s=r(37837),o=r(14686),c=r(77231);function u(e,t,r){e.randomAccessIndicator&&i.M[15](t+36,1|a.f[15](t+36));var u=r.codecpar.codecId;27!==u&&173!==u||i.M[15](t+80,2),i.M[15](t+32,r.index),i.M[17](t+16,e.dts),i.M[17](t+8,e.pts),i.M[17](t+56,e.pos),i.M[15](t+76,9e4),i.M[15](t+72,1),r.startTime===c.Dh&&(r.startTime=a.f[17](t+8)||a.f[17](t+16));var d=(0,s.sY)(e.payload.length);(0,o.lW)(d,e.payload.length,e.payload),(0,n.NX)(t,d,e.payload.length)}},39144:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(6403),i=r(4624),n=r(77231),s="src/avformat/formats/mpegts/function/parsePESSlice.ts";function o(e){for(var t=new Uint8Array(e.totalLength),r=0,o=0;r<e.slices.length;r++){var c=e.slices[r];t.set(c,o),o+=c.byteLength}var u=t[3],d=t[4]<<8|t[5],h=new a.xf;if(h.data=t,h.pid=e.pid,h.streamId=u,h.streamType=e.streamType,h.pos=e.pos,h.randomAccessIndicator=e.randomAccessIndicator,188!==u&&190!==u&&191!==u&&240!==u&&241!==u&&255!==u&&242!==u&&248!==u){var f=(192&t[7])>>>6,p=t[8],l=n.Dh,v=n.Dh;2!==f&&3!==f||(l=BigInt(Math.floor(536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)),v=3===f?BigInt(Math.floor(536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)):l),h.dts=v,h.pts=l;var g=9+p,b=0;if(0!==d){if(d<3+p)return void i.z3("Malformed PES: PES_packet_length < 3 + PES_header_data_length",s,93);b=d-3-p}else b=t.byteLength-g;h.payload=t.subarray(g,g+b)}else if((188===u||191===u||240===u||241===u||255===u||242===u||248===u)&&6===h.streamId){var A;A=0!==d?d:t.byteLength-6,h.payload=t.subarray(6,6+A)}return h}},65945:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(31865),i=r(6403),n=r(92647),s=r(4624),o="src/avformat/formats/mpegts/function/parsePMT.ts";function c(e,t){var r,c=new a.A((0,n.A)(Uint8Array,e.slices),!0),u=c.readUint8();2!==u&&s.z3("parse PMT: table_id ".concat(u," is not corresponded to PAT!"),o,40);var d,h=4095&c.readUint16(),f=c.readUint16(),p=(r=c.readUint8())>>1&31,l=1&r,v=c.readUint8();if(c.readUint8(),1===l&&0===v)(d=new i.I4).programNumber=f,d.versionNumber=p,t.program2Pmt.set(f,d),t.hasPMT=!0;else if(!(d=t.program2Pmt.get(f)))return void s.z3("can not found PMT in mpegts context",o,68);d.pcrPid=8191&c.readUint16();var g=4095&c.readUint16();c.skip(g);for(var b=(0|Number(0xffffffffn&c.getPos()))+(h-9-g-4);c.getPos()<b;){var A=c.readUint8(),m=8191&c.readUint16(),x=4095&c.readUint16();if(d.pid2StreamType.set(m,A),x>0){for(var y=[],k=(0|Number(0xffffffffn&c.getPos()))+x;c.getPos()<k;){var U=new i.kJ;U.tag=c.readUint8();var w=c.readUint8();w>0&&(U.buffer=c.readBuffer(w)),y.push(U)}d.pid2ESDescriptor.set(m,y)}}f===t.currentProgram&&(t.pmt||s.pq("parsed first PMT",o,111),t.pmt=d)}},43383:(e,t,r)=>{"use strict";function a(e,t){}r.d(t,{A:()=>a})},63599:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(20549),i=r(65945),n=r(43383);function s(e,t,r){0===e?(0,a.A)(t,r):e===r.currentPmtPid?(0,i.A)(t,r):r.pmt&&134===r.pmt.pid2StreamType.get(e)&&(0,n.A)(t,r)}},53783:(e,t,r)=>{"use strict";r.d(t,{n:()=>v,q:()=>p});var a=r(25182),i=r(36443),n=r.n(i),s=r(27274),o=r(89564),c=r(52888),u=r(4624),d=r(6403),h=r(31239),f="src/avformat/formats/mpegts/impegts.ts";function p(e){return l.apply(this,arguments)}function l(){return(l=(0,a.A)(n().mark((function e(t){var r,a,i,d,h,p;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.peekBuffer(s.pm);case 3:r=e.sent,e.next=12;break;case 6:if(e.prev=6,e.t0=e.catch(0),-1048576===t.error){e.next=12;break}return e.next=11,t.peekBuffer(t.remainingLength());case 11:r=e.sent;case 12:if(!(r&&r.length>=s.ZT)){e.next=22;break}return a=(0,o.A)(r,s.ZT,!1),i=(0,o.A)(r,s.VG,!1),d=(0,o.A)(r,s.eR,!1),h=(0,c.y)(a,d,i),r.length<s.pm&&(h+=s.hY),p=s.ZT,a>h?p=s.ZT:i>h?p=s.VG:d>h&&(p=s.eR),u.Yz("got ts packet size: ".concat(p),f,72),e.abrupt("return",p);case 22:return e.abrupt("return",0);case 23:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function v(e,t){return g.apply(this,arguments)}function g(){return(g=(0,a.A)(n().mark((function e(t,r){var a,i,o,c,p,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.getPos(),i=0,r.tsPacketSize===s.VG&&t.skip(4),e.next=5,t.readUint8();case 5:return 71!==(o=e.sent)&&u.h2("found syncByte not 0x47, value: ".concat(o.toString(16)),f,94),(c=new d.am).pos=a,e.next=11,t.readUint16();case 11:return i=e.sent,c.payloadUnitStartIndicator=i>>14&1,c.transportPriority=i>>13&1,c.pid=8191&i,e.next=17,t.readUint8();case 17:if(i=e.sent,c.adaptationFieldControl=i>>4&3,c.continuityCounter=15&i,p=4,2!==c.adaptationFieldControl&&3!==c.adaptationFieldControl){e.next=44;break}return e.next=24,t.readUint8();case 24:if(5+(l=e.sent)!==s.ZT){e.next=36;break}return e.t0=h.A,e.next=29,t.readBuffer(l);case 29:return e.t1=e.sent,e.t2=c,(0,e.t0)(e.t1,e.t2),r.tsPacketSize===s.eR&&t.skip(16),e.abrupt("return",c);case 36:if(!(l>0)){e.next=43;break}return e.t3=h.A,e.next=40,t.readBuffer(l);case 40:e.t4=e.sent,e.t5=c,(0,e.t3)(e.t4,e.t5);case 43:p=5+l;case 44:if(1!==c.adaptationFieldControl&&3!==c.adaptationFieldControl){e.next=48;break}return e.next=47,t.readBuffer(s.ZT-p);case 47:c.payload=e.sent;case 48:return r.tsPacketSize===s.eR&&t.skip(16),e.abrupt("return",c);case 50:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},27274:(e,t,r)=>{"use strict";r.d(t,{$x:()=>d,GV:()=>o,VG:()=>n,ZT:()=>s,eR:()=>i,hY:()=>u,pm:()=>c});var a=r(134),i=204,n=192,s=188,o=204,c=8192,u=5,d=(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({},15,[1,86018]),17,[1,86018]),3,[1,86017]),4,[1,86017]),27,[0,27]),36,[0,173]),129,[1,86019]),135,[1,86056])},6403:(e,t,r)=>{"use strict";r.d(t,{Cd:()=>f,I4:()=>l,am:()=>d,kJ:()=>p,pi:()=>h,xf:()=>v}),r(77193),r(25767),r(31060);var a=r(81570),i=r(78716),n=r(134),s=r(80662),o=r.n(s),c=(r(88435),r(77231)),u=(0,a.A)((function e(){(0,i.A)(this,e),(0,n.A)(this,"discontinuityIndicator",0),(0,n.A)(this,"randomAccessIndicator",0),(0,n.A)(this,"elementaryStreamPriorityIndicator",0),(0,n.A)(this,"pcrFlag",0),(0,n.A)(this,"opcrFlag",0),(0,n.A)(this,"splicingPointFlag",0),(0,n.A)(this,"transportPrivateDataFlag",0),(0,n.A)(this,"adaptationFieldExtensionFlag",0),(0,n.A)(this,"pcr",BigInt(0)),(0,n.A)(this,"opcr",BigInt(0)),(0,n.A)(this,"spliceCountDown",0),(0,n.A)(this,"transportPrivateData",null),(0,n.A)(this,"extension",null)})),d=(0,a.A)((function e(){(0,i.A)(this,e),(0,n.A)(this,"pos",c.Dh),(0,n.A)(this,"payloadUnitStartIndicator",0),(0,n.A)(this,"transportPriority",0),(0,n.A)(this,"pid",c.N_),(0,n.A)(this,"adaptationFieldControl",0),(0,n.A)(this,"continuityCounter",0),(0,n.A)(this,"transportScramblingControl",0),(0,n.A)(this,"adaptationFieldInfo",new u),(0,n.A)(this,"payload",null)})),h=(0,a.A)((function e(){(0,i.A)(this,e),(0,n.A)(this,"slices",[]),(0,n.A)(this,"totalLength",0),(0,n.A)(this,"expectedLength",c.N_),(0,n.A)(this,"randomAccessIndicator",0),(0,n.A)(this,"pid",c.N_),(0,n.A)(this,"streamType",0),(0,n.A)(this,"pos",c.Dh)})),f=(0,a.A)((function e(){(0,i.A)(this,e),(0,n.A)(this,"versionNumber",0),(0,n.A)(this,"networkPid",c.N_),(0,n.A)(this,"program2PmtPid",new(o()))})),p=(0,a.A)((function e(){(0,i.A)(this,e),(0,n.A)(this,"tag",void 0),(0,n.A)(this,"buffer",void 0)})),l=(0,a.A)((function e(){(0,i.A)(this,e),(0,n.A)(this,"versionNumber",0),(0,n.A)(this,"programNumber",0),(0,n.A)(this,"pcrPid",0),(0,n.A)(this,"pid2StreamType",new(o())),(0,n.A)(this,"pid2ESDescriptor",new(o()))})),v=(0,a.A)((function e(){(0,i.A)(this,e),(0,n.A)(this,"pid",c.N_),(0,n.A)(this,"streamType",0),(0,n.A)(this,"streamId",c.N_),(0,n.A)(this,"dts",c.Dh),(0,n.A)(this,"pts",c.Dh),(0,n.A)(this,"pos",c.Dh),(0,n.A)(this,"payload",null),(0,n.A)(this,"data",null),(0,n.A)(this,"randomAccessIndicator",0)}))},2187:(e,t,r)=>{"use strict";r.d(t,{d:()=>s});var a=r(72739),i=r(44328),n=r(77231);function s(e,t,r){var s=BigInt(0);return a.__(e,(function(e){s+=e.codecpar.bitRate*(0,i.k)(t,r,n.i0)/BigInt(8e3)})),s}},52071:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var a=r(25182),i=r(36443),n=r.n(i),s=r(63939),o=r(9599),c=r(29170),u=r(77231),d=r(44328),h=r(2187),f=r(71517),p=r(9705),l=r(4624),v="src/avformat/function/seekInBytes.ts";function g(e,t,r,a,i,n){return b.apply(this,arguments)}function b(){return(b=(0,a.A)(n().mark((function e(t,r,a,i,g,b){var A,m,x,y,k,U,w,P,I,R,M,S,C,B;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A=t.ioReader.getPos(),e.next=3,t.ioReader.fileSize();case 3:if(m=e.sent,x=u.Dh,y=a,r.startTime!==u.Dh?y-=r.startTime:y-=r.firstDTS,!((k=(0,d.k)(a,r.timeBase,u.i0))<BigInt(1e4))){e.next=13;break}return l.Yz("seek pts is earlier then 10s, seek to first packet pos(".concat(i,") directly"),v,63),e.next=12,t.ioReader.seek(i);case 12:return e.abrupt("return",A);case 13:if(U=(0,h.d)(t.streams,y,r.timeBase),w=m-(0,h.d)(t.streams,BigInt(5e3),u.i0),P=(0,h.d)(t.streams,BigInt(1e4),u.i0),U>w&&(U=w),!(U<i)){e.next=21;break}return e.next=20,t.ioReader.seek(i);case 20:return e.abrupt("return",A);case 21:I=(0,f._5)(),R=m,M=BigInt(0);case 24:if(!(R-M<P)){e.next=28;break}return x=M,e.abrupt("break",51);case 28:return e.next=30,t.ioReader.seek(U);case 30:return e.next=32,b(t);case 32:return S=t.ioReader.getPos(),e.next=35,g(t,I);case 35:if(!(e.sent>=0)){e.next=48;break}if(C=(0,d.k)(s.f[17](I+8),(0,c.A)(I+72,o.P),u.i0),B=C-k,l.Yz("try to seek to pos: ".concat(U,", got packet pts: ").concat(s.f[17](I+8),"(").concat(C,"ms), diff: ").concat(B,"ms"),v,98),!(B<=BigInt(0)&&-B<BigInt(1e4))){e.next=45;break}return x=S,e.abrupt("break",51);case 45:U=B>BigInt(0)?M+(R=U)>>BigInt(1):(M=U)+R>>BigInt(1);case 46:e.next=49;break;case 48:return e.abrupt("break",51);case 49:e.next=24;break;case 51:if((0,f.Qe)(I),x===u.Dh){e.next=61;break}return l.Yz("finally seek to pos ".concat(x),v,124),e.next=56,t.ioReader.seek(x);case 56:return e.next=58,b(t);case 58:return e.abrupt("return",A);case 61:return e.next=63,t.ioReader.seek(A);case 63:return e.abrupt("return",BigInt(p.E$));case 64:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},23991:(e,t,r)=>{"use strict";function a(e){for(var t=0;t<32&&0===e.readU1();)t++;return e.readU(t)+((1<<t)-1)}function i(e){var t=a(e);return 1&t?(t+1)/2:-t/2}r.d(t,{$x:()=>i,xb:()=>a})},60264:(e,t,r)=>{"use strict";function a(e){return e.length>4&&0===e[0]&&0===e[1]&&(1===e[2]||0===e[2]&&1===e[3])}function i(e,t){for(var r=0,a=t;a<e.length;a++)switch(e[a]){case 0:r++;break;case 1:if(r>=2)return{offset:a-Math.min(r,3),startCode:Math.min(r+1,4)};r=0;break;default:r=0}return{offset:-1,startCode:0}}function n(e){for(var t=[],r=i(e,0),a={offset:-1,startCode:0};(a=i(e,r.offset+r.startCode)).offset>-1;)t.push(e.subarray(r.offset+r.startCode,a.offset,!0)),r=a;return t.push(e.subarray(r.offset+r.startCode,void 0,!0)),t}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;r||(r=e.length);for(var a=new Uint8Array(e.length),i=0,n=0,s=0;s<e.length;s++){if(s>=t&&s<r)if(0===e[s])i++;else if(3===e[s]&&2===i&&s+1<e.length&&e[s+1]<=3){if(++s===e.length)break;i=0===e[s]?1:0}else i=0;a[n++]=e[s]}return a.slice(0,n)}r.d(t,{BN:()=>s,Bs:()=>a,py:()=>n})},37246:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(78716),i=r(81570),n=r(134),s=r(4624),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1048576;(0,a.A)(this,e),(0,n.A)(this,"buffer",void 0),(0,n.A)(this,"pointer",void 0),(0,n.A)(this,"bitsLeft",void 0),(0,n.A)(this,"size",void 0),(0,n.A)(this,"endPointer",void 0),(0,n.A)(this,"error",void 0),(0,n.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.size=t,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}return(0,i.A)(e,[{key:"peekU1",value:function(){(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();var e=this.pointer,t=this.bitsLeft;return 0===t&&(e++,t=8),this.buffer[e]>>t-1&1}},{key:"readU1",value:function(){var e;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,e=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8),e}},{key:"readU",value:function(e){for(var t=0,r=0;r<e;r++)t|=this.readU1()<<e-r-1;return t}},{key:"remainingLength",value:function(){return this.endPointer-this.pointer}},{key:"flush",value:function(){if(!this.onFlush)throw this.error=-1048575,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&this.pointer++,!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);var e=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(e<0)throw this.error=e,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+e,this.pointer=0}else{var t=this.onFlush(this.buffer);if(this.endPointer=t,this.pointer=0,this.bitsLeft=8,t<0)throw this.error=t,Error("IOReader error, flush failed")}}},{key:"getBuffer",value:function(){return this.buffer}},{key:"appendBuffer",value:function(e){if(this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else{var t=Math.min(this.size-this.endPointer,e.length);this.buffer.set(e.subarray(0,t),this.endPointer),this.endPointer+=t,s.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src/common/io/BitReader.ts",170)}}},{key:"clear",value:function(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0}},{key:"skipPadding",value:function(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++)}}]),e}()},729:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(78716),i=r(81570),n=r(134),s=r(4624),o=r(50011),c=function(){function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,a.A)(this,e),(0,n.A)(this,"data",void 0),(0,n.A)(this,"buffer",void 0),(0,n.A)(this,"byteStart",void 0),(0,n.A)(this,"pos",void 0),(0,n.A)(this,"size",void 0),(0,n.A)(this,"littleEndian",void 0),this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!r}return(0,i.A)(e,[{key:"writeUint8",value:function(e){this.data.setUint8(this.pos+++this.byteStart,e)}},{key:"writeUint16",value:function(e){this.data.setUint16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}},{key:"writeUint24",value:function(e){var t=3840&e,r=240&e,a=15&e;this.littleEndian?(this.writeUint8(a),this.writeUint8(r),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(r),this.writeUint8(a))}},{key:"writeUint32",value:function(e){this.data.setUint32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}},{key:"writeUint64",value:function(e){var t=e&BigInt(4294967295),r=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeUint32(Number(t)),this.writeUint32(Number(r))):(this.writeUint32(Number(r)),this.writeUint32(Number(t)))}},{key:"writeInt8",value:function(e){this.data.setInt8(this.pos+++this.byteStart,e)}},{key:"writeInt16",value:function(e){this.data.setInt16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}},{key:"writeInt32",value:function(e){this.data.setInt32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}},{key:"writeInt64",value:function(e){var t=e&BigInt(4294967295),r=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeInt32(Number(t)),this.writeInt32(Number(r))):(this.writeInt32(Number(r)),this.writeInt32(Number(t)))}},{key:"writeFloat",value:function(e){this.data.setFloat32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}},{key:"writeDouble",value:function(e){this.data.setFloat64(this.pos+this.byteStart,e,this.littleEndian),this.pos+=8}},{key:"getPos",value:function(){return this.pos}},{key:"seek",value:function(e){e>this.size&&(e=this.size),this.pos=Math.max(0,e)}},{key:"skip",value:function(e){this.seek(this.pos+e)}},{key:"back",value:function(e){this.seek(this.pos-e)}},{key:"remainingSize",value:function(){return this.size-this.pos}},{key:"writeBuffer",value:function(e){var t=e.length;this.remainingSize()<t&&(t=this.remainingSize(),s.R8("the remaining buffer size is smaller then the wrote buffer, hope set ".concat(e.length,", but set ").concat(t),"src/common/io/BufferWriter.ts",211)),this.buffer.set(e,this.pos),this.pos+=e.length}},{key:"writeString",value:function(e){var t=o.l(e);return this.writeBuffer(t),t.length}},{key:"getWroteBuffer",value:function(){return this.buffer.subarray(0,this.pos)}},{key:"resetBuffer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}}]),e}()},80345:(e,t,r)=>{r(28351),e.exports=r(46438).Reflect.get},28351:(e,t,r)=>{var a=r(81033),i=r(66123),n=r(75509),s=r(88535),o=r(24401),c=r(80812);s(s.S,"Reflect",{get:function e(t,r){var s,u,d=arguments.length<3?t:arguments[2];return c(t)===d?t[r]:(s=a.f(t,r))?n(s,"value")?s.value:void 0!==s.get?s.get.call(d):void 0:o(u=i(t))?e(u,r,d):void 0}})},803:(e,t,r)=>{var a=r(16560),i=r(54220);function n(t){return e.exports=n="function"==typeof a&&"symbol"==typeof i?function(e){return typeof e}:function(e){return e&&"function"==typeof a&&e.constructor===a&&e!==a.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},60394:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(80345),i=r(3706),n=r(41473);function s(){return s="undefined"!=typeof Reflect&&a?a.bind():function(e,t,r){var a=(0,n.A)(e,t);if(a){var s=i(a,t);return s.get?s.get.call(arguments.length<3?e:r):s.value}},s.apply(this,arguments)}},41473:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(25767);function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,a.A)(e)););return e}}}]);