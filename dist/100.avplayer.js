(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[100],{8469:(e,t,i)=>{"use strict";i.d(t,{En:()=>s,Ij:()=>d,XC:()=>o,hY:()=>n});var a=i(7231);const r={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,a.N_,a.N_,a.N_],s=[a.N_,1,2,3,4,5,6,7];function o(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){const{profile:i,sampleRate:r,channels:o}=function(e){let t=a.N_,i=a.N_,r=a.N_;var o,d;return e.length>=2&&(t=e[0]>>3&31,i=null!==(o=n[(7&e[0])<<1|e[1]>>7])&&void 0!==o?o:48e3,r=null!==(d=s[e[1]>>3&15])&&void 0!==d?d:2),{profile:t,sampleRate:i,channels:r}}(t);e.codecpar.profile=i,e.codecpar.sampleRate=r,e.codecpar.chLayout.nbChannels=o,e.codecpar.channels=o}}function d(e){const t=r[e.sampleRate],i=e.chLayout.nbChannels,a=new Uint8Array(2);return a[0]=(31&e.profile)<<3|(14&t)>>1,a[1]=(1&t)<<7|(15&i)<<3,a}},412:(e,t,i)=>{"use strict";i.d(t,{Ui:()=>n,XC:()=>r});var a=i(7246);function r(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=4){const i=n(t);e.codecpar.profile=i.profile,e.codecpar.level=i.level}}function n(e){const t=new a.A(e.length);t.appendBuffer(e),t.readU1(),t.readU(7);const i=t.readU(3),r=t.readU(5),n=t.readU1();let s=t.readU1()?10:8;return t.readU1()&&(s=12),{profile:i,level:r,tier:n,bitDepth:s,monochrome:t.readU1(),chromaSubsamplingX:t.readU1(),chromaSubsamplingY:t.readU1(),chromaSamplePosition:t.readU(2)}}},620:(e,t,i)=>{"use strict";i.d(t,{Jk:()=>x,XC:()=>w,ci:()=>U,oT:()=>b});var a=i(3939),r=i(932),n=i(2739),s=i(729),o=i(1865),d=i(7246),c=i(4624),l=i(4686),f=i(1517),h=i(264),p=i(7837),u=i(3991),m="src/avformat/codecs/h264.ts";const g=3;function y(e,t,i=[]){e.length>32&&(c.R8(`h264 metadata's sps max length is 32, but get ${e.length}`,m,159),e=e.slice(0,32)),e.length>256&&(c.R8(`h264 metadata's pps max length is 256, but get ${e.length}`,m,163),e=e.slice(0,256));let a=7;a=e.reduce(((e,t)=>e+2+t.length),a),a=t.reduce(((e,t)=>e+2+t.length),a);const r=e[0],o=N(r);66!==o.profile&&77!==o.profile&&88!==o.profile&&(a+=4,i.length&&(a=i.reduce(((e,t)=>e+2+t.length),a)));const d=new Uint8Array(a),l=new s.A(d);return l.writeUint8(1),l.writeUint8(r[1]),l.writeUint8(r[2]),l.writeUint8(r[3]),l.writeUint8(252|g),l.writeUint8(224|31&e.length),n.__(e,(e=>{l.writeUint16(e.length),l.writeBuffer(e)})),l.writeUint8(t.length),n.__(t,(e=>{l.writeUint16(e.length),l.writeBuffer(e)})),66!==o.profile&&77!==o.profile&&88!==o.profile&&(l.writeUint8(252|o.chromaFormatIdc),l.writeUint8(248|o.bitDepthLumaMinus8),l.writeUint8(248|o.bitDepthChromaMinus8),i.length&&n.__(i,(e=>{l.writeUint16(e.length),l.writeBuffer(e)}))),d}function b(e){let t,i=(0,h.py)(e),a=!1;if(i.length>1){const e=[],a=[],r=[];i.forEach((t=>{const i=31&t[0];7===i?e.push(t):8===i?a.push(t):13===i&&r.push(t)})),e.length&&a.length&&(t=y(e,a,r)),i=i.filter((e=>{const t=31&e[0];return 9!==t&&8!==t&&7!==t&&13!==t}))}const r=i.reduce(((e,t)=>e+g+1+t.length),0),o=(0,p.sY)(r),d=(0,l.s3)(o,r),c=new s.A(d);return n.__(i,(e=>{3===g?c.writeUint32(e.length):2===g?c.writeUint24(e.length):1===g?c.writeUint16(e.length):c.writeUint8(e.length),c.writeBuffer(e.subarray(0)),5==(31&e[0])&&(a=!0)})),{bufferPointer:o,length:r,key:a,extradata:t}}function x(e,t){var i;if(!(1&a.f[15](e+36)))return;const r=(0,f.iI)(e);if((0,h.Bs)(r))return;const n=null!==(i=t.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:g;let s=[],d=[],c=[],u=[];const m=new o.A(r);for(;m.remainingSize()>0;){let e=0;e=3===n?m.readUint32():2===n?m.readUint24():1===n?m.readUint16():m.readUint8();const t=r.subarray(0|Number(0xffffffffn&m.getPos()),(0|Number(0xffffffffn&m.getPos()))+e);m.skip(e);const i=31&t[0];7===i?s.push(t):8===i?d.push(t):13===i?c.push(t):u.push(t)}if(s.length||d.length){const t=y(s,d,c),i=(0,p.sY)(t.length);(0,l.lW)(i,t.length,t),(0,f.Ow)(e,1,i,t.length)}}function U(e,t=!1){if(!(1&a.f[15](e+36)||t))return;const i=(0,f.iI)(e);if(!(0,h.Bs)(i))return;let n=(0,h.py)(i);if(n.length>1){const t=[],i=[],s=[];if(n.forEach((e=>{const a=31&e[0];7===a?t.push(e):8===a?i.push(e):13===a&&s.push(e)})),t.length&&i.length){const n=y(t,i,s),o=(0,p.sY)(n.length);(0,l.lW)(o,n.length,n),(0,f.Ow)(e,1,o,n.length),r.M[15](e+36,1|a.f[15](e+36))}}}function w(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[4];const{spss:i}=function(e){const t=new o.A(e);t.skip(5);const i=[],a=[],r=[],n=31&t.readUint8();for(let e=0;e<n;e++){const e=t.readUint16();i.push(t.readBuffer(e))}const s=t.readUint8();for(let e=0;e<s;e++){const e=t.readUint16();a.push(t.readBuffer(e))}if(t.remainingSize()>4){t.skip(3);const e=t.readUint8();if(e>0)for(let i=0;i<e;i++){const e=t.readUint16();r.push(t.readBuffer(e))}}return{spss:i,ppss:a,spsExts:r}}(t);if(i.length){const{profile:t,level:a,width:r,height:n}=N(i[0]);e.codecpar.profile=t,e.codecpar.level=a,e.codecpar.width=r,e.codecpar.height=n}}}function N(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);const i=(0,h.BN)(e.subarray(t)),a=new d.A(i.length);a.appendBuffer(i),a.readU1(),a.readU(2),a.readU(5);const r=a.readU(8);a.readU1(),a.readU1(),a.readU1(),a.readU1(),a.readU1(),a.readU1(),a.readU(2);const n=a.readU(8);u.xb(a);let s=1,o=0,c=0;if((100==r||110==r||122==r||244==r||44==r||83==r||86==r||118==r||128==r||138==r||139==r||134==r||135==r)&&(s=u.xb(a),3===s&&a.readU1(),o=u.xb(a),c=u.xb(a),a.readU1(),a.readU1())){const e=new Array(8);for(let t=0;t<(3!=s?8:12);t++)e[t]=a.readU1()}u.xb(a);const l=u.xb(a);if(0===l)u.xb(a);else if(1===l){a.readU1(),u.$x(a),u.$x(a);const e=u.xb(a);for(let t=0;t<e;t++)u.$x(a)}u.xb(a),a.readU1();const f=u.xb(a),p=u.xb(a),m=a.readU1();let g=16*(f+1),y=(2-m)*(p+1)*16;m||a.readU1(),a.readU1();const b=a.readU1();if(b){let e=1,t=2-b;1===s?(e=2,t=2*(2-b)):2===b&&(e=2,t=2-b),g-=e*(u.xb(a)+u.xb(a)),y-=t*(u.xb(a)+u.xb(a))}return{profile:r,level:n,width:g,height:y,chromaFormatIdc:s,bitDepthLumaMinus8:o,bitDepthChromaMinus8:c}}},3e3:(e,t,i)=>{"use strict";i.d(t,{Jk:()=>y,XC:()=>x,ci:()=>b,oT:()=>g});var a=i(3939),r=i(932),n=i(2739),s=i(729),o=i(1865),d=i(7246),c=i(4686),l=i(264),f=i(1517),h=i(7837),p=i(3991);const u=3;function m(e,t,i){const a=t[0];let r=23;e.length&&(r+=3,r=e.reduce(((e,t)=>e+2+t.length),r)),t.length&&(r+=3,r=t.reduce(((e,t)=>e+2+t.length),r)),i.length&&(r+=3,r=i.reduce(((e,t)=>e+2+t.length),r));const o=new Uint8Array(r),d=new s.A(o,!0),c=U(a);d.writeUint8(1),d.writeUint8(a[1]),d.writeUint8(a[2]),d.writeUint8(a[3]),d.writeUint8(a[4]),d.writeUint8(a[5]),d.writeUint8(a[6]),d.writeUint8(a[7]),d.writeUint8(a[8]),d.writeUint8(a[9]),d.writeUint8(a[10]),d.writeUint8(a[11]),d.writeUint8(c.level),d.writeUint8(1020),d.writeUint8(0),d.writeUint8(16320),d.writeUint8(16320|c.chromaFormatIdc),d.writeUint8(8160|c.bitDepthLumaMinus8),d.writeUint8(8160|c.bitDepthChromaMinus8),d.writeUint16(0),d.writeUint8(8|(1&a[0])<<2|u);let l=0;return e.length&&l++,t.length&&l++,i.length&&l++,d.writeUint8(l),e.length&&(d.writeUint8(160),d.writeUint16(e.length),n.__(e,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),t.length&&(d.writeUint8(161),d.writeUint16(t.length),n.__(t,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),i.length&&(d.writeUint8(162),d.writeUint16(i.length),n.__(i,(e=>{d.writeUint16(e.length),d.writeBuffer(e)}))),o}function g(e){let t,i=!1,a=(0,l.py)(e);if(a.length>2){const e=[],i=[],r=[];a.forEach((t=>{const a=t[0]>>>1&63;32===a?e.push(t):33===a?i.push(t):34===a&&r.push(t)})),e.length&&i.length&&r.length&&(t=m(e,i,r),a=a.filter((e=>{const t=e[0]>>>1&63;return 32!==t&&33!==t&&34!==t&&35!==t})))}const r=a.reduce(((e,t)=>e+u+1+t.length),0),o=(0,h.sY)(r),d=(0,c.s3)(o,r),f=new s.A(d);return n.__(a,(e=>{3===u?f.writeUint32(e.length):2===u?f.writeUint24(e.length):1===u?f.writeUint16(e.length):f.writeUint8(e.length),f.writeBuffer(e.subarray(0));const t=e[0]>>>1&63;19!==t&&20!==t&&21!==t||(i=!0)})),{bufferPointer:o,length:r,extradata:t,key:i}}function y(e,t){var i;if(!(1&a.f[15](e+36)))return;const r=(0,f.iI)(e);if((0,l.Bs)(r))return;const n=null!==(i=t.metadata.naluLengthSizeMinusOne)&&void 0!==i?i:u;let s=[],d=[],p=[];const g=new o.A(r);for(;g.remainingSize()>0;){let e=0;e=3===n?g.readUint32():2===n?g.readUint24():1===n?g.readUint16():g.readUint8();const t=r.subarray(0|Number(0xffffffffn&g.getPos()),(0|Number(0xffffffffn&g.getPos()))+e);g.skip(e);const i=t[0]>>>1&63;33===i?d.push(t):34===i?p.push(t):32===i&&s.push(t)}if(d.length||p.length||s.length){const t=m(s,d,p),i=(0,h.sY)(t.length);(0,c.lW)(i,t.length,t),(0,f.Ow)(e,1,i,t.length)}}function b(e,t=!1){if(!(1&a.f[15](e+36)||t))return;const i=(0,f.iI)(e);if(!(0,l.Bs)(i))return;let n=(0,l.py)(i);if(n.length>2){const t=[],i=[],s=[];if(n.forEach((e=>{const a=e[0]>>>1&63;32===a?t.push(e):33===a?i.push(e):34===a&&s.push(e)})),t.length&&i.length&&s.length){const n=m(t,i,s),o=(0,h.sY)(n.length);(0,c.lW)(o,n.length,n),(0,f.Ow)(e,1,o,n.length),r.M[15](e+36,1|a.f[15](e+36))}}}function x(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[21];const{spss:i}=function(e){const t=new o.A(e,!0);t.skip(22);let i=[],a=[],r=[];const n=t.readUint8();for(let e=0;e<n;e++){const e=63&t.readUint8(),n=t.readUint16(),s=[];for(let e=0;e<n;e++){const e=t.readUint16();s.push(t.readBuffer(e))}32===e?i=s:33===e?a=s:34===e&&(r=s)}return{vpss:i,spss:a,ppss:r}}(t);if(i.length){const{profile:t,level:a,width:r,height:n}=U(i[0]);e.codecpar.profile=t,e.codecpar.level=a,e.codecpar.width=r,e.codecpar.height=n}}}function U(e){if(!e||e.length<3)return;let t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);let i=0,a=0,r=0,n=0,s=0,o=0,c=1,f=0,h=0,u=0,m=0;const g=(0,l.BN)(e.subarray(t)),y=new d.A(g.length);y.appendBuffer(g),y.readU1(),y.readU(6),y.readU(6),y.readU(3),y.readU(4);const b=y.readU(3);if(y.readU1(),b<=6){f=y.readU(2),h=y.readU1(),i=y.readU(5),u=y.readU(32),m=y.readU(48),a=y.readU(8);const e=new Array(6),t=new Array(6);for(let i=0;i<b;i++)e[i]=y.readU1(),t[i]=y.readU1();if(b>0)for(let e=b;e<8;e++)y.readU(2);for(let i=0;i<b;i++)e[i]&&(y.readU(2),y.readU(1),y.readU(5),y.readU(32),y.readU(1),y.readU(1),y.readU(1),y.readU(1),y.readU(44)),t[i]&&y.readU(8);p.xb(y),c=p.xb(y),3===c&&y.readU(1),r=p.xb(y),n=p.xb(y);let d=0,l=0,g=0,x=0;y.readU1()&&(d=p.xb(y),l=p.xb(y),g=p.xb(y),x=p.xb(y)),s=p.xb(y),o=p.xb(y);let U=2,w=2;0===c?U=w=0:2===c?(U=2,w=1):3===c&&(U=w=1),r-=U*(1<<s+1)*(d+l),n-=w*(1<<s+1)*(g+x)}return{profile:i,level:a,width:r,height:n,chromaFormatIdc:c,bitDepthLumaMinus8:s,bitDepthChromaMinus8:o,generalProfileSpace:f,generalTierFlag:h,generalProfileCompatibilityFlag:u,constraintFlags:m}}},9088:(e,t,i)=>{"use strict";i.d(t,{Au:()=>b,XC:()=>x,Y2:()=>m,hG:()=>g,oz:()=>y});var a=i(7231);const r=[44100,48e3,32e3,0],n=[22050,24e3,16e3,0],s=[11025,12e3,8e3,0],o=[0,1152,1152,384],d=[0,576,1152,384],c=[0,576,1152,384],l=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],f=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],h=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],p=[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],u=[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1];function m(e,t){switch(e){case 0:return s[t];case 2:return n[t];case 3:return r[t]}return a.N_}function g(e,t){switch(e){case 0:return c[t];case 2:return d[t];case 3:return o[t]}return a.N_}function y(e,t,i){switch(t){case 1:switch(e){case 0:case 2:return u[i];case 3:return h[i]}break;case 2:switch(e){case 0:case 2:return u[i];case 3:return f[i]}case 3:switch(e){case 0:case 2:return p[i];case 3:return l[i]}}return a.N_}function b(e){switch(e){case 1:return 34;case 2:return 33;case 3:return 32}return a.N_}function x(e,t){if(t&&t.length>=4){const i=t[1]>>>3&3,a=(6&t[1])>>1,r=(12&t[2])>>>2,n=3&~(t[3]>>>6)?2:1,s=b(a),o=m(i,r);e.codecpar.profile=s,e.codecpar.sampleRate=o,e.codecpar.chLayout.nbChannels=n,e.codecpar.channels=n}}},5451:(e,t,i)=>{"use strict";i.d(t,{Ij:()=>c,XC:()=>d,kt:()=>o});var a=i(1865),r=i(729),n=i(4328);const s=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(e){let t=0,i=0,a=0;if(e.length<1)return 0;switch(t=e[0],i=s[t>>3],3&t){case 0:a=1;break;case 1:case 2:a=2;break;case 3:if(e.length<2)return 0;a=63&e[1]}return a*i}function d(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=19){const i=new a.A(t,!1);i.skip(9),e.codecpar.chLayout.nbChannels=i.readUint8(),e.codecpar.channels=e.codecpar.chLayout.nbChannels,e.codecpar.initialPadding=i.readUint16(),e.codecpar.sampleRate=i.readUint32(),e.codecpar.seekPreroll=Number((0,n.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function c(e){const t=new Uint8Array(19),i=new r.A(t,!1);return i.writeString("OpusHead"),i.writeUint8(1),i.writeUint8(e.chLayout.nbChannels),i.writeUint16(e.initialPadding),i.writeUint32(e.sampleRate),t}},4392:(e,t,i)=>{"use strict";i.d(t,{U:()=>n,X:()=>r});var a=i(7246);function r(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){const i=n(t);e.codecpar.profile=i.profile,e.codecpar.level=i.level}}function n(e){const t=new a.A(e.length);return t.appendBuffer(e.subarray(4)),{profile:t.readU(8),level:t.readU(8),bitDepth:t.readU(4),chromaSubsampling:t.readU(3),fullRangeFlag:t.readU1(),colorPrimaries:t.readU(8),colorTrc:t.readU(8),colorSpace:t.readU(8)}}},8919:(e,t,i)=>{"use strict";i.d(t,{U:()=>n,X:()=>r});var a=i(7246);function r(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){const i=n(t);e.codecpar.profile=i.profile,e.codecpar.level=i.level}}function n(e){const t=new a.A(e.length);return t.appendBuffer(e.subarray(4)),{profile:t.readU(8),level:t.readU(8),bitDepth:t.readU(4),chromaSubsampling:t.readU(3),fullRangeFlag:t.readU1(),colorPrimaries:t.readU(8),colorTrc:t.readU(8),colorSpace:t.readU(8)}}},5947:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});var a=i(1026);class r{constructor(){(0,a.A)(this,"type",-1),(0,a.A)(this,"onStreamAdd",void 0)}destroy(e){}}},9420:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>te});var a=i(1026),r=i(662),n=i.n(r),s=i(7860),o=i.n(s),d=i(4686),c=i(1499),l=i(3939),f=i(932),h=i(4624),p=i(9705),u=i(5947),m=i(7837),g=i(1517),y=i(7231);const b={A_AAC:86018,A_AC3:86019,A_ALAC:86032,A_DTS:86020,A_EAC3:86056,A_FLAC:86028,A_MLP:86045,"A_MPEG/L2":86016,"A_MPEG/L1":86058,"A_MPEG/L3":86017,A_OPUS:86076,"A_OPUS/EXPERIMENTAL":86076,"A_PCM/FLOAT/IEEE":65557,"A_PCM/INT/BIG":65537,"A_PCM/INT/LIT":65536,"A_QUICKTIME/QDMC":86066,"A_QUICKTIME/QDM2":86035,"A_REAL/14_4":77824,"A_REAL/28_8":77825,"A_REAL/ATRC":86047,"A_REAL/COOK":86036,"A_REAL/SIPR":86057,A_TRUEHD:86060,A_TTA1:86038,A_VORBIS:86021,A_WAVPACK4:86041,"D_WEBVTT/SUBTITLES":94226,"D_WEBVTT/CAPTIONS":94226,"D_WEBVTT/DESCRIPTIONS":94226,"D_WEBVTT/METADATA":94226,"S_TEXT/UTF8":94225,"S_TEXT/ASCII":94210,"S_TEXT/ASS":94230,"S_TEXT/SSA":94230,S_ASS:94230,S_SSA:94230,S_VOBSUB:94208,S_DVBSUB:94209,"S_HDMV/PGS":94214,"S_HDMV/TEXTST":94231,V_AV1:226,V_DIRAC:116,V_FFV1:33,V_MJPEG:7,V_MPEG1:1,V_MPEG2:2,"V_MPEG4/ISO/ASP":12,"V_MPEG4/ISO/AP":12,"V_MPEG4/ISO/SP":12,"V_MPEG4/ISO/AVC":27,"V_MPEGH/ISO/HEVC":173,"V_MPEG4/MS/V3":16,V_PRORES:147,"V_REAL/RV10":5,"V_REAL/RV20":6,"V_REAL/RV30":68,"V_REAL/RV40":69,V_SNOW:209,V_THEORA:30,V_UNCOMPRESSED:13,V_VP8:139,V_VP9:167},x={V_VP8:139,V_VP9:167,V_AV1:226,A_VORBIS:86021,A_OPUS:86076,"D_WEBVTT/SUBTITLES":94226,"D_WEBVTT/CAPTIONS":94226,"D_WEBVTT/DESCRIPTIONS":94226,"D_WEBVTT/METADATA":94226};var U=i(7672),w=i(2739),N="src/avformat/formats/matroska/imatroska.ts";const I=BigInt(20971520),A={19899:{type:9,isArray:!0,filedName:"entry",child:{21419:{type:1,filedName:"id"},21420:{type:2,filedName:"pos"}}}},S={29604:{type:2,filedName:"segmentUUID"},2807729:{type:1,filedName:"timestampScale"},17545:{type:5,filedName:"duration"},31657:{type:7,filedName:"title"},19840:{type:7,filedName:"muxingApp"},22337:{type:7,filedName:"writingApp"},17505:{type:8,filedName:"dateUTC"}},k={174:{type:9,isArray:!0,filedName:"entry",child:{215:{type:1,filedName:"number"},29637:{type:1,filedName:"uid"},131:{type:1,filedName:"type"},21358:{type:7,filedName:"name"},2274716:{type:7,filedName:"language"},2306383:{type:6,filedName:"timeScale"},134:{type:7,filedName:"codecId"},2459272:{type:7,filedName:"codecName"},25506:{type:8,filedName:"codecPrivate"},225:{type:9,filedName:"audio",child:{181:{type:5,filedName:"sampleRate"},30901:{type:5,filedName:"outSampleRate"},25188:{type:1,filedName:"bitDepth"},159:{type:1,filedName:"channels"}}},224:{type:9,filedName:"video",child:{2327523:{type:1,filedName:"framerate"},21680:{type:1,filedName:"displayWidth"},21690:{type:1,filedName:"displayHeight"},176:{type:1,filedName:"pixelWidth"},186:{type:1,filedName:"pixelHeight"},3061028:{type:8,filedName:"colorSpace"},21440:{type:1,filedName:"alphaMode"},21936:{type:9,filedName:"color",child:{21937:{type:1,filedName:"matrixCoefficients"},21938:{type:1,filedName:"bitsPerChannel"},21941:{type:1,filedName:"cbSubHorz"},21942:{type:1,filedName:"cbSubVert"},21939:{type:1,filedName:"chromaSubHorz"},21940:{type:1,filedName:"chromaSubVert"},21943:{type:1,filedName:"chromaSitingHorz"},21944:{type:1,filedName:"chromaSitingVert"},21945:{type:1,filedName:"range"},21946:{type:1,filedName:"transferCharacteristics"},21947:{type:1,filedName:"primaries"},21948:{type:1,filedName:"maxCll"},21949:{type:1,filedName:"maxFall"},21968:{type:9,filedName:"masteringMeta",child:{21969:{type:5,filedName:"rx"},21970:{type:5,filedName:"ry"},21971:{type:5,filedName:"gx"},21972:{type:5,filedName:"gy"},21973:{type:5,filedName:"bx"},21974:{type:5,filedName:"by"},21975:{type:5,filedName:"whiteX"},21976:{type:5,filedName:"whiteY"},21978:{type:5,isArray:!0,filedName:"minLuminance"},21977:{type:5,filedName:"maxLuminance"}}}}},30320:{type:9,filedName:"projection",child:{30321:{type:1,filedName:"type"},30322:{type:8,filedName:"private"},30323:{type:5,filedName:"yaw"},30324:{type:5,filedName:"pitch"},30325:{type:5,filedName:"roll"}}},21682:{type:1,filedName:"displayUnit"},154:{type:1,filedName:"interlaced"},157:{type:1,filedName:"fieldOrder"},21432:{type:1,filedName:"stereoMode"},21683:{type:1,filedName:"aspectRatio"}}},226:{type:9,filedName:"operations",child:{227:{type:9,isArray:!0,filedName:"entry",child:{228:{type:9,isArray:!0,filedName:"planes",child:{230:{type:1,filedName:"type"},229:{type:1,filedName:"uid"}}}}}}},28032:{type:9,filedName:"encodings",child:{25152:{type:9,isArray:!0,filedName:"entry",child:{20530:{type:1,filedName:"scope"},20531:{type:1,filedName:"type"},20532:{type:9,filedName:"compression",child:{16980:{type:1,filedName:"algo"},16981:{type:8,filedName:"settings"}}},20533:{type:9,filedName:"encryption",child:{18401:{type:1,filedName:"algo"},18402:{type:8,filedName:"keyId"}}}}}}}}}},B={24999:{type:9,isArray:!0,filedName:"entry",child:{18094:{type:1,filedName:"uid"},18030:{type:7,filedName:"name"},18016:{type:7,filedName:"mime"},18046:{type:7,filedName:"description"},18012:{type:8,filedName:"data"}}}},R={17849:{type:9,isArray:!0,filedName:"entry",child:{182:{type:9,filedName:"atom",child:{145:{type:2,filedName:"start"},146:{type:2,filedName:"end"},29636:{type:1,filedName:"uid"},128:{type:9,filedName:"display",child:{133:{type:7,filedName:"title"},17276:{type:7,filedName:"language"}}}}}}}},P={187:{type:9,isArray:!0,filedName:"entry",child:{179:{type:2,filedName:"time"},183:{type:9,isArray:!0,filedName:"pos",child:{247:{type:1,filedName:"track"},241:{type:2,filedName:"pos"}}}}}},v={17827:{type:7,filedName:"name"},17543:{type:7,filedName:"string"},17530:{type:7,filedName:"language"},17540:{type:1,filedName:"default"},17588:{type:1,filedName:"default"},26568:{type:9,filedName:"sub"}};v[26568].child=v;const _={29555:{type:9,isArray:!0,filedName:"entry",child:{26568:{type:9,filedName:"tag",child:v},25536:{type:9,filedName:"target",child:{25546:{type:7,filedName:"type"},26826:{type:1,filedName:"typeValue"},25541:{type:1,filedName:"trackUid"},25540:{type:1,filedName:"chapterUid"},25542:{type:1,filedName:"attachUid"}}}}}},L={161:{type:8,filedName:"block"},30113:{type:9,filedName:"additions",child:{166:{type:9,isArray:!0,filedName:"entry",child:{238:{type:1,filedName:"additionalId"},165:{type:8,filedName:"additional"}}}}},155:{type:2,filedName:"duration"},30114:{type:4,filedName:"discardPadding"},251:{type:4,isArray:!0,filedName:"reference"},164:{type:10,filedName:"nonSimple"}},C={163:{type:8,filedName:"block"},160:{type:9,filedName:"blockGroup",child:L},231:{type:2,filedName:"timeCode"},167:{type:2,filedName:"pos"},171:{type:2,filedName:"prevSize"}},E={17030:{type:1,filedName:"version"},17143:{type:1,filedName:"readVersion"},17138:{type:1,filedName:"maxIdLength"},17139:{type:1,filedName:"maxSizeLength"},17026:{type:7,filedName:"docType"},17031:{type:1,filedName:"docTypeVersion"},17029:{type:1,filedName:"docTypeReadVersion"}};async function D(e,t){const i=e.getPos();let a=await e.readUint8();if(!a)return h.z3(`0x00 as pos ${i} invalid as first byte of an EBML number`,N,759),p.LR;let r=1;for(;!(128&a);)r++,a<<=1;if(a&=127,r>t)return h.z3(`Length ${r} indicated by an EBML number's first byte ${a.toString(16)} at pos ${i} exceeds max length ${t}.`,N,772),p.LR;let n=a>>>r-1;for(;--r;)n<<=8,n|=await e.readUint8();return n}async function T(e,t){const i=e.getPos();let a=await e.readUint8(),r=1;if(!a)return h.z3(`0x00 as pos ${i} invalid as first byte of an EBML number`,N,798),BigInt(p.LR);for(;!(128&a);)r++,a<<=1;if(a&=127,r>t)return h.z3(`Length ${r} indicated by an EBML number's first byte ${a.toString(16)} at pos ${i} exceeds max length ${t}.`,N,809),BigInt(p.LR);let n=BigInt(Math.floor(a>>>r-1));for(;--r;){n<<=BigInt(8);const t=await e.readUint8();n|=BigInt(Math.floor(t))}return n}async function M(e,t){switch(t){case BigInt(0):return 0;case BigInt(1):return e.ioReader.readUint8();case BigInt(2):return e.ioReader.readUint16();case BigInt(3):return e.ioReader.readUint24();case BigInt(4):return e.ioReader.readUint32();case BigInt(8):return e.ioReader.readUint64()}let i=BigInt(0),a=0;for(;a++<t;){const t=await e.ioReader.readUint8();i=i<<BigInt(8)|BigInt.asUintN(64,BigInt(Math.floor(t)))}return i}async function z(e,t){switch(t){case BigInt(0):return 0;case BigInt(1):return e.ioReader.readInt8();case BigInt(2):return e.ioReader.readInt16();case BigInt(4):return e.ioReader.readInt32();case BigInt(8):return e.ioReader.readInt64()}let i=BigInt(0),a=0;for(;a++<t;){const t=await e.ioReader.readUint8();i=i<<BigInt(8)|BigInt.asUintN(64,BigInt(Math.floor(t)))}return t===BigInt(3)?0|Number(0xffffffffn&BigInt.asIntN(24,i)):BigInt.asIntN(64,i)}async function V(e,t){const i=e.ioReader.getPos();let a=await e.ioReader.peekUint8();if(!a)return h.z3(`0x00 as pos ${i} invalid as first byte of an EBML number`,N,902),p.LR;let r=1;for(;!(128&a);)r++,a<<=1;let n=0;for(;r--;)n<<=8,n|=await e.ioReader.readUint8();return n}async function O(e,t,i,a={},r=[]){return await async function(e,t,i){const a=e.privateData,r=e.ioReader.getPos();for(;e.ioReader.getPos()<r+t;){const t=await V(e,a.header.maxIdLength),r=await T(e.ioReader,a.header.maxSizeLength);if(e.ioReader.getPos(),!1===await i(t,r))return}}(e,t,(async(t,n)=>{if(i[t]){const r=i[t];let s;switch(r.type){case 1:s=await M(e,n);break;case 2:s=await M(e,n),U.ai(s)&&(s=BigInt(s));break;case 3:s=await z(e,n);break;case 4:s=await z(e,n),U.ai(s)&&(s=BigInt(s));break;case 6:case 5:s=await async function(e,t){return t===BigInt(4)?e.ioReader.readFloat():t===BigInt(8)?e.ioReader.readDouble():(await e.ioReader.skip(0|Number(0xffffffffn&t)),0)}(e,n);break;case 7:s=await e.ioReader.readString(0|Number(0xffffffffn&n));break;case 10:s=!0;break;case 8:s={pos:e.ioReader.getPos(),size:n,data:n<I?await e.ioReader.readBuffer(0|Number(0xffffffffn&n)):null};break;case 9:s=r.child?await O(e,n,r.child):{};break;default:await e.ioReader.skip(0|Number(0xffffffffn&n))}if(s)if(r.isArray){const e=a[r.filedName]||[];e.push(s),a[r.filedName]=e}else a[r.filedName]=s}else await e.ioReader.skip(0|Number(0xffffffffn&n));if(r.length&&w.zy(r,t))return!1})),a}var F=i(620),G=i(3e3),X=i(4392),W=i(8919),$=i(412),H=i(9088),Y=i(5451),K=i(8469),j=i(4328),J=i(1865);function Q(e,t){f.M[2](e,255&t)}function q(e,t){Q(e,t>>8),Q(e+1,t)}function Z(e,t){q(e,t>>16),q(e+2,65535&t)}var ee="src/avformat/formats/IMatroskaFormat.ts";class te extends u.A{constructor(){super(),(0,a.A)(this,"type",5),(0,a.A)(this,"context",void 0),(0,a.A)(this,"blockReader",void 0)}init(e){e.ioReader&&e.ioReader.setEndian(!0);const t={isLive:!0,firstCluster:-BigInt(1),segmentStart:-BigInt(1),header:{version:0,readVersion:0,maxIdLength:4,maxSizeLength:8,docType:"",docTypeVersion:0,docTypeReadVersion:0},seekHead:null,info:null,tracks:null,attachments:null,chapters:null,cues:null,tags:null,currentCluster:{timeCode:BigInt(0),pos:-BigInt(1),block:{pos:-BigInt(1),size:-BigInt(1)},blockGroup:{block:null}},clusterIndexes:[],clusterIndexesPosMap:new(n())};e.privateData=this.context=t}analyzeStreams(e){const t="webm"===this.context.header.docType?x:b;this.context.tracks&&w.__(this.context.tracks.entry,(i=>{var a;const r=e.createStream();switch(r.privData=i,r.codecpar.codecId=t[i.codecId],i.type){case 2:r.codecpar.codecType=1;break;case 1:r.codecpar.codecType=0;break;case 17:r.codecpar.codecType=3;break;default:r.codecpar.codecType=-1}if(i.audio?("A_PCM/FLOAT/IEEE"===i.codecName?64===i.audio.bitDepth?r.codecpar.codecId=65559:32===i.audio.bitDepth&&(r.codecpar.codecId=65557):"A_PCM/INT/BIG"===i.codecName?16===i.audio.bitDepth?r.codecpar.codecId=65537:24===i.audio.bitDepth?r.codecpar.codecId=65549:32===i.audio.bitDepth&&(r.codecpar.codecId=65545):"A_PCM/INT/LIT"===i.codecName&&(8===i.audio.bitDepth?r.codecpar.codecId=65541:16===i.audio.bitDepth?r.codecpar.codecId=65536:24===i.audio.bitDepth?r.codecpar.codecId=65548:32===i.audio.bitDepth&&(r.codecpar.codecId=65544)),r.codecpar.chLayout.nbChannels=i.audio.channels,r.codecpar.channels=i.audio.channels,r.codecpar.sampleRate=0|i.audio.sampleRate,r.codecpar.bitsPerCodedSample=i.audio.bitDepth):i.video&&(r.codecpar.width=i.video.pixelWidth,r.codecpar.height=i.video.pixelHeight,i.video.color&&(r.codecpar.colorPrimaries=i.video.color.primaries,r.codecpar.colorTrc=i.video.color.transferCharacteristics,r.codecpar.colorRange=i.video.color.range,r.codecpar.colorSpace=i.video.color.matrixCoefficients)),null!==(a=i.codecPrivate)&&void 0!==a&&a.data)if(r.codecpar.extradataSize=0|Number(0xffffffffn&i.codecPrivate.size),r.codecpar.extradata=(0,m.sY)(r.codecpar.extradataSize),(0,d.lW)(r.codecpar.extradata,r.codecpar.extradataSize,i.codecPrivate.data),r.codecpar.extradata)switch(r.codecpar.codecId){case 27:F.XC(r,(0,d.s3)(r.codecpar.extradata,r.codecpar.extradataSize));break;case 173:G.XC(r,(0,d.s3)(r.codecpar.extradata,r.codecpar.extradataSize));break;case 226:$.XC(r,(0,d.s3)(r.codecpar.extradata,r.codecpar.extradataSize));break;case 139:X.X(r,(0,d.s3)(r.codecpar.extradata,r.codecpar.extradataSize));break;case 167:W.X(r,(0,d.s3)(r.codecpar.extradata,r.codecpar.extradataSize));break;case 86018:K.XC(r,(0,d.s3)(r.codecpar.extradata,r.codecpar.extradataSize));break;case 86017:H.XC(r,(0,d.s3)(r.codecpar.extradata,r.codecpar.extradataSize));break;case 86076:Y.XC(r,(0,d.s3)(r.codecpar.extradata,r.codecpar.extradataSize))}else{let e;86018===r.codecpar.codecId&&(e=K.Ij(r.codecpar)),e&&(r.codecpar.extradataSize=e.length,r.codecpar.extradata=(0,m.sY)(r.codecpar.extradataSize),(0,d.lW)(r.codecpar.extradata,r.codecpar.extradataSize,e))}this.context.info&&(r.timeBase.num=1,this.context.info.timestampScale?r.timeBase.den=1e3*y.SF/this.context.info.timestampScale|0:r.timeBase.den=1e3,this.context.info.duration&&(r.duration=BigInt(Math.floor(this.context.info.duration))))})),this.context.attachments&&w.__(this.context.attachments.entry,(t=>{const i=e.createStream();i.codecpar.codecType=4,i.privData=t,t.data&&(i.codecpar.extradataSize=0|Number(0xffffffffn&t.data.size),i.codecpar.extradata=(0,m.sY)(i.codecpar.extradataSize),(0,d.lW)(i.codecpar.extradata,i.codecpar.extradataSize,t.data.data))})),this.context.tags&&w.__(this.context.tags.entry,(t=>{var i;if("DURATION"===(null===(i=t.tag)||void 0===i?void 0:i.name)){let i=t.tag.string.replaceAll("\0","").split("."),a=i[0].split(":"),r=BigInt(+a[0])*BigInt(36e8)+BigInt(+a[1])*BigInt(6e7)+BigInt(+a[2])*BigInt(1e6)+BigInt(+i[1])/BigInt(1e3);const n=function(e,t){for(let i=0;i<e.length;i++)if(e[i].privData.uid===t)return e[i]}(e.streams,t.target.trackUid);n&&(n.duration=(0,j.k)(r,y.KR,n.timeBase))}}))}async readHeader(e){if(440786851!==await V(e,this.context.header.maxIdLength))return h.z3("not matroska format",ee,294),p.LR;const t=await T(e.ioReader,this.context.header.maxSizeLength);if(this.context.header=await O(e,t,E),408125543!==await V(e,this.context.header.maxIdLength))return h.z3("not matroska format",ee,303),p.LR;const i=await T(e.ioReader,this.context.header.maxSizeLength);this.context.segmentStart=e.ioReader.getPos();const a=e.ioReader.getPos()+i,r=new(o());for(;e.ioReader.getPos()<a;){const t=e.ioReader.getPos(),i=await V(e,this.context.header.maxIdLength),a=await T(e.ioReader,this.context.header.maxSizeLength);if(290298740===i)this.context.isLive=!1,this.context.seekHead=await O(e,a,A);else if(475249515===i)this.context.isLive=!1,this.context.cues=await O(e,a,P);else if(272869232===i)this.context.isLive=!1,this.context.chapters=await O(e,a,R);else if(357149030===i)this.context.info=await O(e,a,S);else if(307544935===i)this.context.tags=await O(e,a,_);else if(423732329===i)this.context.attachments=await O(e,a,B);else if(374648427===i)this.context.tracks=await O(e,a,k);else if(524531317===i){if(this.context.firstCluster=t,this.context.isLive||!this.context.seekHead||!(1&e.ioReader.flags))break;const i=this.context.seekHead.entry;let a=0;for(;a<i.length;a++)if(!r.has(i[a].id)){await e.ioReader.seek(i[a].pos+this.context.segmentStart);break}if(a===i.length)break}else await e.ioReader.skip(0|Number(0xffffffffn&a));r.add(i)}return await e.ioReader.seek(this.context.firstCluster),this.analyzeStreams(e),0}parseAdditions(e,t){for(let n=0;n<t.entry.length;n++){var i;const s=t.entry[n];if(null!==(i=s.additional)&&void 0!==i&&i.size){4===s.additionalId&&h.R8("ITU_T_T35 not support now",ee,378);const t=(0,m.sY)(s.additional.data.length+8);a=t,r=BigInt(s.additionalId>>>0),Z(a,Number(r>>BigInt(32)&0xffffffffn)),Z(a+4,Number(r&BigInt(4294967295)&0xffffffffn)),(0,d.lW)(t+8,s.additional.data.length,s.additional.data),(0,g.Ow)(e,15,t,s.additional.data.length+8)}}var a,r}async parseBlock(e,t){var i,a;const r=(null===(i=this.context.currentCluster.block)||void 0===i?void 0:i.data)||this.context.currentCluster.blockGroup.block.data;let n=null===(a=this.context.currentCluster.block)||void 0===a?void 0:a.pos;n<0&&(n=this.context.currentCluster.blockGroup.block.pos);let s,o=!1;this.context.currentCluster.blockGroup&&(s=this.context.currentCluster.blockGroup.additions,o=!this.context.currentCluster.blockGroup.reference||0===this.context.currentCluster.blockGroup.reference.length),this.blockReader?this.blockReader.resetBuffer(r):this.blockReader=new J.A(r);const h=this.blockReader.getPos(),p=await D(this.blockReader,4),u=function(e,t){for(let i=0;i<e.length;i++)if(e[i].privData.number===t)return e[i]}(e.streams,p);if(!u)return;const b=this.blockReader.readInt16(),x=this.blockReader.readUint8();128&x&&(o=!0);let U=0,w=[];switch(x>>>1&3){case 1:{U=this.blockReader.readUint8()+1;let e=0;for(let e=0;e<U-1;e++){let e=0;for(;;){const t=this.blockReader.readUint8();if(0===t)break;if(255!==t){e+=t;break}e+=255}w.push(e)}w.push(r.length-(0|Number(this.blockReader.getPos()-h&0xffffffffn))-e);break}case 2:{U=this.blockReader.readUint8()+1;let e=0,t=0;for(let i=0;i<U-1;i++){const i=await D(this.blockReader,4);let a=0;a=t?t+i:i,e+=a,t=a,w.push(a)}w.push(r.length-(0|Number(this.blockReader.getPos()-h&0xffffffffn))-e);break}case 3:U=this.blockReader.readUint8()+1,w.fill(r.length-(0|Number(this.blockReader.getPos()-h&0xffffffffn))/U,0,U);break;case 0:U=1,w.push(r.length-(0|Number(this.blockReader.getPos()-h&0xffffffffn)))}const N=u.privData,I=N.timeScale||1;let A=(this.context.currentCluster.timeCode+BigInt(Math.floor(b*I)))*BigInt(this.context.info.timestampScale>>>0);N.codecDelay&&(A-=N.codecDelay),A/=BigInt(1e3),A=(0,j.k)(A,y.KR,u.timeBase);for(let i=0;i<U;i++){const a=0!==i?(0,g._5)():t;f.M[17](a+56,n+this.blockReader.getPos()),f.M[15](a+32,u.index),(0,d.Mr)(a+72,u.timeBase[c.o9],8),f.M[17](a+8,A),f.M[15](a+28,w[i]);const r=(0,m.sY)(w[i]);(0,d.lW)(r,w[i],this.blockReader.readBuffer(w[i])),(0,g.NX)(a,r,w[i]),o?(f.M[15](a+36,1|l.f[15](a+36)),N.gopCount&&(N.dtsDelta=(N.maxPts-N.minPts)/BigInt(N.gopCount>>>0)),N.gopCount=1,N.minPts=A,N.maxPts=A):(N.gopCount++,N.dtsDelta||(N.dtsDelta=(0,j.k)(BigInt(33),y.i0,u.timeBase))),A>N.maxPts&&(N.maxPts=A),1===u.codecpar.codecType||o?f.M[17](a+16,A):N.dtsDelta?f.M[17](a+16,N.currentDts+N.dtsDelta):f.M[17](a+16,BigInt(0)),N.currentDts=l.f[17](a+16),s&&this.parseAdditions(a,s),0!==i&&e.interval.packetBuffer.push(a)}}addClusterIndex(e){if(this.context.clusterIndexesPosMap.has(e.pos))return;const t=w.El(this.context.clusterIndexes,(t=>t.time<e.time?1:-1));t>-1?(this.context.clusterIndexesPosMap.set(e.pos,t),this.context.clusterIndexes.splice(t,0,e)):(this.context.clusterIndexesPosMap.set(e.pos,this.context.clusterIndexes.length),this.context.clusterIndexes.push(e))}async readAVPacket_(e,t){const i=e.ioReader.getPos(),a=await V(e,this.context.header.maxIdLength),r=await T(e.ioReader,this.context.header.maxSizeLength);if(524531317===a)this.context.currentCluster.pos=i,this.context.currentCluster.timeCode=BigInt(0),await O(e,r,C,this.context.currentCluster,[163,160]),this.addClusterIndex({time:this.context.currentCluster.timeCode,pos:i}),await this.parseBlock(e,t);else if(163===a)this.context.currentCluster.block={pos:e.ioReader.getPos(),size:r,data:await e.ioReader.readBuffer(0|Number(0xffffffffn&r))},await this.parseBlock(e,t);else{if(160!==a)return 475249515===a||307544935===a||423732329===a||272869232===a||357149030===a||374648427===a||290298740===a?(await e.ioReader.skip(0|Number(0xffffffffn&r)),this.readAVPacket_(e,t)):(await this.syncTopLevelElement(e),this.readAVPacket_(e,t));await O(e,r,L,this.context.currentCluster.blockGroup),await this.parseBlock(e,t),this.context.currentCluster.blockGroup={block:null}}return 0}async readAVPacket(e,t){try{return await this.readAVPacket_(e,t)}catch(t){return-1048576!==e.ioReader.error&&h.z3(t.message,ee,654),e.ioReader.error}}async syncTopLevelElement(e){let t=y.Dh;for(;;)try{const i=e.ioReader.getPos(),a=await V(e,this.context.header.maxIdLength),r=await T(e.ioReader,this.context.header.maxSizeLength);if(524531317===a||475249515===a||307544935===a||423732329===a||272869232===a||357149030===a||374648427===a||290298740===a){t=i;let a=0;for(await e.ioReader.skip(0|Number(0xffffffffn&r));a<=3;){const t=await V(e,this.context.header.maxIdLength),i=await T(e.ioReader,this.context.header.maxSizeLength);if(524531317!==t&&475249515!==t&&307544935!==t&&423732329!==t&&272869232!==t&&357149030!==t&&374648427!==t&&290298740!==t)break;a++,await e.ioReader.skip(0|Number(0xffffffffn&i))}if(!(a<3))break;await e.ioReader.seek(t+BigInt(1)),t=y.Dh}else await e.ioReader.seek(i+BigInt(1)),t=y.Dh}catch(e){break}t!==y.Dh&&await e.ioReader.seek(t)}async seek(e,t,i,a){var r;const n=e.ioReader.getPos(),s=(0,j.k)(i,t.timeBase,y.KR);let o=y.Dh;if(null!==(r=this.context.cues)&&void 0!==r&&r.entry.length){const e=t.privData;for(let t=0;t<this.context.cues.entry.length;t++)if((this.context.cues.entry[t].time||BigInt(0))*BigInt(this.context.info.timestampScale>>>0)/BigInt(1e3)>s){const i=this.context.cues.entry[Math.max(t-1,0)].pos;if(1===i.length)o=i[0].pos+this.context.segmentStart;else if(i.length>1){const t=i.find((t=>t.track===e.number));o=t?t.pos+this.context.segmentStart:i[0].pos+this.context.segmentStart}break}}if(o===y.Dh&&this.context.clusterIndexes.length)for(let e=0;e<this.context.clusterIndexes.length;e++)if(this.context.clusterIndexes[e].time*BigInt(this.context.info.timestampScale>>>0)/BigInt(1e3)>s){o=this.context.clusterIndexes[Math.max(e-1,0)].pos;break}return o!==y.Dh?(await e.ioReader.seek(o),n):BigInt(p.E$)}getAnalyzeStreamsCount(){var e,t;return null!==(e=null===(t=this.context.tracks)||void 0===t?void 0:t.entry.length)&&void 0!==e?e:2}}},null:()=>{},3991:(e,t,i)=>{"use strict";function a(e){let t=0,i=0;for(;i<32&&0===e.readU1();)i++;return t=e.readU(i),t+=(1<<i)-1,t}function r(e){let t=a(e);return t=1&t?(t+1)/2:-t/2,t}i.d(t,{$x:()=>r,xb:()=>a})},264:(e,t,i)=>{"use strict";function a(e){return e.length>4&&0===e[0]&&0===e[1]&&(1===e[2]||0===e[2]&&1===e[3])}function r(e,t){let i=0;for(let a=t;a<e.length;a++)switch(e[a]){case 0:i++;break;case 1:if(i>=2)return{offset:a-Math.min(i,3),startCode:Math.min(i+1,4)};i=0;break;default:i=0}return{offset:-1,startCode:0}}function n(e){const t=[];let i=r(e,0),a={offset:-1,startCode:0};for(;a=r(e,i.offset+i.startCode),a.offset>-1;)t.push(e.subarray(i.offset+i.startCode,a.offset,!0)),i=a;return t.push(e.subarray(i.offset+i.startCode,void 0,!0)),t}function s(e,t=0,i){i||(i=e.length);const a=new Uint8Array(e.length);let r=0,n=0;for(let s=0;s<e.length;s++){if(s>=t&&s<i)if(0===e[s])r++;else if(3===e[s]&&2===r&&s+1<e.length&&e[s+1]<=3){if(s++,s===e.length)break;r=0===e[s]?1:0}else r=0;a[n++]=e[s]}return a.slice(0,n)}i.d(t,{BN:()=>s,Bs:()=>a,py:()=>n})},7246:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var a=i(1026),r=i(4624);class n{constructor(e=1048576){(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"pointer",void 0),(0,a.A)(this,"bitsLeft",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"endPointer",void 0),(0,a.A)(this,"error",void 0),(0,a.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.size=e,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}peekU1(){let e=0;(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();let t=this.pointer,i=this.bitsLeft;return 0===i&&(t++,i=8),e=this.buffer[t]>>i-1&1,e}readU1(){let e=0;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,e=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8),e}readU(e){let t=0;for(let i=0;i<e;i++)t|=this.readU1()<<e-i-1;return t}remainingLength(){return this.endPointer-this.pointer}getPos(){return this.pointer}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&this.pointer++,!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);const e=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(e<0)throw this.error=e,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+e,this.pointer=0}else{const e=this.onFlush(this.buffer);if(this.endPointer=e,this.pointer=0,this.bitsLeft=8,e<0)throw this.error=e,Error("IOReader error, flush failed")}}getBuffer(){return this.buffer}appendBuffer(e){if(this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else{const t=Math.min(this.size-this.endPointer,e.length);this.buffer.set(e.subarray(0,t),this.endPointer),this.endPointer+=t,r.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src/common/io/BitReader.ts",174)}}clear(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0}skipPadding(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++)}}},729:(e,t,i)=>{"use strict";i.d(t,{A:()=>s});var a=i(1026),r=i(4624),n=i(11);class s{constructor(e,t=!0){(0,a.A)(this,"data",void 0),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"byteStart",void 0),(0,a.A)(this,"pos",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"littleEndian",void 0),this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}writeUint8(e){this.data.setUint8(this.pos+++this.byteStart,e)}writeUint16(e){this.data.setUint16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}writeUint24(e){const t=3840&e,i=240&e,a=15&e;this.littleEndian?(this.writeUint8(a),this.writeUint8(i),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(i),this.writeUint8(a))}writeUint32(e){this.data.setUint32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeUint64(e){const t=e&BigInt(4294967295),i=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeUint32(Number(t)),this.writeUint32(Number(i))):(this.writeUint32(Number(i)),this.writeUint32(Number(t)))}writeInt8(e){this.data.setInt8(this.pos+++this.byteStart,e)}writeInt16(e){this.data.setInt16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}writeInt32(e){this.data.setInt32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeInt64(e){const t=e&BigInt(4294967295),i=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeInt32(Number(t)),this.writeInt32(Number(i))):(this.writeInt32(Number(i)),this.writeInt32(Number(t)))}writeFloat(e){this.data.setFloat32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}writeDouble(e){this.data.setFloat64(this.pos+this.byteStart,e,this.littleEndian),this.pos+=8}getPos(){return this.pos}seek(e){e>this.size&&(e=this.size),this.pos=Math.max(0,e)}skip(e){this.seek(this.pos+e)}back(e){this.seek(this.pos-e)}remainingSize(){return this.size-this.pos}writeBuffer(e){let t=e.length;this.remainingSize()<t&&(t=this.remainingSize(),r.R8(`the remaining buffer size is smaller then the wrote buffer, hope set ${e.length}, but set ${t}`,"src/common/io/BufferWriter.ts",211)),this.buffer.set(e,this.pos),this.pos+=e.length}writeString(e){const t=n.l(e);return this.writeBuffer(t),t.length}getWroteBuffer(){return this.buffer.subarray(0,this.pos)}resetBuffer(e,t=!0){this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}}},8795:(e,t,i)=>{i(8978),i(7863),i(7914),i(1640),i(871),i(2584),i(8345),e.exports=i(6438).Set},1640:(e,t,i)=>{"use strict";var a=i(5933),r=i(6096);e.exports=i(9373)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return a.def(r(this,"Set"),e=0===e?0:e,e)}},a)},8345:(e,t,i)=>{i(643)("Set")},2584:(e,t,i)=>{i(4398)("Set")},871:(e,t,i)=>{var a=i(8535);a(a.P+a.R,"Set",{toJSON:i(5874)("Set")})},7860:(e,t,i)=>{e.exports=i(8795)}}]);