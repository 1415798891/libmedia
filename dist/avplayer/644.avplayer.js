"use strict";(self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[]).push([[644],{29347:(t,e,i)=>{i.d(e,{R:()=>d,u:()=>c});var a=i(37246),s=i(95073);const r=[1,2,2,2,2,3,3,4,4,5,6,6,6,7,8,8],n=[0,8e3,16e3,32e3,0,0,11025,22050,44100,0,0,12e3,24e3,48e3,96e3,192e3],o=[32e3,56e3,64e3,96e3,112e3,128e3,192e3,224e3,256e3,32e4,384e3,448e3,512e3,576e3,64e4,768e3,96e4,1024e3,1152e3,128e4,1344e3,1408e3,1411200,1472e3,1536e3,192e4,2048e3,3072e3,384e4,0,0,0],c=32;function d(t){const e=new a.A(t.length);e.appendBuffer(t);const i={syncWord:0,frameType:0,deficitSamples:0,crcFlag:0,sampleBlock:0,frameSize:0,channelIndex:0,sampleRateIndex:0,bitrateIndex:0,channels:0,sampleRate:0,bitrate:0};return i.syncWord=e.readU(32),2147385345!==i.syncWord&&4269736320!==i.syncWord?-1:(i.frameType=e.readU1(),i.deficitSamples=e.readU(5)+1,i.crcFlag=e.readU1(),i.sampleBlock=e.readU(7)+1,i.frameSize=(0,s.A)(e.readU(14)+1,4),i.channelIndex=e.readU(6),i.sampleRateIndex=e.readU(4),i.bitrateIndex=e.readU(5),i.channels=r[i.channelIndex],i.sampleRate=n[i.sampleRateIndex],i.bitrate=o[i.bitrateIndex],i)}},65451:(t,e,i)=>{i.d(e,{Ij:()=>d,XC:()=>c,kt:()=>o});var a=i(31865),s=i(729),r=i(44328);const n=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function o(t){let e=0,i=0,a=0;if(t.length<1)return 0;switch(e=t[0],i=n[e>>3],3&e){case 0:a=1;break;case 1:case 2:a=2;break;case 3:if(t.length<2)return 0;a=63&t[1]}return a*i}function c(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=19){const i=new a.A(e,!1);i.skip(9),t.codecpar.chLayout.nbChannels=i.readUint8(),t.codecpar.initialPadding=i.readUint16(),t.codecpar.sampleRate=i.readUint32(),t.codecpar.seekPreroll=Number((0,r.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function d(t){const e=new Uint8Array(19),i=new s.A(e,!1);return i.writeString("OpusHead"),i.writeUint8(1),i.writeUint8(t.chLayout.nbChannels),i.writeUint16(t.initialPadding),i.writeUint32(t.sampleRate),e}},85947:(t,e,i)=>{i.d(e,{A:()=>s});var a=i(134);class s{constructor(){(0,a.A)(this,"type",-1),(0,a.A)(this,"onStreamAdd",void 0)}destroy(t){}}},51660:(t,e,i)=>{i.d(e,{A:()=>o});var a=i(77231),s=i(4624),r=i(9705),n="src/avformat/formats/mpegts/function/parsePES.ts";function o(t){const e=t.data,i=e[3],o=e[4]<<8|e[5];let c=0,d=0,l=0;if(188!==i&&190!==i&&191!==i&&240!==i&&241!==i&&255!==i&&242!==i&&248!==i){let i=a.Dh,h=a.Dh;for(;;){if(6+d>=e.length)return;if(l=e[6+d],255!==l)break;d++}if(64==(192&l)&&(d+=2,l=e[6+d]),32==(224&l))c+=5,i=i=BigInt(Math.floor(536870912*(14&e[6+d])+4194304*(255&e[7+d])+16384*(254&e[8+d])+128*(255&e[9+d])+(254&e[10+d])/2)),16&l?(h=BigInt(Math.floor(536870912*(14&e[11+d])+4194304*(255&e[12+d])+16384*(254&e[13+d])+128*(255&e[14+d])+(254&e[15+d])/2)),c+=5):h=i;else if(128==(192&l)){const t=(192&e[7+d])>>>6;c=3+e[8+d],2!==t&&3!==t||(i=BigInt(Math.floor(536870912*(14&e[9+d])+4194304*(255&e[10+d])+16384*(254&e[11+d])+128*(255&e[12+d])+(254&e[13+d])/2)),h=3===t?BigInt(Math.floor(536870912*(14&e[14+d])+4194304*(255&e[15+d])+16384*(254&e[16+d])+128*(255&e[17+d])+(254&e[18+d])/2)):i)}else{if(15!==l)return s.z3("invalid data",n,121),r.LR;c=1}t.dts=h,t.pts=i;const p=6+d+c;let A=0;if(0!==o){if(o<d+c)return void s.z3("Malformed PES: PES_packet_length < 3 + PES_header_data_length",n,133);A=o-(d+c)}else A=e.byteLength-p;t.payload=e.subarray(p,p+A)}else if((188===i||191===i||240===i||241===i||255===i||242===i||248===i)&&6===t.streamId){const i=6;let a=0;a=0!==o?o:e.byteLength-i,t.payload=e.subarray(i,i+a)}return 0}},6403:(t,e,i)=>{i.d(e,{Cd:()=>l,I4:()=>p,am:()=>c,kJ:()=>h,pi:()=>d,xf:()=>A});var a=i(134),s=i(80662),r=i.n(s),n=i(77231);class o{constructor(){(0,a.A)(this,"discontinuityIndicator",0),(0,a.A)(this,"randomAccessIndicator",0),(0,a.A)(this,"elementaryStreamPriorityIndicator",0),(0,a.A)(this,"pcrFlag",0),(0,a.A)(this,"opcrFlag",0),(0,a.A)(this,"splicingPointFlag",0),(0,a.A)(this,"transportPrivateDataFlag",0),(0,a.A)(this,"adaptationFieldExtensionFlag",0),(0,a.A)(this,"pcr",BigInt(0)),(0,a.A)(this,"opcr",BigInt(0)),(0,a.A)(this,"spliceCountDown",0),(0,a.A)(this,"transportPrivateData",null),(0,a.A)(this,"extension",null)}}class c{constructor(){(0,a.A)(this,"pos",n.Dh),(0,a.A)(this,"payloadUnitStartIndicator",0),(0,a.A)(this,"transportPriority",0),(0,a.A)(this,"pid",n.N_),(0,a.A)(this,"adaptationFieldControl",0),(0,a.A)(this,"continuityCounter",0),(0,a.A)(this,"transportScramblingControl",0),(0,a.A)(this,"adaptationFieldInfo",new o),(0,a.A)(this,"payload",null)}}class d{constructor(){(0,a.A)(this,"slices",[]),(0,a.A)(this,"totalLength",0),(0,a.A)(this,"expectedLength",n.N_),(0,a.A)(this,"randomAccessIndicator",0),(0,a.A)(this,"pid",n.N_),(0,a.A)(this,"streamType",0),(0,a.A)(this,"pos",n.Dh)}}class l{constructor(){(0,a.A)(this,"versionNumber",0),(0,a.A)(this,"networkPid",n.N_),(0,a.A)(this,"program2PmtPid",new(r()))}}class h{constructor(){(0,a.A)(this,"tag",void 0),(0,a.A)(this,"buffer",void 0)}}class p{constructor(){(0,a.A)(this,"versionNumber",0),(0,a.A)(this,"programNumber",0),(0,a.A)(this,"pcrPid",0),(0,a.A)(this,"pid2StreamType",new(r())),(0,a.A)(this,"pid2ESDescriptor",new(r()))}}class A{constructor(){(0,a.A)(this,"pid",n.N_),(0,a.A)(this,"streamType",0),(0,a.A)(this,"streamId",n.N_),(0,a.A)(this,"dts",n.Dh),(0,a.A)(this,"pts",n.Dh),(0,a.A)(this,"pos",n.Dh),(0,a.A)(this,"payload",null),(0,a.A)(this,"data",null),(0,a.A)(this,"randomAccessIndicator",0)}}},2187:(t,e,i)=>{i.d(e,{d:()=>n});var a=i(72739),s=i(44328),r=i(77231);function n(t,e,i){let n=BigInt(0);return a.__(t,(t=>{n+=t.codecpar.bitrate*(0,s.k)(e,i,r.i0)/BigInt(8e3)})),n}},52071:(t,e,i)=>{i.d(e,{A:()=>A});var a=i(63939),s=i(9599),r=i(29170),n=i(77231),o=i(44328),c=i(2187),d=i(71517),l=i(9705),h=i(4624),p="src/avformat/function/seekInBytes.ts";async function A(t,e,i,A,f,u){const m=t.ioReader.getPos(),g=await t.ioReader.fileSize();let I=n.Dh,y=i;e.startTime!==n.Dh?y-=e.startTime:y-=e.firstDTS;const k=(0,o.k)(i,e.timeBase,n.i0);if(k<BigInt(1e4))return h.Yz(`seek pts is earlier then 10s, seek to first packet pos(${A}) directly`,p,63),await t.ioReader.seek(A),m;let w=(0,c.d)(t.streams,y,e.timeBase);const b=g-(0,c.d)(t.streams,BigInt(1e4),n.i0),B=(0,c.d)(t.streams,BigInt(1e4),n.i0);if(w>b&&(w=b),w<A)return await t.ioReader.seek(A),m;const P=(0,d._5)();let v=g,D=BigInt(0);for(;;){if(v-D<B){I=D;break}await t.ioReader.seek(w),await u(t);const e=t.ioReader.getPos();if(!(await f(t,P)>=0)){I=n.Dh;break}{const t=(0,o.k)(a.f[17](P+8),(0,r.A)(P+72,s.P),n.i0),i=t-k;if(h.Yz(`try to seek to pos: ${w}, got packet pts: ${a.f[17](P+8)}(${t}ms), diff: ${i}ms`,p,98),i<=BigInt(0)&&-i<BigInt(1e4)){I=e;break}i>BigInt(0)?(v=w,w=D+v>>BigInt(1)):(D=w,w=D+v>>BigInt(1))}}return(0,d.Qe)(P),I!==n.Dh?(h.Yz(`finally seek to pos ${I}`,p,126),await t.ioReader.seek(I),await u(t),m):(await t.ioReader.seek(m),BigInt(l.E$))}},95073:(t,e,i)=>{function a(t,e){return t+(e-1)&~(e-1)}i.d(e,{A:()=>a})}}]);